/*! For license information please see main.b13448ac.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},61:(e,t,n)=>{n.d(t,{Mq:()=>h,T0:()=>l,d6:()=>d,e0:()=>i,expenseDB:()=>o,mh:()=>f,qF:()=>c,transferDB:()=>u});var r=n(379),s=n(319);const a=function(e){var t,n,r,s;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"database operation";return console.error("Network error during ".concat(a,":"),e),null!==(t=e.message)&&void 0!==t&&t.includes("NetworkError")||null!==(n=e.message)&&void 0!==n&&n.includes("CORS")||null!==(r=e.message)&&void 0!==r&&r.includes("fetch")||null!==(s=e.message)&&void 0!==s&&s.includes("Cross-Origin")||"NETWORK_ERROR"===e.code?(console.warn("\ud83d\udea8 CORS/Network error detected during ".concat(a,":"),{message:e.message,code:e.code,details:e.details,hint:e.hint}),{isNetworkError:!0,isCorsError:!0,message:"Network connection issue or CORS error. This might be due to:\n1. Internet connectivity problems\n2. Supabase project configuration issues\n3. Browser blocking the request\n4. Invalid API keys or authentication\nPlease check your connection and try again.",troubleshooting:{checkConnection:"Verify internet connectivity",checkSupabaseStatus:"Check if Supabase is accessible at https://status.supabase.com",checkApiKeys:"Verify your Supabase URL and API key are correct",checkBrowser:"Try in a different browser or incognito mode",checkConsole:"Check browser console for detailed error messages"},originalError:e}):{isNetworkError:!1,originalError:e}},i=async()=>{try{const{data:e,error:t}=await s.A.from("expenses").select("count",{count:"exact"}).limit(1);if(t){const e=a(t,"database initialization");return e.isNetworkError?{success:!1,message:e.message,isNetworkError:!0}:"42P01"===t.code?(console.error("Database tables do not exist yet. Please run the SQL setup script from MIGRATION-GUIDE.md in the Supabase SQL Editor."),{success:!1,message:"Database tables not found. Please create them using the SQL script in MIGRATION-GUIDE.md."}):(console.error("Error checking database:",t),{success:!1,error:t})}return console.log("Supabase database tables exist and are ready to use."),{success:!0}}catch(e){const t=a(e,"database initialization");return t.isNetworkError?{success:!1,message:t.message,isNetworkError:!0}:(console.error("Error initializing Supabase database:",e),{success:!1,error:e})}},o={getAll:async e=>{if(!e)return[];try{const{data:t,error:n}=await s.A.from("expenses").select("*").eq("user_id",e).is("deleted_at",null).order("date",{ascending:!1});if(n)throw n;return t||[]}catch(t){return console.error("Error getting expenses:",t),[]}},getAllIncludingDeleted:async e=>{if(!e)return[];try{const{data:t,error:n}=await s.A.from("expenses").select("*").eq("user_id",e).order("date",{ascending:!1});if(n)throw n;return t||[]}catch(t){return console.error("Error getting all expenses:",t),[]}},getById:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("expenses").select("*").eq("id",e).eq("user_id",t).single();if(r&&"PGRST116"!==r.code){const t=a(r,"getting expense by ID");if(t.isNetworkError)return console.warn("Network error getting expense ".concat(e,":"),t.message),null;throw r}return n}catch(n){const t=a(n,"getting expense by ID");return t.isNetworkError?(console.warn("Network error getting expense ".concat(e,":"),t.message),null):(console.error("Error getting expense by ID:",n),null)}},add:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const n={user_id:t,amount:parseFloat(e.amount),description:e.description,category:e.category,date:e.date,wallet_id:e.wallet_id,notes:e.notes||"",tags:e.tags.map((e=>"object"===typeof e?e.id:e))||[],is_income:e.is_income,photo_url:e.photoUrl||null,deleted_at:null,last_modified:(new Date).toISOString(),sync_status:"synced"};console.log("Adding expense with data:",n);const{data:r,error:a}=await s.A.from("expenses").insert([n]).select().single();if(a)throw a;return r}catch(n){throw console.error("Error adding expense:",n),n}},update:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const n={user_id:t,amount:parseFloat(e.amount),description:e.description,category:e.category,date:e.date,wallet_id:e.wallet_id,notes:e.notes||"",tags:e.tags.map((e=>"object"===typeof e?e.id:e))||[],is_income:e.is_income,photo_url:e.photoUrl||null,last_modified:(new Date).toISOString(),sync_status:"synced"},{data:r,error:a}=await s.A.from("expenses").update(n).eq("id",e.id).eq("user_id",t).select().single();if(a)throw a;return r}catch(n){throw console.error("Error updating expense:",n),n}},delete:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("expenses").select("*").eq("id",e).eq("user_id",t).single();if(r&&"PGRST116"!==r.code)throw r;if(!n)throw new Error("Expense not found or unauthorized");const{error:a}=await s.A.from("expenses").update({deleted_at:(new Date).toISOString(),last_modified:(new Date).toISOString(),sync_status:"synced"}).eq("id",e).eq("user_id",t);if(a)throw a;return e}catch(n){throw console.error("Error soft deleting expense:",n),n}},hardDelete:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{error:n}=await s.A.from("expenses").delete().eq("id",e).eq("user_id",t);if(n)throw n;return e}catch(n){throw console.error("Error hard deleting expense:",n),n}},restore:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("expenses").update({deleted_at:null,last_modified:(new Date).toISOString(),sync_status:"synced"}).eq("id",e).eq("user_id",t).select().single();if(r)throw r;return n}catch(n){throw console.error("Error restoring expense:",n),n}}},l={getAll:async e=>{if(!e)return[];try{const{data:t,error:n}=await s.A.from("categories").select("*").eq("user_id",e);if(n)throw n;return t||[]}catch(t){return console.error("Error getting categories:",t),[]}},add:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const n=(0,r.A)((0,r.A)((0,r.A)({},e.id&&{id:e.id}),{},{name:e.name.trim(),user_id:t},e.color&&{color:e.color}),{},{last_modified:(new Date).toISOString(),sync_status:"synced"}),{data:a,error:i}=await s.A.from("categories").upsert(n,{onConflict:"id"}).select().single();if(i)throw console.error("Supabase error adding/updating category:",i),i;return a}catch(n){throw console.error("Error in categoryDB.add:",n.message),new Error("Failed to add/update category: ".concat(n.message))}},update:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("categories").select("*").eq("id",e.id).eq("user_id",t).single();if(r)throw r;if(!n)throw new Error("Category not found or unauthorized");const{data:a,error:i}=await s.A.from("categories").update(e).eq("id",e.id).eq("user_id",t).select().single();if(i)throw i;return a}catch(n){throw console.error("Error updating category:",n),n}},delete:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("categories").select("*").eq("id",e).eq("user_id",t).single();if(r&&"PGRST116"!==r.code)throw r;if(!n)throw new Error("Category not found or unauthorized");const{error:a}=await s.A.from("categories").delete().eq("id",e).eq("user_id",t);if(a)throw a;return e}catch(n){throw console.error("Error deleting category:",n),n}},cleanupDuplicates:async e=>{if(!e)throw new Error("User not authenticated");try{const{data:t,error:n}=await s.A.from("categories").select("*").eq("user_id",e).order("created_at",{ascending:!0});if(n)throw n;const r={};t.forEach((e=>{const t=e.name.toLowerCase().trim();r[t]||(r[t]=[]),r[t].push(e)}));const a=[];Object.values(r).forEach((e=>{e.length>1&&a.push(...e.slice(1))}));for(const i of a)await s.A.from("categories").delete().eq("id",i.id).eq("user_id",e);return{duplicatesRemoved:a.length,duplicateNames:[...new Set(a.map((e=>e.name)))]}}catch(t){throw console.error("Error cleaning up duplicate categories:",t),t}}},c={getAll:async e=>{if(!e)return[];try{const{data:t,error:n}=await s.A.from("wallets").select("*").eq("user_id",e);if(n)throw n;return t||[]}catch(t){return console.error("Error getting wallets:",t),[]}},add:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const n=(0,r.A)((0,r.A)({},e),{},{user_id:t,last_modified:(new Date).toISOString(),sync_status:"synced"}),{data:a,error:i}=await s.A.from("wallets").upsert(n,{onConflict:"id"}).select().single();if(i)throw console.error("Supabase error adding/updating wallet:",i),i;return a}catch(n){throw console.error("Error in walletDB.add:",n.message),new Error("Failed to add/update wallet: ".concat(n.message))}},update:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("wallets").select("*").eq("id",e.id).eq("user_id",t).single();if(r)throw r;if(!n)throw new Error("Wallet not found or unauthorized");const{data:a,error:i}=await s.A.from("wallets").update(e).eq("id",e.id).eq("user_id",t).select().single();if(i)throw i;return a}catch(n){throw console.error("Error updating wallet:",n),n}},delete:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("wallets").select("*").eq("id",e).eq("user_id",t).single();if(r&&"PGRST116"!==r.code)throw r;if(!n)throw new Error("Wallet not found or unauthorized");const{error:a}=await s.A.from("wallets").delete().eq("id",e).eq("user_id",t);if(a)throw a;return e}catch(n){throw console.error("Error deleting wallet:",n),n}}},d={getAll:async e=>{if(!e)return[];try{const{data:t,error:n}=await s.A.from("tags").select("*").eq("user_id",e);if(n)throw n;return t||[]}catch(t){return console.error("Error getting tags:",t),[]}},getById:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("tags").select("*").eq("id",e).eq("user_id",t).single();if(r&&"PGRST116"!==r.code){const t=a(r,"getting tag by ID");if(t.isNetworkError)return console.warn("Network error getting tag ".concat(e,":"),t.message),null;throw r}return n}catch(n){const t=a(n,"getting tag by ID");return t.isNetworkError?(console.warn("Network error getting tag ".concat(e,":"),t.message),null):(console.error("Error getting tag by ID:",n),null)}},add:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const n=(0,r.A)((0,r.A)((0,r.A)({},e.id&&{id:e.id}),{},{name:e.name.trim(),user_id:t},e.color&&{color:e.color}),{},{last_modified:(new Date).toISOString(),sync_status:"synced"}),{data:a,error:i}=await s.A.from("tags").upsert(n,{onConflict:"id"}).select().single();if(i)throw console.error("Supabase error adding/updating tag:",i),i;return a}catch(n){throw console.error("Error in tagDB.add:",n.message),new Error("Failed to add/update tag: ".concat(n.message))}},update:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:a}=await s.A.from("tags").select("*").eq("id",e.id).eq("user_id",t).single();if(a)throw a;if(!n)throw new Error("Tag not found or unauthorized");const i=(0,r.A)((0,r.A)({name:e.name.trim()},e.color&&{color:e.color}),{},{last_modified:(new Date).toISOString()}),{data:o,error:l}=await s.A.from("tags").update(i).eq("id",e.id).eq("user_id",t).select().single();if(l)throw l;return o}catch(n){throw console.error("Error updating tag:",n),n}},delete:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("tags").select("*").eq("id",e).eq("user_id",t).single();if(r&&"PGRST116"!==r.code)throw r;if(!n)throw new Error("Tag not found or unauthorized");const{error:a}=await s.A.from("tags").delete().eq("id",e).eq("user_id",t);if(a)throw a;return e}catch(n){throw console.error("Error deleting tag:",n),n}},cleanupDuplicates:async e=>{if(!e)throw new Error("User not authenticated");try{const{data:t,error:n}=await s.A.from("tags").select("*").eq("user_id",e).order("created_at",{ascending:!0});if(n)throw n;const r={};t.forEach((e=>{const t=e.name.toLowerCase().trim();r[t]||(r[t]=[]),r[t].push(e)}));const a=[];Object.values(r).forEach((e=>{e.length>1&&a.push(...e.slice(1))}));for(const i of a)await s.A.from("tags").delete().eq("id",i.id).eq("user_id",e);return{duplicatesRemoved:a.length,duplicateNames:[...new Set(a.map((e=>e.name)))]}}catch(t){throw console.error("Error cleaning up duplicate tags:",t),t}}},u={getAll:async e=>{if(!e)return[];try{const{data:t,error:n}=await s.A.from("transfers").select("*").eq("user_id",e).order("date",{ascending:!1});if(n)throw n;return t||[]}catch(t){return console.error("Error getting transfers:",t),[]}},getById:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("transfers").select("*").eq("id",e).eq("user_id",t).single();if(r&&"PGRST116"!==r.code)throw r;return n}catch(n){return console.error("Error getting transfer by ID:",n),null}},add:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const n={user_id:t,from_wallet_id:e.fromWallet,to_wallet_id:e.toWallet,amount:parseFloat(e.amount),date:e.date,notes:e.notes||"",photo_url:e.photoUrl||"",from_wallet_name:e.fromWalletName||"",to_wallet_name:e.toWalletName||"",timestamp:e.timestamp||(new Date).toISOString()},{data:a,error:i}=await s.A.from("transfers").insert([n]).select().single();if(i)throw i;return(0,r.A)((0,r.A)({},a),{},{fromWallet:a.from_wallet_id,toWallet:a.to_wallet_id,fromWalletName:a.from_wallet_name,toWalletName:a.to_wallet_name,photoUrl:a.photo_url})}catch(n){throw console.error("Error adding transfer:",n),n}},update:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:a}=await s.A.from("transfers").select("*").eq("id",e.id).eq("user_id",t).single();if(a)throw a;if(!n)throw new Error("Transfer not found or unauthorized");const i={from_wallet_id:e.fromWallet,to_wallet_id:e.toWallet,amount:parseFloat(e.amount),date:e.date,notes:e.notes||"",photo_url:e.photoUrl||"",from_wallet_name:e.fromWalletName||"",to_wallet_name:e.toWalletName||"",timestamp:e.timestamp||(new Date).toISOString()},{data:o,error:l}=await s.A.from("transfers").update(i).eq("id",e.id).eq("user_id",t).select().single();if(l)throw l;return(0,r.A)((0,r.A)({},o),{},{fromWallet:o.from_wallet_id,toWallet:o.to_wallet_id,fromWalletName:o.from_wallet_name,toWalletName:o.to_wallet_name,photoUrl:o.photo_url})}catch(n){throw console.error("Error updating transfer:",n),n}},delete:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("transfers").select("*").eq("id",e).eq("user_id",t).single();if(r&&"PGRST116"!==r.code)throw r;if(!n)throw new Error("Transfer not found or unauthorized");const{error:a}=await s.A.from("transfers").delete().eq("id",e).eq("user_id",t);if(a)throw a;return e}catch(n){throw console.error("Error deleting transfer:",n),n}}},h={getAll:async e=>{if(!e)return[];try{const{data:t,error:n}=await s.A.from("recurring").select("*").eq("user_id",e).order("next_date",{ascending:!0});if(n)throw n;return t||[]}catch(t){return console.error("Error getting recurring transactions:",t),[]}},add:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:a}=await s.A.from("recurring").insert([(0,r.A)((0,r.A)({},e),{},{user_id:t})]).select().single();if(a)throw a;return n}catch(n){throw console.error("Error adding recurring transaction:",n),n}},update:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("recurring").select("*").eq("id",e.id).eq("user_id",t).single();if(r)throw r;if(!n)throw new Error("Recurring transaction not found or unauthorized");const{data:a,error:i}=await s.A.from("recurring").update(e).eq("id",e.id).eq("user_id",t).select().single();if(i)throw i;return a}catch(n){throw console.error("Error updating recurring transaction:",n),n}},delete:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("recurring").select("*").eq("id",e).eq("user_id",t).single();if(r&&"PGRST116"!==r.code)throw r;if(!n)throw new Error("Recurring transaction not found or unauthorized");const{error:a}=await s.A.from("recurring").delete().eq("id",e).eq("user_id",t);if(a)throw a;return e}catch(n){throw console.error("Error deleting recurring transaction:",n),n}},getDueTransactions:async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;if(!e)return[];const n=t instanceof Date?t.toISOString().slice(0,10):t;try{const{data:t,error:r}=await s.A.from("recurring").select("*").eq("user_id",e).lte("next_date",n);if(r)throw r;return t||[]}catch(r){return console.error("Error getting due recurring transactions:",r),[]}}},f={getAll:async e=>{if(!e)return[];try{const{data:t,error:n}=await s.A.from("budgets").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(n)throw n;return t||[]}catch(t){return console.error("Error getting budgets:",t),[]}},add:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:a}=await s.A.from("budgets").insert([(0,r.A)((0,r.A)({},e),{},{user_id:t})]).select().single();if(a)throw a;return n}catch(n){throw console.error("Error adding budget:",n),n}},update:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("budgets").select("*").eq("id",e.id).eq("user_id",t).single();if(r)throw r;if(!n)throw new Error("Budget not found or unauthorized");const{data:a,error:i}=await s.A.from("budgets").update(e).eq("id",e.id).eq("user_id",t).select().single();if(i)throw i;return a}catch(n){throw console.error("Error updating budget:",n),n}},delete:async(e,t)=>{if(!t)throw new Error("User not authenticated");try{const{data:n,error:r}=await s.A.from("budgets").select("*").eq("id",e).eq("user_id",t).single();if(r&&"PGRST116"!==r.code)throw r;if(!n)throw new Error("Budget not found or unauthorized");const{error:a}=await s.A.from("budgets").delete().eq("id",e).eq("user_id",t);if(a)throw a;return e}catch(n){throw console.error("Error deleting budget:",n),n}}}},82:(e,t,n)=>{n.d(t,{Mq:()=>v,T0:()=>y,d6:()=>b,dq:()=>m,gf:()=>_,initializeDatabase:()=>S,mh:()=>w,oj:()=>k,qF:()=>x});var r=n(379);const s="expense-tracker-db",a="expenses",i="categories",o="tags",l="wallets",c="recurring",d="budgets",u="transfers",h=[{id:"food",name:"Food"},{id:"transportation",name:"Transportation"},{id:"entertainment",name:"Entertainment"},{id:"utilities",name:"Utilities"},{id:"housing",name:"Housing"},{id:"healthcare",name:"Healthcare"},{id:"other",name:"Other"}],f=[{id:"essential",name:"Essential"},{id:"recurring",name:"Recurring"},{id:"emergency",name:"Emergency"},{id:"personal",name:"Personal"},{id:"work",name:"Work"},{id:"family",name:"Family"},{id:"vacation",name:"Vacation"},{id:"gift",name:"Gift"},{id:"savings",name:"Savings"},{id:"education",name:"Education"}],g=[{id:"cash",name:"Cash",type:"cash",balance:0},{id:"bank",name:"Bank Account",type:"bank",balance:0},{id:"credit",name:"Credit Card",type:"credit_card",balance:0},{id:"ewallet",name:"E-Wallet",type:"e_wallet",balance:0}],p=()=>new Promise(((e,t)=>{if(!window.indexedDB)return console.error("Your browser doesn't support IndexedDB"),void e(!1);const n=window.indexedDB.open(s,8);n.onupgradeneeded=e=>{const t=e.target.result,n=e.oldVersion;if(n<1){if(!t.objectStoreNames.contains(a)){const e=t.createObjectStore(a,{keyPath:"id"});e.createIndex("date","date",{unique:!1}),e.createIndex("category","category",{unique:!1})}if(!t.objectStoreNames.contains(i)){const e=t.createObjectStore(i,{keyPath:"id"});h.forEach((t=>{e.add(t)}))}}if(n<2){if(!t.objectStoreNames.contains(o)){const e=t.createObjectStore(o,{keyPath:"id"});f.forEach((t=>{e.add(t)}))}if(t.objectStoreNames.contains(a)){e.target.transaction.objectStore(a).openCursor().onsuccess=e=>{const t=e.target.result;if(t){if(!t.value.tags){const e=(0,r.A)((0,r.A)({},t.value),{},{tags:[]});t.update(e)}t.continue()}}}}if(n<3&&!t.objectStoreNames.contains(l)){const e=t.createObjectStore(l,{keyPath:"id"});g.forEach((t=>e.add(t)))}if(n<4&&t.objectStoreNames.contains(a)){e.target.transaction.objectStore(a).openCursor().onsuccess=async e=>{const t=e.target.result;if(t){if(!t.value.walletId){const e=(0,r.A)((0,r.A)({},t.value),{},{walletId:"cash"});t.update(e)}t.continue()}}}if(n<5&&t.objectStoreNames.contains(a)){e.target.transaction.objectStore(a).openCursor().onsuccess=e=>{const t=e.target.result;if(t){const e=(0,r.A)((0,r.A)({},t.value),{},{isIncome:t.value.isIncome||!1,notes:t.value.notes||"",photoUrl:t.value.photoUrl||""});t.update(e),t.continue()}}}if(n<6&&!t.objectStoreNames.contains(c)){const e=t.createObjectStore(c,{keyPath:"id"});e.createIndex("nextDate","nextDate",{unique:!1}),e.createIndex("frequency","frequency",{unique:!1})}if(n<7){if(!t.objectStoreNames.contains(d)){const e=t.createObjectStore(d,{keyPath:"id"});e.createIndex("category","category",{unique:!1}),e.createIndex("period","period",{unique:!1})}if(!t.objectStoreNames.contains(u)){const e=t.createObjectStore(u,{keyPath:"id"});e.createIndex("date","date",{unique:!1}),e.createIndex("fromWallet","fromWallet",{unique:!1}),e.createIndex("toWallet","toWallet",{unique:!1})}}if(n<8){const n=e.target.transaction,s=[a,i,o,l,c,d,u];for(const e of s)if(t.objectStoreNames.contains(e)){n.objectStore(e).openCursor().onsuccess=e=>{const t=e.target.result;if(t){const e=t.value,n=(new Date).toISOString(),s=(0,r.A)((0,r.A)({},e),{},{deleted_at:e.deleted_at||null,last_modified:e.last_modified||n,sync_status:e.sync_status||"pending"});t.update(s),t.continue()}}}}},n.onsuccess=t=>{const n=t.target.result;e(!0),n.close()},n.onerror=e=>{console.error("IndexedDB error:",e.target.error),t(e.target.error)}})),m={getAll:()=>new Promise(((e,t)=>{const n=window.indexedDB.open(s,8);n.onsuccess=n=>{const r=n.target.result,s=r.transaction(a,"readonly").objectStore(a).getAll();s.onsuccess=()=>{const t=s.result.filter((e=>!e.deleted_at));e(t),r.close()},s.onerror=e=>{t(e),r.close()}},n.onerror=e=>{t(e.target.error)}})),getAllIncludingDeleted:()=>new Promise(((e,t)=>{const n=window.indexedDB.open(s,8);n.onsuccess=n=>{const r=n.target.result,s=r.transaction(a,"readonly").objectStore(a).getAll();s.onsuccess=()=>{e(s.result),r.close()},s.onerror=e=>{t(e),r.close()}},n.onerror=e=>{t(e.target.error)}})),getById:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,i=s.transaction(a,"readonly").objectStore(a).get(e);i.onsuccess=()=>{t(i.result),s.close()},i.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),add:e=>new Promise(((t,n)=>{const i=window.indexedDB.open(s,8);i.onsuccess=s=>{const i=s.target.result,o=i.transaction(a,"readwrite").objectStore(a),l=(new Date).toISOString(),c=(0,r.A)((0,r.A)({},e),{},{id:e.id||Date.now(),walletId:e.walletId||"cash",isIncome:e.isIncome||!1,notes:e.notes||"",photoUrl:e.photoUrl||"",deleted_at:null,last_modified:l,sync_status:"pending"}),d=o.add(c);d.onsuccess=()=>{t(c),i.close()},d.onerror=e=>{n(e),i.close()}},i.onerror=e=>{n(e.target.error)}})),update:e=>new Promise(((t,n)=>{const i=window.indexedDB.open(s,8);i.onsuccess=s=>{const i=s.target.result,o=i.transaction(a,"readwrite").objectStore(a),l=(new Date).toISOString(),c=(0,r.A)((0,r.A)({},e),{},{walletId:e.walletId||"cash",isIncome:e.isIncome||!1,notes:e.notes||"",photoUrl:e.photoUrl||"",last_modified:l,sync_status:"pending"}),d=o.put(c);d.onsuccess=()=>{t(c),i.close()},d.onerror=e=>{n(e),i.close()}},i.onerror=e=>{n(e.target.error)}})),delete:e=>new Promise(((t,n)=>{const i=window.indexedDB.open(s,8);i.onsuccess=s=>{const i=s.target.result,o=i.transaction(a,"readwrite").objectStore(a),l=o.get(e);l.onsuccess=()=>{const s=l.result;if(!s)return n(new Error("Expense not found")),void i.close();const a=(new Date).toISOString(),c=(0,r.A)((0,r.A)({},s),{},{deleted_at:a,last_modified:a,sync_status:"pending"}),d=o.put(c);d.onsuccess=()=>{t(e),i.close()},d.onerror=e=>{n(e),i.close()}},l.onerror=e=>{n(e),i.close()}},i.onerror=e=>{n(e.target.error)}})),hardDelete:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,i=s.transaction(a,"readwrite").objectStore(a).delete(e);i.onsuccess=()=>{t(e),s.close()},i.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),restore:e=>new Promise(((t,n)=>{const i=window.indexedDB.open(s,8);i.onsuccess=s=>{const i=s.target.result,o=i.transaction(a,"readwrite").objectStore(a),l=o.get(e);l.onsuccess=()=>{const e=l.result;if(!e)return n(new Error("Expense not found")),void i.close();const s=(new Date).toISOString(),a=(0,r.A)((0,r.A)({},e),{},{deleted_at:null,last_modified:s,sync_status:"pending"}),c=o.put(a);c.onsuccess=()=>{t(a),i.close()},c.onerror=e=>{n(e),i.close()}},l.onerror=e=>{n(e),i.close()}},i.onerror=e=>{n(e.target.error)}})),upsert:e=>new Promise(((t,n)=>{const i=window.indexedDB.open(s,8);i.onsuccess=s=>{const i=s.target.result,o=i.transaction(a,"readwrite").objectStore(a),l=(new Date).toISOString(),c=(0,r.A)((0,r.A)({},e),{},{walletId:e.walletId||e.wallet_id||"cash",isIncome:void 0!==e.isIncome?e.isIncome:e.is_income||!1,notes:e.notes||"",photoUrl:e.photoUrl||e.photo_url||"",last_modified:l,sync_status:e.sync_status||"pending"}),d=o.put(c);d.onsuccess=()=>{t(c),i.close()},d.onerror=e=>{console.error("Upsert error:",e),n(e),i.close()}},i.onerror=e=>{n(e.target.error)}}))},y={getAll:()=>new Promise(((e,t)=>{const n=window.indexedDB.open(s,8);n.onsuccess=n=>{const r=n.target.result,s=r.transaction(i,"readonly").objectStore(i).getAll();s.onsuccess=()=>{e(s.result),r.close()},s.onerror=e=>{t(e),r.close()}},n.onerror=e=>{t(e.target.error)}})),getById:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(i,"readonly").objectStore(i).get(e);a.onsuccess=()=>{t(a.result),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),add:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(i,"readwrite").objectStore(i).add(e);a.onsuccess=()=>{t(e),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),update:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(i,"readwrite").objectStore(i).put(e);a.onsuccess=()=>{t(e),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),delete:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(i,"readwrite").objectStore(i).delete(e);a.onsuccess=()=>{t(e),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}}))},b={getAll:()=>new Promise(((e,t)=>{const n=window.indexedDB.open(s,8);n.onsuccess=n=>{const r=n.target.result,s=r.transaction(o,"readonly").objectStore(o).getAll();s.onsuccess=()=>{e(s.result),r.close()},s.onerror=e=>{t(e),r.close()}},n.onerror=e=>{t(e.target.error)}})),add:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(o,"readwrite").objectStore(o).add(e);a.onsuccess=()=>{t(e),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),update:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(o,"readwrite").objectStore(o).put(e);a.onsuccess=()=>{t(e),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),getById:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(o,"readonly").objectStore(o).get(e);a.onsuccess=()=>{t(a.result),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),delete:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(o,"readwrite").objectStore(o).delete(e);a.onsuccess=()=>{t(e),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}}))},x={getAll:()=>new Promise(((e,t)=>{const n=window.indexedDB.open(s,8);n.onsuccess=n=>{const r=n.target.result,s=r.transaction(l,"readonly").objectStore(l).getAll();s.onsuccess=()=>{e(s.result),r.close()},s.onerror=e=>{t(e),r.close()}},n.onerror=e=>{t(e.target.error)}})),getById:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(l,"readonly").objectStore(l).get(e);a.onsuccess=()=>{t(a.result),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),add:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(l,"readwrite").objectStore(l).add(e);a.onsuccess=()=>{t(e),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),update:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(l,"readwrite").objectStore(l).put(e);a.onsuccess=()=>{t(e),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),delete:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(l,"readwrite").objectStore(l).delete(e);a.onsuccess=()=>{t(e),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}}))},v={getAll:()=>new Promise(((e,t)=>{const n=window.indexedDB.open(s,8);n.onsuccess=n=>{const r=n.target.result,s=r.transaction(c,"readonly").objectStore(c).getAll();s.onsuccess=()=>{e(s.result),r.close()},s.onerror=e=>{t(e),r.close()}},n.onerror=e=>{t(e.target.error)}})),getById:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(c,"readonly").objectStore(c).get(e);a.onsuccess=()=>{t(a.result),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),add:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(c,"readwrite").objectStore(c).add(e);a.onsuccess=()=>{t(e),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),update:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(c,"readwrite").objectStore(c).put(e);a.onsuccess=()=>{t(e),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),delete:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(c,"readwrite").objectStore(c).delete(e);a.onsuccess=()=>{t(!0),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),getDueTransactions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(c,"readonly").objectStore(c).index("nextDate"),i=(e=>e.toISOString().split("T")[0])(e),o=IDBKeyRange.upperBound(i),l=a.getAll(o);l.onsuccess=()=>{t(l.result),s.close()},l.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}}))}},w={getAll:()=>new Promise(((e,t)=>{const n=window.indexedDB.open(s,8);n.onsuccess=n=>{const r=n.target.result,s=r.transaction(d,"readonly").objectStore(d).getAll();s.onsuccess=()=>{e(s.result),r.close()},s.onerror=e=>{t(e),r.close()}},n.onerror=e=>{t(e.target.error)}})),getById:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(d,"readonly").objectStore(d).get(e);a.onsuccess=()=>{t(a.result),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),getByCategory:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(d,"readonly").objectStore(d).index("category").getAll(e);a.onsuccess=()=>{t(a.result),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),add:e=>new Promise(((t,n)=>{const a=window.indexedDB.open(s,8);a.onsuccess=s=>{const a=s.target.result,i=a.transaction(d,"readwrite").objectStore(d),o=(0,r.A)((0,r.A)({},e),{},{id:e.id||Date.now()}),l=i.add(o);l.onsuccess=()=>{t(o),a.close()},l.onerror=e=>{n(e),a.close()}},a.onerror=e=>{n(e.target.error)}})),update:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(d,"readwrite").objectStore(d).put(e);a.onsuccess=()=>{t(e),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),delete:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(d,"readwrite").objectStore(d).delete(e);a.onsuccess=()=>{t(!0),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}}))},_={getAll:()=>new Promise(((e,t)=>{const n=window.indexedDB.open(s,8);n.onsuccess=n=>{const r=n.target.result,s=r.transaction(u,"readonly").objectStore(u).getAll();s.onsuccess=()=>{e(s.result),r.close()},s.onerror=e=>{t(e),r.close()}},n.onerror=e=>{t(e.target.error)}})),getById:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(u,"readonly").objectStore(u).get(e);a.onsuccess=()=>{t(a.result),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}})),add:e=>new Promise(((t,n)=>{const a=window.indexedDB.open(s,8);a.onsuccess=s=>{const a=s.target.result,i=a.transaction(u,"readwrite").objectStore(u),o=(0,r.A)((0,r.A)({},e),{},{id:e.id||Date.now(),date:e.date||(new Date).toISOString().slice(0,10),photoUrl:e.photoUrl||""}),l=i.add(o);l.onsuccess=()=>{t(o),a.close()},l.onerror=e=>{n(e),a.close()}},a.onerror=e=>{n(e.target.error)}})),update:e=>new Promise(((t,n)=>{const a=window.indexedDB.open(s,8);a.onsuccess=s=>{const a=s.target.result,i=a.transaction(u,"readwrite").objectStore(u);if(!e.id)return n(new Error("Transfer ID is required for update")),void a.close();const o=(0,r.A)((0,r.A)({},e),{},{date:e.date||(new Date).toISOString().slice(0,10),photoUrl:e.photoUrl||""}),l=i.put(o);l.onsuccess=()=>{t(o),a.close()},l.onerror=e=>{n(e),a.close()}},a.onerror=e=>{n(e.target.error)}})),delete:e=>new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=r=>{const s=r.target.result,a=s.transaction(u,"readwrite").objectStore(u).delete(e);a.onsuccess=()=>{t(!0),s.close()},a.onerror=e=>{n(e),s.close()}},r.onerror=e=>{n(e.target.error)}}))},S=async()=>{try{const e=await p();return e&&await(async()=>{try{const e=localStorage.getItem("expenses");if(e){const t=JSON.parse(e);for(const e of t)await m.add(e);localStorage.removeItem("expenses")}const t=localStorage.getItem("expense-categories");if(t){const e=JSON.parse(t);for(const t of e)await y.add(t).catch((()=>{}));localStorage.removeItem("expense-categories")}return!0}catch(e){return console.error("Error migrating data:",e),!1}})(),e}catch(e){return console.error("Failed to initialize database:",e),!1}},k={cleanupOldTombstones:async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;const t=new Date(Date.now()-24*e*60*60*1e3).toISOString(),n=[a,i,o,l,c,d,u];return new Promise(((e,r)=>{const a=window.indexedDB.open(s,8);a.onsuccess=async s=>{const a=s.target.result;let i=0;try{for(const e of n)if(a.objectStoreNames.contains(e)){const n=a.transaction(e,"readwrite").objectStore(e),r=n.getAll();r.onsuccess=()=>{r.result.filter((e=>e.deleted_at&&e.deleted_at<t)).forEach((e=>{n.delete(e.id),i++}))}}a.close(),e({cleaned:i,cutoffDate:t})}catch(o){a.close(),r(o)}},a.onerror=e=>{r(e.target.error)}}))},getDeletionStats:async()=>{const e=[a,i,o,l,c,d,u];return new Promise(((t,n)=>{const r=window.indexedDB.open(s,8);r.onsuccess=async r=>{const s=r.target.result,a={};try{for(const t of e)if(s.objectStoreNames.contains(t)){const e=s.transaction(t,"readonly"),n=e.objectStore(t).getAll();n.onsuccess=()=>{const e=n.result,r=e.filter((e=>!e.deleted_at)),s=e.filter((e=>e.deleted_at));a[t]={total:e.length,active:r.length,deleted:s.length,deletedOlderThan30Days:s.filter((e=>{const t=new Date(Date.now()-2592e6);return new Date(e.deleted_at)<t})).length}}}s.close(),t(a)}catch(i){s.close(),n(i)}},r.onerror=e=>{n(e.target.error)}}))},validateDataIntegrity:async()=>new Promise(((e,t)=>{const n=window.indexedDB.open(s,8);n.onsuccess=async n=>{const r=n.target.result,s=[];try{const t=r.transaction(a,"readonly"),n=t.objectStore(a).getAll(),o=r.transaction(i,"readonly"),c=o.objectStore(i).getAll(),d=r.transaction(l,"readonly"),u=d.objectStore(l).getAll();Promise.all([new Promise((e=>{n.onsuccess=()=>e(n.result)})),new Promise((e=>{c.onsuccess=()=>e(c.result)})),new Promise((e=>{u.onsuccess=()=>e(u.result)}))]).then((t=>{let[n,a,i]=t;const o=n.filter((e=>!e.deleted_at)),l=a.filter((e=>!e.deleted_at)),c=i.filter((e=>!e.deleted_at)),d=new Set(l.map((e=>e.id))),u=new Set(c.map((e=>e.id)));o.forEach((e=>{d.has(e.category)||s.push({type:"orphaned_expense_category",expense:e,issue:"Category '".concat(e.category,"' not found")}),u.has(e.walletId)||s.push({type:"orphaned_expense_wallet",expense:e,issue:"Wallet '".concat(e.walletId,"' not found")}),e.last_modified||s.push({type:"missing_metadata",expense:e,issue:"Missing last_modified timestamp"})})),r.close(),e(s)}))}catch(o){r.close(),t(o)}},n.onerror=e=>{t(e.target.error)}}))}},153:(e,t,n)=>{var r=n(43),s=Symbol.for("react.element"),a=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,a={},c=null,d=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,r)&&!l.hasOwnProperty(r)&&(a[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===a[r]&&(a[r]=t[r]);return{$$typeof:s,type:e,key:c,ref:d,props:a,_owner:o.current}}t.Fragment=a,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}function b(){}function x(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||g}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=y.prototype;var v=x.prototype=new b;v.constructor=x,p(v,y.prototype),v.isPureReactComponent=!0;var w=Array.isArray,_=Object.prototype.hasOwnProperty,S={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function j(e,t,r){var s,a={},i=null,o=null;if(null!=t)for(s in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(i=""+t.key),t)_.call(t,s)&&!k.hasOwnProperty(s)&&(a[s]=t[s]);var l=arguments.length-2;if(1===l)a.children=r;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];a.children=c}if(e&&e.defaultProps)for(s in l=e.defaultProps)void 0===a[s]&&(a[s]=l[s]);return{$$typeof:n,type:e,key:i,ref:o,props:a,_owner:S.current}}function N(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var E=/\/+/g;function C(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,s,a,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return i=i(l=e),e=""===a?"."+C(l,0):a,w(i)?(s="",null!=e&&(s=e.replace(E,"$&/")+"/"),T(i,t,s,"",(function(e){return e}))):null!=i&&(N(i)&&(i=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,s+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(E,"$&/")+"/")+e)),t.push(i)),1;if(l=0,a=""===a?".":a+":",w(e))for(var c=0;c<e.length;c++){var d=a+C(o=e[c],c);l+=T(o,t,s,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=T(o=o.value,t,s,d=a+C(o,c++),i);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var r=[],s=0;return T(e,r,"","",(function(e){return t.call(n,e,s++)})),r}function D(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var P={current:null},O={transition:null},I={ReactCurrentDispatcher:P,ReactCurrentBatchConfig:O,ReactCurrentOwner:S};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!N(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=s,t.Profiler=i,t.PureComponent=x,t.StrictMode=a,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I,t.act=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var s=p({},e.props),a=e.key,i=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,o=S.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)_.call(t,c)&&!k.hasOwnProperty(c)&&(s[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)s.children=r;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:n,type:e.type,key:a,ref:i,props:s,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=j,t.createFactory=function(e){var t=j.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=N,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:D}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return P.current.useCallback(e,t)},t.useContext=function(e){return P.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return P.current.useDeferredValue(e)},t.useEffect=function(e,t){return P.current.useEffect(e,t)},t.useId=function(){return P.current.useId()},t.useImperativeHandle=function(e,t,n){return P.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return P.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return P.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return P.current.useMemo(e,t)},t.useReducer=function(e,t,n){return P.current.useReducer(e,t,n)},t.useRef=function(e){return P.current.useRef(e)},t.useState=function(e){return P.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return P.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return P.current.useTransition()},t.version="18.3.1"},210:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(829)),a=r(n(736)),i=n(745);class o{constructor(e){let{headers:t={},schema:n,fetch:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=Object.assign(Object.assign({},i.DEFAULT_HEADERS),t),this.schemaName=n,this.fetch=r}from(e){const t=new URL("".concat(this.url,"/").concat(e));return new s.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new o(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{head:r=!1,get:s=!1,count:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=new URL("".concat(this.url,"/rpc/").concat(e));let l;r||s?(t=r?"HEAD":"GET",Object.entries(n).filter((e=>{let[t,n]=e;return void 0!==n})).map((e=>{let[t,n]=e;return[t,Array.isArray(n)?"{".concat(n.join(","),"}"):"".concat(n)]})).forEach((e=>{let[t,n]=e;o.searchParams.append(t,n)}))):(t="POST",l=n);const c=Object.assign({},this.headers);return i&&(c.Prefer="count=".concat(i)),new a.default({method:t,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}}t.default=o},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,s=e[r];if(!(0<a(s,t)))break e;e[r]=t,e[n]=s,n=r}}function r(e){return 0===e.length?null:e[0]}function s(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,s=e.length,i=s>>>1;r<i;){var o=2*(r+1)-1,l=e[o],c=o+1,d=e[c];if(0>a(l,n))c<s&&0>a(d,l)?(e[r]=d,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<s&&0>a(d,n)))break e;e[r]=d,e[c]=n,r=c}}}return t}function a(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,f=3,g=!1,p=!1,m=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,x="undefined"!==typeof setImmediate?setImmediate:null;function v(e){for(var t=r(d);null!==t;){if(null===t.callback)s(d);else{if(!(t.startTime<=e))break;s(d),t.sortIndex=t.expirationTime,n(c,t)}t=r(d)}}function w(e){if(m=!1,v(e),!p)if(null!==r(c))p=!0,O(_);else{var t=r(d);null!==t&&I(w,t.startTime-e)}}function _(e,n){p=!1,m&&(m=!1,b(N),N=-1),g=!0;var a=f;try{for(v(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!T());){var i=h.callback;if("function"===typeof i){h.callback=null,f=h.priorityLevel;var o=i(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&s(c),v(n)}else s(c);h=r(c)}if(null!==h)var l=!0;else{var u=r(d);null!==u&&I(w,u.startTime-n),l=!1}return l}finally{h=null,f=a,g=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,k=!1,j=null,N=-1,E=5,C=-1;function T(){return!(t.unstable_now()-C<E)}function A(){if(null!==j){var e=t.unstable_now();C=e;var n=!0;try{n=j(!0,e)}finally{n?S():(k=!1,j=null)}}else k=!1}if("function"===typeof x)S=function(){x(A)};else if("undefined"!==typeof MessageChannel){var D=new MessageChannel,P=D.port2;D.port1.onmessage=A,S=function(){P.postMessage(null)}}else S=function(){y(A,0)};function O(e){j=e,k||(k=!0,S())}function I(e,n){N=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||g||(p=!0,O(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,s,a){var i=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?i+a:i:a=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:s,priorityLevel:e,startTime:a,expirationTime:o=a+o,sortIndex:-1},a>i?(e.sortIndex=a,n(d,e),null===r(c)&&e===r(d)&&(m?(b(N),N=-1):m=!0,I(w,a-i))):(e.sortIndex=o,n(c,e),p||g||(p=!0,O(_))),e},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},286:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(630)),a=r(n(611));t.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"===typeof fetch?this.fetch=s.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,n,r;let s=null,i=null,o=null,l=e.status,c=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(i="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),a=null===(n=e.headers.get("content-range"))||void 0===n?void 0:n.split("/");r&&a&&a.length>1&&(o=parseInt(a[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(i)&&(i.length>1?(s={code:"PGRST116",details:"Results contain ".concat(i.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},i=null,o=null,l=406,c="Not Acceptable"):i=1===i.length?i[0]:null)}else{const t=await e.text();try{s=JSON.parse(t),Array.isArray(s)&&404===e.status&&(i=[],s=null,l=200,c="OK")}catch(d){404===e.status&&""===t?(l=204,c="No Content"):s={message:t}}if(s&&this.isMaybeSingle&&(null===(r=null===s||void 0===s?void 0:s.details)||void 0===r?void 0:r.includes("0 rows"))&&(s=null,l=200,c="OK"),s&&this.shouldThrowOnError)throw new a.default(s)}return{error:s,data:i,count:o,status:l,statusText:c}}));return this.shouldThrowOnError||(n=n.catch((e=>{var t,n,r;return{error:{message:"".concat(null!==(t=null===e||void 0===e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null===e||void 0===e?void 0:e.message),details:"".concat(null!==(n=null===e||void 0===e?void 0:e.stack)&&void 0!==n?n:""),hint:"",code:"".concat(null!==(r=null===e||void 0===e?void 0:e.code)&&void 0!==r?r:"")},data:null,count:null,status:0,statusText:""}}))),n.then(e,t)}returns(){return this}overrideTypes(){return this}}},319:(e,t,n)=>{n.d(t,{A:()=>Wt});class r extends Error{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"FunctionsError",n=arguments.length>2?arguments[2]:void 0;super(e),this.name=t,this.context=n}}class s extends r{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class a extends r{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class i extends r{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var o;!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(o||(o={}));var l=function(e,t,n,r){return new(n||(n=Promise))((function(s,a){function i(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};class c{constructor(e){let{headers:t={},customFetch:r,region:s=o.Any}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=e,this.headers=t,this.region=s,this.fetch=(e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}})(r)}setAuth(e){this.headers.Authorization="Bearer ".concat(e)}invoke(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;return l(this,void 0,void 0,(function*(){try{const{headers:r,method:o,body:l}=t;let c,d={},{region:u}=t;u||(u=this.region),u&&"any"!==u&&(d["x-region"]=u),l&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!==typeof Blob&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",c=l):"string"===typeof l?(d["Content-Type"]="text/plain",c=l):"undefined"!==typeof FormData&&l instanceof FormData?c=l:(d["Content-Type"]="application/json",c=JSON.stringify(l)));const h=yield this.fetch("".concat(this.url,"/").concat(e),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),r),body:c}).catch((e=>{throw new s(e)})),f=h.headers.get("x-relay-error");if(f&&"true"===f)throw new a(h);if(!h.ok)throw new i(h);let g,p=(null!==(n=h.headers.get("Content-Type"))&&void 0!==n?n:"text/plain").split(";")[0].trim();return g="application/json"===p?yield h.json():"application/octet-stream"===p?yield h.blob():"text/event-stream"===p?h:"multipart/form-data"===p?yield h.formData():yield h.text(),{data:g,error:null}}catch(r){return{data:null,error:r}}}))}}var d=n(980);const{PostgrestClient:u,PostgrestQueryBuilder:h,PostgrestFilterBuilder:f,PostgrestTransformBuilder:g,PostgrestBuilder:p,PostgrestError:m}=d,y={"X-Client-Info":"realtime-js/".concat("2.11.2")};var b,x,v,w,_,S;!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(b||(b={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(x||(x={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(v||(v={})),function(e){e.websocket="websocket"}(w||(w={})),function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(_||(_={}));class k{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"===typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const r=t.getUint8(1),s=t.getUint8(2);let a=this.HEADER_LENGTH+2;const i=n.decode(e.slice(a,a+r));a+=r;const o=n.decode(e.slice(a,a+s));a+=s;return{ref:null,topic:i,event:o,payload:JSON.parse(n.decode(e.slice(a,e.byteLength)))}}}class j{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(S||(S={}));const N=function(e,t){var n;const r=null!==(n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).skipTypes)&&void 0!==n?n:[];return Object.keys(t).reduce(((n,s)=>(n[s]=E(s,e,t,r),n)),{})},E=(e,t,n,r)=>{const s=t.find((t=>t.name===e)),a=null===s||void 0===s?void 0:s.type,i=n[e];return a&&!r.includes(a)?C(a,i):T(i)},C=(e,t)=>{if("_"===e.charAt(0)){const n=e.slice(1,e.length);return O(t,n)}switch(e){case S.bool:return A(t);case S.float4:case S.float8:case S.int2:case S.int4:case S.int8:case S.numeric:case S.oid:return D(t);case S.json:case S.jsonb:return P(t);case S.timestamp:return I(t);case S.abstime:case S.date:case S.daterange:case S.int4range:case S.int8range:case S.money:case S.reltime:case S.text:case S.time:case S.timestamptz:case S.timetz:case S.tsrange:case S.tstzrange:default:return T(t)}},T=e=>e,A=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},D=e=>{if("string"===typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},P=e=>{if("string"===typeof e)try{return JSON.parse(e)}catch(t){return console.log("JSON parse error: ".concat(t)),e}return e},O=(e,t)=>{if("string"!==typeof e)return e;const n=e.length-1,r=e[n];if("{"===e[0]&&"}"===r){let r;const a=e.slice(1,n);try{r=JSON.parse("["+a+"]")}catch(s){r=a?a.split(","):[]}return r.map((e=>C(t,e)))}return e},I=e=>"string"===typeof e?e.replace(" ","T"):e,L=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class M{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;this.channel=e,this.event=t,this.payload=n,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t(null===(n=this.receivedResp)||void 0===n?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive(e){let{status:t,response:n}=e;this.recHooks.filter((e=>e.status===t)).forEach((e=>e.callback(n)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var R,F,B,z;!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(R||(R={}));class U{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(null===t||void 0===t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},(e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=U.syncState(this.state,e,t,n),this.pendingDiffs.forEach((e=>{this.state=U.syncDiff(this.state,e,t,n)})),this.pendingDiffs=[],r()})),this.channel._on(n.diff,{},(e=>{const{onJoin:t,onLeave:n,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=U.syncDiff(this.state,e,t,n),r())})),this.onJoin(((e,t,n)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:n})})),this.onLeave(((e,t,n)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:n})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,n,r){const s=this.cloneDeep(e),a=this.transformState(t),i={},o={};return this.map(s,((e,t)=>{a[e]||(o[e]=t)})),this.map(a,((e,t)=>{const n=s[e];if(n){const r=t.map((e=>e.presence_ref)),s=n.map((e=>e.presence_ref)),a=t.filter((e=>s.indexOf(e.presence_ref)<0)),l=n.filter((e=>r.indexOf(e.presence_ref)<0));a.length>0&&(i[e]=a),l.length>0&&(o[e]=l)}else i[e]=t})),this.syncDiff(s,{joins:i,leaves:o},n,r)}static syncDiff(e,t,n,r){const{joins:s,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),r||(r=()=>{}),this.map(s,((t,r)=>{var s;const a=null!==(s=e[t])&&void 0!==s?s:[];if(e[t]=this.cloneDeep(r),a.length>0){const n=e[t].map((e=>e.presence_ref)),r=a.filter((e=>n.indexOf(e.presence_ref)<0));e[t].unshift(...r)}n(t,a,r)})),this.map(a,((t,n)=>{let s=e[t];if(!s)return;const a=n.map((e=>e.presence_ref));s=s.filter((e=>a.indexOf(e.presence_ref)<0)),e[t]=s,r(t,s,n),0===s.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((n=>t(n,e[n])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,n)=>{const r=e[n];return t[n]="metas"in r?r.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):r,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(F||(F={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(B||(B={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(z||(z={}));class W{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}},n=arguments.length>2?arguments[2]:void 0;this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=x.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new M(this,v.join,this.params,this.timeout),this.rejoinTimer=new j((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=x.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel","close ".concat(this.topic," ").concat(this._joinRef())),this.state=x.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel","error ".concat(this.topic),e),this.state=x.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel","timeout ".concat(this.topic),this.joinPush.timeout),this.state=x.errored,this.rejoinTimer.scheduleTimeout())})),this._on(v.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new U(this),this.broadcastEndpointURL=L(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.timeout;var n,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:a,private:i}}=this.params;this._onError((t=>null===e||void 0===e?void 0:e(z.CHANNEL_ERROR,t))),this._onClose((()=>null===e||void 0===e?void 0:e(z.CLOSED)));const o={},l={broadcast:s,presence:a,postgres_changes:null!==(r=null===(n=this.bindings.postgres_changes)||void 0===n?void 0:n.map((e=>e.filter)))&&void 0!==r?r:[],private:i};this.socket.accessTokenValue&&(o.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async t=>{let{postgres_changes:n}=t;var r;if(this.socket.setAuth(),void 0!==n){const t=this.bindings.postgres_changes,s=null!==(r=null===t||void 0===t?void 0:t.length)&&void 0!==r?r:0,a=[];for(let r=0;r<s;r++){const s=t[r],{filter:{event:i,schema:o,table:l,filter:c}}=s,d=n&&n[r];if(!d||d.event!==i||d.schema!==o||d.table!==l||d.filter!==c)return this.unsubscribe(),void(null===e||void 0===e||e(z.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));a.push(Object.assign(Object.assign({},s),{id:d.id}))}return this.bindings.postgres_changes=a,void(e&&e(z.SUBSCRIBED))}null===e||void 0===e||e(z.SUBSCRIBED)})).receive("error",(t=>{null===e||void 0===e||e(z.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null===e||void 0===e||e(z.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this._on(e,t,n)}async send(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,r;if(this._canPush()||"broadcast"!==e.type)return new Promise((n=>{var r,s,a;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(a=null===(s=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===s?void 0:s.broadcast)||void 0===a?void 0:a.ack)||n("ok"),i.receive("ok",(()=>n("ok"))),i.receive("error",(()=>n("error"))),i.receive("timeout",(()=>n("timed out")))}));{const{event:a,payload:i}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?"Bearer ".concat(this.socket.accessTokenValue):"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(n=t.timeout)&&void 0!==n?n:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(s){return"AbortError"===s.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this.state=x.leaving;const t=()=>{this.socket.log("channel","leave ".concat(this.topic)),this._trigger(v.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((n=>{const r=new M(this,v.leave,{},e);r.receive("ok",(()=>{t(),n("ok")})).receive("timeout",(()=>{t(),n("timed out")})).receive("error",(()=>{n("error")})),r.send(),this._canPush()||r.trigger("ok",{})}))}async _fetchWithTimeout(e,t,n){const r=new AbortController,s=setTimeout((()=>r.abort()),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(s),a}_push(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.timeout;if(!this.joinedOnce)throw"tried to push '".concat(e,"' to '").concat(this.topic,"' before joining. Use channel.subscribe() before pushing events");let r=new M(this,e,t,n);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var r,s;const a=e.toLocaleLowerCase(),{close:i,error:o,leave:l,join:c}=v;if(n&&[i,o,l,c].indexOf(a)>=0&&n!==this._joinRef())return;let d=this._onMessage(a,t,n);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter((e=>{var t,n,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(n=e.filter)||void 0===n?void 0:n.event)||void 0===r?void 0:r.toLocaleLowerCase())===a})).map((e=>e.callback(d,n))):null===(s=this.bindings[a])||void 0===s||s.filter((e=>{var n,r,s,i,o,l;if(["broadcast","presence","postgres_changes"].includes(a)){if("id"in e){const a=e.id,i=null===(n=e.filter)||void 0===n?void 0:n.event;return a&&(null===(r=t.ids)||void 0===r?void 0:r.includes(a))&&("*"===i||(null===i||void 0===i?void 0:i.toLocaleLowerCase())===(null===(s=t.data)||void 0===s?void 0:s.type.toLocaleLowerCase()))}{const n=null===(o=null===(i=null===e||void 0===e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===n||n===(null===(l=null===t||void 0===t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===a})).map((e=>{if("object"===typeof d&&"ids"in d){const e=d.data,{schema:t,table:n,commit_timestamp:r,type:s,errors:a}=e,i={schema:t,table:n,commit_timestamp:r,eventType:s,new:{},old:{},errors:a};d=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(d,n)}))}_isClosed(){return this.state===x.closed}_isJoined(){return this.state===x.joined}_isJoining(){return this.state===x.joining}_isLeaving(){return this.state===x.leaving}_replyEventName(e){return"chan_reply_".concat(e)}_on(e,t,n){const r=e.toLocaleLowerCase(),s={type:r,filter:t,callback:n};return this.bindings[r]?this.bindings[r].push(s):this.bindings[r]=[s],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter((e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===n&&W.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(v.close,{},e)}_onError(e){this._on(v.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.timeout;this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=x.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=N(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=N(e.columns,e.old_record)),t}}const q=()=>{},H="undefined"!==typeof WebSocket;class V{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=y,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=q,this.conn=null,this.sendBuffer=[],this.serializer=new k,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}},this.endPoint="".concat(e,"/").concat(w.websocket),this.httpEndpoint=L(e),(null===t||void 0===t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null===t||void 0===t?void 0:t.params)&&(this.params=t.params),(null===t||void 0===t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null===t||void 0===t?void 0:t.timeout)&&(this.timeout=t.timeout),(null===t||void 0===t?void 0:t.logger)&&(this.logger=t.logger),(null===t||void 0===t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=null===(r=null===t||void 0===t?void 0:t.params)||void 0===r?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=(null===t||void 0===t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null===t||void 0===t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null===t||void 0===t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new j((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null===t||void 0===t?void 0:t.fetch),null===t||void 0===t?void 0:t.worker){if("undefined"!==typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null===t||void 0===t?void 0:t.worker)||!1,this.workerUrl=null===t||void 0===t?void 0:t.workerUrl}this.accessToken=(null===t||void 0===t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(H)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new J(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),n.e(952).then(n.t.bind(n,952,23)).then((e=>{let{default:t}=e;this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!==t&&void 0!==t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case b.connecting:return _.Connecting;case b.open:return _.Open;case b.closing:return _.Closing;default:return _.Closed}}isConnected(){return this.connectionState()===_.Open}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};const n=new W("realtime:".concat(e),t,this);return this.channels.push(n),n}push(e){const{topic:t,event:n,payload:r,ref:s}=e,a=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push","".concat(t," ").concat(n," (").concat(s,")"),r),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(){let e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:null)||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(e){let n=null;try{n=JSON.parse(atob(e.split(".")[1]))}catch(t){}if(n&&n.exp){if(!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",'InvalidJWTToken: Invalid value for JWT claim "exp" with value '.concat(n.exp)),Promise.reject('InvalidJWTToken: Invalid value for JWT claim "exp" with value '.concat(n.exp))}this.accessTokenValue=e,this.channels.forEach((t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(v.access_token,{access_token:e})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",'leaving duplicate topic "'.concat(e,'"')),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:n,payload:r,ref:s}=e;s&&s===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive","".concat(r.status||""," ").concat(t," ").concat(n," ").concat(s&&"("+s+")"||""),r),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(n,r,s))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport","connected to ".concat(this.endpointURL())),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker","starting worker for from ".concat(this.workerUrl)):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(v.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const n=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return"".concat(e).concat(n).concat(r)}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class J{constructor(e,t,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=b.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=n.close}}class K extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Y(e){return"object"===typeof e&&null!==e&&"__isStorageError"in e}class G extends K{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class $ extends K{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Q=function(e,t,n,r){return new(n||(n=Promise))((function(s,a){function i(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};const X=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}},Z=e=>{if(Array.isArray(e))return e.map((e=>Z(e)));if("function"===typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((e=>{let[n,r]=e;const s=n.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[s]=Z(r)})),t};var ee=function(e,t,n,r){return new(n||(n=Promise))((function(s,a){function i(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};const te=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ne=(e,t,r)=>ee(void 0,void 0,void 0,(function*(){const s=yield Q(void 0,void 0,void 0,(function*(){return"undefined"===typeof Response?(yield Promise.resolve().then(n.bind(n,630))).Response:Response}));e instanceof s&&!(null===r||void 0===r?void 0:r.noResolveJson)?e.json().then((n=>{t(new G(te(n),e.status||500))})).catch((e=>{t(new $(te(e),e))})):t(new $(te(e),e))}));function re(e,t,n,r,s,a){return ee(this,void 0,void 0,(function*(){return new Promise(((i,o)=>{e(n,((e,t,n,r)=>{const s={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?s:(s.headers=Object.assign({"Content-Type":"application/json"},null===t||void 0===t?void 0:t.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),n))})(t,r,s,a)).then((e=>{if(!e.ok)throw e;return(null===r||void 0===r?void 0:r.noResolveJson)?e:e.json()})).then((e=>i(e))).catch((e=>ne(e,o,r)))}))}))}function se(e,t,n,r){return ee(this,void 0,void 0,(function*(){return re(e,"GET",t,n,r)}))}function ae(e,t,n,r,s){return ee(this,void 0,void 0,(function*(){return re(e,"POST",t,r,s,n)}))}function ie(e,t,n,r,s){return ee(this,void 0,void 0,(function*(){return re(e,"DELETE",t,r,s,n)}))}var oe=function(e,t,n,r){return new(n||(n=Promise))((function(s,a){function i(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};const le={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ce={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class de{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;this.url=e,this.headers=t,this.bucketId=n,this.fetch=X(r)}uploadOrUpdate(e,t,n,r){return oe(this,void 0,void 0,(function*(){try{let s;const a=Object.assign(Object.assign({},ce),r);let i=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(a.upsert)});const o=a.metadata;"undefined"!==typeof Blob&&n instanceof Blob?(s=new FormData,s.append("cacheControl",a.cacheControl),o&&s.append("metadata",this.encodeMetadata(o)),s.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(s=n,s.append("cacheControl",a.cacheControl),o&&s.append("metadata",this.encodeMetadata(o))):(s=n,i["cache-control"]="max-age=".concat(a.cacheControl),i["content-type"]=a.contentType,o&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null===r||void 0===r?void 0:r.headers)&&(i=Object.assign(Object.assign({},i),r.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield this.fetch("".concat(this.url,"/object/").concat(c),Object.assign({method:e,body:s,headers:i},(null===a||void 0===a?void 0:a.duplex)?{duplex:a.duplex}:{})),u=yield d.json();if(d.ok)return{data:{path:l,id:u.Id,fullPath:u.Key},error:null};return{data:null,error:u}}catch(s){if(Y(s))return{data:null,error:s};throw s}}))}upload(e,t,n){return oe(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,n)}))}uploadToSignedUrl(e,t,n,r){return oe(this,void 0,void 0,(function*(){const s=this._removeEmptyFolders(e),a=this._getFinalPath(s),i=new URL(this.url+"/object/upload/sign/".concat(a));i.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:ce.upsert},r),a=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!==typeof Blob&&n instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",n)):"undefined"!==typeof FormData&&n instanceof FormData?(e=n,e.append("cacheControl",t.cacheControl)):(e=n,a["cache-control"]="max-age=".concat(t.cacheControl),a["content-type"]=t.contentType);const o=yield this.fetch(i.toString(),{method:"PUT",body:e,headers:a}),l=yield o.json();if(o.ok)return{data:{path:s,fullPath:l.Key},error:null};return{data:null,error:l}}catch(o){if(Y(o))return{data:null,error:o};throw o}}))}createSignedUploadUrl(e,t){return oe(this,void 0,void 0,(function*(){try{let n=this._getFinalPath(e);const r=Object.assign({},this.headers);(null===t||void 0===t?void 0:t.upsert)&&(r["x-upsert"]="true");const s=yield ae(this.fetch,"".concat(this.url,"/object/upload/sign/").concat(n),{},{headers:r}),a=new URL(this.url+s.url),i=a.searchParams.get("token");if(!i)throw new K("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:i},error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}))}update(e,t,n){return oe(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,n)}))}move(e,t,n){return oe(this,void 0,void 0,(function*(){try{return{data:yield ae(this.fetch,"".concat(this.url,"/object/move"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}}))}copy(e,t,n){return oe(this,void 0,void 0,(function*(){try{return{data:{path:(yield ae(this.fetch,"".concat(this.url,"/object/copy"),{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null===n||void 0===n?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}}))}createSignedUrl(e,t,n){return oe(this,void 0,void 0,(function*(){try{let r=this._getFinalPath(e),s=yield ae(this.fetch,"".concat(this.url,"/object/sign/").concat(r),Object.assign({expiresIn:t},(null===n||void 0===n?void 0:n.transform)?{transform:n.transform}:{}),{headers:this.headers});const a=(null===n||void 0===n?void 0:n.download)?"&download=".concat(!0===n.download?"":n.download):"";return s={signedUrl:encodeURI("".concat(this.url).concat(s.signedURL).concat(a))},{data:s,error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}}))}createSignedUrls(e,t,n){return oe(this,void 0,void 0,(function*(){try{const r=yield ae(this.fetch,"".concat(this.url,"/object/sign/").concat(this.bucketId),{expiresIn:t,paths:e},{headers:this.headers}),s=(null===n||void 0===n?void 0:n.download)?"&download=".concat(!0===n.download?"":n.download):"";return{data:r.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI("".concat(this.url).concat(e.signedURL).concat(s)):null}))),error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}}))}download(e,t){return oe(this,void 0,void 0,(function*(){const n="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{}),s=r?"?".concat(r):"";try{const t=this._getFinalPath(e),r=yield se(this.fetch,"".concat(this.url,"/").concat(n,"/").concat(t).concat(s),{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(a){if(Y(a))return{data:null,error:a};throw a}}))}info(e){return oe(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield se(this.fetch,"".concat(this.url,"/object/info/").concat(t),{headers:this.headers});return{data:Z(e),error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}))}exists(e){return oe(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,n,r){return ee(this,void 0,void 0,(function*(){return re(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)}))}(this.fetch,"".concat(this.url,"/object/").concat(t),{headers:this.headers}),{data:!0,error:null}}catch(n){if(Y(n)&&n instanceof $){const e=n.originalError;if([400,404].includes(null===e||void 0===e?void 0:e.status))return{data:!1,error:n}}throw n}}))}getPublicUrl(e,t){const n=this._getFinalPath(e),r=[],s=(null===t||void 0===t?void 0:t.download)?"download=".concat(!0===t.download?"":t.download):"";""!==s&&r.push(s);const a="undefined"!==typeof(null===t||void 0===t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null===t||void 0===t?void 0:t.transform)||{});""!==i&&r.push(i);let o=r.join("&");return""!==o&&(o="?".concat(o)),{data:{publicUrl:encodeURI("".concat(this.url,"/").concat(a,"/public/").concat(n).concat(o))}}}remove(e){return oe(this,void 0,void 0,(function*(){try{return{data:yield ie(this.fetch,"".concat(this.url,"/object/").concat(this.bucketId),{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}}))}list(e,t,n){return oe(this,void 0,void 0,(function*(){try{const r=Object.assign(Object.assign(Object.assign({},le),t),{prefix:e||""});return{data:yield ae(this.fetch,"".concat(this.url,"/object/list/").concat(this.bucketId),r,{headers:this.headers},n),error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!==typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return"".concat(this.bucketId,"/").concat(e)}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push("width=".concat(e.width)),e.height&&t.push("height=".concat(e.height)),e.resize&&t.push("resize=".concat(e.resize)),e.format&&t.push("format=".concat(e.format)),e.quality&&t.push("quality=".concat(e.quality)),t.join("&")}}const ue={"X-Client-Info":"storage-js/".concat("2.7.1")};var he=function(e,t,n,r){return new(n||(n=Promise))((function(s,a){function i(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};class fe{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;this.url=e,this.headers=Object.assign(Object.assign({},ue),t),this.fetch=X(n)}listBuckets(){return he(this,void 0,void 0,(function*(){try{return{data:yield se(this.fetch,"".concat(this.url,"/bucket"),{headers:this.headers}),error:null}}catch(e){if(Y(e))return{data:null,error:e};throw e}}))}getBucket(e){return he(this,void 0,void 0,(function*(){try{return{data:yield se(this.fetch,"".concat(this.url,"/bucket/").concat(e),{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}}))}createBucket(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{public:!1};return he(this,void 0,void 0,(function*(){try{return{data:yield ae(this.fetch,"".concat(this.url,"/bucket"),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}))}updateBucket(e,t){return he(this,void 0,void 0,(function*(){try{const n=yield function(e,t,n,r,s){return ee(this,void 0,void 0,(function*(){return re(e,"PUT",t,r,s,n)}))}(this.fetch,"".concat(this.url,"/bucket/").concat(e),{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:n,error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}))}emptyBucket(e){return he(this,void 0,void 0,(function*(){try{return{data:yield ae(this.fetch,"".concat(this.url,"/bucket/").concat(e,"/empty"),{},{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return he(this,void 0,void 0,(function*(){try{return{data:yield ie(this.fetch,"".concat(this.url,"/bucket/").concat(e),{},{headers:this.headers}),error:null}}catch(t){if(Y(t))return{data:null,error:t};throw t}}))}}class ge extends fe{constructor(e){super(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},arguments.length>2?arguments[2]:void 0)}from(e){return new de(this.url,this.headers,e,this.fetch)}}let pe="";pe="undefined"!==typeof Deno?"deno":"undefined"!==typeof document?"web":"undefined"!==typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const me={headers:{"X-Client-Info":"supabase-js-".concat(pe,"/").concat("2.49.4")}},ye={schema:"public"},be={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},xe={};var ve=n(630),we=function(e,t,n,r){return new(n||(n=Promise))((function(s,a){function i(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};const _e=e=>{let t;return t=e||("undefined"===typeof fetch?ve.default:fetch),function(){return t(...arguments)}},Se=(e,t,n)=>{const r=_e(n),s="undefined"===typeof Headers?ve.Headers:Headers;return(n,a)=>we(void 0,void 0,void 0,(function*(){var i;const o=null!==(i=yield t())&&void 0!==i?i:e;let l=new s(null===a||void 0===a?void 0:a.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization","Bearer ".concat(o)),r(n,Object.assign(Object.assign({},a),{headers:l}))}))};var ke=function(e,t,n,r){return new(n||(n=Promise))((function(s,a){function i(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};const je="2.69.1",Ne=3e4,Ee=9e4,Ce={"X-Client-Info":"gotrue-js/".concat(je)},Te="X-Supabase-Api-Version",Ae={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},De=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Pe extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function Oe(e){return"object"===typeof e&&null!==e&&"__isAuthError"in e}class Ie extends Pe{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}class Le extends Pe{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Me extends Pe{constructor(e,t,n,r){super(e,n,r),this.name=t,this.status=n}}class Re extends Me{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Fe extends Me{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Be extends Me{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ze extends Me{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ue extends Me{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class We extends Me{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function qe(e){return Oe(e)&&"AuthRetryableFetchError"===e.name}class He extends Me{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class Ve extends Me{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Je="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ke=" \t\n\r=".split(""),Ye=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Ke.length;t+=1)e[Ke[t].charCodeAt(0)]=-2;for(let t=0;t<Je.length;t+=1)e[Je[t].charCodeAt(0)]=t;return e})();function Ge(e,t,n){const r=Ye[e];if(!(r>-1)){if(-2===r)return;throw new Error('Invalid Base64-URL character "'.concat(String.fromCharCode(e),'"'))}for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function $e(e){const t=[],n=e=>{t.push(String.fromCodePoint(e))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=e=>{!function(e,t,n){if(0===t.utf8seq){if(e<=127)return void n(e);for(let n=1;n<6;n+=1)if(0===(e>>7-n&1)){t.utf8seq=n;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&n(t.codepoint)}}(e,r,n)};for(let i=0;i<e.length;i+=1)Ge(e.charCodeAt(i),s,a);return t.join("")}function Qe(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error("Unrecognized Unicode codepoint: ".concat(e.toString(16)))}t(e)}function Xe(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const t=1024*(r-55296)&65535;r=65536+(e.charCodeAt(n+1)-56320&65535|t),n+=1}Qe(r,t)}}function Ze(e){const t=[],n={queue:0,queuedBits:0},r=e=>{t.push(e)};for(let s=0;s<e.length;s+=1)Ge(e.charCodeAt(s),n,r);return new Uint8Array(t)}const et=()=>"undefined"!==typeof window&&"undefined"!==typeof document,tt={tested:!1,writable:!1},nt=()=>{if(!et())return!1;try{if("object"!==typeof globalThis.localStorage)return!1}catch(t){return!1}if(tt.tested)return tt.writable;const e="lswt-".concat(Math.random()).concat(Math.random());try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),tt.tested=!0,tt.writable=!0}catch(t){tt.tested=!0,tt.writable=!1}return tt.writable};const rt=e=>{let t;return t=e||("undefined"===typeof fetch?function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Promise.resolve().then(n.bind(n,630)).then((e=>{let{default:n}=e;return n(...t)}))}:fetch),function(){return t(...arguments)}},st=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},at=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch(r){return n}},it=async(e,t)=>{await e.removeItem(t)};class ot{constructor(){this.promise=new ot.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function lt(e){const t=e.split(".");if(3!==t.length)throw new Ve("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!De.test(t[n]))throw new Ve("JWT not in base64url format");return{header:JSON.parse($e(t[0])),payload:JSON.parse($e(t[1])),signature:Ze(t[2]),raw:{header:t[0],payload:t[1]}}}function ct(e){return("0"+e.toString(16)).substr(-2)}async function dt(e){if(!("undefined"!==typeof crypto&&"undefined"!==typeof crypto.subtle&&"undefined"!==typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(n);return Array.from(r).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ut(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=function(){const e=new Uint32Array(56);if("undefined"===typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let n="";for(let r=0;r<56;r++)n+=e.charAt(Math.floor(Math.random()*t));return n}return crypto.getRandomValues(e),Array.from(e,ct).join("")}();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await st(e,"".concat(t,"-code-verifier"),s);const a=await dt(r);return[a,r===a?"plain":"s256"]}ot.promiseConstructor=Promise;const ht=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;var ft=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n};const gt=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),pt=[502,503,504];async function mt(e){var t,n;if(!("object"===typeof(n=e)&&null!==n&&"status"in n&&"ok"in n&&"json"in n&&"function"===typeof n.json))throw new We(gt(e),0);if(pt.includes(e.status))throw new We(gt(e),e.status);let r,s;try{r=await e.json()}catch(i){throw new Le(gt(i),i)}const a=function(e){const t=e.headers.get(Te);if(!t)return null;if(!t.match(ht))return null;try{return new Date("".concat(t,"T00:00:00.0Z"))}catch(i){return null}}(e);if(a&&a.getTime()>=Ae.timestamp&&"object"===typeof r&&r&&"string"===typeof r.code?s=r.code:"object"===typeof r&&r&&"string"===typeof r.error_code&&(s=r.error_code),s){if("weak_password"===s)throw new He(gt(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===s)throw new Re}else if("object"===typeof r&&r&&"object"===typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0))throw new He(gt(r),e.status,r.weak_password.reasons);throw new Ie(gt(r),e.status||500,s)}async function yt(e,t,n,r){var s;const a=Object.assign({},null===r||void 0===r?void 0:r.headers);a[Te]||(a[Te]=Ae.name),(null===r||void 0===r?void 0:r.jwt)&&(a.Authorization="Bearer ".concat(r.jwt));const i=null!==(s=null===r||void 0===r?void 0:r.query)&&void 0!==s?s:{};(null===r||void 0===r?void 0:r.redirectTo)&&(i.redirect_to=r.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await async function(e,t,n,r,s,a){const i=((e,t,n,r)=>{const s={method:e,headers:(null===t||void 0===t?void 0:t.headers)||{}};return"GET"===e?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null===t||void 0===t?void 0:t.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))})(t,r,s,a);let o;try{o=await e(n,Object.assign({},i))}catch(l){throw console.error(l),new We(gt(l),0)}o.ok||await mt(o);if(null===r||void 0===r?void 0:r.noResolveJson)return o;try{return await o.json()}catch(l){await mt(l)}}(e,t,n+o,{headers:a,noResolveJson:null===r||void 0===r?void 0:r.noResolveJson},{},null===r||void 0===r?void 0:r.body);return(null===r||void 0===r?void 0:r.xform)?null===r||void 0===r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}function bt(e){var t;let n=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:n,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function xt(e){const t=bt(e);return!t.error&&e.weak_password&&"object"===typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"===typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"===typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function vt(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function wt(e){return{data:e,error:null}}function _t(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:a}=e,i=ft(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:a},user:Object.assign({},i)},error:null}}function St(e){return e}var kt=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var s=0;for(r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]])}return n};class jt{constructor(e){let{url:t="",headers:n={},fetch:r}=e;this.url=t,this.headers=n,this.fetch=rt(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"global";try{return await yt(this.fetch,"POST","".concat(this.url,"/logout?scope=").concat(t),{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await yt(this.fetch,"POST","".concat(this.url,"/invite"),{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:vt})}catch(n){if(Oe(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=kt(e,["options"]),r=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(r.new_email=null===n||void 0===n?void 0:n.newEmail,delete r.newEmail),await yt(this.fetch,"POST","".concat(this.url,"/admin/generate_link"),{body:r,headers:this.headers,xform:_t,redirectTo:null===t||void 0===t?void 0:t.redirectTo})}catch(t){if(Oe(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await yt(this.fetch,"POST","".concat(this.url,"/admin/users"),{body:e,headers:this.headers,xform:vt})}catch(t){if(Oe(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,r,s,a,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await yt(this.fetch,"GET","".concat(this.url,"/admin/users"),{headers:this.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null===e||void 0===e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(s=null===(r=null===e||void 0===e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==s?s:""},xform:St});if(c.error)throw c.error;const d=await c.json(),u=null!==(a=c.headers.get("x-total-count"))&&void 0!==a?a:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),n=JSON.parse(e.split(";")[1].split("=")[1]);l["".concat(n,"Page")]=t})),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Oe(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await yt(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,xform:vt})}catch(t){if(Oe(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await yt(this.fetch,"PUT","".concat(this.url,"/admin/users/").concat(e),{body:t,headers:this.headers,xform:vt})}catch(n){if(Oe(n))return{data:{user:null},error:n};throw n}}async deleteUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return await yt(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e),{headers:this.headers,body:{should_soft_delete:t},xform:vt})}catch(n){if(Oe(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){try{const{data:t,error:n}=await yt(this.fetch,"GET","".concat(this.url,"/admin/users/").concat(e.userId,"/factors"),{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:n}}catch(t){if(Oe(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await yt(this.fetch,"DELETE","".concat(this.url,"/admin/users/").concat(e.userId,"/factors/").concat(e.id),{headers:this.headers}),error:null}}catch(t){if(Oe(t))return{data:null,error:t};throw t}}}const Nt={getItem:e=>nt()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{nt()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{nt()&&globalThis.localStorage.removeItem(e)}};function Et(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const Ct=!!(globalThis&&nt()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class Tt extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class At extends Tt{}async function Dt(e,t,n){Ct&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout((()=>{r.abort(),Ct&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},(async r=>{if(!r){if(0===t)throw Ct&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new At('Acquiring an exclusive Navigator LockManager lock "'.concat(e,'" immediately failed'));if(Ct)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}Ct&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,r.name);try{return await n()}finally{Ct&&console.log("@supabase/gotrue-js: navigatorLock: released",e,r.name)}}))))}!function(){if("object"!==typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!==typeof self&&(self.globalThis=self)}}();const Pt={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ce,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Ot(e,t,n){return await n()}class It{constructor(e){var t,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=It.nextInstanceID,It.nextInstanceID+=1,this.instanceID>0&&et()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Pt),e);if(this.logDebugMessages=!!r.debug,"function"===typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new jt({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=rt(r.fetch),this.lock=r.lock||Ot,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:et()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=Dt:this.lock=Ot,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:nt()?this.storage=Nt:(this.memoryStorage={},this.storage=Et(this.memoryStorage)):(this.memoryStorage={},this.storage=Et(this.memoryStorage)),et()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}null===(n=this.broadcastChannel)||void 0===n||n.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(){if(this.logDebugMessages){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.logger("GoTrueClient@".concat(this.instanceID," (").concat(je,") ").concat((new Date).toISOString()),...t)}return this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},n=new URL(e);if(n.hash&&"#"===n.hash[0])try{new URLSearchParams(n.hash.substring(1)).forEach(((e,n)=>{t[n]=e}))}catch(r){}return n.searchParams.forEach(((e,n)=>{t[n]=e})),t}(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),et()&&this.detectSessionInUrl&&"none"!==n){const{data:r,error:s}=await this._getSessionFromURL(t,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),function(e){return Oe(e)&&"AuthImplicitGrantRedirectError"===e.name}(s)){const t=null===(e=s.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:s}}return await this._removeSession(),{error:s}}const{session:a,redirectType:i}=r;return this._debug("#_initialize()","detected session in URL",a,"redirect type",i),await this._saveSession(a),setTimeout((async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Oe(t)?{error:t}:{error:new Le("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,r;try{const s=await yt(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{data:null!==(n=null===(t=null===e||void 0===e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null===(r=null===e||void 0===e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:bt}),{data:a,error:i}=s;if(i||!a)return{data:{user:null,session:null},error:i};const o=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(s){if(Oe(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var t,n,r;try{let s;if("email"in e){const{email:n,password:r,options:a}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await ut(this.storage,this.storageKey)),s=await yt(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,redirectTo:null===a||void 0===a?void 0:a.emailRedirectTo,body:{email:n,password:r,data:null!==(t=null===a||void 0===a?void 0:a.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null===a||void 0===a?void 0:a.captchaToken},code_challenge:i,code_challenge_method:o},xform:bt})}else{if(!("phone"in e))throw new Be("You must provide either an email or phone number and a password");{const{phone:t,password:a,options:i}=e;s=await yt(this.fetch,"POST","".concat(this.url,"/signup"),{headers:this.headers,body:{phone:t,password:a,data:null!==(n=null===i||void 0===i?void 0:i.data)&&void 0!==n?n:{},channel:null!==(r=null===i||void 0===i?void 0:i.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null===i||void 0===i?void 0:i.captchaToken}},xform:bt})}}const{data:a,error:i}=s;if(i||!a)return{data:{user:null,session:null},error:i};const o=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(s){if(Oe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let t;if("email"in e){const{email:n,password:r,options:s}=e;t=await yt(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{email:n,password:r,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken}},xform:xt})}else{if(!("phone"in e))throw new Be("You must provide either an email or phone number and a password");{const{phone:n,password:r,options:s}=e;t=await yt(this.fetch,"POST","".concat(this.url,"/token?grant_type=password"),{headers:this.headers,body:{phone:n,password:r,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken}},xform:xt})}}const{data:n,error:r}=t;return r?{data:{user:null,session:null},error:r}:n&&n.session&&n.user?(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:r}):{data:{user:null,session:null},error:new Fe}}catch(t){if(Oe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,r,s;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(s=e.options)||void 0===s?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await at(this.storage,"".concat(this.storageKey,"-code-verifier")),[n,r]=(null!==t&&void 0!==t?t:"").split("/");try{const{data:t,error:s}=await yt(this.fetch,"POST","".concat(this.url,"/token?grant_type=pkce"),{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:bt});if(await it(this.storage,"".concat(this.storageKey,"-code-verifier")),s)throw s;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!==r&&void 0!==r?r:null}),error:s}):{data:{user:null,session:null,redirectType:null},error:new Fe}}catch(s){if(Oe(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:t,provider:n,token:r,access_token:s,nonce:a}=e,i=await yt(this.fetch,"POST","".concat(this.url,"/token?grant_type=id_token"),{headers:this.headers,body:{provider:n,id_token:r,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:null===t||void 0===t?void 0:t.captchaToken}},xform:bt}),{data:o,error:l}=i;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new Fe}}catch(t){if(Oe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,r,s,a;try{if("email"in e){const{email:r,options:s}=e;let a=null,i=null;"pkce"===this.flowType&&([a,i]=await ut(this.storage,this.storageKey));const{error:o}=await yt(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{email:r,data:null!==(t=null===s||void 0===s?void 0:s.data)&&void 0!==t?t:{},create_user:null===(n=null===s||void 0===s?void 0:s.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken},code_challenge:a,code_challenge_method:i},redirectTo:null===s||void 0===s?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:n}=e,{data:i,error:o}=await yt(this.fetch,"POST","".concat(this.url,"/otp"),{headers:this.headers,body:{phone:t,data:null!==(r=null===n||void 0===n?void 0:n.data)&&void 0!==r?r:{},create_user:null===(s=null===n||void 0===n?void 0:n.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null===n||void 0===n?void 0:n.captchaToken},channel:null!==(a=null===n||void 0===n?void 0:n.channel)&&void 0!==a?a:"sms"}});return{data:{user:null,session:null,messageId:null===i||void 0===i?void 0:i.message_id},error:o}}throw new Be("You must provide either an email or phone number.")}catch(i){if(Oe(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(e){var t,n;try{let r,s;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,s=null===(n=e.options)||void 0===n?void 0:n.captchaToken);const{data:a,error:i}=await yt(this.fetch,"POST","".concat(this.url,"/verify"),{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:r,xform:bt});if(i)throw i;if(!a)throw new Error("An error occurred on token verification.");const o=a.session,l=a.user;return(null===o||void 0===o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(r){if(Oe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,n,r;try{let s=null,a=null;return"pkce"===this.flowType&&([s,a]=await ut(this.storage,this.storageKey)),await yt(this.fetch,"POST","".concat(this.url,"/sso"),{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==n?n:void 0}),(null===(r=null===e||void 0===e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:wt})}catch(s){if(Oe(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new Re;const{error:r}=await yt(this.fetch,"GET","".concat(this.url,"/reauthenticate"),{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}}))}catch(e){if(Oe(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t="".concat(this.url,"/resend");if("email"in e){const{email:n,type:r,options:s}=e,{error:a}=await yt(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:r,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken}},redirectTo:null===s||void 0===s?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){const{phone:n,type:r,options:s}=e,{data:a,error:i}=await yt(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:r,gotrue_meta_security:{captcha_token:null===s||void 0===s?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:null===a||void 0===a?void 0:a.message_id},error:i}}throw new Be("You must provide either an email or phone number and a type")}catch(t){if(Oe(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await n}catch(e){}})()),n}return await this.lock("lock:".concat(this.storageKey),e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await at(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=!!e.expires_at&&1e3*e.expires_at-Date.now()<Ee;if(this._debug("#__loadSession()","session has".concat(n?"":" not"," expired"),"expires_at",e.expires_at),!n){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,n,r)=>(t||"user"!==n||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,n,r))})}return{data:{session:e},error:null}}const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await yt(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:e,xform:vt}):await this._useSession((async e=>{var t,n,r;const{data:s,error:a}=e;if(a)throw a;return(null===(t=s.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await yt(this.fetch,"GET","".concat(this.url,"/user"),{headers:this.headers,jwt:null!==(r=null===(n=s.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0,xform:vt}):{data:{user:null},error:new Re}}))}catch(t){if(Oe(t))return function(e){return Oe(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await it(this.storage,"".concat(this.storageKey,"-code-verifier"))),{data:{user:null},error:t};throw t}}async updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this._useSession((async n=>{const{data:r,error:s}=n;if(s)throw s;if(!r.session)throw new Re;const a=r.session;let i=null,o=null;"pkce"===this.flowType&&null!=e.email&&([i,o]=await ut(this.storage,this.storageKey));const{data:l,error:c}=await yt(this.fetch,"PUT","".concat(this.url,"/user"),{headers:this.headers,redirectTo:null===t||void 0===t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:o}),jwt:a.access_token,xform:vt});if(c)throw c;return a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}}))}catch(n){if(Oe(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Re;const t=Date.now()/1e3;let n=t,r=!0,s=null;const{payload:a}=lt(e.access_token);if(a.exp&&(n=a.exp,r=n<=t),r){const{session:t,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return{data:{user:null,session:null},error:n};if(!t)return{data:{user:null,session:null},error:null};s=t}else{const{data:r,error:a}=await this._getUser(e.access_token);if(a)throw a;s={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if(Oe(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var n;if(!e){const{data:r,error:s}=t;if(s)throw s;e=null!==(n=r.session)&&void 0!==n?n:void 0}if(!(null===e||void 0===e?void 0:e.refresh_token))throw new Re;const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(Oe(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!et())throw new ze("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ze(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new Ue("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new ze("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ue("No code detected.");const{data:t,error:n}=await this._exchangeCodeForSession(e.code);if(n)throw n;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:r,access_token:s,refresh_token:a,expires_in:i,expires_at:o,token_type:l}=e;if(!s||!i||!a||!l)throw new ze("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(i);let u=c+d;o&&(u=parseInt(o));const h=u-c;1e3*h<=Ne&&console.warn("@supabase/gotrue-js: Session as retrieved from URL expires in ".concat(h,"s, should have been closer to ").concat(d,"s"));const f=u-d;c-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,u,c):c-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,u,c);const{data:g,error:p}=await this._getUser(s);if(p)throw p;const m={provider_token:n,provider_refresh_token:r,access_token:s,expires_in:d,expires_at:u,refresh_token:a,token_type:l,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:e.type},error:null}}catch(n){if(Oe(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await at(this.storage,"".concat(this.storageKey,"-code-verifier"));return!(!e.code||!t)}async signOut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut(){let{scope:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{scope:"global"};return await this._useSession((async t=>{var n;const{data:r,error:s}=t;if(s)return{error:s};const a=null===(n=r.session)||void 0===n?void 0:n.access_token;if(a){const{error:t}=await this.admin.signOut(a,e);if(t&&(!function(e){return Oe(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await it(this.storage,"".concat(this.storageKey,"-code-verifier"))),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession((async t=>{var n,r;try{const{data:{session:r},error:s}=t;if(s)throw s;await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(s){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}}))}async resetPasswordForEmail(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=null;"pkce"===this.flowType&&([n,r]=await ut(this.storage,this.storageKey,!0));try{return await yt(this.fetch,"POST","".concat(this.url,"/recover"),{body:{email:e,code_challenge:n,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(Oe(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Oe(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:n,error:r}=await this._useSession((async t=>{var n,r,s,a,i;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider("".concat(this.url,"/user/identities/authorize"),e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(s=e.options)||void 0===s?void 0:s.queryParams,skipBrowserRedirect:!0});return await yt(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(a=o.session)||void 0===a?void 0:a.access_token)&&void 0!==i?i:void 0})}));if(r)throw r;return et()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null===n||void 0===n?void 0:n.url),{data:{provider:e.provider,url:null===n||void 0===n?void 0:n.url},error:null}}catch(n){if(Oe(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var n,r;const{data:s,error:a}=t;if(a)throw a;return await yt(this.fetch,"DELETE","".concat(this.url,"/user/identities/").concat(e.identity_id),{headers:this.headers,jwt:null!==(r=null===(n=s.session)||void 0===n?void 0:n.access_token)&&void 0!==r?r:void 0})}))}catch(t){if(Oe(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t="#_refreshAccessToken(".concat(e.substring(0,5),"...)");this._debug(t,"begin");try{const s=Date.now();return await(n=async n=>(n>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,n-1)),this._debug(t,"refreshing attempt",n),await yt(this.fetch,"POST","".concat(this.url,"/token?grant_type=refresh_token"),{body:{refresh_token:e},headers:this.headers,xform:bt})),r=(e,t)=>{const n=200*Math.pow(2,e);return t&&qe(t)&&Date.now()+n-s<Ne},new Promise(((e,t)=>{(async()=>{for(let a=0;a<1/0;a++)try{const t=await n(a);if(!r(a,null,t))return void e(t)}catch(s){if(!r(a,s))return void t(s)}})()})))}catch(s){if(this._debug(t,"error",s),Oe(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}var n,r}_isValidSession(e){return"object"===typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider("".concat(this.url,"/authorize"),e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),et()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const n=await at(this.storage,this.storageKey);if(this._debug(t,"session from storage",n),!this._isValidSession(n))return this._debug(t,"session is not valid"),void(null!==n&&await this._removeSession());const r=1e3*(null!==(e=n.expires_at)&&void 0!==e?e:1/0)-Date.now()<Ee;if(this._debug(t,"session has".concat(r?"":" not"," expired with margin of ").concat(Ee,"s")),r){if(this.autoRefreshToken&&n.refresh_token){const{error:e}=await this._callRefreshToken(n.refresh_token);e&&(console.error(e),qe(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){return this._debug(t,"error",n),void console.error(n)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new Re;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r="#_callRefreshToken(".concat(e.substring(0,5),"...)");this._debug(r,"begin");try{this.refreshingDeferred=new ot;const{data:t,error:n}=await this._refreshAccessToken(e);if(n)throw n;if(!t.session)throw new Re;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(s){if(this._debug(r,"error",s),Oe(s)){const e={session:null,error:s};return qe(s)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(n=this.refreshingDeferred)||void 0===n||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r="#_notifyAllSubscribers(".concat(e,")");this._debug(r,"begin",t,"broadcast = ".concat(n));try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],s=Array.from(this.stateChangeEmitters.values()).map((async n=>{try{await n.callback(e,t)}catch(s){r.push(s)}}));if(await Promise.all(s),r.length>0){for(let e=0;e<r.length;e+=1)console.error(r[e]);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await st(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await it(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&et()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),Ne);this.autoRefreshTicker=e,e&&"object"===typeof e&&"function"===typeof e.unref?e.unref():"undefined"!==typeof Deno&&"function"===typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const t=Date.now();try{return await this._useSession((async e=>{const{data:{session:n}}=e;if(!n||!n.refresh_token||!n.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*n.expires_at-t)/Ne);this._debug("#_autoRefreshTokenTick()","access token expires in ".concat(r," ticks, a tick lasts ").concat(Ne,"ms, refresh threshold is ").concat(3," ticks")),r<=3&&await this._callRefreshToken(n.refresh_token)}))}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof Tt))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!et()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t="#_onVisibilityChanged(".concat(e,")");this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const r=["provider=".concat(encodeURIComponent(t))];if((null===n||void 0===n?void 0:n.redirectTo)&&r.push("redirect_to=".concat(encodeURIComponent(n.redirectTo))),(null===n||void 0===n?void 0:n.scopes)&&r.push("scopes=".concat(encodeURIComponent(n.scopes))),"pkce"===this.flowType){const[e,t]=await ut(this.storage,this.storageKey),n=new URLSearchParams({code_challenge:"".concat(encodeURIComponent(e)),code_challenge_method:"".concat(encodeURIComponent(t))});r.push(n.toString())}if(null===n||void 0===n?void 0:n.queryParams){const e=new URLSearchParams(n.queryParams);r.push(e.toString())}return(null===n||void 0===n?void 0:n.skipBrowserRedirect)&&r.push("skip_http_redirect=".concat(n.skipBrowserRedirect)),"".concat(e,"?").concat(r.join("&"))}async _unenroll(e){try{return await this._useSession((async t=>{var n;const{data:r,error:s}=t;return s?{data:null,error:s}:await yt(this.fetch,"DELETE","".concat(this.url,"/factors/").concat(e.factorId),{headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token})}))}catch(t){if(Oe(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var n,r;const{data:s,error:a}=t;if(a)return{data:null,error:a};const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await yt(this.fetch,"POST","".concat(this.url,"/factors"),{body:i,headers:this.headers,jwt:null===(n=null===s||void 0===s?void 0:s.session)||void 0===n?void 0:n.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null===o||void 0===o?void 0:o.totp)||void 0===r?void 0:r.qr_code)&&(o.totp.qr_code="data:image/svg+xml;utf-8,".concat(o.totp.qr_code)),{data:o,error:null})}))}catch(t){if(Oe(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:r,error:s}=t;if(s)return{data:null,error:s};const{data:a,error:i}=await yt(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/verify"),{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:i})}))}catch(t){if(Oe(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var n;const{data:r,error:s}=t;return s?{data:null,error:s}:await yt(this.fetch,"POST","".concat(this.url,"/factors/").concat(e.factorId,"/challenge"),{body:{channel:e.channel},headers:this.headers,jwt:null===(n=null===r||void 0===r?void 0:r.session)||void 0===n?void 0:n.access_token})}))}catch(t){if(Oe(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const n=(null===e||void 0===e?void 0:e.factors)||[],r=n.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),s=n.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:n,totp:r,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,n;const{data:{session:r},error:s}=e;if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=lt(r.access_token);let i=null;a.aal&&(i=a.aal);let o=i;(null!==(n=null===(t=r.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==n?n:[]).length>0&&(o="aal2");return{data:{currentLevel:i,nextLevel:o,currentAuthenticationMethods:a.amr||[]},error:null}}))))}async fetchJwk(e){let t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]}).keys.find((t=>t.kid===e));if(t)return t;if(t=this.jwks.keys.find((t=>t.kid===e)),t&&this.jwks_cached_at+6e5>Date.now())return t;const{data:n,error:r}=await yt(this.fetch,"GET","".concat(this.url,"/.well-known/jwks.json"),{headers:this.headers});if(r)throw r;if(!n.keys||0===n.keys.length)throw new Ve("JWKS is empty");if(this.jwks=n,this.jwks_cached_at=Date.now(),t=n.keys.find((t=>t.kid===e)),!t)throw new Ve("No matching signing key found in JWKS");return t}async getClaims(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{keys:[]};try{let n=e;if(!n){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};n=e.session.access_token}const{header:r,payload:s,signature:a,raw:{header:i,payload:o}}=lt(n);if(function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(s.exp),!r.kid||"HS256"===r.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:e}=await this.getUser(n);if(e)throw e;return{data:{claims:s,header:r,signature:a},error:null}}const l=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(r.alg),c=await this.fetchJwk(r.kid,t),d=await crypto.subtle.importKey("jwk",c,l,!0,["verify"]);if(!await crypto.subtle.verify(l,d,a,function(e){const t=[];return Xe(e,(e=>t.push(e))),new Uint8Array(t)}("".concat(i,".").concat(o))))throw new Ve("Invalid JWT signature");return{data:{claims:s,header:r,signature:a},error:null}}catch(n){if(Oe(n))return{data:null,error:n};throw n}}}It.nextInstanceID=0;const Lt=It;class Mt extends Lt{constructor(e){super(e)}}var Rt=function(e,t,n,r){return new(n||(n=Promise))((function(s,a){function i(e){try{l(r.next(e))}catch(t){a(t)}}function o(e){try{l(r.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,o)}l((r=r.apply(e,t||[])).next())}))};class Ft{constructor(e,t,n){var r,s,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const i=e.replace(/\/$/,"");this.realtimeUrl="".concat(i,"/realtime/v1").replace(/^http/i,"ws"),this.authUrl="".concat(i,"/auth/v1"),this.storageUrl="".concat(i,"/storage/v1"),this.functionsUrl="".concat(i,"/functions/v1");const o="sb-".concat(new URL(this.authUrl).hostname.split(".")[0],"-auth-token"),l=function(e,t){const{db:n,auth:r,realtime:s,global:a}=e,{db:i,auth:o,realtime:l,global:c}=t,d={db:Object.assign(Object.assign({},i),n),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},l),s),global:Object.assign(Object.assign({},c),a),accessToken:()=>ke(this,void 0,void 0,(function*(){return""}))};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!==n&&void 0!==n?n:{},{db:ye,realtime:xe,auth:Object.assign(Object.assign({},be),{storageKey:o}),global:me});this.storageKey=null!==(r=l.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(s=l.global.headers)&&void 0!==s?s:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error("@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.".concat(String(t)," is not possible"))}})):this.auth=this._initSupabaseAuthClient(null!==(a=l.auth)&&void 0!==a?a:{},this.headers,l.global.fetch),this.fetch=Se(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new u("".concat(i,"/rest/v1"),{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new c(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ge(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.rest.rpc(e,t,n)}channel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{config:{}};return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Rt(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return null!==(t=null===(e=n.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient(e,t,n){let{autoRefreshToken:r,persistSession:s,detectSessionInUrl:a,storage:i,storageKey:o,flowType:l,lock:c,debug:d}=e;const u={Authorization:"Bearer ".concat(this.supabaseKey),apikey:"".concat(this.supabaseKey)};return new Mt({url:this.authUrl,headers:Object.assign(Object.assign({},u),t),storageKey:o,autoRefreshToken:r,persistSession:s,detectSessionInUrl:a,storage:i,flowType:l,lock:c,debug:d,fetch:n,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new V(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null===e||void 0===e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null===t||void 0===t?void 0:t.access_token)}))}_handleTokenChanged(e,t,n){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===n?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=n}}const Bt="https://mplrakcyrohgkqdhzpry.supabase.co",zt="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1wbHJha2N5cm9oZ2txZGh6cHJ5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDc0NjQ4NTIsImV4cCI6MjA2MzA0MDg1Mn0.uPw-jom-Hsio1-yot4tJQ15FKrPxe0itLfyXPY-qREw";const Ut=((e,t,n)=>new Ft(e,t,n))(Bt,zt),Wt=Ut},374:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(286));class a extends s.default{select(e){let t=!1;const n=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e){let{ascending:t=!0,nullsFirst:n,foreignTable:r,referencedTable:s=r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=s?"".concat(s,".order"):"order",i=this.url.searchParams.get(a);return this.url.searchParams.set(a,"".concat(i?"".concat(i,","):"").concat(e,".").concat(t?"asc":"desc").concat(void 0===n?"":n?".nullsfirst":".nullslast")),this}limit(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r="undefined"===typeof n?"limit":"".concat(n,".limit");return this.url.searchParams.set(r,"".concat(e)),this}range(e,t){let{foreignTable:n,referencedTable:r=n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s="undefined"===typeof r?"offset":"".concat(r,".offset"),a="undefined"===typeof r?"limit":"".concat(r,".limit");return this.url.searchParams.set(s,"".concat(e)),this.url.searchParams.set(a,"".concat(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain(){let{analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:r=!1,wal:s=!1,format:a="text"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};var i;const o=[e?"analyze":null,t?"verbose":null,n?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),l=null!==(i=this.headers.Accept)&&void 0!==i?i:"application/json";return this.headers.Accept="application/vnd.pgrst.plan+".concat(a,'; for="').concat(l,'"; options=').concat(o,";"),this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}t.default=a},379:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(705);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},400:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.version=void 0,t.version="0.0.0-automated"},579:(e,t,n)=>{e.exports=n(153)},611:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class n extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}t.default=n},630:(e,t,n)=>{n.r(t),n.d(t,{Headers:()=>i,Request:()=>o,Response:()=>l,default:()=>a,fetch:()=>s});var r=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("unable to locate global object")}();const s=r.fetch,a=r.fetch.bind(r),i=r.Headers,o=r.Request,l=r.Response},705:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function s(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var s=n.call(e,t||"default");if("object"!=r(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function a(e,t,n){return(t=s(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{A:()=>a})},730:(e,t,n)=>{var r=n(43),s=n(853);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},g={};function p(e,t,n,r,s,a,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new p(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new p(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new p(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new p(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new p(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new p(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function b(e){return e[1].toUpperCase()}function x(e,t,n,r){var s=m.hasOwnProperty(t)?m[t]:null;(null!==s?0!==s.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,s,r)&&(n=null),r||null===s?function(e){return!!u.call(g,e)||!u.call(f,e)&&(h.test(e)?g[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=null===n?3!==s.type&&"":n:(t=s.attributeName,r=s.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(s=s.type)||4===s&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,b);m[t]=new p(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,b);m[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,b);m[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)}));var v=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),_=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),j=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),E=Symbol.for("react.context"),C=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var I=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=I&&e[I]||e["@@iterator"])?e:null}var M,R=Object.assign;function F(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var B=!1;function z(e,t){if(!e||B)return"";B=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var s=c.stack.split("\n"),a=r.stack.split("\n"),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(1!==i||1!==o)do{if(i--,0>--o||s[i]!==a[o]){var l="\n"+s[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=o);break}}}finally{B=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?F(e):""}function U(e){switch(e.tag){case 5:return F(e.type);case 16:return F("Lazy");case 13:return F("Suspense");case 19:return F("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function W(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case _:return"Portal";case j:return"Profiler";case k:return"StrictMode";case T:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case N:return(e._context.displayName||"Context")+".Provider";case C:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case D:return null!==(t=e.displayName||null)?t:W(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return W(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function J(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var s=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(e){r=""+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=V(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Y(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function G(e,t){var n=t.checked;return R({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function $(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=H(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&x(e,"checked",t,!1)}function X(e,t){Q(e,t);var n=H(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Y(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+H(n),t=null,s=0;s<e.length;s++){if(e[s].value===n)return e[s].selected=!0,void(r&&(e[s].defaultSelected=!0));null!==t||e[s].disabled||(t=e[s])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return R({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(te(n)){if(1<n.length)throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:H(n)}}function ae(e,t){var n=H(t.value),r=H(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return de(e,t)}))}:de);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ge=["Webkit","ms","Moz","O"];function pe(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),s=pe(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}Object.keys(fe).forEach((function(e){ge.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ye=R({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function be(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function xe(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ve=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,Se=null,ke=null;function je(e){if(e=xs(e)){if("function"!==typeof _e)throw Error(a(280));var t=e.stateNode;t&&(t=ws(t),_e(e.stateNode,e.type,t))}}function Ne(e){Se?ke?ke.push(e):ke=[e]:Se=e}function Ee(){if(Se){var e=Se,t=ke;if(ke=Se=null,je(e),t)for(e=0;e<t.length;e++)je(t[e])}}function Ce(e,t){return e(t)}function Te(){}var Ae=!1;function De(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ce(e,t,n)}finally{Ae=!1,(null!==Se||null!==ke)&&(Te(),Ee())}}function Pe(e,t){var n=e.stateNode;if(null===n)return null;var r=ws(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Oe=!1;if(d)try{var Ie={};Object.defineProperty(Ie,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Ie,Ie),window.removeEventListener("test",Ie,Ie)}catch(de){Oe=!1}function Le(e,t,n,r,s,a,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(d){this.onError(d)}}var Me=!1,Re=null,Fe=!1,Be=null,ze={onError:function(e){Me=!0,Re=e}};function Ue(e,t,n,r,s,a,i,o,l){Me=!1,Re=null,Le.apply(ze,arguments)}function We(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(We(e)!==e)throw Error(a(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(null===s)break;var i=s.alternate;if(null===i){if(null!==(r=s.return)){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return He(s),e;if(i===r)return He(s),t;i=i.sibling}throw Error(a(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e))?Je(e):null}function Je(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Je(e);if(null!==t)return t;e=e.sibling}return null}var Ke=s.unstable_scheduleCallback,Ye=s.unstable_cancelCallback,Ge=s.unstable_shouldYield,$e=s.unstable_requestPaint,Qe=s.unstable_now,Xe=s.unstable_getCurrentPriorityLevel,Ze=s.unstable_ImmediatePriority,et=s.unstable_UserBlockingPriority,tt=s.unstable_NormalPriority,nt=s.unstable_LowPriority,rt=s.unstable_IdlePriority,st=null,at=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,s=e.suspendedLanes,a=e.pingedLanes,i=268435455&n;if(0!==i){var o=i&~s;0!==o?r=ut(o):0!==(a&=i)&&(r=ut(a))}else 0!==(i=n&~s)?r=ut(i):0!==a&&(r=ut(a));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&s)&&((s=r&-r)>=(a=t&-t)||16===s&&0!==(4194240&a)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)s=1<<(n=31-it(t)),r|=e[n],t&=~s;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function gt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=n}function bt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-it(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var xt=0;function vt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,_t,St,kt,jt,Nt=!1,Et=[],Ct=null,Tt=null,At=null,Dt=new Map,Pt=new Map,Ot=[],It="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Ct=null;break;case"dragenter":case"dragleave":Tt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Dt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pt.delete(t.pointerId)}}function Mt(e,t,n,r,s,a){return null===e||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[s]},null!==t&&(null!==(t=xs(t))&&_t(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==s&&-1===t.indexOf(s)&&t.push(s),e)}function Rt(e){var t=bs(e.target);if(null!==t){var n=We(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void jt(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ft(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Gt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=xs(n))&&_t(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);ve=r,n.target.dispatchEvent(r),ve=null,t.shift()}return!0}function Bt(e,t,n){Ft(e)&&n.delete(t)}function zt(){Nt=!1,null!==Ct&&Ft(Ct)&&(Ct=null),null!==Tt&&Ft(Tt)&&(Tt=null),null!==At&&Ft(At)&&(At=null),Dt.forEach(Bt),Pt.forEach(Bt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Nt||(Nt=!0,s.unstable_scheduleCallback(s.unstable_NormalPriority,zt)))}function Wt(e){function t(t){return Ut(t,e)}if(0<Et.length){Ut(Et[0],e);for(var n=1;n<Et.length;n++){var r=Et[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Ct&&Ut(Ct,e),null!==Tt&&Ut(Tt,e),null!==At&&Ut(At,e),Dt.forEach(t),Pt.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Rt(n),null===n.blockedOn&&Ot.shift()}var qt=v.ReactCurrentBatchConfig,Ht=!0;function Vt(e,t,n,r){var s=xt,a=qt.transition;qt.transition=null;try{xt=1,Kt(e,t,n,r)}finally{xt=s,qt.transition=a}}function Jt(e,t,n,r){var s=xt,a=qt.transition;qt.transition=null;try{xt=4,Kt(e,t,n,r)}finally{xt=s,qt.transition=a}}function Kt(e,t,n,r){if(Ht){var s=Gt(e,t,n,r);if(null===s)Hr(e,t,r,Yt,n),Lt(e,r);else if(function(e,t,n,r,s){switch(t){case"focusin":return Ct=Mt(Ct,e,t,n,r,s),!0;case"dragenter":return Tt=Mt(Tt,e,t,n,r,s),!0;case"mouseover":return At=Mt(At,e,t,n,r,s),!0;case"pointerover":var a=s.pointerId;return Dt.set(a,Mt(Dt.get(a)||null,e,t,n,r,s)),!0;case"gotpointercapture":return a=s.pointerId,Pt.set(a,Mt(Pt.get(a)||null,e,t,n,r,s)),!0}return!1}(s,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<It.indexOf(e)){for(;null!==s;){var a=xs(s);if(null!==a&&wt(a),null===(a=Gt(e,t,n,r))&&Hr(e,t,r,Yt,n),a===s)break;s=a}null!==s&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Yt=null;function Gt(e,t,n,r){if(Yt=null,null!==(e=bs(e=we(r))))if(null===(t=We(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yt=e,null}function $t(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Qt=null,Xt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Xt,r=n.length,s="value"in Qt?Qt.value:Qt.textContent,a=s.length;for(e=0;e<r&&n[e]===s[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===s[a-t];t++);return Zt=s.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,s,a){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=s,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(s):s[i]);return this.isDefaultPrevented=(null!=s.defaultPrevented?s.defaultPrevented:!1===s.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return R(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=sn(cn),un=R({},cn,{view:0,detail:0}),hn=sn(un),fn=R({},un,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),gn=sn(fn),pn=sn(R({},fn,{dataTransfer:0})),mn=sn(R({},un,{relatedTarget:0})),yn=sn(R({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),bn=R({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),xn=sn(bn),vn=sn(R({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function jn(){return kn}var Nn=R({},un,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_n[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),En=sn(Nn),Cn=sn(R({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Tn=sn(R({},un,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jn})),An=sn(R({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Dn=R({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=sn(Dn),On=[9,13,27,32],In=d&&"CompositionEvent"in window,Ln=null;d&&"documentMode"in document&&(Ln=document.documentMode);var Mn=d&&"TextEvent"in window&&!Ln,Rn=d&&(!In||Ln&&8<Ln&&11>=Ln),Fn=String.fromCharCode(32),Bn=!1;function zn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Wn=!1;var qn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!qn[e.type]:"textarea"===t}function Vn(e,t,n,r){Ne(r),0<(t=Jr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Jn=null,Kn=null;function Yn(e){Fr(e,0)}function Gn(e){if(K(vs(e)))return e}function $n(e,t){if("change"===e)return t}var Qn=!1;if(d){var Xn;if(d){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Xn=Zn}else Xn=!1;Qn=Xn&&(!document.documentMode||9<document.documentMode)}function tr(){Jn&&(Jn.detachEvent("onpropertychange",nr),Kn=Jn=null)}function nr(e){if("value"===e.propertyName&&Gn(Kn)){var t=[];Vn(t,Kn,e,we(e)),De(Yn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Jn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function sr(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Gn(Kn)}function ar(e,t){if("click"===e)return Gn(t)}function ir(e,t){if("input"===e||"change"===e)return Gn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!u.call(t,s)||!or(e[s],t[s]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function ur(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ur(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Y();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Y((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function gr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&ur(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var s=n.textContent.length,a=Math.min(r.start,s);r=void 0===r.end?a:Math.min(r.end,s),!e.extend&&a>r&&(s=r,r=a,a=s),s=dr(n,a);var i=dr(n,r);s&&i&&(1!==e.rangeCount||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(s.node,s.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var pr=d&&"documentMode"in document&&11>=document.documentMode,mr=null,yr=null,br=null,xr=!1;function vr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;xr||null==mr||mr!==Y(r)||("selectionStart"in(r=mr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},br&&lr(br,r)||(br=r,0<(r=Jr(yr,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _r={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Sr={},kr={};function jr(e){if(Sr[e])return Sr[e];if(!_r[e])return e;var t,n=_r[e];for(t in n)if(n.hasOwnProperty(t)&&t in kr)return Sr[e]=n[t];return e}d&&(kr=document.createElement("div").style,"AnimationEvent"in window||(delete _r.animationend.animation,delete _r.animationiteration.animation,delete _r.animationstart.animation),"TransitionEvent"in window||delete _r.transitionend.transition);var Nr=jr("animationend"),Er=jr("animationiteration"),Cr=jr("animationstart"),Tr=jr("transitionend"),Ar=new Map,Dr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pr(e,t){Ar.set(e,t),l(t,[e])}for(var Or=0;Or<Dr.length;Or++){var Ir=Dr[Or];Pr(Ir.toLowerCase(),"on"+(Ir[0].toUpperCase()+Ir.slice(1)))}Pr(Nr,"onAnimationEnd"),Pr(Er,"onAnimationIteration"),Pr(Cr,"onAnimationStart"),Pr("dblclick","onDoubleClick"),Pr("focusin","onFocus"),Pr("focusout","onBlur"),Pr(Tr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Rr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,s,i,o,l,c){if(Ue.apply(this,arguments),Me){if(!Me)throw Error(a(198));var d=Re;Me=!1,Re=null,Fe||(Fe=!0,Be=d)}}(r,t,void 0,e),e.currentTarget=null}function Fr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var i=r.length-1;0<=i;i--){var o=r[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==a&&s.isPropagationStopped())break e;Rr(s,o,c),a=l}else for(i=0;i<r.length;i++){if(l=(o=r[i]).instance,c=o.currentTarget,o=o.listener,l!==a&&s.isPropagationStopped())break e;Rr(s,o,c),a=l}}}if(Fe)throw e=Be,Fe=!1,Be=null,e}function Br(e,t){var n=t[ps];void 0===n&&(n=t[ps]=new Set);var r=e+"__bubble";n.has(r)||(qr(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),qr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Wr(e){if(!e[Ur]){e[Ur]=!0,i.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||zr(t,!1,e),zr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,zr("selectionchange",!1,t))}}function qr(e,t,n,r){switch($t(t)){case 1:var s=Vt;break;case 4:s=Jt;break;default:s=Kt}n=s.bind(null,t,n,e),s=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(s=!0),r?void 0!==s?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):void 0!==s?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,s){var a=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var o=r.stateNode.containerInfo;if(o===s||8===o.nodeType&&o.parentNode===s)break;if(4===i)for(i=r.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===s||8===l.nodeType&&l.parentNode===s))return;i=i.return}for(;null!==o;){if(null===(i=bs(o)))return;if(5===(l=i.tag)||6===l){r=a=i;continue e}o=o.parentNode}}r=r.return}De((function(){var r=a,s=we(n),i=[];e:{var o=Ar.get(e);if(void 0!==o){var l=dn,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=En;break;case"focusin":c="focus",l=mn;break;case"focusout":c="blur",l=mn;break;case"beforeblur":case"afterblur":l=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=gn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=pn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Tn;break;case Nr:case Er:case Cr:l=yn;break;case Tr:l=An;break;case"scroll":l=hn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=xn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Cn}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==o?o+"Capture":null:o;d=[];for(var f,g=r;null!==g;){var p=(f=g).stateNode;if(5===f.tag&&null!==p&&(f=p,null!==h&&(null!=(p=Pe(g,h))&&d.push(Vr(g,p,f)))),u)break;g=g.return}0<d.length&&(o=new l(o,c,null,n,s),i.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===ve||!(c=n.relatedTarget||n.fromElement)||!bs(c)&&!c[gs])&&(l||o)&&(o=s.window===s?s:(o=s.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?bs(c):null)&&(c!==(u=We(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(d=gn,p="onMouseLeave",h="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(d=Cn,p="onPointerLeave",h="onPointerEnter",g="pointer"),u=null==l?o:vs(l),f=null==c?o:vs(c),(o=new d(p,g+"leave",l,n,s)).target=u,o.relatedTarget=f,p=null,bs(s)===r&&((d=new d(h,g+"enter",c,n,s)).target=f,d.relatedTarget=u,p=d),u=p,l&&c)e:{for(h=c,g=0,f=d=l;f;f=Kr(f))g++;for(f=0,p=h;p;p=Kr(p))f++;for(;0<g-f;)d=Kr(d),g--;for(;0<f-g;)h=Kr(h),f--;for(;g--;){if(d===h||null!==h&&d===h.alternate)break e;d=Kr(d),h=Kr(h)}d=null}else d=null;null!==l&&Yr(i,o,l,d,!1),null!==c&&null!==u&&Yr(i,u,c,d,!0)}if("select"===(l=(o=r?vs(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var m=$n;else if(Hn(o))if(Qn)m=ir;else{m=sr;var y=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(m=ar);switch(m&&(m=m(e,r))?Vn(i,m,n,s):(y&&y(e,o,r),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&ee(o,"number",o.value)),y=r?vs(r):window,e){case"focusin":(Hn(y)||"true"===y.contentEditable)&&(mr=y,yr=r,br=null);break;case"focusout":br=yr=mr=null;break;case"mousedown":xr=!0;break;case"contextmenu":case"mouseup":case"dragend":xr=!1,vr(i,n,s);break;case"selectionchange":if(pr)break;case"keydown":case"keyup":vr(i,n,s)}var b;if(In)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Wn?zn(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(Rn&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==x?"onCompositionEnd"===x&&Wn&&(b=en()):(Xt="value"in(Qt=s)?Qt.value:Qt.textContent,Wn=!0)),0<(y=Jr(r,x)).length&&(x=new vn(x,e,null,n,s),i.push({event:x,listeners:y}),b?x.data=b:null!==(b=Un(n))&&(x.data=b))),(b=Mn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Bn=!0,Fn);case"textInput":return(e=t.data)===Fn&&Bn?null:e;default:return null}}(e,n):function(e,t){if(Wn)return"compositionend"===e||!In&&zn(e,t)?(e=en(),Zt=Xt=Qt=null,Wn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Rn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Jr(r,"onBeforeInput")).length&&(s=new vn("onBeforeInput","beforeinput",null,n,s),i.push({event:s,listeners:r}),s.data=b))}Fr(i,t)}))}function Vr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Jr(e,t){for(var n=t+"Capture",r=[];null!==e;){var s=e,a=s.stateNode;5===s.tag&&null!==a&&(s=a,null!=(a=Pe(e,n))&&r.unshift(Vr(e,a,s)),null!=(a=Pe(e,t))&&r.push(Vr(e,a,s))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yr(e,t,n,r,s){for(var a=t._reactName,i=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,s?null!=(l=Pe(n,a))&&i.unshift(Vr(n,l,o)):s||null!=(l=Pe(n,a))&&i.push(Vr(n,l,o))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}var Gr=/\r\n?/g,$r=/\u0000|\uFFFD/g;function Qr(e){return("string"===typeof e?e:""+e).replace(Gr,"\n").replace($r,"")}function Xr(e,t,n){if(t=Qr(t),Qr(e)!==t&&n)throw Error(a(425))}function Zr(){}var es=null,ts=null;function ns(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rs="function"===typeof setTimeout?setTimeout:void 0,ss="function"===typeof clearTimeout?clearTimeout:void 0,as="function"===typeof Promise?Promise:void 0,is="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof as?function(e){return as.resolve(null).then(e).catch(os)}:rs;function os(e){setTimeout((function(){throw e}))}function ls(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&8===s.nodeType)if("/$"===(n=s.data)){if(0===r)return e.removeChild(s),void Wt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=s}while(n);Wt(t)}function cs(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ds(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var us=Math.random().toString(36).slice(2),hs="__reactFiber$"+us,fs="__reactProps$"+us,gs="__reactContainer$"+us,ps="__reactEvents$"+us,ms="__reactListeners$"+us,ys="__reactHandles$"+us;function bs(e){var t=e[hs];if(t)return t;for(var n=e.parentNode;n;){if(t=n[gs]||n[hs]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ds(e);null!==e;){if(n=e[hs])return n;e=ds(e)}return t}n=(e=n).parentNode}return null}function xs(e){return!(e=e[hs]||e[gs])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function vs(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function ws(e){return e[fs]||null}var _s=[],Ss=-1;function ks(e){return{current:e}}function js(e){0>Ss||(e.current=_s[Ss],_s[Ss]=null,Ss--)}function Ns(e,t){Ss++,_s[Ss]=e.current,e.current=t}var Es={},Cs=ks(Es),Ts=ks(!1),As=Es;function Ds(e,t){var n=e.type.contextTypes;if(!n)return Es;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s,a={};for(s in n)a[s]=t[s];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function Ps(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Os(){js(Ts),js(Cs)}function Is(e,t,n){if(Cs.current!==Es)throw Error(a(168));Ns(Cs,t),Ns(Ts,n)}function Ls(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var s in r=r.getChildContext())if(!(s in t))throw Error(a(108,q(e)||"Unknown",s));return R({},n,r)}function Ms(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Es,As=Cs.current,Ns(Cs,e),Ns(Ts,Ts.current),!0}function Rs(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=Ls(e,t,As),r.__reactInternalMemoizedMergedChildContext=e,js(Ts),js(Cs),Ns(Cs,e)):js(Ts),Ns(Ts,n)}var Fs=null,Bs=!1,zs=!1;function Us(e){null===Fs?Fs=[e]:Fs.push(e)}function Ws(){if(!zs&&null!==Fs){zs=!0;var e=0,t=xt;try{var n=Fs;for(xt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Fs=null,Bs=!1}catch(s){throw null!==Fs&&(Fs=Fs.slice(e+1)),Ke(Ze,Ws),s}finally{xt=t,zs=!1}}return null}var qs=[],Hs=0,Vs=null,Js=0,Ks=[],Ys=0,Gs=null,$s=1,Qs="";function Xs(e,t){qs[Hs++]=Js,qs[Hs++]=Vs,Vs=e,Js=t}function Zs(e,t,n){Ks[Ys++]=$s,Ks[Ys++]=Qs,Ks[Ys++]=Gs,Gs=e;var r=$s;e=Qs;var s=32-it(r)-1;r&=~(1<<s),n+=1;var a=32-it(t)+s;if(30<a){var i=s-s%5;a=(r&(1<<i)-1).toString(32),r>>=i,s-=i,$s=1<<32-it(t)+s|n<<s|r,Qs=a+e}else $s=1<<a|n<<s|r,Qs=e}function ea(e){null!==e.return&&(Xs(e,1),Zs(e,1,0))}function ta(e){for(;e===Vs;)Vs=qs[--Hs],qs[Hs]=null,Js=qs[--Hs],qs[Hs]=null;for(;e===Gs;)Gs=Ks[--Ys],Ks[Ys]=null,Qs=Ks[--Ys],Ks[Ys]=null,$s=Ks[--Ys],Ks[Ys]=null}var na=null,ra=null,sa=!1,aa=null;function ia(e,t){var n=Dc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function oa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,na=e,ra=cs(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,na=e,ra=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Gs?{id:$s,overflow:Qs}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Dc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,na=e,ra=null,!0);default:return!1}}function la(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ca(e){if(sa){var t=ra;if(t){var n=t;if(!oa(e,t)){if(la(e))throw Error(a(418));t=cs(n.nextSibling);var r=na;t&&oa(e,t)?ia(r,n):(e.flags=-4097&e.flags|2,sa=!1,na=e)}}else{if(la(e))throw Error(a(418));e.flags=-4097&e.flags|2,sa=!1,na=e}}}function da(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;na=e}function ua(e){if(e!==na)return!1;if(!sa)return da(e),sa=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ns(e.type,e.memoizedProps)),t&&(t=ra)){if(la(e))throw ha(),Error(a(418));for(;t;)ia(e,t),t=cs(t.nextSibling)}if(da(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ra=cs(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ra=null}}else ra=na?cs(e.stateNode.nextSibling):null;return!0}function ha(){for(var e=ra;e;)e=cs(e.nextSibling)}function fa(){ra=na=null,sa=!1}function ga(e){null===aa?aa=[e]:aa.push(e)}var pa=v.ReactCurrentBatchConfig;function ma(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var s=r,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=s.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function ya(e,t){throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ba(e){return(0,e._init)(e._payload)}function xa(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function s(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Rc(n,e.mode,r)).return=e,t):((t=s(t,n)).return=e,t)}function c(e,t,n,r){var a=n.type;return a===S?u(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===a||"object"===typeof a&&null!==a&&a.$$typeof===P&&ba(a)===t.type)?((r=s(t,n.props)).ref=ma(e,t,n),r.return=e,r):((r=Ic(n.type,n.key,n.props,null,e.mode,r)).ref=ma(e,t,n),r.return=e,r)}function d(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Fc(n,e.mode,r)).return=e,t):((t=s(t,n.children||[])).return=e,t)}function u(e,t,n,r,a){return null===t||7!==t.tag?((t=Lc(n,e.mode,r,a)).return=e,t):((t=s(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Rc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Ic(t.type,t.key,t.props,null,e.mode,n)).ref=ma(e,null,t),n.return=e,n;case _:return(t=Fc(t,e.mode,n)).return=e,t;case P:return h(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Lc(t,e.mode,n,null)).return=e,t;ya(e,t)}return null}function f(e,t,n,r){var s=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==s?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===s?c(e,t,n,r):null;case _:return n.key===s?d(e,t,n,r):null;case P:return f(e,t,(s=n._init)(n._payload),r)}if(te(n)||L(n))return null!==s?null:u(e,t,n,r,null);ya(e,n)}return null}function g(e,t,n,r,s){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,s);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,s);case _:return d(t,e=e.get(null===r.key?n:r.key)||null,r,s);case P:return g(e,t,n,(0,r._init)(r._payload),s)}if(te(r)||L(r))return u(t,e=e.get(n)||null,r,s,null);ya(t,r)}return null}function p(s,a,o,l){for(var c=null,d=null,u=a,p=a=0,m=null;null!==u&&p<o.length;p++){u.index>p?(m=u,u=null):m=u.sibling;var y=f(s,u,o[p],l);if(null===y){null===u&&(u=m);break}e&&u&&null===y.alternate&&t(s,u),a=i(y,a,p),null===d?c=y:d.sibling=y,d=y,u=m}if(p===o.length)return n(s,u),sa&&Xs(s,p),c;if(null===u){for(;p<o.length;p++)null!==(u=h(s,o[p],l))&&(a=i(u,a,p),null===d?c=u:d.sibling=u,d=u);return sa&&Xs(s,p),c}for(u=r(s,u);p<o.length;p++)null!==(m=g(u,s,p,o[p],l))&&(e&&null!==m.alternate&&u.delete(null===m.key?p:m.key),a=i(m,a,p),null===d?c=m:d.sibling=m,d=m);return e&&u.forEach((function(e){return t(s,e)})),sa&&Xs(s,p),c}function m(s,o,l,c){var d=L(l);if("function"!==typeof d)throw Error(a(150));if(null==(l=d.call(l)))throw Error(a(151));for(var u=d=null,p=o,m=o=0,y=null,b=l.next();null!==p&&!b.done;m++,b=l.next()){p.index>m?(y=p,p=null):y=p.sibling;var x=f(s,p,b.value,c);if(null===x){null===p&&(p=y);break}e&&p&&null===x.alternate&&t(s,p),o=i(x,o,m),null===u?d=x:u.sibling=x,u=x,p=y}if(b.done)return n(s,p),sa&&Xs(s,m),d;if(null===p){for(;!b.done;m++,b=l.next())null!==(b=h(s,b.value,c))&&(o=i(b,o,m),null===u?d=b:u.sibling=b,u=b);return sa&&Xs(s,m),d}for(p=r(s,p);!b.done;m++,b=l.next())null!==(b=g(p,s,m,b.value,c))&&(e&&null!==b.alternate&&p.delete(null===b.key?m:b.key),o=i(b,o,m),null===u?d=b:u.sibling=b,u=b);return e&&p.forEach((function(e){return t(s,e)})),sa&&Xs(s,m),d}return function e(r,a,i,l){if("object"===typeof i&&null!==i&&i.type===S&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var c=i.key,d=a;null!==d;){if(d.key===c){if((c=i.type)===S){if(7===d.tag){n(r,d.sibling),(a=s(d,i.props.children)).return=r,r=a;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===P&&ba(c)===d.type){n(r,d.sibling),(a=s(d,i.props)).ref=ma(r,d,i),a.return=r,r=a;break e}n(r,d);break}t(r,d),d=d.sibling}i.type===S?((a=Lc(i.props.children,r.mode,l,i.key)).return=r,r=a):((l=Ic(i.type,i.key,i.props,null,r.mode,l)).ref=ma(r,a,i),l.return=r,r=l)}return o(r);case _:e:{for(d=i.key;null!==a;){if(a.key===d){if(4===a.tag&&a.stateNode.containerInfo===i.containerInfo&&a.stateNode.implementation===i.implementation){n(r,a.sibling),(a=s(a,i.children||[])).return=r,r=a;break e}n(r,a);break}t(r,a),a=a.sibling}(a=Fc(i,r.mode,l)).return=r,r=a}return o(r);case P:return e(r,a,(d=i._init)(i._payload),l)}if(te(i))return p(r,a,i,l);if(L(i))return m(r,a,i,l);ya(r,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==a&&6===a.tag?(n(r,a.sibling),(a=s(a,i)).return=r,r=a):(n(r,a),(a=Rc(i,r.mode,l)).return=r,r=a),o(r)):n(r,a)}}var va=xa(!0),wa=xa(!1),_a=ks(null),Sa=null,ka=null,ja=null;function Na(){ja=ka=Sa=null}function Ea(e){var t=_a.current;js(_a),e._currentValue=t}function Ca(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Ta(e,t){Sa=e,ja=ka=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xo=!0),e.firstContext=null)}function Aa(e){var t=e._currentValue;if(ja!==e)if(e={context:e,memoizedValue:t,next:null},null===ka){if(null===Sa)throw Error(a(308));ka=e,Sa.dependencies={lanes:0,firstContext:e}}else ka=ka.next=e;return t}var Da=null;function Pa(e){null===Da?Da=[e]:Da.push(e)}function Oa(e,t,n,r){var s=t.interleaved;return null===s?(n.next=n,Pa(t)):(n.next=s.next,s.next=n),t.interleaved=n,Ia(e,r)}function Ia(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var La=!1;function Ma(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ra(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Fa(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ba(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Cl)){var s=r.pending;return null===s?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Ia(e,n)}return null===(s=r.interleaved)?(t.next=t,Pa(r)):(t.next=s.next,s.next=t),r.interleaved=t,Ia(e,n)}function za(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}function Ua(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var s=null,a=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===a?s=a=i:a=a.next=i,n=n.next}while(null!==n);null===a?s=a=t:a=a.next=t}else s=a=t;return n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Wa(e,t,n,r){var s=e.updateQueue;La=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(null!==o){s.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?a=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==a){var u=s.baseState;for(i=0,d=c=l=null,o=a;;){var h=o.lane,f=o.eventTime;if((r&h)===h){null!==d&&(d=d.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,p=o;switch(h=t,f=n,p.tag){case 1:if("function"===typeof(g=p.payload)){u=g.call(f,u,h);break e}u=g;break e;case 3:g.flags=-65537&g.flags|128;case 0:if(null===(h="function"===typeof(g=p.payload)?g.call(f,u,h):g)||void 0===h)break e;u=R({},u,h);break e;case 2:La=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=s.effects)?s.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=f,l=u):d=d.next=f,i|=h;if(null===(o=o.next)){if(null===(o=s.shared.pending))break;o=(h=o).next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}if(null===d&&(l=u),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=d,null!==(t=s.shared.interleaved)){s=t;do{i|=s.lane,s=s.next}while(s!==t)}else null===a&&(s.shared.lanes=0);Ml|=i,e.lanes=i,e.memoizedState=u}}function qa(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(null!==s){if(r.callback=null,r=n,"function"!==typeof s)throw Error(a(191,s));s.call(r)}}}var Ha={},Va=ks(Ha),Ja=ks(Ha),Ka=ks(Ha);function Ya(e){if(e===Ha)throw Error(a(174));return e}function Ga(e,t){switch(Ns(Ka,t),Ns(Ja,e),Ns(Va,Ha),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}js(Va),Ns(Va,t)}function $a(){js(Va),js(Ja),js(Ka)}function Qa(e){Ya(Ka.current);var t=Ya(Va.current),n=le(t,e.type);t!==n&&(Ns(Ja,e),Ns(Va,n))}function Xa(e){Ja.current===e&&(js(Va),js(Ja))}var Za=ks(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function ni(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var ri=v.ReactCurrentDispatcher,si=v.ReactCurrentBatchConfig,ai=0,ii=null,oi=null,li=null,ci=!1,di=!1,ui=0,hi=0;function fi(){throw Error(a(321))}function gi(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function pi(e,t,n,r,s,i){if(ai=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ri.current=null===e||null===e.memoizedState?Xi:Zi,e=n(r,s),di){i=0;do{if(di=!1,ui=0,25<=i)throw Error(a(301));i+=1,li=oi=null,t.updateQueue=null,ri.current=eo,e=n(r,s)}while(di)}if(ri.current=Qi,t=null!==oi&&null!==oi.next,ai=0,li=oi=ii=null,ci=!1,t)throw Error(a(300));return e}function mi(){var e=0!==ui;return ui=0,e}function yi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===li?ii.memoizedState=li=e:li=li.next=e,li}function bi(){if(null===oi){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=oi.next;var t=null===li?ii.memoizedState:li.next;if(null!==t)li=t,oi=e;else{if(null===e)throw Error(a(310));e={memoizedState:(oi=e).memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},null===li?ii.memoizedState=li=e:li=li.next=e}return li}function xi(e,t){return"function"===typeof t?t(e):t}function vi(e){var t=bi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=oi,s=r.baseQueue,i=n.pending;if(null!==i){if(null!==s){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(null!==s){i=s.next,r=r.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((ai&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,ii.lanes|=u,Ml|=u}d=d.next}while(null!==d&&d!==i);null===c?o=r:c.next=l,or(r,t.memoizedState)||(xo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){s=e;do{i=s.lane,ii.lanes|=i,Ml|=i,s=s.next}while(s!==e)}else null===s&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function wi(e){var t=bi(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(null!==s){n.pending=null;var o=s=s.next;do{i=e(i,o.action),o=o.next}while(o!==s);or(i,t.memoizedState)||(xo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function _i(){}function Si(e,t){var n=ii,r=bi(),s=t(),i=!or(r.memoizedState,s);if(i&&(r.memoizedState=s,xo=!0),r=r.queue,Li(Ni.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||null!==li&&1&li.memoizedState.tag){if(n.flags|=2048,Ai(9,ji.bind(null,n,r,s,t),void 0,null),null===Tl)throw Error(a(349));0!==(30&ai)||ki(n,t,s)}return s}function ki(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ji(e,t,n,r){t.value=n,t.getSnapshot=r,Ei(t)&&Ci(e)}function Ni(e,t,n){return n((function(){Ei(t)&&Ci(e)}))}function Ei(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Ci(e){var t=Ia(e,1);null!==t&&nc(t,e,1,-1)}function Ti(e){var t=yi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:xi,lastRenderedState:e},t.queue=e,e=e.dispatch=Ki.bind(null,ii,e),[t.memoizedState,e]}function Ai(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Di(){return bi().memoizedState}function Pi(e,t,n,r){var s=yi();ii.flags|=e,s.memoizedState=Ai(1|t,n,void 0,void 0===r?null:r)}function Oi(e,t,n,r){var s=bi();r=void 0===r?null:r;var a=void 0;if(null!==oi){var i=oi.memoizedState;if(a=i.destroy,null!==r&&gi(r,i.deps))return void(s.memoizedState=Ai(t,n,a,r))}ii.flags|=e,s.memoizedState=Ai(1|t,n,a,r)}function Ii(e,t){return Pi(8390656,8,e,t)}function Li(e,t){return Oi(2048,8,e,t)}function Mi(e,t){return Oi(4,2,e,t)}function Ri(e,t){return Oi(4,4,e,t)}function Fi(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Bi(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Oi(4,4,Fi.bind(null,t,e),n)}function zi(){}function Ui(e,t){var n=bi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&gi(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Wi(e,t){var n=bi();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&gi(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function qi(e,t,n){return 0===(21&ai)?(e.baseState&&(e.baseState=!1,xo=!0),e.memoizedState=n):(or(n,t)||(n=pt(),ii.lanes|=n,Ml|=n,e.baseState=!0),t)}function Hi(e,t){var n=xt;xt=0!==n&&4>n?n:4,e(!0);var r=si.transition;si.transition={};try{e(!1),t()}finally{xt=n,si.transition=r}}function Vi(){return bi().memoizedState}function Ji(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Yi(e))Gi(t,n);else if(null!==(n=Oa(e,t,n,r))){nc(n,e,r,ec()),$i(n,t,r)}}function Ki(e,t,n){var r=tc(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Yi(e))Gi(t,s);else{var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=a(i,n);if(s.hasEagerState=!0,s.eagerState=o,or(o,i)){var l=t.interleaved;return null===l?(s.next=s,Pa(t)):(s.next=l.next,l.next=s),void(t.interleaved=s)}}catch(c){}null!==(n=Oa(e,t,s,r))&&(nc(n,e,r,s=ec()),$i(n,t,r))}}function Yi(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function Gi(e,t){di=ci=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function $i(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,bt(e,n)}}var Qi={readContext:Aa,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useInsertionEffect:fi,useLayoutEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useMutableSource:fi,useSyncExternalStore:fi,useId:fi,unstable_isNewReconciler:!1},Xi={readContext:Aa,useCallback:function(e,t){return yi().memoizedState=[e,void 0===t?null:t],e},useContext:Aa,useEffect:Ii,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pi(4194308,4,Fi.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Pi(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pi(4,2,e,t)},useMemo:function(e,t){var n=yi();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=yi();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ji.bind(null,ii,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},yi().memoizedState=e},useState:Ti,useDebugValue:zi,useDeferredValue:function(e){return yi().memoizedState=e},useTransition:function(){var e=Ti(!1),t=e[0];return e=Hi.bind(null,e[1]),yi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ii,s=yi();if(sa){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===Tl)throw Error(a(349));0!==(30&ai)||ki(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,Ii(Ni.bind(null,r,i,e),[e]),r.flags|=2048,Ai(9,ji.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=yi(),t=Tl.identifierPrefix;if(sa){var n=Qs;t=":"+t+"R"+(n=($s&~(1<<32-it($s)-1)).toString(32)+n),0<(n=ui++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=hi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zi={readContext:Aa,useCallback:Ui,useContext:Aa,useEffect:Li,useImperativeHandle:Bi,useInsertionEffect:Mi,useLayoutEffect:Ri,useMemo:Wi,useReducer:vi,useRef:Di,useState:function(){return vi(xi)},useDebugValue:zi,useDeferredValue:function(e){return qi(bi(),oi.memoizedState,e)},useTransition:function(){return[vi(xi)[0],bi().memoizedState]},useMutableSource:_i,useSyncExternalStore:Si,useId:Vi,unstable_isNewReconciler:!1},eo={readContext:Aa,useCallback:Ui,useContext:Aa,useEffect:Li,useImperativeHandle:Bi,useInsertionEffect:Mi,useLayoutEffect:Ri,useMemo:Wi,useReducer:wi,useRef:Di,useState:function(){return wi(xi)},useDebugValue:zi,useDeferredValue:function(e){var t=bi();return null===oi?t.memoizedState=e:qi(t,oi.memoizedState,e)},useTransition:function(){return[wi(xi)[0],bi().memoizedState]},useMutableSource:_i,useSyncExternalStore:Si,useId:Vi,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=R({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:R({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ro={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),s=tc(e),a=Fa(r,s);a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ba(e,a,s))&&(nc(t,e,s,r),za(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),s=tc(e),a=Fa(r,s);a.tag=1,a.payload=t,void 0!==n&&null!==n&&(a.callback=n),null!==(t=Ba(e,a,s))&&(nc(t,e,s,r),za(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),s=Fa(n,r);s.tag=2,void 0!==t&&null!==t&&(s.callback=t),null!==(t=Ba(e,s,r))&&(nc(t,e,r,n),za(t,e,r))}};function so(e,t,n,r,s,a,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,i):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(s,a))}function ao(e,t,n){var r=!1,s=Es,a=t.contextType;return"object"===typeof a&&null!==a?a=Aa(a):(s=Ps(t)?As:Cs.current,a=(r=null!==(r=t.contextTypes)&&void 0!==r)?Ds(e,s):Es),t=new t(n,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ro,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function io(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ro.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},Ma(e);var a=t.contextType;"object"===typeof a&&null!==a?s.context=Aa(a):(a=Ps(t)?As:Cs.current,s.context=Ds(e,a)),s.state=e.memoizedState,"function"===typeof(a=t.getDerivedStateFromProps)&&(no(e,t,a,n),s.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof s.getSnapshotBeforeUpdate||"function"!==typeof s.UNSAFE_componentWillMount&&"function"!==typeof s.componentWillMount||(t=s.state,"function"===typeof s.componentWillMount&&s.componentWillMount(),"function"===typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount(),t!==s.state&&ro.enqueueReplaceState(s,s.state,null),Wa(e,n,s,r),s.state=e.memoizedState),"function"===typeof s.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var s=n}catch(a){s="\nError generating stack: "+a.message+"\n"+a.stack}return{value:e,source:t,stack:s,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ho="function"===typeof WeakMap?WeakMap:Map;function fo(e,t,n){(n=Fa(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hl||(Hl=!0,Vl=r),uo(0,t)},n}function go(e,t,n){(n=Fa(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){uo(0,t)}}var a=e.stateNode;return null!==a&&"function"===typeof a.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof r&&(null===Jl?Jl=new Set([this]):Jl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function po(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ho;var s=new Set;r.set(t,s)}else void 0===(s=r.get(t))&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=jc.bind(null,e,t,n),t.then(e,e))}function mo(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,n,r,s){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Fa(-1,1)).tag=2,Ba(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=s,e)}var bo=v.ReactCurrentOwner,xo=!1;function vo(e,t,n,r){t.child=null===e?wa(t,null,n,r):va(t,e.child,n,r)}function wo(e,t,n,r,s){n=n.render;var a=t.ref;return Ta(t,s),r=pi(e,t,n,r,a,s),n=mi(),null===e||xo?(sa&&n&&ea(t),t.flags|=1,vo(e,t,r,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ho(e,t,s))}function _o(e,t,n,r,s){if(null===e){var a=n.type;return"function"!==typeof a||Pc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Ic(n.type,null,r,t,t.mode,s)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,So(e,t,a,r,s))}if(a=e.child,0===(e.lanes&s)){var i=a.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(i,r)&&e.ref===t.ref)return Ho(e,t,s)}return t.flags|=1,(e=Oc(a,r)).ref=t.ref,e.return=t,t.child=e}function So(e,t,n,r,s){if(null!==e){var a=e.memoizedProps;if(lr(a,r)&&e.ref===t.ref){if(xo=!1,t.pendingProps=r=a,0===(e.lanes&s))return t.lanes=e.lanes,Ho(e,t,s);0!==(131072&e.flags)&&(xo=!0)}}return No(e,t,n,r,s)}function ko(e,t,n){var r=t.pendingProps,s=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ns(Ol,Pl),Pl|=n;else{if(0===(1073741824&n))return e=null!==a?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ns(Ol,Pl),Pl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==a?a.baseLanes:n,Ns(Ol,Pl),Pl|=r}else null!==a?(r=a.baseLanes|n,t.memoizedState=null):r=n,Ns(Ol,Pl),Pl|=r;return vo(e,t,s,n),t.child}function jo(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function No(e,t,n,r,s){var a=Ps(n)?As:Cs.current;return a=Ds(t,a),Ta(t,s),n=pi(e,t,n,r,a,s),r=mi(),null===e||xo?(sa&&r&&ea(t),t.flags|=1,vo(e,t,n,s),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ho(e,t,s))}function Eo(e,t,n,r,s){if(Ps(n)){var a=!0;Ms(t)}else a=!1;if(Ta(t,s),null===t.stateNode)qo(e,t),ao(t,n,r),oo(t,n,r,s),r=!0;else if(null===e){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=n.contextType;"object"===typeof c&&null!==c?c=Aa(c):c=Ds(t,c=Ps(n)?As:Cs.current);var d=n.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==r||l!==c)&&io(t,i,r,c),La=!1;var h=t.memoizedState;i.state=h,Wa(t,r,i,s),l=t.memoizedState,o!==r||h!==l||Ts.current||La?("function"===typeof d&&(no(t,n,d,r),l=t.memoizedState),(o=La||so(t,n,o,r,h,l,c))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),i.props=r,i.state=l,i.context=c,r=o):("function"===typeof i.componentDidMount&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,Ra(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),i.props=c,u=t.pendingProps,h=i.context,"object"===typeof(l=n.contextType)&&null!==l?l=Aa(l):l=Ds(t,l=Ps(n)?As:Cs.current);var f=n.getDerivedStateFromProps;(d="function"===typeof f||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==u||h!==l)&&io(t,i,r,l),La=!1,h=t.memoizedState,i.state=h,Wa(t,r,i,s);var g=t.memoizedState;o!==u||h!==g||Ts.current||La?("function"===typeof f&&(no(t,n,f,r),g=t.memoizedState),(c=La||so(t,n,c,r,h,g,l)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,g,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,g,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=g),i.props=r,i.state=g,i.context=l,r=c):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return Co(e,t,n,r,a,s)}function Co(e,t,n,r,s,a){jo(e,t);var i=0!==(128&t.flags);if(!r&&!i)return s&&Rs(t,n,!1),Ho(e,t,a);r=t.stateNode,bo.current=t;var o=i&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&i?(t.child=va(t,e.child,null,a),t.child=va(t,null,o,a)):vo(e,t,o,a),t.memoizedState=r.state,s&&Rs(t,n,!0),t.child}function To(e){var t=e.stateNode;t.pendingContext?Is(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Is(0,t.context,!1),Ga(e,t.containerInfo)}function Ao(e,t,n,r,s){return fa(),ga(s),t.flags|=256,vo(e,t,n,r),t.child}var Do,Po,Oo,Io,Lo={dehydrated:null,treeContext:null,retryLane:0};function Mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ro(e,t,n){var r,s=t.pendingProps,i=Za.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),Ns(Za,1&i),null===e)return ca(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=s.children,e=s.fallback,o?(s=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&s)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Mc(l,s,0,null),e=Lc(e,s,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Mo(n),t.memoizedState=Lo,e):Fo(t,l));if(null!==(i=e.memoizedState)&&null!==(r=i.dehydrated))return function(e,t,n,r,s,i,o){if(n)return 256&t.flags?(t.flags&=-257,Bo(e,t,o,r=co(Error(a(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Mc({mode:"visible",children:r.children},s,0,null),(i=Lc(i,s,o,null)).flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,0!==(1&t.mode)&&va(t,e.child,null,o),t.child.memoizedState=Mo(o),t.memoizedState=Lo,i);if(0===(1&t.mode))return Bo(e,t,o,null);if("$!"===s.data){if(r=s.nextSibling&&s.nextSibling.dataset)var l=r.dgst;return r=l,Bo(e,t,o,r=co(i=Error(a(419)),r,void 0))}if(l=0!==(o&e.childLanes),xo||l){if(null!==(r=Tl)){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}0!==(s=0!==(s&(r.suspendedLanes|o))?0:s)&&s!==i.retryLane&&(i.retryLane=s,Ia(e,s),nc(r,e,s,-1))}return pc(),Bo(e,t,o,r=co(Error(a(421))))}return"$?"===s.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,ra=cs(s.nextSibling),na=t,sa=!0,aa=null,null!==e&&(Ks[Ys++]=$s,Ks[Ys++]=Qs,Ks[Ys++]=Gs,$s=e.id,Qs=e.overflow,Gs=t),t=Fo(t,r.children),t.flags|=4096,t)}(e,t,l,s,r,i,n);if(o){o=s.fallback,l=t.mode,r=(i=e.child).sibling;var c={mode:"hidden",children:s.children};return 0===(1&l)&&t.child!==i?((s=t.child).childLanes=0,s.pendingProps=c,t.deletions=null):(s=Oc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==r?o=Oc(r,o):(o=Lc(o,l,n,null)).flags|=2,o.return=t,s.return=t,s.sibling=o,t.child=s,s=o,o=t.child,l=null===(l=e.child.memoizedState)?Mo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Lo,s}return e=(o=e.child).sibling,s=Oc(o,{mode:"visible",children:s.children}),0===(1&t.mode)&&(s.lanes=n),s.return=t,s.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=s,t.memoizedState=null,s}function Fo(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bo(e,t,n,r){return null!==r&&ga(r),va(t,e.child,null,n),(e=Fo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ca(e.return,t,n)}function Uo(e,t,n,r,s){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=s)}function Wo(e,t,n){var r=t.pendingProps,s=r.revealOrder,a=r.tail;if(vo(e,t,r.children,n),0!==(2&(r=Za.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,n,t);else if(19===e.tag)zo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ns(Za,r),0===(1&t.mode))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;null!==n;)null!==(e=n.alternate)&&null===ei(e)&&(s=n),n=n.sibling;null===(n=s)?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Uo(t,!1,s,n,a);break;case"backwards":for(n=null,s=t.child,t.child=null;null!==s;){if(null!==(e=s.alternate)&&null===ei(e)){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Uo(t,!0,n,null,a);break;case"together":Uo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ho(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Oc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Vo(e,t){if(!sa)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Jo(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=14680064&s.subtreeFlags,r|=14680064&s.flags,s.return=e,s=s.sibling;else for(s=e.child;null!==s;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ko(e,t,n){var r=t.pendingProps;switch(ta(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jo(t),null;case 1:case 17:return Ps(t.type)&&Os(),Jo(t),null;case 3:return r=t.stateNode,$a(),js(Ts),js(Cs),ni(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ua(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==aa&&(ic(aa),aa=null))),Po(e,t),Jo(t),null;case 5:Xa(t);var s=Ya(Ka.current);if(n=t.type,null!==e&&null!=t.stateNode)Oo(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(a(166));return Jo(t),null}if(e=Ya(Va.current),ua(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[hs]=t,r[fs]=i,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(s=0;s<Lr.length;s++)Br(Lr[s],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":$(r,i),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Br("invalid",r);break;case"textarea":se(r,i),Br("invalid",r)}for(var l in be(n,i),s=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==i.suppressHydrationWarning&&Xr(r.textContent,c,e),s=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Xr(r.textContent,c,e),s=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Br("scroll",r)}switch(n){case"input":J(r),Z(r,i,!0);break;case"textarea":J(r),ie(r);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(r.onclick=Zr)}r=s,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===s.nodeType?s:s.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hs]=t,e[fs]=r,Do(e,t,!1,!1),t.stateNode=e;e:{switch(l=xe(n,r),n){case"dialog":Br("cancel",e),Br("close",e),s=r;break;case"iframe":case"object":case"embed":Br("load",e),s=r;break;case"video":case"audio":for(s=0;s<Lr.length;s++)Br(Lr[s],e);s=r;break;case"source":Br("error",e),s=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),s=r;break;case"details":Br("toggle",e),s=r;break;case"input":$(e,r),s=G(e,r),Br("invalid",e);break;case"option":default:s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=R({},r,{value:void 0}),Br("invalid",e);break;case"textarea":se(e,r),s=re(e,r),Br("invalid",e)}for(i in be(n,s),c=s)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?me(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===i?"string"===typeof d?("textarea"!==n||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(o.hasOwnProperty(i)?null!=d&&"onScroll"===i&&Br("scroll",e):null!=d&&x(e,i,d,l))}switch(n){case"input":J(e),Z(e,r,!1);break;case"textarea":J(e),ie(e);break;case"option":null!=r.value&&e.setAttribute("value",""+H(r.value));break;case"select":e.multiple=!!r.multiple,null!=(i=r.value)?ne(e,!!r.multiple,i,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof s.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Jo(t),null;case 6:if(e&&null!=t.stateNode)Io(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));if(n=Ya(Ka.current),Ya(Va.current),ua(t)){if(r=t.stateNode,n=t.memoizedProps,r[hs]=t,(i=r.nodeValue!==n)&&null!==(e=na))switch(e.tag){case 3:Xr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Xr(r.nodeValue,n,0!==(1&e.mode))}i&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hs]=t,t.stateNode=r}return Jo(t),null;case 13:if(js(Za),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(sa&&null!==ra&&0!==(1&t.mode)&&0===(128&t.flags))ha(),fa(),t.flags|=98560,i=!1;else if(i=ua(t),null!==r&&null!==r.dehydrated){if(null===e){if(!i)throw Error(a(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(a(317));i[hs]=t}else fa(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Jo(t),i=!1}else null!==aa&&(ic(aa),aa=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Za.current)?0===Il&&(Il=3):pc())),null!==t.updateQueue&&(t.flags|=4),Jo(t),null);case 4:return $a(),Po(e,t),null===e&&Wr(t.stateNode.containerInfo),Jo(t),null;case 10:return Ea(t.type._context),Jo(t),null;case 19:if(js(Za),null===(i=t.memoizedState))return Jo(t),null;if(r=0!==(128&t.flags),null===(l=i.rendering))if(r)Vo(i,!1);else{if(0!==Il||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ei(e))){for(t.flags|=128,Vo(i,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(i=n).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ns(Za,1&Za.current|2),t.child}e=e.sibling}null!==i.tail&&Qe()>Wl&&(t.flags|=128,r=!0,Vo(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ei(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Vo(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!sa)return Jo(t),null}else 2*Qe()-i.renderingStartTime>Wl&&1073741824!==n&&(t.flags|=128,r=!0,Vo(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=i.last)?n.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Qe(),t.sibling=null,n=Za.current,Ns(Za,r?1&n|2:1&n),t):(Jo(t),null);case 22:case 23:return uc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Pl)&&(Jo(t),6&t.subtreeFlags&&(t.flags|=8192)):Jo(t),null;case 24:case 25:return null}throw Error(a(156,t.tag))}function Yo(e,t){switch(ta(t),t.tag){case 1:return Ps(t.type)&&Os(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return $a(),js(Ts),js(Cs),ni(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xa(t),null;case 13:if(js(Za),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));fa()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return js(Za),null;case 4:return $a(),null;case 10:return Ea(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Do=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Po=function(){},Oo=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,Ya(Va.current);var a,i=null;switch(n){case"input":s=G(e,s),r=G(e,r),i=[];break;case"select":s=R({},s,{value:void 0}),r=R({},r,{value:void 0}),i=[];break;case"textarea":s=re(e,s),r=re(e,r),i=[];break;default:"function"!==typeof s.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(d in be(n,r),n=null,s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&null!=s[d])if("style"===d){var l=s[d];for(a in l)l.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(l=null!=s?s[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(a in l)!l.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&l[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(d,n)),n=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Br("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Io=function(e,t,n,r){n!==r&&(t.flags|=4)};var Go=!1,$o=!1,Qo="function"===typeof WeakSet?WeakSet:Set,Xo=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){kc(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){kc(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var s=r=r.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,void 0!==a&&el(t,n,a)}s=s.next}while(s!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function sl(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hs],delete t[fs],delete t[ps],delete t[ms],delete t[ys])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var dl=null,ul=!1;function hl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(at&&"function"===typeof at.onCommitFiberUnmount)try{at.onCommitFiberUnmount(st,n)}catch(o){}switch(n.tag){case 5:$o||Zo(n,t);case 6:var r=dl,s=ul;dl=null,hl(e,t,n),ul=s,null!==(dl=r)&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(ul?(e=dl,n=n.stateNode,8===e.nodeType?ls(e.parentNode,n):1===e.nodeType&&ls(e,n),Wt(e)):ls(dl,n.stateNode));break;case 4:r=dl,s=ul,dl=n.stateNode.containerInfo,ul=!0,hl(e,t,n),dl=r,ul=s;break;case 0:case 11:case 14:case 15:if(!$o&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){s=r=r.next;do{var a=s,i=a.destroy;a=a.tag,void 0!==i&&(0!==(2&a)||0!==(4&a))&&el(n,t,i),s=s.next}while(s!==r)}hl(e,t,n);break;case 1:if(!$o&&(Zo(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){kc(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?($o=(r=$o)||null!==n.memoizedState,hl(e,t,n),$o=r):hl(e,t,n);break;default:hl(e,t,n)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Qo),t.forEach((function(t){var r=Cc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function pl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(a(160));fl(i,o,s),dl=null,ul=!1;var c=s.alternate;null!==c&&(c.return=null),s.return=null}catch(d){kc(s,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ml(t,e),t=t.sibling}function ml(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pl(t,e),yl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(m){kc(e,e.return,m)}try{nl(5,e,e.return)}catch(m){kc(e,e.return,m)}}break;case 1:pl(t,e),yl(e),512&r&&null!==n&&Zo(n,n.return);break;case 5:if(pl(t,e),yl(e),512&r&&null!==n&&Zo(n,n.return),32&e.flags){var s=e.stateNode;try{he(s,"")}catch(m){kc(e,e.return,m)}}if(4&r&&null!=(s=e.stateNode)){var i=e.memoizedProps,o=null!==n?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&Q(s,i),xe(l,o);var d=xe(l,i);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];"style"===u?me(s,h):"dangerouslySetInnerHTML"===u?ue(s,h):"children"===u?he(s,h):x(s,u,h,d)}switch(l){case"input":X(s,i);break;case"textarea":ae(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var g=i.value;null!=g?ne(s,!!i.multiple,g,!1):f!==!!i.multiple&&(null!=i.defaultValue?ne(s,!!i.multiple,i.defaultValue,!0):ne(s,!!i.multiple,i.multiple?[]:"",!1))}s[fs]=i}catch(m){kc(e,e.return,m)}}break;case 6:if(pl(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(a(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(m){kc(e,e.return,m)}}break;case 3:if(pl(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(m){kc(e,e.return,m)}break;case 4:default:pl(t,e),yl(e);break;case 13:pl(t,e),yl(e),8192&(s=e.child).flags&&(i=null!==s.memoizedState,s.stateNode.isHidden=i,!i||null!==s.alternate&&null!==s.alternate.memoizedState||(Ul=Qe())),4&r&&gl(e);break;case 22:if(u=null!==n&&null!==n.memoizedState,1&e.mode?($o=(d=$o)||u,pl(t,e),$o=d):pl(t,e),yl(e),8192&r){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Xo=e,u=e.child;null!==u;){for(h=Xo=u;null!==Xo;){switch(g=(f=Xo).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Zo(f,f.return);var p=f.stateNode;if("function"===typeof p.componentWillUnmount){r=f,n=f.return;try{t=r,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(m){kc(r,n,m)}}break;case 5:Zo(f,f.return);break;case 22:if(null!==f.memoizedState){wl(h);continue}}null!==g?(g.return=f,Xo=g):wl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{s=h.stateNode,d?"function"===typeof(i=s.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=pe("display",o))}catch(m){kc(e,e.return,m)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(m){kc(e,e.return,m)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:pl(t,e),yl(e),4&r&&gl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(il(n)){var r=n;break e}n=n.return}throw Error(a(160))}switch(r.tag){case 5:var s=r.stateNode;32&r.flags&&(he(s,""),r.flags&=-33),cl(e,ol(e),s);break;case 3:case 4:var i=r.stateNode.containerInfo;ll(e,ol(e),i);break;default:throw Error(a(161))}}catch(o){kc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){Xo=e,xl(e,t,n)}function xl(e,t,n){for(var r=0!==(1&e.mode);null!==Xo;){var s=Xo,a=s.child;if(22===s.tag&&r){var i=null!==s.memoizedState||Go;if(!i){var o=s.alternate,l=null!==o&&null!==o.memoizedState||$o;o=Go;var c=$o;if(Go=i,($o=l)&&!c)for(Xo=s;null!==Xo;)l=(i=Xo).child,22===i.tag&&null!==i.memoizedState?_l(s):null!==l?(l.return=i,Xo=l):_l(s);for(;null!==a;)Xo=a,xl(a,t,n),a=a.sibling;Xo=s,Go=o,$o=c}vl(e)}else 0!==(8772&s.subtreeFlags)&&null!==a?(a.return=s,Xo=a):vl(e)}}function vl(e){for(;null!==Xo;){var t=Xo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:$o||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!$o)if(null===n)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&qa(t,i,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}qa(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Wt(h)}}}break;default:throw Error(a(163))}$o||512&t.flags&&sl(t)}catch(f){kc(t,t.return,f)}}if(t===e){Xo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Xo=n;break}Xo=t.return}}function wl(e){for(;null!==Xo;){var t=Xo;if(t===e){Xo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Xo=n;break}Xo=t.return}}function _l(e){for(;null!==Xo;){var t=Xo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){kc(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var s=t.return;try{r.componentDidMount()}catch(l){kc(t,s,l)}}var a=t.return;try{sl(t)}catch(l){kc(t,a,l)}break;case 5:var i=t.return;try{sl(t)}catch(l){kc(t,i,l)}}}catch(l){kc(t,t.return,l)}if(t===e){Xo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Xo=o;break}Xo=t.return}}var Sl,kl=Math.ceil,jl=v.ReactCurrentDispatcher,Nl=v.ReactCurrentOwner,El=v.ReactCurrentBatchConfig,Cl=0,Tl=null,Al=null,Dl=0,Pl=0,Ol=ks(0),Il=0,Ll=null,Ml=0,Rl=0,Fl=0,Bl=null,zl=null,Ul=0,Wl=1/0,ql=null,Hl=!1,Vl=null,Jl=null,Kl=!1,Yl=null,Gl=0,$l=0,Ql=null,Xl=-1,Zl=0;function ec(){return 0!==(6&Cl)?Qe():-1!==Xl?Xl:Xl=Qe()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Cl)&&0!==Dl?Dl&-Dl:null!==pa.transition?(0===Zl&&(Zl=pt()),Zl):0!==(e=xt)?e:e=void 0===(e=window.event)?16:$t(e.type)}function nc(e,t,n,r){if(50<$l)throw $l=0,Ql=null,Error(a(185));yt(e,n,r),0!==(2&Cl)&&e===Tl||(e===Tl&&(0===(2&Cl)&&(Rl|=n),4===Il&&oc(e,Dl)),rc(e,r),1===n&&0===Cl&&0===(1&t.mode)&&(Wl=Qe()+500,Bs&&Ws()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-it(a),o=1<<i,l=s[i];-1===l?0!==(o&n)&&0===(o&r)||(s[i]=ft(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var r=ht(e,e===Tl?Dl:0);if(0===r)null!==n&&Ye(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ye(n),1===t)0===e.tag?function(e){Bs=!0,Us(e)}(lc.bind(null,e)):Us(lc.bind(null,e)),is((function(){0===(6&Cl)&&Ws()})),n=null;else{switch(vt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Tc(n,sc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function sc(e,t){if(Xl=-1,Zl=0,0!==(6&Cl))throw Error(a(327));var n=e.callbackNode;if(_c()&&e.callbackNode!==n)return null;var r=ht(e,e===Tl?Dl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=mc(e,r);else{t=r;var s=Cl;Cl|=2;var i=gc();for(Tl===e&&Dl===t||(ql=null,Wl=Qe()+500,hc(e,t));;)try{bc();break}catch(l){fc(e,l)}Na(),jl.current=i,Cl=s,null!==Al?t=0:(Tl=null,Dl=0,t=Il)}if(0!==t){if(2===t&&(0!==(s=gt(e))&&(r=s,t=ac(e,s))),1===t)throw n=Ll,hc(e,0),oc(e,r),rc(e,Qe()),n;if(6===t)oc(e,r);else{if(s=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var s=n[r],a=s.getSnapshot;s=s.value;try{if(!or(a(),s))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(s)&&(2===(t=mc(e,r))&&(0!==(i=gt(e))&&(r=i,t=ac(e,i))),1===t))throw n=Ll,hc(e,0),oc(e,r),rc(e,Qe()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(a(345));case 2:case 5:wc(e,zl,ql);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=Ul+500-Qe())){if(0!==ht(e,0))break;if(((s=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=rs(wc.bind(null,e,zl,ql),t);break}wc(e,zl,ql);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-it(r);i=1<<o,(o=t[o])>s&&(s=o),r&=~i}if(r=s,10<(r=(120>(r=Qe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*kl(r/1960))-r)){e.timeoutHandle=rs(wc.bind(null,e,zl,ql),r);break}wc(e,zl,ql);break;default:throw Error(a(329))}}}return rc(e,Qe()),e.callbackNode===n?sc.bind(null,e):null}function ac(e,t){var n=Bl;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=zl,zl=n,null!==t&&ic(t)),e}function ic(e){null===zl?zl=e:zl.push.apply(zl,e)}function oc(e,t){for(t&=~Fl,t&=~Rl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-it(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Cl))throw Error(a(327));_c();var t=ht(e,0);if(0===(1&t))return rc(e,Qe()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var r=gt(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=Ll,hc(e,0),oc(e,t),rc(e,Qe()),n;if(6===n)throw Error(a(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zl,ql),rc(e,Qe()),null}function cc(e,t){var n=Cl;Cl|=1;try{return e(t)}finally{0===(Cl=n)&&(Wl=Qe()+500,Bs&&Ws())}}function dc(e){null!==Yl&&0===Yl.tag&&0===(6&Cl)&&_c();var t=Cl;Cl|=1;var n=El.transition,r=xt;try{if(El.transition=null,xt=1,e)return e()}finally{xt=r,El.transition=n,0===(6&(Cl=t))&&Ws()}}function uc(){Pl=Ol.current,js(Ol)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ss(n)),null!==Al)for(n=Al.return;null!==n;){var r=n;switch(ta(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Os();break;case 3:$a(),js(Ts),js(Cs),ni();break;case 5:Xa(r);break;case 4:$a();break;case 13:case 19:js(Za);break;case 10:Ea(r.type._context);break;case 22:case 23:uc()}n=n.return}if(Tl=e,Al=e=Oc(e.current,null),Dl=Pl=t,Il=0,Ll=null,Fl=Rl=Ml=0,zl=Bl=null,null!==Da){for(t=0;t<Da.length;t++)if(null!==(r=(n=Da[t]).interleaved)){n.interleaved=null;var s=r.next,a=n.pending;if(null!==a){var i=a.next;a.next=s,r.next=i}n.pending=r}Da=null}return e}function fc(e,t){for(;;){var n=Al;try{if(Na(),ri.current=Qi,ci){for(var r=ii.memoizedState;null!==r;){var s=r.queue;null!==s&&(s.pending=null),r=r.next}ci=!1}if(ai=0,li=oi=ii=null,di=!1,ui=0,Nl.current=null,null===n||null===n.return){Il=1,Ll=t,Al=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=Dl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var g=mo(o);if(null!==g){g.flags&=-257,yo(g,o,l,0,t),1&g.mode&&po(i,d,t),c=d;var p=(t=g).updateQueue;if(null===p){var m=new Set;m.add(c),t.updateQueue=m}else p.add(c);break e}if(0===(1&t)){po(i,d,t),pc();break e}c=Error(a(426))}else if(sa&&1&l.mode){var y=mo(o);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),yo(y,o,l,0,t),ga(lo(c,l));break e}}i=c=lo(c,l),4!==Il&&(Il=2),null===Bl?Bl=[i]:Bl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Ua(i,fo(0,c,t));break e;case 1:l=c;var b=i.type,x=i.stateNode;if(0===(128&i.flags)&&("function"===typeof b.getDerivedStateFromError||null!==x&&"function"===typeof x.componentDidCatch&&(null===Jl||!Jl.has(x)))){i.flags|=65536,t&=-t,i.lanes|=t,Ua(i,go(i,l,t));break e}}i=i.return}while(null!==i)}vc(n)}catch(v){t=v,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function gc(){var e=jl.current;return jl.current=Qi,null===e?Qi:e}function pc(){0!==Il&&3!==Il&&2!==Il||(Il=4),null===Tl||0===(268435455&Ml)&&0===(268435455&Rl)||oc(Tl,Dl)}function mc(e,t){var n=Cl;Cl|=2;var r=gc();for(Tl===e&&Dl===t||(ql=null,hc(e,t));;)try{yc();break}catch(s){fc(e,s)}if(Na(),Cl=n,jl.current=r,null!==Al)throw Error(a(261));return Tl=null,Dl=0,Il}function yc(){for(;null!==Al;)xc(Al)}function bc(){for(;null!==Al&&!Ge();)xc(Al)}function xc(e){var t=Sl(e.alternate,e,Pl);e.memoizedProps=e.pendingProps,null===t?vc(e):Al=t,Nl.current=null}function vc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ko(n,t,Pl)))return void(Al=n)}else{if(null!==(n=Yo(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Il=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Il&&(Il=5)}function wc(e,t,n){var r=xt,s=El.transition;try{El.transition=null,xt=1,function(e,t,n,r){do{_c()}while(null!==Yl);if(0!==(6&Cl))throw Error(a(327));n=e.finishedWork;var s=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-it(n),a=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~a}}(e,i),e===Tl&&(Al=Tl=null,Dl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Tc(tt,(function(){return _c(),null}))),i=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||i){i=El.transition,El.transition=null;var o=xt;xt=1;var l=Cl;Cl|=4,Nl.current=null,function(e,t){if(es=Ht,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch(w){n=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,f=null;t:for(;;){for(var g;h!==n||0!==s&&3!==h.nodeType||(l=o+s),h!==i||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(g=h.firstChild);)f=h,h=g;for(;;){if(h===e)break t;if(f===n&&++d===s&&(l=o),f===i&&++u===r&&(c=o),null!==(g=h.nextSibling))break;f=(h=f).parentNode}h=g}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ts={focusedElem:e,selectionRange:n},Ht=!1,Xo=t;null!==Xo;)if(e=(t=Xo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Xo=e;else for(;null!==Xo;){t=Xo;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var m=p.memoizedProps,y=p.memoizedState,b=t.stateNode,x=b.getSnapshotBeforeUpdate(t.elementType===t.type?m:to(t.type,m),y);b.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(a(163))}}catch(w){kc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Xo=e;break}Xo=t.return}p=tl,tl=!1}(e,n),ml(n,e),gr(ts),Ht=!!es,ts=es=null,e.current=n,bl(n,e,s),$e(),Cl=l,xt=o,El.transition=i}else e.current=n;if(Kl&&(Kl=!1,Yl=e,Gl=s),i=e.pendingLanes,0===i&&(Jl=null),function(e){if(at&&"function"===typeof at.onCommitFiberRoot)try{at.onCommitFiberRoot(st,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Qe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Hl)throw Hl=!1,e=Vl,Vl=null,e;0!==(1&Gl)&&0!==e.tag&&_c(),i=e.pendingLanes,0!==(1&i)?e===Ql?$l++:($l=0,Ql=e):$l=0,Ws()}(e,t,n,r)}finally{El.transition=s,xt=r}return null}function _c(){if(null!==Yl){var e=vt(Gl),t=El.transition,n=xt;try{if(El.transition=null,xt=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Gl=0,0!==(6&Cl))throw Error(a(331));var s=Cl;for(Cl|=4,Xo=e.current;null!==Xo;){var i=Xo,o=i.child;if(0!==(16&Xo.flags)){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Xo=d;null!==Xo;){var u=Xo;switch(u.tag){case 0:case 11:case 15:nl(8,u,i)}var h=u.child;if(null!==h)h.return=u,Xo=h;else for(;null!==Xo;){var f=(u=Xo).sibling,g=u.return;if(al(u),u===d){Xo=null;break}if(null!==f){f.return=g,Xo=f;break}Xo=g}}}var p=i.alternate;if(null!==p){var m=p.child;if(null!==m){p.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Xo=i}}if(0!==(2064&i.subtreeFlags)&&null!==o)o.return=i,Xo=o;else e:for(;null!==Xo;){if(0!==(2048&(i=Xo).flags))switch(i.tag){case 0:case 11:case 15:nl(9,i,i.return)}var b=i.sibling;if(null!==b){b.return=i.return,Xo=b;break e}Xo=i.return}}var x=e.current;for(Xo=x;null!==Xo;){var v=(o=Xo).child;if(0!==(2064&o.subtreeFlags)&&null!==v)v.return=o,Xo=v;else e:for(o=x;null!==Xo;){if(0!==(2048&(l=Xo).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(_){kc(l,l.return,_)}if(l===o){Xo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Xo=w;break e}Xo=l.return}}if(Cl=s,Ws(),at&&"function"===typeof at.onPostCommitFiberRoot)try{at.onPostCommitFiberRoot(st,e)}catch(_){}r=!0}return r}finally{xt=n,El.transition=t}}return!1}function Sc(e,t,n){e=Ba(e,t=fo(0,t=lo(n,t),1),1),t=ec(),null!==e&&(yt(e,1,t),rc(e,t))}function kc(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Jl||!Jl.has(r))){t=Ba(t,e=go(t,e=lo(n,e),1),1),e=ec(),null!==t&&(yt(t,1,e),rc(t,e));break}}t=t.return}}function jc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Tl===e&&(Dl&n)===n&&(4===Il||3===Il&&(130023424&Dl)===Dl&&500>Qe()-Ul?hc(e,0):Fl|=n),rc(e,t)}function Nc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var n=ec();null!==(e=Ia(e,t))&&(yt(e,t,n),rc(e,n))}function Ec(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Nc(e,n)}function Cc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;null!==s&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(a(314))}null!==r&&r.delete(t),Nc(e,n)}function Tc(e,t){return Ke(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Dc(e,t,n,r){return new Ac(e,t,n,r)}function Pc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var n=e.alternate;return null===n?((n=Dc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Ic(e,t,n,r,s,i){var o=2;if(r=e,"function"===typeof e)Pc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case S:return Lc(n.children,s,i,t);case k:o=8,s|=8;break;case j:return(e=Dc(12,n,t,2|s)).elementType=j,e.lanes=i,e;case T:return(e=Dc(13,n,t,s)).elementType=T,e.lanes=i,e;case A:return(e=Dc(19,n,t,s)).elementType=A,e.lanes=i,e;case O:return Mc(n,s,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case N:o=10;break e;case E:o=9;break e;case C:o=11;break e;case D:o=14;break e;case P:o=16,r=null;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Dc(o,n,t,s)).elementType=e,t.type=r,t.lanes=i,t}function Lc(e,t,n,r){return(e=Dc(7,e,r,t)).lanes=n,e}function Mc(e,t,n,r){return(e=Dc(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Rc(e,t,n){return(e=Dc(6,e,null,t)).lanes=n,e}function Fc(e,t,n){return(t=Dc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,s,a,i,o,l){return e=new Bc(e,t,n,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=Dc(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ma(a),e}function Uc(e){if(!e)return Es;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(a(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ps(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(a(171))}if(1===e.tag){var n=e.type;if(Ps(n))return Ls(e,n,t)}return t}function Wc(e,t,n,r,s,a,i,o,l){return(e=zc(n,r,!0,e,0,a,0,o,l)).context=Uc(null),n=e.current,(a=Fa(r=ec(),s=tc(n))).callback=void 0!==t&&null!==t?t:null,Ba(n,a,s),e.current.lanes=s,yt(e,s,r),rc(e,r),e}function qc(e,t,n,r){var s=t.current,a=ec(),i=tc(s);return n=Uc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Fa(a,i)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Ba(s,t,i))&&(nc(e,s,i,a),za(e,s,i)),i}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Jc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ts.current)xo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xo=!1,function(e,t,n){switch(t.tag){case 3:To(t),fa();break;case 5:Qa(t);break;case 1:Ps(t.type)&&Ms(t);break;case 4:Ga(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Ns(_a,r._currentValue),r._currentValue=s;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ns(Za,1&Za.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ro(e,t,n):(Ns(Za,1&Za.current),null!==(e=Ho(e,t,n))?e.sibling:null);Ns(Za,1&Za.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Wo(e,t,n);t.flags|=128}if(null!==(s=t.memoizedState)&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ns(Za,Za.current),r)break;return null;case 22:case 23:return t.lanes=0,ko(e,t,n)}return Ho(e,t,n)}(e,t,n);xo=0!==(131072&e.flags)}else xo=!1,sa&&0!==(1048576&t.flags)&&Zs(t,Js,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;qo(e,t),e=t.pendingProps;var s=Ds(t,Cs.current);Ta(t,n),s=pi(null,t,r,e,s,n);var i=mi();return t.flags|=1,"object"===typeof s&&null!==s&&"function"===typeof s.render&&void 0===s.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ps(r)?(i=!0,Ms(t)):i=!1,t.memoizedState=null!==s.state&&void 0!==s.state?s.state:null,Ma(t),s.updater=ro,t.stateNode=s,s._reactInternals=t,oo(t,r,e,n),t=Co(null,t,r,!0,i,n)):(t.tag=0,sa&&i&&ea(t),vo(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(qo(e,t),e=t.pendingProps,r=(s=r._init)(r._payload),t.type=r,s=t.tag=function(e){if("function"===typeof e)return Pc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===C)return 11;if(e===D)return 14}return 2}(r),e=to(r,e),s){case 0:t=No(null,t,r,e,n);break e;case 1:t=Eo(null,t,r,e,n);break e;case 11:t=wo(null,t,r,e,n);break e;case 14:t=_o(null,t,r,to(r.type,e),n);break e}throw Error(a(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,No(e,t,r,s=t.elementType===r?s:to(r,s),n);case 1:return r=t.type,s=t.pendingProps,Eo(e,t,r,s=t.elementType===r?s:to(r,s),n);case 3:e:{if(To(t),null===e)throw Error(a(387));r=t.pendingProps,s=(i=t.memoizedState).element,Ra(e,t),Wa(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated){if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Ao(e,t,r,n,s=lo(Error(a(423)),t));break e}if(r!==s){t=Ao(e,t,r,n,s=lo(Error(a(424)),t));break e}for(ra=cs(t.stateNode.containerInfo.firstChild),na=t,sa=!0,aa=null,n=wa(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fa(),r===s){t=Ho(e,t,n);break e}vo(e,t,r,n)}t=t.child}return t;case 5:return Qa(t),null===e&&ca(t),r=t.type,s=t.pendingProps,i=null!==e?e.memoizedProps:null,o=s.children,ns(r,s)?o=null:null!==i&&ns(r,i)&&(t.flags|=32),jo(e,t),vo(e,t,o,n),t.child;case 6:return null===e&&ca(t),null;case 13:return Ro(e,t,n);case 4:return Ga(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=va(t,null,r,n):vo(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,wo(e,t,r,s=t.elementType===r?s:to(r,s),n);case 7:return vo(e,t,t.pendingProps,n),t.child;case 8:case 12:return vo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Ns(_a,r._currentValue),r._currentValue=o,null!==i)if(or(i.value,o)){if(i.children===s.children&&!Ts.current){t=Ho(e,t,n);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){o=i.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===i.tag){(c=Fa(-1,n&-n)).tag=2;var d=i.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=n,null!==(c=i.alternate)&&(c.lanes|=n),Ca(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===i.tag)o=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(o=i.return))throw Error(a(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ca(o,n,t),o=i.sibling}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===t){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}vo(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Ta(t,n),r=r(s=Aa(s)),t.flags|=1,vo(e,t,r,n),t.child;case 14:return s=to(r=t.type,t.pendingProps),_o(e,t,r,s=to(r.type,s),n);case 15:return So(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:to(r,s),qo(e,t),t.tag=1,Ps(r)?(e=!0,Ms(t)):e=!1,Ta(t,n),ao(t,r,s),oo(t,r,s,n),Co(null,t,r,!0,e,n);case 19:return Wo(e,t,n);case 22:return ko(e,t,n)}throw Error(a(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Gc(e){this._internalRoot=e}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,n,r,s){var a=n._reactRootContainer;if(a){var i=a;if("function"===typeof s){var o=s;s=function(){var e=Hc(i);o.call(e)}}qc(t,i,e,s)}else i=function(e,t,n,r,s){if(s){if("function"===typeof r){var a=r;r=function(){var e=Hc(i);a.call(e)}}var i=Wc(t,r,e,0,null,!1,0,"",Xc);return e._reactRootContainer=i,e[gs]=i.current,Wr(8===e.nodeType?e.parentNode:e),dc(),i}for(;s=e.lastChild;)e.removeChild(s);if("function"===typeof r){var o=r;r=function(){var e=Hc(l);o.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=l,e[gs]=l.current,Wr(8===e.nodeType?e.parentNode:e),dc((function(){qc(t,l,n,r)})),l}(n,t,e,s,r);return Hc(i)}Gc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));qc(e,t,null,null)},Gc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc((function(){qc(null,e,null,null)})),t[gs]=null}},Gc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Rt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ut(t.pendingLanes);0!==n&&(bt(t,1|n),rc(t,Qe()),0===(6&Cl)&&(Wl=Qe()+500,Ws()))}break;case 13:dc((function(){var t=Ia(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Jc(e,1)}},_t=function(e){if(13===e.tag){var t=Ia(e,134217728);if(null!==t)nc(t,e,134217728,ec());Jc(e,134217728)}},St=function(e){if(13===e.tag){var t=tc(e),n=Ia(e,t);if(null!==n)nc(n,e,t,ec());Jc(e,t)}},kt=function(){return xt},jt=function(e,t){var n=xt;try{return xt=e,t()}finally{xt=n}},_e=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=ws(r);if(!s)throw Error(a(90));K(r),X(r,s)}}}break;case"textarea":ae(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ce=cc,Te=dc;var ed={usingClientEntryPoint:!1,Events:[xs,vs,ws,Ne,Ee,cc]},td={findFiberByHostInstance:bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:v.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var rd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!rd.isDisabled&&rd.supportsFiber)try{st=rd.inject(nd),at=rd}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!$c(t))throw Error(a(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!$c(e))throw Error(a(299));var n=!1,r="",s=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(s=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,s),e[gs]=t.current,Wr(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Qc(t))throw Error(a(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!$c(e))throw Error(a(405));var r=null!=n&&n.hydratedSources||null,s=!1,i="",o=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(s=!0),void 0!==n.identifierPrefix&&(i=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Wc(t,null,e,1,null!=n?n:null,s,0,i,o),e[gs]=t.current,Wr(e),r)for(e=0;e<r.length;e++)s=(s=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Gc(t)},t.render=function(e,t,n){if(!Qc(t))throw Error(a(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Qc(e))throw Error(a(40));return!!e._reactRootContainer&&(dc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[gs]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Qc(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},736:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(374));class a extends s.default{eq(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this}neq(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this}gt(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this}gte(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this}lt(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this}lte(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this}like(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this}likeAllOf(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this}likeAnyOf(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this}ilike(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this}is(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this}in(e,t){const n=Array.from(new Set(t)).map((e=>"string"===typeof e&&new RegExp("[,()]").test(e)?'"'.concat(e,'"'):"".concat(e))).join(",");return this.url.searchParams.append(e,"in.(".concat(n,")")),this}contains(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this}containedBy(e,t){return"string"===typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this}rangeGt(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this}rangeGte(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this}rangeLt(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this}rangeLte(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this}overlaps(e,t){return"string"===typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this}textSearch(e,t){let{config:n,type:r}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s="";"plain"===r?s="pl":"phrase"===r?s="ph":"websearch"===r&&(s="w");const a=void 0===n?"":"(".concat(n,")");return this.url.searchParams.append(e,"".concat(s,"fts").concat(a,".").concat(t)),this}match(e){return Object.entries(e).forEach((e=>{let[t,n]=e;this.url.searchParams.append(t,"eq.".concat(n))})),this}not(e,t,n){return this.url.searchParams.append(e,"not.".concat(t,".").concat(n)),this}or(e){let{foreignTable:t,referencedTable:n=t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=n?"".concat(n,".or"):"or";return this.url.searchParams.append(r,"(".concat(e,")")),this}filter(e,t,n){return this.url.searchParams.append(e,"".concat(t,".").concat(n)),this}}t.default=a},745:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_HEADERS=void 0;const r=n(400);t.DEFAULT_HEADERS={"X-Client-Info":"postgrest-js/".concat(r.version)}},829:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=r(n(736));t.default=class{constructor(e,t){let{headers:n={},schema:r,fetch:s}=t;this.url=e,this.headers=n,this.schema=r,this.fetch=s}select(e){let{head:t=!1,count:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=t?"HEAD":"GET";let a=!1;const i=(null!==e&&void 0!==e?e:"*").split("").map((e=>/\s/.test(e)&&!a?"":('"'===e&&(a=!a),e))).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer="count=".concat(n)),new s.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e){let{count:t,defaultToNull:n=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push("count=".concat(t)),n||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>'"'.concat(e,'"')));this.url.searchParams.set("columns",e.join(","))}}return new s.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e){let{onConflict:t,ignoreDuplicates:n=!1,count:r,defaultToNull:a=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=["resolution=".concat(n?"ignore":"merge","-duplicates")];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push("count=".concat(r)),a||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>'"'.concat(e,'"')));this.url.searchParams.set("columns",e.join(","))}}return new s.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e){let{count:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=[];return this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push("count=".concat(t)),this.headers.Prefer=n.join(","),new s.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete(){let{count:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=[];return e&&t.push("count=".concat(e)),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new s.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},980:function(e,t,n){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PostgrestError=t.PostgrestBuilder=t.PostgrestTransformBuilder=t.PostgrestFilterBuilder=t.PostgrestQueryBuilder=t.PostgrestClient=void 0;const s=r(n(210));t.PostgrestClient=s.default;const a=r(n(829));t.PostgrestQueryBuilder=a.default;const i=r(n(736));t.PostgrestFilterBuilder=i.default;const o=r(n(374));t.PostgrestTransformBuilder=o.default;const l=r(n(286));t.PostgrestBuilder=l.default;const c=r(n(611));t.PostgrestError=c.default,t.default={PostgrestClient:s.default,PostgrestQueryBuilder:a.default,PostgrestFilterBuilder:i.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default}}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.m=e,(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,s){if(1&s&&(r=this(r)),8&s)return r;if("object"===typeof r&&r){if(4&s&&r.__esModule)return r;if(16&s&&"function"===typeof r.then)return r}var a=Object.create(null);n.r(a);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&s&&r;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((e=>i[e]=()=>r[e]));return i.default=()=>r,n.d(a,i),a}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".f985087a.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="expense-tracker:";n.l=(r,s,a,i)=>{if(e[r])e[r].push(s);else{var o,l;if(void 0!==a)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==r||u.getAttribute("data-webpack")==t+a){o=u;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+a),o.src=r),e[r]=[s];var h=(t,n)=>{o.onerror=o.onload=null,clearTimeout(f);var s=e[r];if(delete e[r],o.parentNode&&o.parentNode.removeChild(o),s&&s.forEach((e=>e(n))),t)return t(n)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var s=n.o(e,t)?e[t]:void 0;if(0!==s)if(s)r.push(s[2]);else{var a=new Promise(((n,r)=>s=e[t]=[n,r]));r.push(s[2]=a);var i=n.p+n.u(t),o=new Error;n.l(i,(r=>{if(n.o(e,t)&&(0!==(s=e[t])&&(e[t]=void 0),s)){var a=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;o.message="Loading chunk "+t+" failed.\n("+a+": "+i+")",o.name="ChunkLoadError",o.type=a,o.request=i,s[1](o)}}),"chunk-"+t,t)}};var t=(t,r)=>{var s,a,i=r[0],o=r[1],l=r[2],c=0;if(i.some((t=>0!==e[t]))){for(s in o)n.o(o,s)&&(n.m[s]=o[s]);if(l)l(n)}for(t&&t(r);c<i.length;c++)a=i[c],n.o(e,a)&&e[a]&&e[a][0](),e[a]=0},r=self.webpackChunkexpense_tracker=self.webpackChunkexpense_tracker||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r,s=n(43),a=n.t(s,2),i=n(391),o=n(950),l=n.t(o,2);function c(){return c=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},c.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(r||(r={}));const d="popstate";function u(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function h(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(n){}}}function f(e,t){return{usr:e.state,key:e.key,idx:t}}function g(e,t,n,r){return void 0===n&&(n=null),c({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?m(t):t,{state:n,key:t&&t.key||r||Math.random().toString(36).substr(2,8)})}function p(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(t+="#"===r.charAt(0)?r:"#"+r),t}function m(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function y(e,t,n,s){void 0===s&&(s={});let{window:a=document.defaultView,v5Compat:i=!1}=s,o=a.history,l=r.Pop,h=null,m=y();function y(){return(o.state||{idx:null}).idx}function b(){l=r.Pop;let e=y(),t=null==e?null:e-m;m=e,h&&h({action:l,location:v.location,delta:t})}function x(e){let t="null"!==a.location.origin?a.location.origin:a.location.href,n="string"===typeof e?e:p(e);return n=n.replace(/ $/,"%20"),u(t,"No window.location.(origin|href) available to create URL for href: "+n),new URL(n,t)}null==m&&(m=0,o.replaceState(c({},o.state,{idx:m}),""));let v={get action(){return l},get location(){return e(a,o)},listen(e){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener(d,b),h=e,()=>{a.removeEventListener(d,b),h=null}},createHref:e=>t(a,e),createURL:x,encodeLocation(e){let t=x(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){l=r.Push;let s=g(v.location,e,t);n&&n(s,e),m=y()+1;let c=f(s,m),d=v.createHref(s);try{o.pushState(c,"",d)}catch(u){if(u instanceof DOMException&&"DataCloneError"===u.name)throw u;a.location.assign(d)}i&&h&&h({action:l,location:v.location,delta:1})},replace:function(e,t){l=r.Replace;let s=g(v.location,e,t);n&&n(s,e),m=y();let a=f(s,m),c=v.createHref(s);o.replaceState(a,"",c),i&&h&&h({action:l,location:v.location,delta:0})},go:e=>o.go(e)};return v}var b;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(b||(b={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function x(e,t,n){return void 0===n&&(n="/"),v(e,t,n,!1)}function v(e,t,n,r){let s=I(("string"===typeof t?m(t):t).pathname||"/",n);if(null==s)return null;let a=w(e);!function(e){e.sort(((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every(((e,n)=>e===t[n]));return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map((e=>e.childrenIndex)),t.routesMeta.map((e=>e.childrenIndex)))))}(a);let i=null;for(let o=0;null==i&&o<a.length;++o){let e=O(s);i=D(a[o],e,r)}return i}function w(e,t,n,r){void 0===t&&(t=[]),void 0===n&&(n=[]),void 0===r&&(r="");let s=(e,s,a)=>{let i={relativePath:void 0===a?e.path||"":a,caseSensitive:!0===e.caseSensitive,childrenIndex:s,route:e};i.relativePath.startsWith("/")&&(u(i.relativePath.startsWith(r),'Absolute route path "'+i.relativePath+'" nested under path "'+r+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),i.relativePath=i.relativePath.slice(r.length));let o=B([r,i.relativePath]),l=n.concat(i);e.children&&e.children.length>0&&(u(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+o+'".'),w(e.children,t,l,o)),(null!=e.path||e.index)&&t.push({path:o,score:A(o,e.index),routesMeta:l})};return e.forEach(((e,t)=>{var n;if(""!==e.path&&null!=(n=e.path)&&n.includes("?"))for(let r of _(e.path))s(e,t,r);else s(e,t)})),t}function _(e){let t=e.split("/");if(0===t.length)return[];let[n,...r]=t,s=n.endsWith("?"),a=n.replace(/\?$/,"");if(0===r.length)return s?[a,""]:[a];let i=_(r.join("/")),o=[];return o.push(...i.map((e=>""===e?a:[a,e].join("/")))),s&&o.push(...i),o.map((t=>e.startsWith("/")&&""===t?"/":t))}const S=/^:[\w-]+$/,k=3,j=2,N=1,E=10,C=-2,T=e=>"*"===e;function A(e,t){let n=e.split("/"),r=n.length;return n.some(T)&&(r+=C),t&&(r+=j),n.filter((e=>!T(e))).reduce(((e,t)=>e+(S.test(t)?k:""===t?N:E)),r)}function D(e,t,n){void 0===n&&(n=!1);let{routesMeta:r}=e,s={},a="/",i=[];for(let o=0;o<r.length;++o){let e=r[o],l=o===r.length-1,c="/"===a?t:t.slice(a.length)||"/",d=P({path:e.relativePath,caseSensitive:e.caseSensitive,end:l},c),u=e.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=P({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(s,d.params),i.push({params:s,pathname:B([a,d.pathname]),pathnameBase:z(B([a,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(a=B([a,d.pathnameBase]))}return i}function P(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=function(e,t,n){void 0===t&&(t=!1);void 0===n&&(n=!0);h("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,((e,t,n)=>(r.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")));e.endsWith("*")?(r.push({paramName:"*"}),s+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":""!==e&&"/"!==e&&(s+="(?:(?=\\/|$))");let a=new RegExp(s,t?void 0:"i");return[a,r]}(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1),l=r.reduce(((e,t,n)=>{let{paramName:r,isOptional:s}=t;if("*"===r){let e=o[n]||"";i=a.slice(0,a.length-e.length).replace(/(.)\/+$/,"$1")}const l=o[n];return e[r]=s&&!l?void 0:(l||"").replace(/%2F/g,"/"),e}),{});return{params:l,pathname:a,pathnameBase:i,pattern:e}}function O(e){try{return e.split("/").map((e=>decodeURIComponent(e).replace(/\//g,"%2F"))).join("/")}catch(t){return h(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function I(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&"/"!==r?null:e.slice(n)||"/"}function L(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the `to."+n+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function M(e){return e.filter(((e,t)=>0===t||e.route.path&&e.route.path.length>0))}function R(e,t){let n=M(e);return t?n.map(((e,t)=>t===n.length-1?e.pathname:e.pathnameBase)):n.map((e=>e.pathnameBase))}function F(e,t,n,r){let s;void 0===r&&(r=!1),"string"===typeof e?s=m(e):(s=c({},e),u(!s.pathname||!s.pathname.includes("?"),L("?","pathname","search",s)),u(!s.pathname||!s.pathname.includes("#"),L("#","pathname","hash",s)),u(!s.search||!s.search.includes("#"),L("#","search","hash",s)));let a,i=""===e||""===s.pathname,o=i?"/":s.pathname;if(null==o)a=n;else{let e=t.length-1;if(!r&&o.startsWith("..")){let t=o.split("/");for(;".."===t[0];)t.shift(),e-=1;s.pathname=t.join("/")}a=e>=0?t[e]:"/"}let l=function(e,t){void 0===t&&(t="/");let{pathname:n,search:r="",hash:s=""}="string"===typeof e?m(e):e,a=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach((e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)})),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:a,search:U(r),hash:W(s)}}(s,a),d=o&&"/"!==o&&o.endsWith("/"),h=(i||"."===o)&&n.endsWith("/");return l.pathname.endsWith("/")||!d&&!h||(l.pathname+="/"),l}const B=e=>e.join("/").replace(/\/\/+/g,"/"),z=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),U=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",W=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function q(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const H=["post","put","patch","delete"],V=(new Set(H),["get",...H]);new Set(V),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function J(){return J=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},J.apply(this,arguments)}const K=s.createContext(null);const Y=s.createContext(null);const G=s.createContext(null);const $=s.createContext(null);const Q=s.createContext({outlet:null,matches:[],isDataRoute:!1});const X=s.createContext(null);function Z(){return null!=s.useContext($)}function ee(){return Z()||u(!1),s.useContext($).location}function te(e){s.useContext(G).static||s.useLayoutEffect(e)}function ne(){let{isDataRoute:e}=s.useContext(Q);return e?function(){let{router:e}=he(de.UseNavigateStable),t=ge(ue.UseNavigateStable),n=s.useRef(!1);te((()=>{n.current=!0}));let r=s.useCallback((function(r,s){void 0===s&&(s={}),n.current&&("number"===typeof r?e.navigate(r):e.navigate(r,J({fromRouteId:t},s)))}),[e,t]);return r}():function(){Z()||u(!1);let e=s.useContext(K),{basename:t,future:n,navigator:r}=s.useContext(G),{matches:a}=s.useContext(Q),{pathname:i}=ee(),o=JSON.stringify(R(a,n.v7_relativeSplatPath)),l=s.useRef(!1);te((()=>{l.current=!0}));let c=s.useCallback((function(n,s){if(void 0===s&&(s={}),!l.current)return;if("number"===typeof n)return void r.go(n);let a=F(n,JSON.parse(o),i,"path"===s.relative);null==e&&"/"!==t&&(a.pathname="/"===a.pathname?t:B([t,a.pathname])),(s.replace?r.replace:r.push)(a,s.state,s)}),[t,r,o,i,e]);return c}()}function re(e,t){let{relative:n}=void 0===t?{}:t,{future:r}=s.useContext(G),{matches:a}=s.useContext(Q),{pathname:i}=ee(),o=JSON.stringify(R(a,r.v7_relativeSplatPath));return s.useMemo((()=>F(e,JSON.parse(o),i,"path"===n)),[e,o,i,n])}function se(e,t,n,a){Z()||u(!1);let{navigator:i,static:o}=s.useContext(G),{matches:l}=s.useContext(Q),c=l[l.length-1],d=c?c.params:{},h=(c&&c.pathname,c?c.pathnameBase:"/");c&&c.route;let f,g=ee();if(t){var p;let e="string"===typeof t?m(t):t;"/"===h||(null==(p=e.pathname)?void 0:p.startsWith(h))||u(!1),f=e}else f=g;let y=f.pathname||"/",b=y;if("/"!==h){let e=h.replace(/^\//,"").split("/");b="/"+y.replace(/^\//,"").split("/").slice(e.length).join("/")}let v=!o&&n&&n.matches&&n.matches.length>0?n.matches:x(e,{pathname:b});let w=ce(v&&v.map((e=>Object.assign({},e,{params:Object.assign({},d,e.params),pathname:B([h,i.encodeLocation?i.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?h:B([h,i.encodeLocation?i.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])}))),l,n,a);return t&&w?s.createElement($.Provider,{value:{location:J({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:r.Pop}},w):w}function ae(){let e=function(){var e;let t=s.useContext(X),n=fe(ue.UseRouteError),r=ge(ue.UseRouteError);if(void 0!==t)return t;return null==(e=n.errors)?void 0:e[r]}(),t=q(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r};return s.createElement(s.Fragment,null,s.createElement("h2",null,"Unexpected Application Error!"),s.createElement("h3",{style:{fontStyle:"italic"}},t),n?s.createElement("pre",{style:a},n):null,null)}const ie=s.createElement(ae,null);class oe extends s.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?s.createElement(Q.Provider,{value:this.props.routeContext},s.createElement(X.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function le(e){let{routeContext:t,match:n,children:r}=e,a=s.useContext(K);return a&&a.static&&a.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=n.route.id),s.createElement(Q.Provider,{value:t},r)}function ce(e,t,n,r){var a;if(void 0===t&&(t=[]),void 0===n&&(n=null),void 0===r&&(r=null),null==e){var i;if(!n)return null;if(n.errors)e=n.matches;else{if(!(null!=(i=r)&&i.v7_partialHydration&&0===t.length&&!n.initialized&&n.matches.length>0))return null;e=n.matches}}let o=e,l=null==(a=n)?void 0:a.errors;if(null!=l){let e=o.findIndex((e=>e.route.id&&void 0!==(null==l?void 0:l[e.route.id])));e>=0||u(!1),o=o.slice(0,Math.min(o.length,e+1))}let c=!1,d=-1;if(n&&r&&r.v7_partialHydration)for(let s=0;s<o.length;s++){let e=o[s];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=s),e.route.id){let{loaderData:t,errors:r}=n,s=e.route.loader&&void 0===t[e.route.id]&&(!r||void 0===r[e.route.id]);if(e.route.lazy||s){c=!0,o=d>=0?o.slice(0,d+1):[o[0]];break}}}return o.reduceRight(((e,r,a)=>{let i,u=!1,h=null,f=null;var g;n&&(i=l&&r.route.id?l[r.route.id]:void 0,h=r.route.errorElement||ie,c&&(d<0&&0===a?(g="route-fallback",!1||pe[g]||(pe[g]=!0),u=!0,f=null):d===a&&(u=!0,f=r.route.hydrateFallbackElement||null)));let p=t.concat(o.slice(0,a+1)),m=()=>{let t;return t=i?h:u?f:r.route.Component?s.createElement(r.route.Component,null):r.route.element?r.route.element:e,s.createElement(le,{match:r,routeContext:{outlet:e,matches:p,isDataRoute:null!=n},children:t})};return n&&(r.route.ErrorBoundary||r.route.errorElement||0===a)?s.createElement(oe,{location:n.location,revalidation:n.revalidation,component:h,error:i,children:m(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):m()}),null)}var de=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(de||{}),ue=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(ue||{});function he(e){let t=s.useContext(K);return t||u(!1),t}function fe(e){let t=s.useContext(Y);return t||u(!1),t}function ge(e){let t=function(){let e=s.useContext(Q);return e||u(!1),e}(),n=t.matches[t.matches.length-1];return n.route.id||u(!1),n.route.id}const pe={};function me(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}a.startTransition;function ye(e){let{to:t,replace:n,state:r,relative:a}=e;Z()||u(!1);let{future:i,static:o}=s.useContext(G),{matches:l}=s.useContext(Q),{pathname:c}=ee(),d=ne(),h=F(t,R(l,i.v7_relativeSplatPath),c,"path"===a),f=JSON.stringify(h);return s.useEffect((()=>d(JSON.parse(f),{replace:n,state:r,relative:a})),[d,f,a,n,r]),null}function be(e){u(!1)}function xe(e){let{basename:t="/",children:n=null,location:a,navigationType:i=r.Pop,navigator:o,static:l=!1,future:c}=e;Z()&&u(!1);let d=t.replace(/^\/*/,"/"),h=s.useMemo((()=>({basename:d,navigator:o,static:l,future:J({v7_relativeSplatPath:!1},c)})),[d,c,o,l]);"string"===typeof a&&(a=m(a));let{pathname:f="/",search:g="",hash:p="",state:y=null,key:b="default"}=a,x=s.useMemo((()=>{let e=I(f,d);return null==e?null:{location:{pathname:e,search:g,hash:p,state:y,key:b},navigationType:i}}),[d,f,g,p,y,b,i]);return null==x?null:s.createElement(G.Provider,{value:h},s.createElement($.Provider,{children:n,value:x}))}function ve(e){let{children:t,location:n}=e;return se(we(t),n)}new Promise((()=>{}));s.Component;function we(e,t){void 0===t&&(t=[]);let n=[];return s.Children.forEach(e,((e,r)=>{if(!s.isValidElement(e))return;let a=[...t,r];if(e.type===s.Fragment)return void n.push.apply(n,we(e.props.children,a));e.type!==be&&u(!1),e.props.index&&e.props.children&&u(!1);let i={id:e.props.id||a.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(i.children=we(e.props.children,a)),n.push(i)})),n}function _e(){return _e=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_e.apply(this,arguments)}function Se(e,t){if(null==e)return{};var n,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const ke=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(pu){}new Map;const je=a.startTransition;l.flushSync,a.useId;function Ne(e){let{basename:t,children:n,future:r,window:a}=e,i=s.useRef();var o;null==i.current&&(i.current=(void 0===(o={window:a,v5Compat:!0})&&(o={}),y((function(e,t){let{pathname:n,search:r,hash:s}=e.location;return g("",{pathname:n,search:r,hash:s},t.state&&t.state.usr||null,t.state&&t.state.key||"default")}),(function(e,t){return"string"===typeof t?t:p(t)}),null,o)));let l=i.current,[c,d]=s.useState({action:l.action,location:l.location}),{v7_startTransition:u}=r||{},h=s.useCallback((e=>{u&&je?je((()=>d(e))):d(e)}),[d,u]);return s.useLayoutEffect((()=>l.listen(h)),[l,h]),s.useEffect((()=>me(r)),[r]),s.createElement(xe,{basename:t,children:n,location:c.location,navigationType:c.action,navigator:l,future:r})}const Ee="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Ce=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Te=s.forwardRef((function(e,t){let n,{onClick:r,relative:a,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:h,viewTransition:f}=e,g=Se(e,ke),{basename:m}=s.useContext(G),y=!1;if("string"===typeof d&&Ce.test(d)&&(n=d,Ee))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),n=I(t.pathname,m);t.origin===e.origin&&null!=n?d=n+t.search+t.hash:y=!0}catch(pu){}let b=function(e,t){let{relative:n}=void 0===t?{}:t;Z()||u(!1);let{basename:r,navigator:a}=s.useContext(G),{hash:i,pathname:o,search:l}=re(e,{relative:n}),c=o;return"/"!==r&&(c="/"===o?r:B([r,o])),a.createHref({pathname:c,search:l,hash:i})}(d,{relative:a}),x=function(e,t){let{target:n,replace:r,state:a,preventScrollReset:i,relative:o,viewTransition:l}=void 0===t?{}:t,c=ne(),d=ee(),u=re(e,{relative:o});return s.useCallback((t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,n)){t.preventDefault();let n=void 0!==r?r:p(d)===p(u);c(e,{replace:n,state:a,preventScrollReset:i,relative:o,viewTransition:l})}}),[d,c,u,r,a,n,e,i,o,l])}(d,{replace:o,state:l,target:c,preventScrollReset:h,relative:a,viewTransition:f});return s.createElement("a",_e({},g,{href:n||b,onClick:y||i?r:function(e){r&&r(e),e.defaultPrevented||x(e)},ref:t,target:c}))}));var Ae,De;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Ae||(Ae={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(De||(De={}));var Pe=n(319),Oe=n(379),Ie=n(82),Le=n(61);const Me={expenses:{required:["id","name","amount","category","walletId","date"],types:{id:"string",name:"string",amount:"number",category:"string",walletId:"string",date:"string",isIncome:"boolean",tags:"array"},constraints:{amount:e=>e>0,name:e=>e.length>0&&e.length<=100,date:e=>!isNaN(Date.parse(e))}},categories:{required:["id","name"],types:{id:"string",name:"string",color:"string"},constraints:{name:e=>e.length>0&&e.length<=50}},wallets:{required:["id","name","type","balance"],types:{id:"string",name:"string",type:"string",balance:"number"},constraints:{name:e=>e.length>0&&e.length<=50,type:e=>["cash","bank","credit_card","e_wallet"].includes(e)}},transfers:{required:["id","fromWallet","toWallet","amount","date"],types:{id:"string",fromWallet:"string",toWallet:"string",amount:"number",date:"string"},constraints:{amount:e=>e>0,date:e=>!isNaN(Date.parse(e)),fromWallet:(e,t)=>e!==t.toWallet}},budgets:{required:["id","category","amount","period"],types:{id:"string",category:"string",amount:"number",period:"string"},constraints:{amount:e=>e>0,period:e=>["monthly","weekly","yearly"].includes(e)}},tags:{required:["id","name"],types:{id:"string",name:"string",color:"string"},constraints:{name:e=>e.length>0&&e.length<=30}},recurring:{required:["id","name","amount","category","frequency","nextDate"],types:{id:"string",name:"string",amount:"number",category:"string",frequency:"string",nextDate:"string"},constraints:{amount:e=>e>0,frequency:e=>["daily","weekly","biweekly","monthly","quarterly","annually"].includes(e),nextDate:e=>!isNaN(Date.parse(e))}}};class Re{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.userId=e,this.useCloudDB=t,this.validationErrors=[],this.integrityIssues=[],this.autoFixEnabled=!0,this.failedFixes=new Map,this.maxRetries=3}validateItem(e,t){const n=Me[e];if(!n)throw new Error("No validation rules defined for type: ".concat(e));const r=[];for(const a of n.required)void 0!==t[a]&&null!==t[a]||r.push("Missing required field: ".concat(a));for(const[a,i]of Object.entries(n.types))if(void 0!==t[a]&&null!==t[a]){const e=Array.isArray(t[a])?"array":typeof t[a];e!==i&&r.push("Field ".concat(a," should be ").concat(i,", got ").concat(e))}if(n.constraints)for(const[a,i]of Object.entries(n.constraints))if(void 0!==t[a]&&null!==t[a])try{i(t[a],t)||r.push("Field ".concat(a," failed constraint validation"))}catch(s){r.push("Field ".concat(a," constraint check failed: ").concat(s.message))}return{valid:0===r.length,errors:r,item:t}}async validateDataType(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const n=this.getLocalDB(e),r=t||await n.getAll(),s={type:e,total:r.length,valid:0,invalid:0,errors:[]};for(const a of r){const t=this.validateItem(e,a);t.valid?s.valid++:(s.invalid++,s.errors.push({id:a.id,errors:t.errors}))}return s}async preSyncValidation(){console.log("Starting pre-sync validation...");const e={},t=["expenses","categories","wallets","transfers","budgets","tags","recurring"];for(const a of t)try{e[a]=await this.validateDataType(a)}catch(s){e[a]={type:a,error:s.message,total:0,valid:0,invalid:0,errors:[]}}const n=await this.checkReferentialIntegrity(),r={validation:e,integrity:n,overallValid:Object.values(e).every((e=>0===e.invalid))&&0===n.issues.length,timestamp:(new Date).toISOString()};return console.log("Pre-sync validation completed:",r),r}async checkReferentialIntegrity(){const e=[];try{const[t,n,r,s,a,i,o]=await Promise.all([Ie.dq.getAll(),Ie.T0.getAll(),Ie.qF.getAll(),Ie.gf.getAll(),Ie.mh.getAll(),Ie.d6.getAll(),Ie.Mq.getAll()]),l=t.filter((e=>!e.deleted_at)),c=n.filter((e=>!e.deleted_at)),d=r.filter((e=>!e.deleted_at)),u=s.filter((e=>!e.deleted_at)),h=a.filter((e=>!e.deleted_at)),f=i.filter((e=>!e.deleted_at)),g=o.filter((e=>!e.deleted_at)),p=new Set(c.map((e=>e.id))),m=new Set(d.map((e=>e.id))),y=new Set(f.map((e=>e.id)));for(const x of l)if(p.has(x.category)||e.push({type:"orphaned_expense_category",id:x.id,issue:"Expense references non-existent category: ".concat(x.category),severity:"high",autoFixable:!0}),m.has(x.walletId)||e.push({type:"orphaned_expense_wallet",id:x.id,issue:"Expense references non-existent wallet: ".concat(x.walletId),severity:"high",autoFixable:!0}),x.tags&&Array.isArray(x.tags))for(const t of x.tags)y.has(t)||e.push({type:"orphaned_expense_tag",id:x.id,issue:"Expense references non-existent tag: ".concat(t),severity:"medium",autoFixable:!0});for(const x of u)m.has(x.fromWallet)||e.push({type:"orphaned_transfer_from_wallet",id:x.id,issue:"Transfer references non-existent from wallet: ".concat(x.fromWallet),severity:"high",autoFixable:!1}),m.has(x.toWallet)||e.push({type:"orphaned_transfer_to_wallet",id:x.id,issue:"Transfer references non-existent to wallet: ".concat(x.toWallet),severity:"high",autoFixable:!1});for(const x of h)p.has(x.category)||e.push({type:"orphaned_budget_category",id:x.id,issue:"Budget references non-existent category: ".concat(x.category),severity:"medium",autoFixable:!0});for(const x of g)p.has(x.category)||e.push({type:"orphaned_recurring_category",id:x.id,issue:"Recurring transaction references non-existent category: ".concat(x.category),severity:"medium",autoFixable:!0}),x.walletId&&!m.has(x.walletId)&&e.push({type:"orphaned_recurring_wallet",id:x.id,issue:"Recurring transaction references non-existent wallet: ".concat(x.walletId),severity:"medium",autoFixable:!0});const b=(t,n)=>{const r=new Set;for(const s of t)r.has(s.id)&&e.push({type:"duplicate_id",id:s.id,issue:"Duplicate ID found in ".concat(n,": ").concat(s.id),severity:"critical",autoFixable:!1}),r.add(s.id)};b(l,"expenses"),b(c,"categories"),b(d,"wallets"),b(u,"transfers"),b(h,"budgets"),b(f,"tags"),b(g,"recurring")}catch(t){e.push({type:"integrity_check_error",issue:"Failed to check referential integrity: ".concat(t.message),severity:"critical",autoFixable:!1})}return{issues:e,summary:{total:e.length,critical:e.filter((e=>"critical"===e.severity)).length,high:e.filter((e=>"high"===e.severity)).length,medium:e.filter((e=>"medium"===e.severity)).length,autoFixable:e.filter((e=>e.autoFixable)).length}}}async autoFixIntegrityIssues(e){const t={attempted:0,successful:0,failed:0,skipped:0,errors:[]},n=e.filter((e=>e.autoFixable));for(const s of n){const e="".concat(s.type,"_").concat(s.id),n=this.failedFixes.get(e)||0;if(n>=this.maxRetries)t.skipped++;else{t.attempted++;try{switch(s.type){case"orphaned_expense_category":await this.fixOrphanedExpenseCategory(s.id);break;case"orphaned_expense_wallet":await this.fixOrphanedExpenseWallet(s.id);break;case"orphaned_expense_tag":await this.fixOrphanedExpenseTag(s.id);break;case"orphaned_budget_category":await this.fixOrphanedBudgetCategory(s.id);break;case"orphaned_recurring_category":await this.fixOrphanedRecurringCategory(s.id);break;case"orphaned_recurring_wallet":await this.fixOrphanedRecurringWallet(s.id);break;default:throw new Error("No auto-fix available for issue type: ".concat(s.type))}t.successful++,this.failedFixes.delete(e),(t.successful<=5||t.successful%10===0)&&console.log("Auto-fixed issue: ".concat(s.type," for ID ").concat(s.id))}catch(r){t.failed++,this.failedFixes.set(e,n+1),t.errors.push({issue:s,error:r.message}),n<2&&console.error("Failed to auto-fix issue ".concat(s.type," for ID ").concat(s.id,":"),r)}}}return t}async fixOrphanedExpenseCategory(e){const t=await Ie.dq.getById(e);if(t){let e=await Ie.T0.getById("other");e||(e={id:"other",name:"Other",color:"#gray"},await Ie.T0.add(e)),t.category="other",t.last_modified=(new Date).toISOString(),await Ie.dq.update(t)}}async fixOrphanedExpenseWallet(e){const t=await Ie.dq.getById(e);if(t){let e=await Ie.qF.getById("cash");e||(e={id:"cash",name:"Cash",type:"cash",balance:0},await Ie.qF.add(e)),t.walletId="cash",t.last_modified=(new Date).toISOString(),await Ie.dq.update(t)}}async fixOrphanedExpenseTag(e){try{const t=this.useCloudDB?this.getCloudDB("expenses"):this.getLocalDB("expenses"),n=this.useCloudDB?this.getCloudDB("tags"):this.getLocalDB("tags");let r;if(r=this.useCloudDB&&this.userId?await t.getById(e,this.userId):await t.getById(e),r&&r.tags){const e=[];for(const t of r.tags)try{let r;r=this.useCloudDB&&this.userId?await n.getById(t,this.userId):await n.getById(t),r&&e.push(t)}catch(s){console.warn("Could not verify tag ".concat(t,", keeping it:"),s.message),e.push(t)}e.length!==r.tags.length&&(r.tags=e,r.last_modified=(new Date).toISOString(),this.useCloudDB&&this.userId?await t.update(r,this.userId):await t.update(r))}}catch(a){var t,n,r;if(null!==(t=a.message)&&void 0!==t&&t.includes("NetworkError")||null!==(n=a.message)&&void 0!==n&&n.includes("CORS")||null!==(r=a.message)&&void 0!==r&&r.includes("fetch"))return void console.warn("Network error during tag integrity fix for expense ".concat(e,", skipping:"),a.message);throw a}}async fixOrphanedBudgetCategory(e){const t=await Ie.mh.getById(e);if(t){let e=await Ie.T0.getById("other");e||(e={id:"other",name:"Other",color:"#gray"},await Ie.T0.add(e)),t.category="other",t.last_modified=(new Date).toISOString(),await Ie.mh.update(t)}}async fixOrphanedRecurringCategory(e){const t=await Ie.Mq.getById(e);if(t){let e=await Ie.T0.getById("other");e||(e={id:"other",name:"Other",color:"#gray"},await Ie.T0.add(e)),t.category="other",t.last_modified=(new Date).toISOString(),await Ie.Mq.update(t)}}async fixOrphanedRecurringWallet(e){const t=await Ie.Mq.getById(e);if(t){let e=await Ie.qF.getById("cash");e||(e={id:"cash",name:"Cash",type:"cash",balance:0},await Ie.qF.add(e)),t.walletId="cash",t.last_modified=(new Date).toISOString(),await Ie.Mq.update(t)}}async performMaintenance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{cleanupTombstonesOlderThan:t=30,validateData:n=!0,autoFix:r=!0}=e,s={tombstoneCleanup:null,validation:null,integrity:null,autoFix:null,timestamp:(new Date).toISOString()};try{if(console.log("Cleaning up tombstones older than ".concat(t," days...")),s.tombstoneCleanup=await Ie.oj.cleanupOldTombstones(t),n){console.log("Performing data validation...");const e=await this.preSyncValidation();s.validation=e.validation,s.integrity=e.integrity,r&&e.integrity.issues.length>0&&(console.log("Auto-fixing integrity issues..."),s.autoFix=await this.autoFixIntegrityIssues(e.integrity.issues))}return console.log("Database maintenance completed:",s),s}catch(a){throw console.error("Database maintenance failed:",a),new Error("Maintenance failed: ".concat(a.message))}}getLocalDB(e){const t={expenses:Ie.dq,categories:Ie.T0,wallets:Ie.qF,transfers:Ie.gf,budgets:Ie.mh,tags:Ie.d6,recurring:Ie.Mq}[e];if(!t)throw new Error("Unknown database type: ".concat(e));return t}getCloudDB(e){const t={expenses:Le.expenseDB,categories:Le.T0,wallets:Le.qF,transfers:Le.transferDB,budgets:Le.mh,tags:Le.d6,recurring:Le.Mq}[e];if(!t)throw new Error("Unknown cloud database type: ".concat(e));return t}}const Fe=new Re,Be=()=>Fe.preSyncValidation(),ze="expense_tracker_cleaned_duplicates";class Ue{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.user=e,this.useCloudDB=t}static trackCleanedDuplicate(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"duplicate_cleanup";try{const n=this.getCleanedDuplicates();n[e]={cleanedAt:(new Date).toISOString(),reason:t,fingerprint:this.generateCleanupFingerprint(e)},this.cleanOldCleanedDuplicates(n),localStorage.setItem(ze,JSON.stringify(n))}catch(n){console.warn("Failed to track cleaned duplicate:",n)}}static isRecentlyCleanedDuplicate(e){try{const t=this.getCleanedDuplicates(),n=t.hasOwnProperty(e);if(n){const n=t[e];console.log("\u2705 Transaction ".concat(e," is tracked as cleaned duplicate:"),{cleanedAt:n.cleanedAt,reason:n.reason,fingerprint:n.fingerprint})}else console.log("\u274c Transaction ".concat(e," is NOT tracked as cleaned duplicate"));return n}catch(t){return console.warn("Failed to check cleaned duplicates:",t),!1}}static getCleanedDuplicates(){try{const e=localStorage.getItem(ze);return e?JSON.parse(e):{}}catch(e){return console.warn("Failed to get cleaned duplicates:",e),{}}}static cleanOldCleanedDuplicates(e){const t=new Date(Date.now()-6048e5);Object.keys(e).forEach((n=>{const r=e[n];new Date(r.cleanedAt)<t&&delete e[n]}))}static generateCleanupFingerprint(e){return"cleanup_".concat(e,"_").concat(Date.now())}static clearCleanedDuplicates(){try{localStorage.removeItem(ze)}catch(e){console.warn("Failed to clear cleaned duplicates:",e)}}static getCleanupStatistics(){try{const e=this.getCleanedDuplicates(),t=Object.entries(e),n={totalTracked:t.length,byReason:{},oldestCleanup:null,newestCleanup:null,recentCleanups:0},r=new Date(Date.now()-864e5);return t.forEach((e=>{let[t,s]=e;const a=new Date(s.cleanedAt);n.byReason[s.reason]=(n.byReason[s.reason]||0)+1,(!n.oldestCleanup||a<new Date(n.oldestCleanup))&&(n.oldestCleanup=s.cleanedAt),(!n.newestCleanup||a>new Date(n.newestCleanup))&&(n.newestCleanup=s.cleanedAt),a>r&&n.recentCleanups++})),n}catch(e){return console.warn("Failed to get cleanup statistics:",e),{error:e.message}}}static debugCleanupStatus(){const e=this.getCleanupStatistics();return console.group("\ud83e\uddf9 Duplicate Cleanup Status"),console.log("Total tracked cleaned duplicates:",e.totalTracked),console.log("Recent cleanups (24h):",e.recentCleanups),console.log("Cleanup reasons:",e.byReason),e.oldestCleanup&&console.log("Oldest cleanup:",new Date(e.oldestCleanup).toLocaleString()),e.newestCleanup&&console.log("Newest cleanup:",new Date(e.newestCleanup).toLocaleString()),console.groupEnd(),e}async findDuplicates(){var e;const t=this.useCloudDB?Le.expenseDB:Ie.dq;let n;n=this.useCloudDB&&null!==(e=this.user)&&void 0!==e&&e.id?await t.getAllIncludingDeleted(this.user.id):await t.getAllIncludingDeleted();const r=n.filter((e=>!e.deleted_at));return this.groupDuplicates(r)}groupDuplicates(e){const t=new Map;e.forEach((e=>{const n=this.createDuplicateKey(e);t.has(n)||t.set(n,[]),t.get(n).push(e)}));const n=[];return t.forEach(((e,t)=>{e.length>1&&(e.sort(((e,t)=>new Date(e.created_at||e.date)-new Date(t.created_at||t.date))),n.push({key:t,count:e.length,transactions:e,toKeep:e[0],toDelete:e.slice(1)}))})),n}createDuplicateKey(e){const t=parseFloat(e.amount).toFixed(2),n=(e.description||e.name||"").toLowerCase().trim(),r=e.date,s=e.category||"";return"".concat(t,"|").concat(n,"|").concat(r,"|").concat(s)}async removeDuplicates(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{dryRun:n=!1,maxToDelete:r=100}=t,s=this.useCloudDB?Le.expenseDB:Ie.dq;let a=0;const i={processed:0,deleted:0,errors:[],dryRun:n};for(const c of e){if(a>=r)break;i.processed++;for(const e of c.toDelete){if(a>=r)break;try{var o;if(!n)this.useCloudDB&&null!==(o=this.user)&&void 0!==o&&o.id?await s.delete(e.id,this.user.id):await s.delete(e.id),Ue.trackCleanedDuplicate(e.id,"automatic_duplicate_cleanup");a++,i.deleted++,console.log("".concat(n?"[DRY RUN] Would delete":"Deleted"," duplicate:"),{id:e.id,amount:e.amount,description:e.description||e.name,date:e.date})}catch(l){console.error("Error deleting duplicate:",l),i.errors.push({id:e.id,error:l.message})}}}return i}getDuplicateSummary(e){const t=e.reduce(((e,t)=>e+t.toDelete.length),0);return{totalGroups:e.length,totalDuplicates:t,duplicatesByAmount:e.reduce(((e,t)=>{const n=parseFloat(t.transactions[0].amount);return e[n]=(e[n]||0)+t.toDelete.length,e}),{}),largestGroup:Math.max(...e.map((e=>e.count)),0)}}async performSafeCleanup(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{maxToDelete:t=50,dryRun:n=!0,requireConfirmation:r=!0}=e;try{console.log("Scanning for duplicate transactions...");const e=await this.findDuplicates();if(0===e.length)return{success:!0,message:"No duplicate transactions found.",duplicates:0};const r=this.getDuplicateSummary(e);console.log("Duplicate analysis:",r);const s=await this.removeDuplicates(e,{dryRun:n,maxToDelete:t});return{success:!0,summary:r,results:s,message:n?"Found ".concat(r.totalDuplicates," duplicates in ").concat(r.totalGroups," groups. Run with dryRun=false to delete them."):"Successfully removed ".concat(s.deleted," duplicate transactions.")}}catch(s){return console.error("Error during duplicate cleanup:",s),{success:!1,error:s.message}}}}"undefined"!==typeof window&&(window.DuplicateCleanupDebugger={getStatistics:()=>Ue.getCleanupStatistics(),debugStatus:()=>Ue.debugCleanupStatus(),clearTracking:()=>Ue.clearCleanedDuplicates(),isRecentlyCleaned:e=>Ue.isRecentlyCleanedDuplicate(e),getTrackedDuplicates:()=>Ue.getCleanedDuplicates(),testDuplicatePrevention:()=>{console.group("\ud83e\uddea Testing Duplicate Prevention System");const e="test_duplicate_"+Date.now();console.log("Test 1: Tracking a test duplicate..."),Ue.trackCleanedDuplicate(e,"test_cleanup"),console.log("Test 2: Checking if test duplicate is tracked...");const t=Ue.isRecentlyCleanedDuplicate(e);console.log("Is tracked:",t),console.log("Test 3: Getting cleanup statistics...");const n=Ue.getCleanupStatistics();console.log("Statistics:",n),console.log("Test 4: Getting all tracked duplicates...");const r=Ue.getCleanedDuplicates();console.log("Tracked duplicates:",r),console.log("Cleaning up test data...");const s=Ue.getCleanedDuplicates();return delete s[e],localStorage.setItem("expense_tracker_cleaned_duplicates",JSON.stringify(s)),console.log("\u2705 Test completed successfully!"),console.groupEnd(),{testPassed:t,statistics:n,trackedCount:Object.keys(r).length}},manuallyTrackCleaned:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"manual_test";return console.log("Manually tracking transaction ".concat(e," as cleaned...")),Ue.trackCleanedDuplicate(e,t),console.log("\u2705 Transaction tracked successfully"),Ue.isRecentlyCleanedDuplicate(e)}},console.log("\ud83e\uddf9 DuplicateCleanupDebugger available globally. Try: DuplicateCleanupDebugger.testDuplicatePrevention()"));class We{static getCurrentUsage(){let e=0;for(let t in localStorage)localStorage.hasOwnProperty(t)&&(e+=localStorage[t].length+t.length);return e}static getUsagePercentage(){return this.getCurrentUsage()/this.QUOTA_LIMIT*100}static isApproachingQuota(){return this.getUsagePercentage()>100*this.WARNING_THRESHOLD}static getKeySize(e){const t=localStorage.getItem(e);return t?t.length+e.length:0}static getAllKeySizes(){const e={};for(let t in localStorage)localStorage.hasOwnProperty(t)&&(e[t]=this.getKeySize(t));return e}static safeSetItem(e,t){try{const n=this.getCurrentUsage(),r=t.length+e.length,s=this.getKeySize(e);if(n-s+r>this.QUOTA_LIMIT){console.warn("LocalStorage quota would be exceeded. Attempting cleanup..."),this.performCleanup();const t=this.getCurrentUsage();if(t-this.getKeySize(e)+r>this.QUOTA_LIMIT)throw new Error("QUOTA_BYTES quota exceeded even after cleanup")}return localStorage.setItem(e,t),!0}catch(n){throw console.error("Error setting localStorage item:",n),(n.message.includes("QUOTA")||"QuotaExceededError"===n.name)&&this.handleQuotaExceeded(e,t),n}}static handleQuotaExceeded(e,t){console.warn("LocalStorage quota exceeded. Performing emergency cleanup...");const n=this.getAllKeySizes(),r=Object.keys(n).sort(((e,t)=>n[t]-n[e])),s=["user","auth","settings","onboarding_completed"];for(const a of r)if(!s.includes(a)){console.log("Removing ".concat(a," (").concat(n[a]," bytes) to free space")),localStorage.removeItem(a);try{return localStorage.setItem(e,t),void console.log("Successfully saved after cleanup")}catch(pu){continue}}throw new Error("Unable to free enough space in localStorage")}static performCleanup(){try{console.log("Performing localStorage cleanup..."),this.compressLargeArrays(),this.cleanupSyncData(),console.log("\u2705 localStorage cleanup completed")}catch(e){console.error("Error during cleanup:",e)}}static cleanupOperationQueue(){console.log("Operation queue cleanup skipped (operation queue removed)")}static cleanupSyncData(){try{const e=localStorage.getItem("syncStatus");e&&e.length>1e4&&(localStorage.removeItem("syncStatus"),console.log("Removed large sync status data"))}catch(e){console.error("Error cleaning sync data:",e)}}static compressLargeArrays(){["expenses","wallet-transfers","budgets"].forEach((e=>{try{const t=localStorage.getItem(e);if(t){const n=JSON.parse(t);if(Array.isArray(n)&&n.length>1e3){let t=n;n[0]&&n[0].date&&(t=n.sort(((e,t)=>new Date(t.date)-new Date(e.date))));const r=t.slice(0,500);this.safeSetItem(e,JSON.stringify(r)),console.log("Compressed ".concat(e,": ").concat(n.length," -> ").concat(r.length," items"))}}}catch(t){console.error("Error compressing ".concat(e,":"),t)}}))}static getStorageReport(){const e=this.getCurrentUsage(),t=this.getUsagePercentage(),n=this.getAllKeySizes();return{totalUsage:e,usagePercentage:t,isApproachingQuota:this.isApproachingQuota(),keySizes:n,largestKeys:Object.keys(n).sort(((e,t)=>n[t]-n[e])).slice(0,10).map((e=>({key:e,size:n[e]})))}}static initializeMonitoring(){if(!this.isInitialized)try{this.isApproachingQuota()&&(console.warn("LocalStorage usage is at ".concat(this.getUsagePercentage().toFixed(1),"% - cleanup recommended")),this.performCleanup()),this.isInitialized=!0,console.log("LocalStorage monitoring initialized")}catch(e){console.error("Error initializing localStorage monitoring:",e)}}static emergencyCleanup(){try{console.log("\ud83d\udea8 Performing emergency localStorage cleanup...");const e=this.getCurrentUsage();localStorage.removeItem("operationQueue");const t=["user","auth","settings","onboarding","supabase.auth.token","sb-mplrakcyrohgkqdhzpry-auth-token"],n=Object.keys(localStorage);let r=0;n.forEach((e=>{if(!t.some((t=>e.includes(t))))try{localStorage.removeItem(e),r++}catch(pu){console.warn("Failed to remove key:",e)}}));const s=this.getCurrentUsage(),a=e-s;return console.log("\ud83c\udf89 Emergency cleanup completed!"),console.log("\ud83d\udcca Removed keys:",r),console.log("\ud83d\udcbe Storage freed:",(a/1024).toFixed(2),"KB"),{success:!0,removedKeys:r,freedBytes:a,beforeUsage:e,afterUsage:s}}catch(e){return console.error("Emergency cleanup failed:",e),{success:!1,error:e.message}}}}We.QUOTA_LIMIT=5242880,We.WARNING_THRESHOLD=.8,We.isInitialized=!1,"undefined"!==typeof window&&window.localStorage&&We.initializeMonitoring();const qe=We,He=(e,t)=>{try{return qe.safeSetItem(e,t)}catch(n){if(console.error("Failed to save ".concat(e," to localStorage:"),n),n.message.includes("QUOTA")||"QuotaExceededError"===n.name){console.warn("Attempting emergency cleanup due to quota error...");try{return qe.emergencyCleanup(),qe.safeSetItem(e,t)}catch(r){console.error("Emergency cleanup failed:",r)}}throw n}};class Ve{constructor(e){console.log("\ud83d\uded1 AUTOMATIC SYNC DISABLED - SyncManager initialized in manual-only mode"),this.user=e,this.syncStatus={lastSync:this.getLastSyncTime(),inProgress:!1,conflicts:[],errors:[],hasLocalChanges:this.hasLocalChanges(),isOnline:navigator.onLine,backgroundSyncEnabled:!1,adaptiveInterval:3e5,consecutiveFailures:0,lastSuccessfulSync:null},this.dataIntegrityManager=new Re(null===e||void 0===e?void 0:e.id,!0),window.addEventListener("online",this.handleOnlineStatusChange.bind(this)),window.addEventListener("offline",this.handleOnlineStatusChange.bind(this)),this.initializeLocalDatabase()}async initializeLocalDatabase(){try{const{initializeDatabase:e}=await Promise.resolve().then(n.bind(n,82));await e()?console.log("Local database initialized successfully for sync"):console.warn("Local database initialization failed, sync may not work properly")}catch(e){console.error("Error initializing local database for sync:",e)}}getSyncStatus(){return this.syncStatus}handleOnlineStatusChange(){const e=this.syncStatus.isOnline;this.syncStatus.isOnline=navigator.onLine,!e&&navigator.onLine?(console.log("Device came online - resuming background sync"),this.syncStatus.backgroundSyncEnabled=!0,this.syncStatus.consecutiveFailures=0):e&&!navigator.onLine&&(console.log("Device went offline - pausing background sync"),this.backgroundSyncInterval&&(clearTimeout(this.backgroundSyncInterval),this.backgroundSyncInterval=null)),this.saveStatusToLocalStorage()}getLastSyncTime(){return localStorage.getItem("lastSyncTime")||null}hasLocalChanges(){return"true"===localStorage.getItem("hasLocalChanges")}markLocalChange(){this.syncStatus.hasLocalChanges=!0,He("hasLocalChanges","true"),this.saveStatusToLocalStorage()}clearLocalChanges(){this.syncStatus.hasLocalChanges=!1,localStorage.removeItem("hasLocalChanges"),this.saveStatusToLocalStorage()}saveStatusToLocalStorage(){He("syncStatus",JSON.stringify(this.syncStatus)),this.syncStatus.lastSync&&He("lastSyncTime",this.syncStatus.lastSync)}async fullSync(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bidirectional",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{skipValidation:r=!1,autoFixIntegrity:s=!0,performMaintenance:a=!1}=n;if(this.syncStatus.inProgress)throw new Error("Sync already in progress");if(!this.syncStatus.isOnline)throw new Error("Cannot sync while offline");if(null===(e=this.user)||void 0===e||!e.id)throw new Error("User not authenticated");try{await this.validateLocalDatabase()}catch(i){throw console.error("Local database validation failed:",i),new Error("Local database not ready: ".concat(i.message))}this.syncStatus.inProgress=!0,this.syncStatus.errors=[],this.syncStatus.conflicts=[],this.saveStatusToLocalStorage();try{let e={success:!0,conflicts:[],stats:{},validation:null,maintenance:null};if(!r){console.log("Performing pre-sync validation...");try{const t=await Be();if(e.validation=t,s&&t.integrity.issues.length>0){console.log("Found ".concat(t.integrity.issues.length," integrity issues, attempting auto-fix..."));const n=await this.dataIntegrityManager.autoFixIntegrityIssues(t.integrity.issues);e.validation.autoFix=n,n.successful>0&&(console.log("Auto-fixed ".concat(n.successful," integrity issues")),e.validation.postFix=await Be())}if(!t.overallValid&&!s){const e=t.integrity.issues.filter((e=>"critical"===e.severity));if(e.length>0)throw new Error("Critical data integrity issues found: ".concat(e.length," issues. Sync aborted."))}}catch(o){console.error("Pre-sync validation failed:",o),this.syncStatus.errors.push({message:"Pre-sync validation failed: ".concat(o.message),timestamp:(new Date).toISOString(),type:"validation"})}}if(a){console.log("Performing database maintenance...");try{e.maintenance=await this.dataIntegrityManager.performMaintenance({cleanupTombstonesOlderThan:30,validateData:!0,autoFix:s})}catch(l){console.error("Database maintenance failed:",l),this.syncStatus.errors.push({message:"Database maintenance failed: ".concat(l.message),timestamp:(new Date).toISOString(),type:"maintenance"})}}switch(t){case"upload":e=(0,Oe.A)((0,Oe.A)({},e),await this.uploadToCloud());break;case"download":e=(0,Oe.A)((0,Oe.A)({},e),await this.downloadFromCloud());break;default:e=(0,Oe.A)((0,Oe.A)({},e),await this.bidirectionalSync())}return this.syncStatus.lastSync=(new Date).toISOString(),this.syncStatus.lastSuccessfulSync=(new Date).toISOString(),this.syncStatus.consecutiveFailures=0,this.clearLocalChanges(),console.log("Enhanced ".concat(t," sync completed successfully:"),{stats:e.stats,validation:e.validation?"completed":"skipped",maintenance:e.maintenance?"completed":"skipped"}),e}catch(i){throw this.syncStatus.errors.push({message:i.message,timestamp:(new Date).toISOString(),type:t}),this.syncStatus.consecutiveFailures++,i}finally{this.syncStatus.inProgress=!1,this.saveStatusToLocalStorage()}}async validateLocalDatabase(){try{const e=[Ie.dq.getAll().catch((e=>({error:"expenses",message:e.message}))),Ie.T0.getAll().catch((e=>({error:"categories",message:e.message}))),Ie.qF.getAll().catch((e=>({error:"wallets",message:e.message}))),Ie.d6.getAll().catch((e=>({error:"tags",message:e.message}))),Ie.mh.getAll().catch((e=>({error:"budgets",message:e.message}))),Ie.Mq.getAll().catch((e=>({error:"recurring",message:e.message}))),Ie.gf.getAll().catch((e=>({error:"transfers",message:e.message})))],t=(await Promise.all(e)).filter((e=>e&&e.error));if(t.length>0){const e=t.map((e=>"".concat(e.error,": ").concat(e.message))).join(", ");throw new Error("Database validation failed for: ".concat(e))}return console.log("Local database validation successful"),!0}catch(e){throw console.error("Database validation error:",e),e}}async uploadToCloud(){const e={expenses:{uploaded:0,errors:0},categories:{uploaded:0,errors:0},wallets:{uploaded:0,errors:0},transfers:{uploaded:0,errors:0},budgets:{uploaded:0,errors:0},tags:{uploaded:0,errors:0},recurring:{uploaded:0,errors:0}};return await this.uploadDataType("expenses",Ie.dq,Le.expenseDB,e),await this.uploadDataType("categories",Ie.T0,Le.T0,e),await this.uploadDataType("wallets",Ie.qF,Le.qF,e),await this.uploadDataType("transfers",Ie.gf,Le.transferDB,e),await this.uploadDataType("budgets",Ie.mh,Le.mh,e),await this.uploadDataType("tags",Ie.d6,Le.d6,e),await this.uploadDataType("recurring",Ie.Mq,Le.Mq,e),{stats:e,conflicts:this.syncStatus.conflicts}}async downloadFromCloud(){const e={expenses:{downloaded:0,errors:0},categories:{downloaded:0,errors:0},wallets:{downloaded:0,errors:0},transfers:{downloaded:0,errors:0},budgets:{downloaded:0,errors:0},tags:{downloaded:0,errors:0},recurring:{downloaded:0,errors:0}};return await this.downloadDataType("expenses",Le.expenseDB,Ie.dq,e),await this.downloadDataType("categories",Le.T0,Ie.T0,e),await this.downloadDataType("wallets",Le.qF,Ie.qF,e),await this.downloadDataType("transfers",Le.transferDB,Ie.gf,e),await this.downloadDataType("budgets",Le.mh,Ie.mh,e),await this.downloadDataType("tags",Le.d6,Ie.d6,e),await this.downloadDataType("recurring",Le.Mq,Ie.Mq,e),{stats:e,conflicts:this.syncStatus.conflicts}}async bidirectionalSync(){const e={expenses:{uploaded:0,downloaded:0,conflicts:0,errors:0},categories:{uploaded:0,downloaded:0,conflicts:0,errors:0},wallets:{uploaded:0,downloaded:0,conflicts:0,errors:0},transfers:{uploaded:0,downloaded:0,conflicts:0,errors:0},budgets:{uploaded:0,downloaded:0,conflicts:0,errors:0},tags:{uploaded:0,downloaded:0,conflicts:0,errors:0},recurring:{uploaded:0,downloaded:0,conflicts:0,errors:0}};return await this.syncDataTypeBidirectional("expenses",Ie.dq,Le.expenseDB,e),await this.syncDataTypeBidirectional("categories",Ie.T0,Le.T0,e),await this.syncDataTypeBidirectional("wallets",Ie.qF,Le.qF,e),await this.syncDataTypeBidirectional("transfers",Ie.gf,Le.transferDB,e),await this.syncDataTypeBidirectional("budgets",Ie.mh,Le.mh,e),await this.syncDataTypeBidirectional("tags",Ie.d6,Le.d6,e),await this.syncDataTypeBidirectional("recurring",Ie.Mq,Le.Mq,e),{stats:e,conflicts:this.syncStatus.conflicts}}async uploadDataType(e,t,n,r){try{let o;try{o="expenses"===e?await t.getAllIncludingDeleted():await t.getAll()}catch(s){return console.error("Error accessing local ".concat(e," database:"),s),void r[e].errors++}for(const t of o)try{const s=this.transformForSupabase(e,t);await n.add(s,this.user.id),r[e].uploaded++}catch(a){if(a.message.includes("duplicate")||"23505"===a.code)try{const s=this.transformForSupabase(e,t);await n.update(s,this.user.id),r[e].uploaded++}catch(i){console.error("Error updating ".concat(e,":"),i),r[e].errors++}else console.error("Error uploading ".concat(e,":"),a),r[e].errors++}}catch(a){console.error("Error in uploadDataType for ".concat(e,":"),a),r[e].errors++}}async downloadDataType(e,t,n,r){try{let l;try{l="expenses"===e?await t.getAllIncludingDeleted(this.user.id):await t.getAll(this.user.id)}catch(s){return console.error("Error accessing remote ".concat(e," database:"),s),void r[e].errors++}try{await n.getAll()}catch(a){return console.error("Error accessing local ".concat(e," database:"),a),void r[e].errors++}try{const t="expenses"===e?await n.getAllIncludingDeleted():await n.getAll();for(const r of t)"expenses"===e&&n.hardDelete?await n.hardDelete(r.id):await n.delete(r.id)}catch(i){console.error("Error clearing local ".concat(e," data:"),i)}for(const t of l)try{const s=this.transformFromSupabase(e,t);await n.add(s),r[e].downloaded++}catch(o){console.error("Error downloading ".concat(e,":"),o),r[e].errors++}}catch(o){console.error("Error in downloadDataType for ".concat(e,":"),o),r[e].errors++}}async syncDataTypeBidirectional(e,t,n,r){const s=[];try{const[c,d]=await Promise.all(["expenses"===e?t.getAllIncludingDeleted():t.getAll(),"expenses"===e?n.getAllIncludingDeleted(this.user.id):n.getAll(this.user.id)]),u=new Map(c.map((e=>[e.id,e]))),h=new Map(d.map((e=>[e.id,e])));for(const[t,s]of u)if(!h.has(t))try{const t=this.transformForSupabase(e,s);if("expenses"===e&&s.deleted_at)try{await n.update(t,this.user.id)}catch(i){await n.add(t,this.user.id)}else await n.add(t,this.user.id);r[e].uploaded++}catch(o){if(o.message.includes("duplicate")||"23505"===o.code)try{const t=this.transformForSupabase(e,s);await n.update(t,this.user.id),r[e].uploaded++}catch(i){console.error("Error updating ".concat(e," during upload:"),i)}else console.error("Error uploading new ".concat(e,":"),o)}for(const[s,i]of h){const c=u.get(s);if(c){if(c.deleted_at&&!i.deleted_at){const a=new Date(c.deleted_at);if(a>new Date(i.last_modified||i.updated_at||i.created_at))try{const t=this.transformForSupabase(e,c);await n.update(t,this.user.id),r[e].uploaded++,console.log("Synced local deletion to remote for ".concat(e," ").concat(s))}catch(o){console.error("Error syncing deletion to remote for ".concat(e,":"),o)}else try{const n=this.transformFromSupabase(e,i);await t.update(n),r[e].downloaded++,console.log("Restored ".concat(e," ").concat(s," from remote (newer than local deletion)"))}catch(o){console.error("Error restoring ".concat(e," from remote:"),o)}}}else{if("expenses"===e&&Ue.isRecentlyCleanedDuplicate(i.id)){console.log("Skipping download of expense ".concat(i.id," - recently cleaned as duplicate"));continue}try{const n=this.transformFromSupabase(e,i);if(t.upsert&&"expenses"===e)await t.upsert(n);else try{await t.add(n)}catch(l){var a;if(!("ConstraintError"===l.name||null!==(a=l.message)&&void 0!==a&&a.includes("Key already exists")))throw l;console.log("Item ".concat(i.id," already exists locally, updating instead")),await t.update(n)}r[e].downloaded++}catch(o){console.error("Error downloading new ".concat(e," (ID: ").concat(i.id,"):"),{error:o,errorName:o.name,errorMessage:o.message,remoteItem:i,transformedItem:this.transformFromSupabase(e,i)}),r[e].errors=(r[e].errors||0)+1}}}for(const[a,i]of u){const l=h.get(a);if(l){const c=this.resolveConflict(e,i,l);if(c.hasConflict)try{if("use_local"===c.resolution){const t=this.transformForSupabase(e,i);await n.update(t,this.user.id),r[e].uploaded++}else if("use_remote"===c.resolution){const n=this.transformFromSupabase(e,l);await t.update(n),r[e].downloaded++}s.push({id:a,type:e,localVersion:i,remoteVersion:l,resolution:c.resolution,reason:c.reason}),r[e].conflicts++}catch(o){console.error("Error resolving conflict for ".concat(e,":"),o)}}}}catch(o){throw console.error("Error in bidirectional sync for ".concat(e,":"),o),o}return{conflicts:s}}resolveConflict(e,t,n){if(!this.detectConflict(e,t,n))return{hasConflict:!1};const r=null!==t.deleted_at&&void 0!==t.deleted_at,s=null!==n.deleted_at&&void 0!==n.deleted_at;if(r&&!s){return new Date(t.deleted_at)>new Date(n.last_modified||n.updated_at||n.created_at)?{hasConflict:!0,resolution:"use_local",reason:"Local deletion is newer than remote modification"}:{hasConflict:!0,resolution:"use_remote",reason:"Remote modification is newer than local deletion"}}if(s&&!r){return new Date(n.deleted_at)>new Date(t.last_modified||t.updated_at||t.created_at)?{hasConflict:!0,resolution:"use_remote",reason:"Remote deletion is newer than local modification"}:{hasConflict:!0,resolution:"use_local",reason:"Local modification is newer than remote deletion"}}if(r&&s){return{hasConflict:!0,resolution:new Date(t.deleted_at)>new Date(n.deleted_at)?"use_local":"use_remote",reason:"Using later deletion timestamp"}}const a=new Date(t.last_modified||t.updated_at||t.created_at),i=new Date(n.last_modified||n.updated_at||n.created_at);return a>i?{hasConflict:!0,resolution:"use_local",reason:"Local version is newer"}:i>a?{hasConflict:!0,resolution:"use_remote",reason:"Remote version is newer"}:{hasConflict:!0,resolution:"use_remote",reason:"Same timestamp - server wins tiebreaker"}}detectConflict(e,t,n){const r=(0,Oe.A)({},t),s=(0,Oe.A)({},n);delete r.created_at,delete r.updated_at,delete r.last_modified,delete r.sync_status,delete s.created_at,delete s.updated_at,delete s.last_modified,delete s.sync_status,delete s.user_id;const a=this.transformFromSupabase(e,s);return JSON.stringify(r)!==JSON.stringify(a)}transformForSupabase(e,t){const n=(0,Oe.A)({},t);switch(e){case"expenses":n.walletId&&(n.wallet_id=n.walletId,delete n.walletId),void 0!==n.isIncome&&(n.is_income=n.isIncome,delete n.isIncome),n.photoUrl&&(n.photo_url=n.photoUrl,delete n.photoUrl);break;case"transfers":n.fromWallet&&(n.from_wallet_id=n.fromWallet,delete n.fromWallet),n.toWallet&&(n.to_wallet_id=n.toWallet,delete n.toWallet),n.fromWalletName&&(n.from_wallet_name=n.fromWalletName,delete n.fromWalletName),n.toWalletName&&(n.to_wallet_name=n.toWalletName,delete n.toWalletName),n.photoUrl&&(n.photo_url=n.photoUrl,delete n.photoUrl)}return n}transformFromSupabase(e,t){const n=(0,Oe.A)({},t);switch(delete n.user_id,delete n.created_at,delete n.updated_at,e){case"expenses":n.wallet_id&&(n.walletId=n.wallet_id,delete n.wallet_id),void 0!==n.is_income&&(n.isIncome=n.is_income,delete n.is_income),n.photo_url&&(n.photoUrl=n.photo_url,delete n.photo_url);break;case"transfers":n.from_wallet_id&&(n.fromWallet=n.from_wallet_id,delete n.from_wallet_id),n.to_wallet_id&&(n.toWallet=n.to_wallet_id,delete n.to_wallet_id),n.from_wallet_name&&(n.fromWalletName=n.from_wallet_name,delete n.from_wallet_name),n.to_wallet_name&&(n.toWalletName=n.to_wallet_name,delete n.to_wallet_name),n.photo_url&&(n.photoUrl=n.photo_url,delete n.photo_url)}return n}async exportLocalData(){try{var e;const[t,n,r,s,a,i,o]=await Promise.all([Ie.dq.getAll(),Ie.T0.getAll(),Ie.qF.getAll(),Ie.gf.getAll(),Ie.d6.getAll(),Ie.mh.getAll(),Ie.Mq.getAll()]);return{version:"1.0",exportDate:(new Date).toISOString(),userId:(null===(e=this.user)||void 0===e?void 0:e.id)||"anonymous",data:{expenses:t,categories:n,wallets:r,transfers:s,tags:a,budgets:i,recurring:o},metadata:{totalExpenses:t.length,totalCategories:n.length,totalWallets:r.length,totalTransfers:s.length,totalTags:a.length,totalBudgets:i.length,totalRecurring:o.length}}}catch(t){throw console.error("Error exporting data:",t),new Error("Export failed: ".concat(t.message))}}async importLocalData(e){try{if(!e.version||!e.data)throw new Error("Invalid backup file format");const{data:n}=e,r=[this.clearDataType(Ie.dq),this.clearDataType(Ie.T0),this.clearDataType(Ie.qF),this.clearDataType(Ie.gf),this.clearDataType(Ie.d6),this.clearDataType(Ie.mh),this.clearDataType(Ie.Mq)];await Promise.all(r);const s=[{name:"categories",data:n.categories||[],db:Ie.T0},{name:"tags",data:n.tags||[],db:Ie.d6},{name:"wallets",data:n.wallets||[],db:Ie.qF},{name:"budgets",data:n.budgets||[],db:Ie.mh},{name:"recurring",data:n.recurring||[],db:Ie.Mq},{name:"transfers",data:n.transfers||[],db:Ie.gf},{name:"expenses",data:n.expenses||[],db:Ie.dq}],a={};for(const e of s)try{let t=0;for(const n of e.data)await e.db.add(n),t++;a[e.name]={imported:t,total:e.data.length}}catch(t){console.error("Error importing ".concat(e.name,":"),t),a[e.name]={imported:0,total:e.data.length,error:t.message}}return this.markLocalChange(),{success:!0,stats:a}}catch(t){throw console.error("Error importing data:",t),new Error("Import failed: ".concat(t.message))}}async clearDataType(e){try{const t=await e.getAll();for(const n of t)await e.delete(n.id)}catch(t){console.error("Error clearing data type:",t)}}setupAdaptiveBackgroundSync(){console.warn("\ud83d\uded1 setupAdaptiveBackgroundSync() called but is disabled to prevent automatic sync"),console.warn("Use manual sync methods instead")}setBackgroundSyncEnabled(e){console.warn("\ud83d\uded1 Background sync is permanently disabled to prevent automatic database writes"),console.warn("Use manual sync methods instead: forceSync(), uploadToCloud(), downloadFromCloud()"),this.syncStatus.backgroundSyncEnabled=!1,this.backgroundSyncInterval&&(clearTimeout(this.backgroundSyncInterval),this.backgroundSyncInterval=null),this.saveStatusToLocalStorage()}async forceSync(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"bidirectional";this.syncStatus.adaptiveInterval=12e4,this.syncStatus.consecutiveFailures=0,this.syncStatus.backgroundSyncEnabled=!0;return await this.fullSync(e)}async getSyncStatistics(){try{return{lastSync:this.syncStatus.lastSync,lastSuccessfulSync:this.syncStatus.lastSuccessfulSync,consecutiveFailures:this.syncStatus.consecutiveFailures,hasLocalChanges:this.syncStatus.hasLocalChanges,isOnline:this.syncStatus.isOnline,backgroundSyncEnabled:this.syncStatus.backgroundSyncEnabled,adaptiveInterval:this.syncStatus.adaptiveInterval,errors:this.syncStatus.errors.slice(-10),conflicts:this.syncStatus.conflicts.slice(-10)}}catch(e){return console.error("Error getting sync statistics:",e),null}}cleanup(){this.backgroundSyncInterval&&(clearTimeout(this.backgroundSyncInterval),this.backgroundSyncInterval=null),window.removeEventListener("online",this.handleOnlineStatusChange.bind(this)),window.removeEventListener("offline",this.handleOnlineStatusChange.bind(this))}}let Je=null;const Ke=e=>{Je=e&&e.id?new Ve(e):null},Ye=()=>Je;var Ge=n(579);const $e=(0,s.createContext)(),Qe=()=>(0,s.useContext)($e),Xe=e=>{let{children:t}=e;const[n,r]=(0,s.useState)(null),[a,i]=(0,s.useState)(!0);(0,s.useEffect)((()=>{(async()=>{try{const{data:{session:t},error:n}=await Pe.A.auth.getSession();if(n)console.error("Error getting session:",n),await Pe.A.auth.signOut(),r(null),Ke(null);else{var e;const n=null!==(e=null===t||void 0===t?void 0:t.user)&&void 0!==e?e:null;r(n),Ke(n)}}catch(t){console.error("Session error:",t),r(null),Ke(null)}finally{i(!1)}})();const{data:{subscription:e}}=Pe.A.auth.onAuthStateChange((async(e,t)=>{var n,s;console.log("Auth state changed:",e,null===t||void 0===t||null===(n=t.user)||void 0===n?void 0:n.email);const a=null!==(s=null===t||void 0===t?void 0:t.user)&&void 0!==s?s:null;if("SIGNED_OUT"===e){const e=[];for(let t=0;t<sessionStorage.length;t++){const n=sessionStorage.key(t);n&&n.startsWith("duplicateDetectionRun_")&&e.push(n)}e.forEach((e=>sessionStorage.removeItem(e))),r(null),Ke(null)}else"SIGNED_IN"===e?(r(a),Ke(a)):"TOKEN_REFRESHED"===e?r(a):"USER_UPDATED"===e&&(r(a),Ke(a));"TOKEN_REFRESHED"!==e||t||(console.warn("Token refresh failed, signing out user"),await Pe.A.auth.signOut(),r(null),Ke(null)),i(!1)}));return()=>e.unsubscribe()}),[]);const o=async()=>{try{const e=[];for(let n=0;n<sessionStorage.length;n++){const t=sessionStorage.key(n);t&&t.startsWith("duplicateDetectionRun_")&&e.push(t)}e.forEach((e=>sessionStorage.removeItem(e)));const{error:t}=await Pe.A.auth.signOut();if(t)throw t;r(null),Ke(null)}catch(e){console.error("Sign out error:",e),r(null),Ke(null)}},l={user:n,loading:a,signUp:async(e,t)=>{try{const{data:n,error:r}=await Pe.A.auth.signUp({email:e,password:t,options:{emailRedirectTo:"https://expense-tracker-cursor.vercel.app/dashboard"}});if(r)throw r;return n}catch(n){throw console.error("Signup error:",n),n}},signIn:async(e,t)=>{try{const{data:n,error:r}=await Pe.A.auth.signInWithPassword({email:e,password:t});if(r)throw r;return n}catch(n){throw console.error("Sign in error:",n),n}},signOut:o,resetPassword:async e=>{try{const{data:t,error:n}=await Pe.A.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(n)throw n;return t}catch(t){throw console.error("Reset password error:",t),t}},updatePassword:async e=>{try{const{data:t,error:n}=await Pe.A.auth.updateUser({password:e});if(n)throw n;return t}catch(t){throw console.error("Update password error:",t),t}},isSessionValid:async()=>{try{const{data:{session:e},error:t}=await Pe.A.auth.getSession();return!t&&e&&e.user}catch(e){return console.error("Session validation error:",e),!1}},refreshSession:async()=>{try{var e,t;const{data:n,error:s}=await Pe.A.auth.refreshSession();if(s)throw s;return r(null!==(e=null===(t=n.session)||void 0===t?void 0:t.user)&&void 0!==e?e:null),n.session}catch(n){throw console.error("Manual session refresh failed:",n),await o(),n}}};return(0,Ge.jsx)($e.Provider,{value:l,children:t})},Ze=()=>{const[e,t]=(0,s.useState)(""),[n,r]=(0,s.useState)(""),[a,i]=(0,s.useState)(""),{signIn:o,loading:l}=Qe(),c=ne();return(0,Ge.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:(0,Ge.jsxs)("div",{className:"max-w-md w-full space-y-8 bg-gray-800 p-8 rounded-lg shadow-md",children:[(0,Ge.jsx)("div",{children:(0,Ge.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-indigo-300",children:"Sign in to your account"})}),a&&(0,Ge.jsx)("div",{className:"bg-red-900/50 border border-red-800 text-red-300 px-4 py-3 rounded relative",role:"alert",children:(0,Ge.jsx)("span",{className:"block sm:inline",children:a})}),(0,Ge.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async t=>{if(t.preventDefault(),i(""),e&&n)try{const{error:t}=await o(e,n);if(t)throw new Error(t.message);c("/dashboard")}catch(r){i(r.message)}else i("Please fill in all fields")},children:[(0,Ge.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),(0,Ge.jsx)("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-700 bg-gray-700 placeholder-gray-500 text-white rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:e,onChange:e=>t(e.target.value)})]}),(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password"}),(0,Ge.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-700 bg-gray-700 placeholder-gray-500 text-white rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password",value:n,onChange:e=>r(e.target.value)})]})]}),(0,Ge.jsx)("div",{className:"flex items-center justify-between",children:(0,Ge.jsx)("div",{className:"text-sm",children:(0,Ge.jsx)(Te,{to:"/forgot-password",className:"font-medium text-indigo-400 hover:text-indigo-300",children:"Forgot your password?"})})}),(0,Ge.jsx)("div",{children:(0,Ge.jsx)("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Signing in...":"Sign in"})}),(0,Ge.jsx)("div",{className:"text-center",children:(0,Ge.jsxs)("p",{className:"text-sm text-gray-400",children:["Don't have an account?"," ",(0,Ge.jsx)(Te,{to:"/signup",className:"font-medium text-indigo-400 hover:text-indigo-300",children:"Sign up"})]})})]})]})})},et=()=>{const[e,t]=(0,s.useState)(""),[n,r]=(0,s.useState)(""),[a,i]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),[c,d]=(0,s.useState)(""),{signUp:u,loading:h}=Qe(),f=ne();return(0,Ge.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:(0,Ge.jsxs)("div",{className:"max-w-md w-full space-y-8 bg-gray-800 p-8 rounded-lg shadow-md",children:[(0,Ge.jsx)("div",{children:(0,Ge.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-indigo-300",children:"Create your account"})}),o&&(0,Ge.jsx)("div",{className:"bg-red-900/50 border border-red-800 text-red-300 px-4 py-3 rounded relative",role:"alert",children:(0,Ge.jsx)("span",{className:"block sm:inline",children:o})}),c&&(0,Ge.jsx)("div",{className:"bg-green-900/50 border border-green-800 text-green-300 px-4 py-3 rounded relative",role:"alert",children:(0,Ge.jsx)("span",{className:"block sm:inline",children:c})}),(0,Ge.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async t=>{if(t.preventDefault(),l(""),d(""),e&&n&&a)if(n===a)if(n.length<6)l("Password must be at least 6 characters");else try{const{error:t,user:r}=await u(e,n);if(t)throw new Error(t.message);r?(d("Registration successful! Please check your email to confirm your account."),setTimeout((()=>{f("/login")}),3e3)):d("Registration successful! Please check your email to confirm your account before logging in.")}catch(r){l(r.message)}else l("Passwords do not match");else l("Please fill in all fields")},children:[(0,Ge.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),(0,Ge.jsx)("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-700 bg-gray-700 placeholder-gray-500 text-white rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address",value:e,onChange:e=>t(e.target.value)})]}),(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password"}),(0,Ge.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-700 bg-gray-700 placeholder-gray-500 text-white focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password",value:n,onChange:e=>r(e.target.value)})]}),(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("label",{htmlFor:"confirm-password",className:"sr-only",children:"Confirm Password"}),(0,Ge.jsx)("input",{id:"confirm-password",name:"confirm-password",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-700 bg-gray-700 placeholder-gray-500 text-white rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Confirm Password",value:a,onChange:e=>i(e.target.value)})]})]}),(0,Ge.jsx)("div",{children:(0,Ge.jsx)("button",{type:"submit",disabled:h,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Creating account...":"Sign up"})}),(0,Ge.jsx)("div",{className:"text-center",children:(0,Ge.jsxs)("p",{className:"text-sm text-gray-400",children:["Already have an account?"," ",(0,Ge.jsx)(Te,{to:"/login",className:"font-medium text-indigo-400 hover:text-indigo-300",children:"Sign in"})]})})]})]})})},tt=()=>{const[e,t]=(0,s.useState)(""),[n,r]=(0,s.useState)(""),[a,i]=(0,s.useState)(""),{resetPassword:o,loading:l}=Qe();return(0,Ge.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:(0,Ge.jsxs)("div",{className:"max-w-md w-full space-y-8 bg-gray-800 p-8 rounded-lg shadow-md",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-indigo-300",children:"Reset your password"}),(0,Ge.jsx)("p",{className:"mt-2 text-center text-sm text-gray-400",children:"Enter your email address and we'll send you instructions to reset your password."})]}),n&&(0,Ge.jsx)("div",{className:"bg-red-900/50 border border-red-800 text-red-300 px-4 py-3 rounded relative",role:"alert",children:(0,Ge.jsx)("span",{className:"block sm:inline",children:n})}),a&&(0,Ge.jsx)("div",{className:"bg-green-900/50 border border-green-800 text-green-300 px-4 py-3 rounded relative",role:"alert",children:(0,Ge.jsx)("span",{className:"block sm:inline",children:a})}),(0,Ge.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async n=>{if(n.preventDefault(),r(""),i(""),e)try{const{error:n,success:r}=await o(e);if(n)throw new Error(n.message);r&&(i("Password reset instructions have been sent to your email."),t(""))}catch(s){r(s.message)}else r("Please enter your email address")},children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("label",{htmlFor:"email-address",className:"block text-sm font-medium text-gray-300",children:"Email address"}),(0,Ge.jsx)("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,className:"mt-1 appearance-none block w-full px-3 py-2 border border-gray-700 bg-gray-700 placeholder-gray-500 text-white rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Your email address",value:e,onChange:e=>t(e.target.value)})]}),(0,Ge.jsx)("div",{children:(0,Ge.jsx)("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Sending instructions...":"Reset Password"})}),(0,Ge.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ge.jsx)("div",{className:"text-sm",children:(0,Ge.jsx)(Te,{to:"/login",className:"font-medium text-indigo-400 hover:text-indigo-300",children:"Back to login"})}),(0,Ge.jsx)("div",{className:"text-sm",children:(0,Ge.jsx)(Te,{to:"/signup",className:"font-medium text-indigo-400 hover:text-indigo-300",children:"Create account"})})]})]})]})})},nt=()=>{const[e,t]=(0,s.useState)(""),[n,r]=(0,s.useState)(""),[a,i]=(0,s.useState)(""),[o,l]=(0,s.useState)(""),{updatePassword:c,loading:d}=Qe(),u=ne();return(0,Ge.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 py-12 px-4 sm:px-6 lg:px-8",children:(0,Ge.jsxs)("div",{className:"max-w-md w-full space-y-8 bg-gray-800 p-8 rounded-lg shadow-md",children:[(0,Ge.jsx)("div",{children:(0,Ge.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-indigo-300",children:"Set new password"})}),a&&(0,Ge.jsx)("div",{className:"bg-red-900/50 border border-red-800 text-red-300 px-4 py-3 rounded relative",role:"alert",children:(0,Ge.jsx)("span",{className:"block sm:inline",children:a})}),o&&(0,Ge.jsx)("div",{className:"bg-green-900/50 border border-green-800 text-green-300 px-4 py-3 rounded relative",role:"alert",children:(0,Ge.jsx)("span",{className:"block sm:inline",children:o})}),(0,Ge.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async t=>{if(t.preventDefault(),i(""),l(""),e&&n)if(e===n)if(e.length<6)i("Password must be at least 6 characters");else try{const{error:t,success:n}=await c(e);if(t)throw new Error(t.message);n&&(l("Password has been updated successfully."),setTimeout((()=>{u("/login")}),3e3))}catch(r){i(r.message)}else i("Passwords do not match");else i("Please fill in all fields")},children:[(0,Ge.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("label",{htmlFor:"password",className:"sr-only",children:"New Password"}),(0,Ge.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-700 bg-gray-700 placeholder-gray-500 text-white rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"New Password",value:e,onChange:e=>t(e.target.value)})]}),(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("label",{htmlFor:"confirm-password",className:"sr-only",children:"Confirm New Password"}),(0,Ge.jsx)("input",{id:"confirm-password",name:"confirm-password",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-700 bg-gray-700 placeholder-gray-500 text-white rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Confirm New Password",value:n,onChange:e=>r(e.target.value)})]})]}),(0,Ge.jsx)("div",{children:(0,Ge.jsx)("button",{type:"submit",disabled:d,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Updating password...":"Update Password"})}),(0,Ge.jsx)("div",{className:"text-center",children:(0,Ge.jsxs)("p",{className:"text-sm text-gray-400",children:["Remember your password?"," ",(0,Ge.jsx)(Te,{to:"/login",className:"font-medium text-indigo-400 hover:text-indigo-300",children:"Sign in"})]})})]})]})})},rt=e=>{let{children:t}=e;const{user:n,loading:r}=Qe(),s=ee();return r?(0,Ge.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900",children:(0,Ge.jsx)("div",{className:"text-indigo-400",children:(0,Ge.jsxs)("svg",{className:"animate-spin h-10 w-10 mr-3",viewBox:"0 0 24 24",children:[(0,Ge.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,Ge.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})}):n?t:(0,Ge.jsx)(ye,{to:"/login",state:{from:s},replace:!0})},st={checkStatus(){const e=qe.getStorageReport();return console.log("=== LocalStorage Status ==="),console.log("Total Usage: ".concat((e.totalUsage/1024).toFixed(2)," KB")),console.log("Usage Percentage: ".concat(e.usagePercentage.toFixed(1),"%")),console.log("Approaching Quota: ".concat(e.isApproachingQuota?"YES":"NO")),console.log("\n=== Largest Keys ==="),e.largestKeys.forEach(((e,t)=>{console.log("".concat(t+1,". ").concat(e.key,": ").concat((e.size/1024).toFixed(2)," KB"))})),e},listAll(){const e=qe.getAllKeySizes();return console.log("=== All LocalStorage Keys ==="),Object.entries(e).sort(((e,t)=>{let[,n]=e,[,r]=t;return r-n})).forEach((e=>{let[t,n]=e;console.log("".concat(t,": ").concat((n/1024).toFixed(2)," KB"))})),e},cleanKey(e){const t=qe.getKeySize(e);return localStorage.removeItem(e),console.log("Removed ".concat(e," (").concat((t/1024).toFixed(2)," KB)")),t},cleanup(){console.log("Performing cleanup...");const e=qe.getCurrentUsage();qe.performCleanup();const t=qe.getCurrentUsage(),n=e-t;return console.log("Cleanup complete. Freed ".concat((n/1024).toFixed(2)," KB")),{beforeUsage:e,afterUsage:t,saved:n}},emergencyCleanup(){console.log("Performing EMERGENCY cleanup...");const e=qe.emergencyCleanup();return console.log("Emergency cleanup complete. Freed ".concat((e.freedBytes/1024).toFixed(2)," KB")),e},showKey(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;const n=localStorage.getItem(e);return n?(console.log("=== ".concat(e," ===")),console.log("Size: ".concat((n.length/1024).toFixed(2)," KB")),n.length>t?(console.log("Content (first ".concat(t," chars):")),console.log(n.substring(0,t)+"...")):(console.log("Content:"),console.log(n)),n):(console.log('Key "'.concat(e,'" not found')),null)},testWrite(){const e="storage-test-"+Date.now(),t="x".repeat(1e3);try{return localStorage.setItem(e,t),localStorage.removeItem(e),console.log("\u2705 LocalStorage write test passed"),!0}catch(n){return console.error("\u274c LocalStorage write test failed:",n),!1}},estimateQuota(){const e="quota-test-"+Date.now();let t=0;const n=102400;try{for(;t<52428800;){const r="x".repeat(n);localStorage.setItem(e,r),t+=n}}catch(r){return localStorage.removeItem(e),console.log("Estimated quota: ~".concat((t/1024/1024).toFixed(1)," MB")),t}return localStorage.removeItem(e),console.log("Could not determine quota (exceeded test limit)"),null},immediateCleanup(){try{console.log("\ud83d\udea8 IMMEDIATE EMERGENCY CLEANUP STARTING...");const e=JSON.stringify(localStorage).length;console.log("Storage before cleanup:",e,"bytes");const t=["user","auth","settings","onboarding","supabase.auth.token","sb-mplrakcyrohgkqdhzpry-auth-token"],n=Object.keys(localStorage);let r=0;n.forEach((e=>{if(t.some((t=>e.includes(t))))console.log("\ud83d\udd12 Kept essential:",e);else try{localStorage.removeItem(e),r++,console.log("\u2705 Removed:",e)}catch(pu){console.warn("\u274c Failed to remove:",e,pu)}}));const s=JSON.stringify(localStorage).length,a=e-s;return console.log("\ud83c\udf89 IMMEDIATE CLEANUP COMPLETED!"),console.log("\ud83d\udcca Removed keys:",r),console.log("\ud83d\udcbe Storage after cleanup:",s,"bytes"),console.log("\ud83c\udd93 Freed up:",a,"bytes"),console.log("\ud83d\udcc8 Storage reduction:",(a/e*100).toFixed(1)+"%"),{success:!0,removedKeys:r,freedBytes:a,beforeUsage:e,afterUsage:s}}catch(e){return console.error("\u274c Immediate cleanup failed:",e),{success:!1,error:e.message}}},debugHardResetLocalStorage(){try{console.warn("\ud83d\udca3 DEBUG HARD RESET: Clearing almost all localStorage items...");const e=["supabase.auth.token","sb-mplrakcyrohgkqdhzpry-auth-token"];let t=0,n=0;for(let r=localStorage.length-1;r>=0;r--){const s=localStorage.key(r);s&&!e.some((e=>s.startsWith(e)))?(localStorage.removeItem(s),console.log("\ud83d\udca3 Removed: ".concat(s)),t++):s&&(console.log("\ud83d\udd12 Kept by debugHardReset: ".concat(s)),n++)}return console.warn("\ud83d\udca3 DEBUG HARD RESET COMPLETE: Removed ".concat(t," items, Kept ").concat(n," items.")),alert("DEBUG HARD RESET of localStorage complete. Please refresh the application."),{success:!0,removed:t,kept:n}}catch(e){return console.error("\ud83d\udca3 DEBUG HARD RESET FAILED:",e),alert("DEBUG HARD RESET FAILED. Check console."),{success:!1,error:e.message}}},nuclearCleanup(){try{console.warn("\u2622\ufe0f NUCLEAR CLEANUP: Clearing ALL localStorage except auth tokens...");const e={};for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);n&&(n.includes("auth")||n.includes("token")||n.includes("supabase"))&&(e[n]=localStorage.getItem(n),console.log("\ud83d\udd12 Preserving auth key: ".concat(n)))}return localStorage.clear(),Object.keys(e).forEach((t=>{localStorage.setItem(t,e[t]),console.log("\ud83d\udd04 Restored auth key: ".concat(t))})),console.warn("\u2622\ufe0f NUCLEAR CLEANUP COMPLETE - localStorage cleared except auth tokens"),{success:!0,preservedKeys:Object.keys(e)}}catch(e){return console.error("\u2622\ufe0f NUCLEAR CLEANUP FAILED:",e),{success:!1,error:e.message}}},quickDebug(){console.log("=== QUICK STORAGE DEBUG ===");const e=JSON.stringify(localStorage).length;console.log("Total localStorage usage: ".concat((e/1024).toFixed(2)," KB"));const t={};for(let s in localStorage)localStorage.hasOwnProperty(s)&&(t[s]=localStorage[s].length);const n=Object.entries(t).sort(((e,t)=>{let[,n]=e,[,r]=t;return r-n}));console.log("Top 5 largest keys:"),n.slice(0,5).forEach(((e,t)=>{let[n,r]=e;console.log("".concat(t+1,". ").concat(n,": ").concat((r/1024).toFixed(2)," KB"))}));try{const e="test-"+Date.now();localStorage.setItem(e,"test"),localStorage.removeItem(e),console.log("\u2705 localStorage write test: PASSED")}catch(r){console.log("\u274c localStorage write test: FAILED -",r.message)}return{usage:e,sizes:n}},arcBrowserCleanup(){try{var e;console.warn("\ud83c\udf10 ARC BROWSER CLEANUP: Performing aggressive cleanup for Arc browser...");if(!(navigator.userAgent.includes("Arc")||(null===(e=window.chrome)||void 0===e?void 0:e.webstore)||navigator.userAgent.includes("Chrome")))return console.log("Not Arc browser, using standard cleanup"),this.nuclearCleanup();const t=JSON.stringify(localStorage).length;console.log("Arc browser detected. Storage before cleanup: ".concat((t/1024).toFixed(2)," KB"));const n=["supabase.auth.token","sb-mplrakcyrohgkqdhzpry-auth-token","auth","user"];let r=0,s=0;const a=[];for(let e=0;e<localStorage.length;e++)a.push(localStorage.key(e));a.forEach((e=>{if(e&&!n.some((t=>e.includes(t))))try{localStorage.removeItem(e),console.log("\ud83c\udf10 Arc cleanup removed: ".concat(e)),r++}catch(pu){console.warn("\ud83c\udf10 Arc cleanup failed to remove: ".concat(e),pu)}else e&&(console.log("\ud83d\udd12 Arc cleanup kept: ".concat(e)),s++)}));const i=JSON.stringify(localStorage).length,o=t-i;return console.warn("\ud83c\udf10 ARC BROWSER CLEANUP COMPLETE!"),console.log("\ud83d\udcca Removed keys: ".concat(r)),console.log("\ud83d\udd12 Kept keys: ".concat(s)),console.log("\ud83d\udcbe Storage after cleanup: ".concat((i/1024).toFixed(2)," KB")),console.log("\ud83c\udd93 Freed up: ".concat((o/1024).toFixed(2)," KB")),console.log("\ud83d\udcc8 Storage reduction: ".concat((o/t*100).toFixed(1),"%")),o>102400&&(console.warn("\ud83c\udf10 Arc browser: Significant cleanup performed. Recommend page reload."),window.confirm("Arc browser cleanup complete. Reload page to ensure clean state?")&&window.location.reload()),{success:!0,browser:"Arc",removedKeys:r,keptKeys:s,freedBytes:o,beforeUsage:t,afterUsage:i}}catch(t){return console.error("\ud83c\udf10 Arc browser cleanup failed:",t),{success:!1,error:t.message}}}};"undefined"!==typeof window&&(window.StorageDebugger=st,console.log("StorageDebugger available globally. Try: StorageDebugger.checkStatus()"));function at(e){let{name:t,options:n,displayValue:r,value:a,onChange:i,defaultValue:o,"aria-label":l,id:c,children:d}=e;const[u,h]=(0,s.useState)(!1),[f,g]=(0,s.useState)(""),[p,m]=(0,s.useState)(o||a||null),[y,b]=(0,s.useState)(-1),x=(0,s.useRef)(null),v=(0,s.useRef)(null),w=null===n||void 0===n?void 0:n.filter((e=>r(e).toLowerCase().includes(f.toLowerCase())));(0,s.useEffect)((()=>{function e(e){x.current&&!x.current.contains(e.target)&&h(!1)}return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const _=e=>{m(e),h(!1),b(-1),i&&i({target:{name:t,value:e}})};return(0,s.useEffect)((()=>{if(y>=0&&v.current){const e=v.current.getElementsByTagName("li");e[y]&&e[y].scrollIntoView({block:"nearest"})}}),[y]),(0,Ge.jsxs)("div",{className:"relative",ref:x,children:[(0,Ge.jsxs)("button",{type:"button",id:c,className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white flex items-center justify-between focus:outline-none focus:ring-2 focus:ring-indigo-500",onClick:()=>h(!u),"aria-haspopup":"listbox","aria-expanded":u,"aria-labelledby":l,"aria-controls":"".concat(c,"-listbox"),onKeyDown:e=>{if(u)switch(e.key){case"ArrowDown":e.preventDefault(),b((e=>e<w.length-1?e+1:e));break;case"ArrowUp":e.preventDefault(),b((e=>e>0?e-1:e));break;case"Enter":case" ":e.preventDefault(),y>=0&&y<w.length&&_(w[y]);break;case"Escape":e.preventDefault(),h(!1),b(-1);break;case"Tab":h(!1),b(-1)}else"Enter"!==e.key&&" "!==e.key&&"ArrowDown"!==e.key||(e.preventDefault(),h(!0),b(0))},role:"combobox",children:[(0,Ge.jsx)("span",{children:p?r(p):"Select an option"}),(0,Ge.jsx)("svg",{className:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),u&&(0,Ge.jsxs)("div",{className:"absolute z-10 mt-1 w-full bg-gray-800 rounded-md shadow-lg max-h-60 overflow-auto",role:"presentation",children:[(0,Ge.jsx)("div",{className:"p-2",children:(0,Ge.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Search...",value:f,onChange:e=>g(e.target.value),onClick:e=>e.stopPropagation(),"aria-label":"Search options"})}),(0,Ge.jsx)("ul",{id:"".concat(c,"-listbox"),className:"py-1",role:"listbox",ref:v,"aria-label":l,children:null===w||void 0===w?void 0:w.map(((e,t)=>(0,Ge.jsx)("li",{role:"option",className:"px-4 py-2 hover:bg-gray-700 cursor-pointer text-gray-200 ".concat(y===t?"bg-gray-700":""),onClick:()=>_(e),"aria-selected":p===e,onMouseEnter:()=>b(t),children:d?d(e):r(e)},t)))})]}),(0,Ge.jsx)("input",{type:"hidden",name:t,value:p||""})]})}function it(e){let{children:t,htmlFor:n}=e;return(0,Ge.jsx)("label",{htmlFor:n,className:"block",children:t})}function ot(e){let{value:t,children:n}=e;return n}function lt(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}const ct={blue:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",green:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",yellow:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",indigo:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300",purple:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",pink:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300",lime:"bg-lime-100 text-lime-800 dark:bg-lime-900 dark:text-lime-300",rose:"bg-rose-100 text-rose-800 dark:bg-rose-900 dark:text-rose-300",teal:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-300",cyan:"bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-300",orange:"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300",gray:"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-300"},dt=e=>ct[e]||ct.gray,ut=e=>{for(const[t,n]of Object.entries(ct))if(n===e)return t;return"gray"},ht=Object.keys(ct),ft=["children","color","className","removable","onRemove"];const gt=function(e){let{children:t,color:n="gray",className:r="",removable:s,onRemove:a}=e,i=lt(e,ft);const o=dt(n);return(0,Ge.jsxs)("span",(0,Oe.A)((0,Oe.A)({className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(o," ").concat(r)},i),{},{children:[t,!0===s&&(0,Ge.jsxs)("button",{type:"button",className:"ml-1.5 -mr-1 h-4 w-4 rounded-full inline-flex items-center justify-center text-gray-400 hover:bg-gray-200 hover:text-gray-500 focus:outline-none focus:bg-gray-500 focus:text-white",onClick:e=>{e.stopPropagation(),"function"===typeof a&&a()},children:[(0,Ge.jsx)("span",{className:"sr-only",children:"Remove tag"}),(0,Ge.jsx)("svg",{className:"h-2 w-2",stroke:"currentColor",fill:"none",viewBox:"0 0 8 8",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeWidth:"1.5",d:"M1 1l6 6m0-6L1 7"})})]})]}))};function pt(){const[e,t]=(0,s.useState)(null),n=(0,s.useCallback)((e=>{const{title:n="Notification",message:r,type:s="info",showCancel:a=!1,onConfirm:i,confirmText:o="OK",cancelText:l="Cancel"}=e;t({title:n,message:r,type:s,showCancel:a,onConfirm:i,confirmText:o,cancelText:l,isOpen:!0})}),[]),r=(0,s.useCallback)((()=>{t(null)}),[]),a=(0,s.useCallback)((function(e){n({title:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Success",message:e,type:"success"})}),[n]),i=(0,s.useCallback)((function(e){n({title:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Error",message:e,type:"error"})}),[n]),o=(0,s.useCallback)((function(e){n({title:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Warning",message:e,type:"warning"})}),[n]),l=(0,s.useCallback)((function(e){n({title:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Information",message:e,type:"info"})}),[n]),c=(0,s.useCallback)((function(e,t){n({title:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Confirm",message:e,type:"warning",showCancel:!0,onConfirm:t,confirmText:"Yes",cancelText:"No"})}),[n]);return{notification:e,showNotification:n,hideNotification:r,showSuccess:a,showError:i,showWarning:o,showInfo:l,showConfirm:c}}let mt=null;const yt=()=>{mt?mt.markLocalChange():He("hasLocalChanges","true")},bt=(0,s.forwardRef)(((e,t)=>{let{selectedTags:n=[],availableTags:r=[],onChange:a,dbInitialized:i=!1,id:o}=e;const{user:l}=Qe(),[c,d]=(0,s.useState)(""),[u,h]=(0,s.useState)(!1),[f,g]=(0,s.useState)(""),[p,m]=(0,s.useState)([]),{showWarning:y}=pt();(0,s.useImperativeHandle)(t,(()=>({openAddTagModal:()=>h(!0),getTemporaryTags:()=>p})));const b=[...r,...p].filter((e=>e.name.toLowerCase().includes(c.toLowerCase()))).filter((e=>!n.some((t=>"object"===typeof t?t.id===e.id:t===e.id)))),x=e=>{const t=[...n,e];a(t),d("")},v=["blue","green","yellow","indigo","purple","pink","lime","rose","teal","cyan","orange"],w=(e,t)=>e.color||v[t%v.length],_=async()=>{if(!f.trim())return;const e=f.trim().toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,""),t=[...r,...p].find((t=>t.id===e||t.name.toLowerCase()===f.trim().toLowerCase()));if(t)return x(t),g(""),void h(!1);const n=["blue","green","yellow","indigo","purple","pink","lime","rose","teal","cyan","orange"],s=n[Math.floor(Math.random()*n.length)],a={id:e,name:f.trim(),color:s};try{if(i&&l)await Le.d6.add(a,l.id),x(a);else{m((e=>[...e,a]));try{const t=JSON.parse(localStorage.getItem("expense-tags")||"[]");t.some((t=>t.id===e||t.name.toLowerCase()===f.trim().toLowerCase()))||(t.push(a),He("expense-tags",JSON.stringify(t)))}catch(pu){console.error("Error saving tag to localStorage:",pu)}x(a)}yt()}catch(o){console.error("Error saving tag to database:",o),m((e=>[...e,a])),x(a),y("Tag saved locally only: ".concat(o.message))}g(""),h(!1)};return(0,Ge.jsxs)("div",{className:"space-y-4",children:[n.length>0&&(0,Ge.jsx)("div",{className:"p-4 flex flex-wrap gap-2 mb-4 border-b border-gray-700",children:n.map(((e,t)=>{const s=(e=>{if("object"===typeof e&&null!==e&&e.name)return e;const t=e,n=[...r,...p].find((e=>e.id===t));return n||{id:t,name:t}})(e);return s?(0,Ge.jsx)(gt,{color:w(s,t),removable:!0,onRemove:()=>(e=>{const t=n.filter((t=>"object"===typeof t?t.id!==e:t!==e));a(t)})("object"===typeof e?e.id:e),children:s.name},"object"===typeof e?e.id:e):null}))}),(0,Ge.jsx)("div",{className:"relative mb-4",children:(0,Ge.jsx)("input",{id:o,type:"text",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Search tags...",value:c,onChange:e=>d(e.target.value),"aria-label":"Search tags"})}),(0,Ge.jsx)("div",{className:"flex flex-wrap gap-2",children:0===b.length?(0,Ge.jsx)("p",{className:"text-gray-400 text-sm",children:"No matching tags found"}):b.map(((e,t)=>(0,Ge.jsx)(gt,{color:w(e,t),className:"cursor-pointer hover:opacity-80 transition-opacity",onClick:()=>x(e),children:e.name},e.id)))}),u&&(0,Ge.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-lg p-6 w-full max-w-md",children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white mb-4",children:"Add New Tag"}),(0,Ge.jsx)("div",{className:"mb-4",children:(0,Ge.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Tag name",value:f,onChange:e=>g(e.target.value),onKeyDown:e=>{"Enter"===e.key&&(e.preventDefault(),_())},autoFocus:!0})}),(0,Ge.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,Ge.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors duration-300",onClick:()=>{g(""),h(!1)},children:"Cancel"}),(0,Ge.jsx)("button",{type:"button",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors duration-300",onClick:_,disabled:!f.trim(),children:"Add Tag"})]})]})})]})}));function xt(e){let{selectedTags:t,availableTags:n,onChange:r,id:a="tags",dbInitialized:i=!1}=e;const o=s.useRef();return(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Ge.jsx)("label",{htmlFor:a,className:"font-medium text-gray-300",children:"Tags"}),(0,Ge.jsx)("button",{type:"button",className:"text-xs px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md transition-colors",onClick:()=>{var e;return null===(e=o.current)||void 0===e?void 0:e.openAddTagModal()},children:"+ Add New Tag"})]}),(0,Ge.jsx)(bt,{ref:o,selectedTags:t,availableTags:n,onChange:r,dbInitialized:i,id:a})]})}function vt(e){const t=e.getDay();return 0===t||6===t}function wt(e,t){return e&&t&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function _t(e){let{value:t,onChange:n,onClose:r,isSingleDatePicker:a=!1,pickerLabel:i="Select Date Range"}=e;const o=new Date,[l,c]=(0,s.useState)(o.getMonth()),[d,u]=(0,s.useState)(o.getFullYear()),[h,f]=(0,s.useState)("start"),[g,p]=(0,s.useState)({start:(null===t||void 0===t?void 0:t.start)||null,end:(null===t||void 0===t?void 0:t.end)||null}),m=function(e,t){return new Date(e,t+1,0).getDate()}(d,l),y=new Date(d,l,1).getDay();return(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 shadow-lg w-full max-w-xs mt-2",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Ge.jsx)("button",{type:"button",onClick:()=>{0===l?(c(11),u(d-1)):c(l-1)},className:"text-gray-400 hover:text-white px-2",children:"\u2190"}),(0,Ge.jsx)("span",{className:"text-white font-semibold",children:new Date(d,l).toLocaleString("en-US",{month:"long",year:"numeric"})}),(0,Ge.jsx)("button",{type:"button",onClick:()=>{11===l?(c(0),u(d+1)):c(l+1)},className:"text-gray-400 hover:text-white px-2",children:"\u2192"})]}),(0,Ge.jsx)("div",{className:"grid grid-cols-7 mb-1",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(((e,t)=>(0,Ge.jsx)("div",{className:"text-xs text-center ".concat(0===t||6===t?"text-red-400":"text-gray-300"),children:e},e)))}),(0,Ge.jsxs)("div",{className:"grid grid-cols-7 gap-1",children:[Array(y).fill(null).map(((e,t)=>(0,Ge.jsx)("div",{},t))),Array(m).fill(null).map(((e,r)=>{const s=new Date(d,l,r+1);let i=!1;a?void 0!==(null===t||void 0===t?void 0:t.start)?i=wt(s,g.start):void 0!==(null===t||void 0===t?void 0:t.end)&&(i=wt(s,g.end)):i=wt(s,g.start)||wt(s,g.end);const o=!a&&function(e,t,n){return!(!t||!n)&&e>=t&&e<=n}(s,g.start,g.end);return(0,Ge.jsx)("button",{className:"w-8 h-8 rounded-full text-sm flex items-center justify-center transition-colors\n                ".concat(vt(s)?"text-red-400":"text-gray-200","\n                ").concat(i?"bg-indigo-600 text-white":o?"bg-indigo-900 text-white":"hover:bg-gray-700","\n              "),onClick:()=>(e=>{a?(void 0!==(null===t||void 0===t?void 0:t.start)?(p({start:e,end:null}),n&&n({start:e,end:null})):void 0!==(null===t||void 0===t?void 0:t.end)&&(p({start:null,end:e}),n&&n({start:null,end:e})),f("start")):"start"===h?(p({start:e,end:null}),f("end")):(e<g.start?p({start:e,end:g.start}):p({start:g.start,end:e}),f("start"),n&&n({start:g.start,end:e<g.start?g.start:e}))})(s),type:"button",children:r+1},r)}))]}),(0,Ge.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,Ge.jsx)("div",{className:"text-xs text-gray-300",children:a?i:(0,Ge.jsxs)(Ge.Fragment,{children:[g.start?"Start: ".concat(g.start.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})):"Pick start date",(0,Ge.jsx)("br",{}),g.end?"End: ".concat(g.end.toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric",year:"numeric"})):g.start?"Pick end date":""]})}),(0,Ge.jsx)("button",{className:"px-3 py-1 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 text-xs",onClick:r,type:"button",children:"Done"})]})]})}function St(e){let{open:t,onClose:n,onSave:r}=e;const[a,i]=(0,s.useState)("");return t?(0,Ge.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-sm shadow-lg",children:[(0,Ge.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Add New Category"}),(0,Ge.jsx)("input",{type:"text",className:"w-full px-3 py-2 mb-4 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Category name",value:a,onChange:e=>i(e.target.value),autoFocus:!0}),(0,Ge.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,Ge.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-500",onClick:n,children:"Cancel"}),(0,Ge.jsx)("button",{type:"button",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",onClick:()=>{a.trim()&&(r(a.trim()),i(""))},children:"Save"})]})]})}):null}const kt=function(e){let{addExpense:t,dbInitialized:n=!1,onClose:r,onSubmit:a}=e;const{user:i}=Qe(),{showError:o,showWarning:l}=pt(),c=new Date,d=c.toISOString().slice(0,10),u=c.toTimeString().slice(0,5),[h,f]=(0,s.useState)({name:"",amount:"",category:"food",tags:[],walletId:null,wallet_id:null,is_income:!1,notes:"",photoUrl:"",date:d,time:u}),[g,p]=(0,s.useState)(""),[m,y]=(0,s.useState)(!1),b=(0,s.useRef)(null),[x,v]=(0,s.useState)(""),[w,_]=(0,s.useState)(null),[S,k]=(0,s.useState)(null),[j,N]=(0,s.useState)([{id:"food",name:"Food"},{id:"transportation",name:"Transportation"},{id:"entertainment",name:"Entertainment"},{id:"utilities",name:"Utilities"},{id:"housing",name:"Housing"},{id:"healthcare",name:"Healthcare"},{id:"other",name:"Other"}]),[E,C]=(0,s.useState)([{id:"essential",name:"Essential"},{id:"recurring",name:"Recurring"},{id:"emergency",name:"Emergency"},{id:"personal",name:"Personal"},{id:"work",name:"Work"}]),[T,A]=(0,s.useState)([{id:"cash",name:"Cash",type:"cash",balance:0},{id:"bank",name:"Bank Account",type:"bank",balance:0},{id:"credit",name:"Credit Card",type:"credit_card",balance:0},{id:"ewallet",name:"E-Wallet",type:"e_wallet",balance:0}]),[D,P]=(0,s.useState)(!1),[O,I]=(0,s.useState)(""),[L,M]=(0,s.useState)(""),[R,F]=(0,s.useState)(null),[B,z]=(0,s.useState)(!1);(0,s.useEffect)((()=>{(async()=>{try{if(n&&i){const e=await Le.T0.getAll(i.id);if(e.length>0){N(e);const t=e.find((e=>"food"===e.id))||e[0];t&&f((e=>(0,Oe.A)((0,Oe.A)({},e),{},{category:t.id})))}const t=await Le.d6.getAll(i.id);t.length>0&&C(t);const n=await Le.qF.getAll(i.id);if(n.length>0){A(n);const e=n[0];e&&f((t=>(0,Oe.A)((0,Oe.A)({},t),{},{walletId:e.id,wallet_id:e.id})))}else console.error("No wallets found in database"),l("Please add a wallet before adding transactions")}else U()}catch(g){console.error("Error loading form data:",g),U()}})()}),[n,i]);const U=()=>{const e=localStorage.getItem("expense-categories");if(e){const t=JSON.parse(e);N(t);const n=t.find((e=>"food"===e.id))||t[0];n&&f((e=>(0,Oe.A)((0,Oe.A)({},e),{},{category:n.id})))}const t=localStorage.getItem("expense-tags");t&&C(JSON.parse(t));const n=localStorage.getItem("wallets");if(n){const e=JSON.parse(n);A(e),e.length>0&&f((t=>(0,Oe.A)((0,Oe.A)({},t),{},{walletId:e[0].id,wallet_id:e[0].id})))}},W=e=>{const{name:t,value:n}=e.target;f((0,Oe.A)((0,Oe.A)({},h),{},{[t]:n}))},q=()=>{f((0,Oe.A)((0,Oe.A)({},h),{},{is_income:!h.is_income}))},H=j.filter((e=>e.name.toLowerCase().includes(L.toLowerCase()))),V=e=>e?ut(e.color):"gray",J=Array.from({length:24},((e,t)=>t.toString().padStart(2,"0"))),K=Array.from({length:60},((e,t)=>t.toString().padStart(2,"0"))),Y=(e,t)=>{const n="".concat(e,":").concat(t);f((e=>(0,Oe.A)((0,Oe.A)({},e),{},{time:n}))),k(null)};return(0,Ge.jsxs)("div",{className:"flex flex-col h-full",children:[(0,Ge.jsx)("div",{className:"sticky top-0 left-0 right-0 px-6 py-4 bg-gray-800 border-b border-gray-700 z-10",children:(0,Ge.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ge.jsxs)("h2",{className:"text-xl font-semibold text-indigo-300",children:["Add New ",h.is_income?"Income":"Expense"]}),(0,Ge.jsx)("button",{type:"button",className:"text-gray-400 hover:text-white p-2 rounded-full bg-gray-700 bg-opacity-50",onClick:r,children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,Ge.jsxs)("div",{className:"flex-1 overflow-auto px-6 py-4 pt-2",children:[(0,Ge.jsx)("div",{className:"mb-4",children:(0,Ge.jsxs)("div",{className:"flex bg-gray-700 rounded-md p-1",children:[(0,Ge.jsx)("button",{type:"button",className:"flex-1 py-2 px-4 rounded ".concat(h.is_income?"text-gray-300":"bg-indigo-600 text-white"),onClick:()=>!h.is_income||q(),children:"Expense"}),(0,Ge.jsx)("button",{type:"button",className:"flex-1 py-2 px-4 rounded ".concat(h.is_income?"bg-green-600 text-white":"text-gray-300"),onClick:()=>h.is_income||q(),children:"Income"})]})}),(0,Ge.jsxs)("form",{id:"expense-form",onSubmit:async e=>{var n;if(e.preventDefault(),null!==(n=h.name)&&void 0!==n&&n.trim())if(h.wallet_id)try{var s;y(!0);const e=h.time?"".concat(h.date,"T").concat(h.time,":00"):h.date,n={amount:parseFloat(h.amount),description:h.name.trim(),category:h.category,date:e,wallet_id:h.wallet_id,notes:(null===(s=h.notes)||void 0===s?void 0:s.trim())||"",tags:h.tags,is_income:Boolean(h.is_income),photo_url:h.photoUrl||null};console.log("Submitting expense data:",n);const i=a||t;if("function"!==typeof i)throw new Error("No submit function provided");await i(n),f({name:"",amount:"",category:h.category,tags:[],wallet_id:h.wallet_id,is_income:!1,notes:"",photoUrl:"",date:d,time:u}),v(""),b.current&&(b.current.value=""),"function"===typeof r&&r()}catch(g){console.error("Error adding expense:",g),p(g.message||"There was a problem saving your expense. Please try again.")}finally{y(!1)}else p("Please select a wallet");else p("Please enter a description")},children:[(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsxs)("label",{htmlFor:"name",className:"block mb-2 font-medium text-gray-200",children:[h.is_income?"Income":"Expense"," Name"]}),(0,Ge.jsx)("input",{type:"text",id:"name",name:"name",value:h.name,onChange:W,placeholder:h.is_income?"e.g., Salary":"e.g., Groceries",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0,autoFocus:!0})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("label",{htmlFor:"amount",className:"block mb-2 font-medium text-gray-200",children:"Amount (Rp)"}),(0,Ge.jsx)("input",{type:"number",id:"amount",name:"amount",value:h.amount,onChange:W,placeholder:"0",min:"0",step:"any",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),(0,Ge.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,Ge.jsxs)("div",{className:"relative",children:[(0,Ge.jsx)("label",{htmlFor:"date",className:"block mb-2 font-medium text-gray-200",children:"Date"}),(0,Ge.jsx)("input",{type:"text",id:"date",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer",placeholder:"Select date",readOnly:!0,value:h.date?(e=>{if(!e)return"";return("string"===typeof e?new Date(e):e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})(h.date):"",onClick:()=>_("date")}),"date"===w&&(0,Ge.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 date-picker-container",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Ge.jsx)("h4",{className:"text-lg font-medium text-white",children:"Select Date"}),(0,Ge.jsx)("button",{type:"button",className:"text-gray-400 hover:text-white p-2 rounded-full",onClick:()=>_(null),children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ge.jsx)(_t,{value:{start:h.date?new Date(h.date):null,end:null},onChange:e=>{if(e.start){const t=e.start.toISOString().slice(0,10);f((e=>(0,Oe.A)((0,Oe.A)({},e),{},{date:t})))}_(null)},onClose:()=>_(null),isSingleDatePicker:!0,pickerLabel:"Select Date"})]})})]}),(0,Ge.jsxs)("div",{className:"relative",children:[(0,Ge.jsx)("label",{htmlFor:"time",className:"block mb-2 font-medium text-gray-200",children:"Time"}),(0,Ge.jsx)("input",{type:"text",id:"time",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer",placeholder:"Select time",readOnly:!0,value:h.time?(e=>{if(!e)return"";const[t,n]=e.split(":"),r=parseInt(t,10),s=r>=12?"PM":"AM";return"".concat(r%12||12,":").concat(n," ").concat(s)})(h.time):"",onClick:()=>k("time")}),"time"===S&&(0,Ge.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 time-picker-container",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Ge.jsx)("h4",{className:"text-lg font-medium text-white",children:"Select Time"}),(0,Ge.jsx)("button",{type:"button",className:"text-gray-400 hover:text-white p-2 rounded-full",onClick:()=>k(null),children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ge.jsxs)("div",{className:"flex justify-between p-4 bg-gray-700 rounded-lg",children:[(0,Ge.jsxs)("div",{className:"space-y-2 max-h-60 overflow-y-auto w-1/2 pr-2",children:[(0,Ge.jsx)("p",{className:"text-xs font-semibold text-gray-300 px-2",children:"Hour"}),(0,Ge.jsx)("ul",{className:"space-y-1",children:J.map((e=>(0,Ge.jsx)("li",{children:(0,Ge.jsx)("button",{type:"button",className:"w-full text-left px-2 py-1 hover:bg-indigo-600 hover:text-white rounded ".concat(h.time&&h.time.split(":")[0]===e?"bg-indigo-600 text-white":"text-gray-300"),onClick:()=>Y(e,h.time.split(":")[1]||"00"),children:e})},"hour-".concat(e))))})]}),(0,Ge.jsxs)("div",{className:"space-y-2 max-h-60 overflow-y-auto w-1/2 pl-2",children:[(0,Ge.jsx)("p",{className:"text-xs font-semibold text-gray-300 px-2",children:"Minute"}),(0,Ge.jsx)("ul",{className:"space-y-1",children:K.map((e=>(0,Ge.jsx)("li",{children:(0,Ge.jsx)("button",{type:"button",className:"w-full text-left px-2 py-1 hover:bg-indigo-600 hover:text-white rounded ".concat(h.time&&h.time.split(":")[1]===e?"bg-indigo-600 text-white":"text-gray-300"),onClick:()=>Y(h.time.split(":")[0]||"00",e),children:e})},"minute-".concat(e))))})]})]})]})})]})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("label",{htmlFor:"wallet-select",className:"block mb-2 font-medium text-gray-200",children:"Wallet"}),T.length>0?(0,Ge.jsx)(at,{id:"wallet-select",name:"wallet",options:T,displayValue:e=>null===e||void 0===e?void 0:e.name,defaultValue:T.find((e=>e.id===h.walletId)),onChange:e=>{const t=null!==e&&void 0!==e&&e.target?e.target.value:e;if(console.log("Selected wallet:",t),!t||!t.id)return console.error("Invalid wallet selected:",t),void p("Please select a valid wallet");f((e=>(0,Oe.A)((0,Oe.A)({},e),{},{wallet_id:t.id})))},"aria-label":"Wallet",children:e=>(0,Ge.jsx)(ot,{value:e,children:(0,Ge.jsx)(it,{children:e.name})})}):(0,Ge.jsx)("div",{className:"text-gray-400 py-2",children:"No wallets available. Please add some in Wallets."})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Ge.jsx)("label",{htmlFor:"category-select",className:"font-medium text-gray-200",children:"Category"}),!D&&(0,Ge.jsx)("button",{type:"button",className:"text-xs px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md transition-colors",onClick:()=>{z(!0)},children:"+ New Category"})]}),D?(0,Ge.jsx)("input",{id:"category-select",type:"text",value:O,onChange:W,placeholder:"New category name",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",autoFocus:!0}):(0,Ge.jsxs)("div",{className:"space-y-4",children:[(0,Ge.jsx)("div",{className:"relative mb-4",children:(0,Ge.jsx)("input",{id:"category-select",type:"text",value:L,onChange:e=>{M(e.target.value)},placeholder:"Search categories...",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"})}),j.length>0?(0,Ge.jsx)("div",{className:"flex flex-wrap gap-2",children:H.map((e=>(0,Ge.jsx)(gt,{color:V(e),className:(null===R||void 0===R?void 0:R.id)===e.id?"ring-2 ring-offset-2 ring-offset-gray-800 ring-indigo-500":"",onClick:()=>(e=>{F(e),f((0,Oe.A)((0,Oe.A)({},h),{},{category:e.id})),M("")})(e),children:e.name},e.id)))}):(0,Ge.jsx)("div",{className:"text-gray-400 py-2",children:"No categories available. Please add some in Settings."})]})]}),(0,Ge.jsx)("div",{className:"mb-6",children:(0,Ge.jsx)(xt,{selectedTags:h.tags,availableTags:E,onChange:e=>{f((t=>(0,Oe.A)((0,Oe.A)({},t),{},{tags:e})))},id:"tags-select",dbInitialized:n})}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("label",{htmlFor:"notes",className:"block mb-2 font-medium text-gray-200",children:"Notes (optional)"}),(0,Ge.jsx)("textarea",{id:"notes",name:"notes",value:h.notes,onChange:W,placeholder:"Add any additional details...",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 min-h-[80px]"})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-300",children:"Photo (optional)"}),(0,Ge.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,Ge.jsxs)("button",{type:"button",onClick:()=>{b.current&&b.current.click()},className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-md hover:bg-gray-600 flex items-center",children:[(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})}),"Take Photo"]}),x&&(0,Ge.jsx)("button",{type:"button",onClick:()=>{f((0,Oe.A)((0,Oe.A)({},h),{},{photoUrl:""})),v(""),b.current&&(b.current.value="")},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Remove Photo"})]}),(0,Ge.jsx)("input",{type:"file",ref:b,accept:"image/*",capture:"camera",className:"hidden",onChange:e=>{const t=e.target.files[0];if(!t)return;if(!t.type.startsWith("image/"))return void o("Please select an image file");if(t.size>5242880)return void o("File size should be less than 5MB");const n=new FileReader;n.onload=e=>{f((0,Oe.A)((0,Oe.A)({},h),{},{photoUrl:e.target.result})),v(e.target.result)},n.readAsDataURL(t)}}),x&&(0,Ge.jsx)("div",{className:"mt-2 relative",children:(0,Ge.jsx)("img",{src:x,alt:"Preview",className:"max-h-48 rounded-md border border-gray-600"})})]}),(0,Ge.jsx)("div",{className:"pb-20"})]})]}),(0,Ge.jsx)("div",{className:"sticky bottom-0 left-0 right-0 px-6 py-4 bg-gray-800 border-t border-gray-700 shadow-lg",children:(0,Ge.jsx)("div",{className:"flex justify-end",children:(0,Ge.jsx)("button",{type:"submit",form:"expense-form",className:"px-6 py-2 text-white rounded-md transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 ".concat(h.is_income?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"),disabled:m,children:m?"Saving...":h.is_income?"Add Income":"Add Expense"})})}),(0,Ge.jsx)(St,{open:B,onClose:()=>{z(!1)},onSave:async e=>{if(!e.trim())return;const t=e.trim().toLowerCase(),r=j.find((e=>e.name.toLowerCase()===t));if(r)return F(r),f((e=>(0,Oe.A)((0,Oe.A)({},e),{},{category:r.id}))),void z(!1);const s={name:e.trim()};try{if(n&&i){const e=await Le.T0.add(s,i.id),t=await Le.T0.getAll(i.id);N(t),F(e),f((t=>(0,Oe.A)((0,Oe.A)({},t),{},{category:e.id})))}else{const t=(0,Oe.A)({id:e.trim().toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")},s),n=[...j,t];N(n),He("expense-categories",JSON.stringify(n)),F(t),f((e=>(0,Oe.A)((0,Oe.A)({},e),{},{category:t.id})))}z(!1)}catch(g){if(console.error("Error adding category:",g),g.message.includes("already exists")){if(n&&i){const e=await Le.T0.getAll(i.id);N(e);const n=e.find((e=>e.name.toLowerCase()===t));n&&(F(n),f((e=>(0,Oe.A)((0,Oe.A)({},e),{},{category:n.id}))))}z(!1)}else o("Failed to add category: ".concat(g.message))}}})]})};const jt=function(e){let{isOpen:t,onClose:n,title:r="Notification",message:s,type:a="info",showCancel:i=!1,onConfirm:o,confirmText:l="OK",cancelText:c="Cancel"}=e;if(!t)return null;const d=(()=>{switch(a){case"success":return{icon:(0,Ge.jsx)("svg",{className:"w-6 h-6 text-green-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),bgColor:"bg-green-100",iconBg:"bg-green-100",buttonColor:"bg-green-600 hover:bg-green-700 focus:ring-green-500"};case"warning":return{icon:(0,Ge.jsx)("svg",{className:"w-6 h-6 text-yellow-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),bgColor:"bg-yellow-100",iconBg:"bg-yellow-100",buttonColor:"bg-yellow-600 hover:bg-yellow-700 focus:ring-yellow-500"};case"error":return{icon:(0,Ge.jsx)("svg",{className:"w-6 h-6 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),bgColor:"bg-red-100",iconBg:"bg-red-100",buttonColor:"bg-red-600 hover:bg-red-700 focus:ring-red-500"};default:return{icon:(0,Ge.jsx)("svg",{className:"w-6 h-6 text-blue-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),bgColor:"bg-blue-100",iconBg:"bg-blue-100",buttonColor:"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500"}}})();return(0,Ge.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,Ge.jsxs)("div",{className:"relative max-w-md w-full bg-gray-800 rounded-lg shadow-xl",children:[(0,Ge.jsxs)("div",{className:"flex items-center p-6 pb-4",children:[(0,Ge.jsx)("div",{className:"flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ".concat(d.iconBg," bg-opacity-20"),children:d.icon}),(0,Ge.jsx)("div",{className:"ml-4",children:(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white",children:r})})]}),(0,Ge.jsx)("div",{className:"px-6 pb-6",children:(0,Ge.jsx)("div",{className:"text-gray-300 text-sm leading-relaxed whitespace-pre-line",children:s})}),(0,Ge.jsxs)("div",{className:"flex justify-end space-x-3 px-6 pb-6",children:[i&&(0,Ge.jsx)("button",{type:"button",className:"px-4 py-2 text-sm font-medium text-gray-300 bg-gray-700 border border-gray-600 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",onClick:()=>{n()},children:c}),(0,Ge.jsx)("button",{type:"button",className:"px-4 py-2 text-sm font-medium text-white rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 ".concat(d.buttonColor),onClick:()=>{o?o():n()},autoFocus:!0,children:l})]})]})})};const Nt=function(e){let{expense:t,onSave:n,onCancel:r,onDelete:a,dbInitialized:i=!1}=e;const{user:o}=Qe(),{notification:l,showError:c,showWarning:d,showConfirm:u,hideNotification:h}=pt(),[f,g]=(0,s.useState)({id:t.id,description:t.description||"",amount:t.amount||"",category:t.category||"other",tags:t.tags||[],wallet_id:t.wallet_id||null,is_income:t.is_income||!1,notes:t.notes||"",photoUrl:t.photo_url||"",date:t.date||(new Date).toISOString().slice(0,10),time:t.time||(new Date).toTimeString().slice(0,5)}),[p,m]=(0,s.useState)(""),[y,b]=(0,s.useState)(!1),x=(0,s.useRef)(null),[v,w]=(0,s.useState)(t.photo_url||""),[_,S]=(0,s.useState)(null),[k,j]=(0,s.useState)(null),[N,E]=(0,s.useState)([]),[C,T]=(0,s.useState)([]),[A,D]=(0,s.useState)([{id:"cash",name:"Cash",type:"cash",balance:0},{id:"bank",name:"Bank Account",type:"bank",balance:0},{id:"credit",name:"Credit Card",type:"credit_card",balance:0},{id:"ewallet",name:"E-Wallet",type:"e_wallet",balance:0}]),[P,O]=(0,s.useState)(!0),[I,L]=(0,s.useState)(!1),[M,R]=(0,s.useState)(""),[F,B]=(0,s.useState)(""),[z,U]=(0,s.useState)(N.find((e=>e.id===t.category))||null);(0,s.useEffect)((()=>{(async()=>{try{if(i&&o){const e=await Le.T0.getAll(o.id);if(e.length>0){E(e);const n=e.find((e=>e.id===t.category));n&&U(n)}const n=await Le.d6.getAll(o.id);n.length>0&&T(n);const r=await Le.qF.getAll(o.id);r.length>0&&(D(r),t.wallet_id?g((e=>(0,Oe.A)((0,Oe.A)({},e),{},{wallet_id:t.wallet_id}))):f.wallet_id||g((e=>(0,Oe.A)((0,Oe.A)({},e),{},{wallet_id:r[0].id}))))}else W(),q()}catch(p){console.error("Error loading data:",p),W(),q()}finally{O(!1)}})()}),[i,t.category,t.wallet_id,o,f.wallet_id]);const W=(0,s.useCallback)((()=>{const e=localStorage.getItem("expense-categories");e&&E(JSON.parse(e));const t=localStorage.getItem("wallets");if(t){const e=JSON.parse(t);D(e),f.wallet_id||g((t=>(0,Oe.A)((0,Oe.A)({},t),{},{wallet_id:e[0].id})))}}),[f.wallet_id]),q=(0,s.useCallback)((()=>{const e=localStorage.getItem("expense-tags");T(e?JSON.parse(e):[{id:"essential",name:"Essential"},{id:"recurring",name:"Recurring"},{id:"emergency",name:"Emergency"},{id:"personal",name:"Personal"},{id:"work",name:"Work"}])}),[]),H=e=>{const{name:t,value:n}=e.target;g((0,Oe.A)((0,Oe.A)({},f),{},{[t]:n}))},V=()=>{g((0,Oe.A)((0,Oe.A)({},f),{},{is_income:!f.is_income}))},J=async e=>{var s;if(e.preventDefault(),null!==(s=f.description)&&void 0!==s&&s.trim())try{var a;const e={id:t.id,amount:parseFloat(f.amount),description:f.description.trim(),category:f.category,date:f.date,wallet_id:f.wallet_id,notes:(null===(a=f.notes)||void 0===a?void 0:a.trim())||"",tags:f.tags,is_income:Boolean(f.is_income),photo_url:f.photoUrl||null};if(console.log("Submitting expense data:",e),"function"!==typeof n)throw new Error("No save function provided");await n(e),r()}catch(p){c("There was a problem saving your expense. Please try again.")}else c("Please enter a description")},K=Array.from({length:24},((e,t)=>t.toString().padStart(2,"0"))),Y=Array.from({length:60},((e,t)=>t.toString().padStart(2,"0"))),G=(e,t)=>{const n="".concat(e,":").concat(t);g((e=>(0,Oe.A)((0,Oe.A)({},e),{},{time:n}))),j(null)},$=N.filter((e=>e.name.toLowerCase().includes(F.toLowerCase()))),Q=e=>e?ut(e.color):"gray";return P?(0,Ge.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Ge.jsx)("div",{className:"bg-gray-800 rounded-lg shadow-lg p-6",children:(0,Ge.jsxs)("div",{className:"flex justify-center items-center",children:[(0,Ge.jsx)("div",{className:"text-indigo-400",children:(0,Ge.jsxs)("svg",{className:"animate-spin h-8 w-8 mr-3",viewBox:"0 0 24 24",children:[(0,Ge.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,Ge.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,Ge.jsx)("p",{className:"text-indigo-300",children:"Loading..."})]})})}):(0,Ge.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:[(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-lg w-full max-w-md flex flex-col h-[80vh]",children:[(0,Ge.jsx)("div",{className:"sticky top-0 left-0 right-0 px-6 py-4 bg-gray-800 border-b border-gray-700 z-10",children:(0,Ge.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ge.jsxs)("h2",{className:"text-xl font-semibold text-indigo-300",children:["Edit ",f.is_income?"Income":"Expense"]}),(0,Ge.jsx)("button",{type:"button",className:"text-gray-400 hover:text-white p-2 rounded-full bg-gray-700 bg-opacity-50",onClick:r,children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,Ge.jsxs)("div",{className:"p-6 pt-2 flex-1 overflow-auto",children:[(0,Ge.jsx)("div",{className:"mb-4",children:(0,Ge.jsxs)("div",{className:"flex bg-gray-700 rounded-md p-1",children:[(0,Ge.jsx)("button",{type:"button",className:"flex-1 py-2 px-4 rounded ".concat(f.is_income?"text-gray-300":"bg-indigo-600 text-white"),onClick:()=>!f.is_income||V(),children:"Expense"}),(0,Ge.jsx)("button",{type:"button",className:"flex-1 py-2 px-4 rounded ".concat(f.is_income?"bg-green-600 text-white":"text-gray-300"),onClick:()=>f.is_income||V(),children:"Income"})]})}),(0,Ge.jsxs)("form",{onSubmit:J,children:[(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsxs)("label",{htmlFor:"description",className:"block mb-2 font-medium text-gray-200",children:[f.is_income?"Income":"Expense"," Name"]}),(0,Ge.jsx)("input",{type:"text",id:"description",name:"description",value:f.description,onChange:H,className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("label",{htmlFor:"amount",className:"block mb-2 font-medium text-gray-200",children:"Amount (Rp)"}),(0,Ge.jsx)("input",{type:"number",id:"amount",name:"amount",value:f.amount,onChange:H,placeholder:"0",min:"0",step:"any",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),(0,Ge.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,Ge.jsxs)("div",{className:"relative",children:[(0,Ge.jsx)("label",{htmlFor:"date",className:"block mb-2 font-medium text-gray-200",children:"Date"}),(0,Ge.jsx)("input",{type:"text",id:"date",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer",placeholder:"Select date",readOnly:!0,value:f.date?(e=>{if(!e)return"";return("string"===typeof e?new Date(e):e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})(f.date):"",onClick:()=>S("date")}),"date"===_&&(0,Ge.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 date-picker-container",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Ge.jsx)("h4",{className:"text-lg font-medium text-white",children:"Select Date"}),(0,Ge.jsx)("button",{type:"button",className:"text-gray-400 hover:text-white p-2 rounded-full",onClick:()=>S(null),children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ge.jsx)(_t,{value:{start:f.date?new Date(f.date):null,end:null},onChange:e=>{if(e.start){const t=e.start.toISOString().slice(0,10);g((e=>(0,Oe.A)((0,Oe.A)({},e),{},{date:t})))}S(null)},onClose:()=>S(null),isSingleDatePicker:!0,pickerLabel:"Select Date"})]})})]}),(0,Ge.jsxs)("div",{className:"relative",children:[(0,Ge.jsx)("label",{htmlFor:"time",className:"block mb-2 font-medium text-gray-200",children:"Time"}),(0,Ge.jsx)("input",{type:"text",id:"time",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer",placeholder:"Select time",readOnly:!0,value:f.time?(e=>{if(!e)return"";const[t,n]=e.split(":"),r=parseInt(t,10),s=r>=12?"PM":"AM";return"".concat(r%12||12,":").concat(n," ").concat(s)})(f.time):"",onClick:()=>j("time")}),"time"===k&&(0,Ge.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 time-picker-container",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Ge.jsx)("h4",{className:"text-lg font-medium text-white",children:"Select Time"}),(0,Ge.jsx)("button",{type:"button",className:"text-gray-400 hover:text-white p-2 rounded-full",onClick:()=>j(null),children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ge.jsxs)("div",{className:"flex justify-between p-4 bg-gray-700 rounded-lg",children:[(0,Ge.jsxs)("div",{className:"space-y-2 max-h-60 overflow-y-auto w-1/2 pr-2",children:[(0,Ge.jsx)("p",{className:"text-xs font-semibold text-gray-300 px-2",children:"Hour"}),(0,Ge.jsx)("ul",{className:"space-y-1",children:K.map((e=>(0,Ge.jsx)("li",{children:(0,Ge.jsx)("button",{type:"button",className:"w-full text-left px-2 py-1 hover:bg-indigo-600 hover:text-white rounded ".concat(f.time&&f.time.split(":")[0]===e?"bg-indigo-600 text-white":"text-gray-300"),onClick:()=>G(e,f.time.split(":")[1]||"00"),children:e})},"hour-".concat(e))))})]}),(0,Ge.jsxs)("div",{className:"space-y-2 max-h-60 overflow-y-auto w-1/2 pl-2",children:[(0,Ge.jsx)("p",{className:"text-xs font-semibold text-gray-300 px-2",children:"Minute"}),(0,Ge.jsx)("ul",{className:"space-y-1",children:Y.map((e=>(0,Ge.jsx)("li",{children:(0,Ge.jsx)("button",{type:"button",className:"w-full text-left px-2 py-1 hover:bg-indigo-600 hover:text-white rounded ".concat(f.time&&f.time.split(":")[1]===e?"bg-indigo-600 text-white":"text-gray-300"),onClick:()=>G(f.time.split(":")[0]||"00",e),children:e})},"minute-".concat(e))))})]})]})]})})]})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("label",{htmlFor:"wallet-select",className:"block mb-2 font-medium text-gray-200",children:"Wallet"}),A.length>0?(0,Ge.jsx)(at,{id:"wallet-select",name:"wallet",options:A,displayValue:e=>null===e||void 0===e?void 0:e.name,defaultValue:A.find((e=>e.id===f.wallet_id)),onChange:e=>{const t=null!==e&&void 0!==e&&e.target?e.target.value:e;t&&t.id?g((e=>(0,Oe.A)((0,Oe.A)({},e),{},{wallet_id:t.id}))):console.error("Invalid wallet selected:",t)},"aria-label":"Select a wallet",children:e=>(0,Ge.jsxs)(ot,{value:e,children:[e.name," ",void 0!==e.balance?"($".concat(e.balance,")"):""]})}):(0,Ge.jsx)("div",{className:"text-gray-200 py-2",children:"No wallets available. Please add some in Wallets."})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,Ge.jsx)("label",{htmlFor:"category",className:"font-medium text-gray-200",children:"Category"}),!I&&(0,Ge.jsx)("button",{type:"button",className:"text-xs px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md transition-colors",onClick:()=>{L(!0)},children:"+ New Category"})]}),I?(0,Ge.jsx)("input",{type:"text",value:M,onChange:e=>{R(e.target.value)},placeholder:"New category name",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",autoFocus:!0}):(0,Ge.jsxs)("div",{className:"space-y-4",children:[(0,Ge.jsx)("div",{className:"relative mb-4",children:(0,Ge.jsx)("input",{type:"text",value:F,onChange:e=>{const t=e.target.value.toLowerCase();B(t)},placeholder:"Search categories...",className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"})}),N.length>0?(0,Ge.jsx)("div",{className:"flex flex-wrap gap-2",children:$.map((e=>(0,Ge.jsx)(gt,{color:Q(e),className:(null===z||void 0===z?void 0:z.id)===e.id?"ring-2 ring-offset-2 ring-offset-gray-800 ring-indigo-500":"",onClick:()=>(e=>{U(e),g((0,Oe.A)((0,Oe.A)({},f),{},{category:e.id})),B("")})(e),children:e.name},e.id)))}):(0,Ge.jsx)("div",{className:"text-gray-400 py-2",children:"No categories available. Please add some in Settings."})]})]}),(0,Ge.jsx)("div",{className:"mb-6",children:(0,Ge.jsx)(xt,{selectedTags:f.tags.map((e=>C.find((t=>t.id===e))||e)),availableTags:C,onChange:e=>{const t=e.map((e=>"object"===typeof e&&null!==e?e.id:e));g((e=>(0,Oe.A)((0,Oe.A)({},e),{},{tags:t})))},id:"tags",dbInitialized:i})}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("label",{htmlFor:"notes",className:"block mb-2 font-medium text-gray-200",children:"Notes (optional)"}),(0,Ge.jsx)("textarea",{id:"notes",name:"notes",value:f.notes,onChange:H,placeholder:"Add any additional details...",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 min-h-[80px]"})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-200",children:"Photo (optional)"}),(0,Ge.jsxs)("div",{className:"flex gap-2 mb-2",children:[(0,Ge.jsxs)("button",{type:"button",onClick:()=>{x.current&&x.current.click()},className:"px-4 py-2 bg-gray-700 text-gray-300 rounded-md hover:bg-gray-600 flex items-center",children:[(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})}),v?"Change Photo":"Take Photo"]}),v&&(0,Ge.jsx)("button",{type:"button",onClick:()=>{g((0,Oe.A)((0,Oe.A)({},f),{},{photoUrl:""})),w(""),x.current&&(x.current.value="")},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Remove Photo"})]}),(0,Ge.jsx)("input",{type:"file",ref:x,accept:"image/*",capture:"camera",className:"hidden",onChange:e=>{const t=e.target.files[0];if(!t)return;if(!t.type.startsWith("image/"))return void d("Please select an image file");if(t.size>5242880)return void d("File size should be less than 5MB");const n=new FileReader;n.onload=e=>{g((0,Oe.A)((0,Oe.A)({},f),{},{photoUrl:e.target.result})),w(e.target.result)},n.readAsDataURL(t)}}),v&&(0,Ge.jsx)("div",{className:"mt-2 relative",children:(0,Ge.jsx)("img",{src:v,alt:"Preview",className:"max-h-48 rounded-md border border-gray-600"})})]}),(0,Ge.jsx)("div",{className:"pb-20"})]})]}),(0,Ge.jsx)("div",{className:"sticky bottom-0 left-0 right-0 px-6 py-4 bg-gray-800 border-t border-gray-700 shadow-lg",children:(0,Ge.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ge.jsx)("button",{type:"button",onClick:()=>{u("Are you sure you want to delete this transaction? This action cannot be undone.",(()=>{a&&a(f.id),r&&r()}),"Delete Transaction")},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors duration-300",children:"Delete"}),(0,Ge.jsxs)("div",{className:"flex gap-2",children:[(0,Ge.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors duration-300",children:"Cancel"}),(0,Ge.jsx)("button",{onClick:J,className:"px-4 py-2 text-white rounded-md transition-colors duration-300 ".concat(f.is_income?"bg-green-600 hover:bg-green-700":"bg-indigo-600 hover:bg-indigo-700"),disabled:0===N.length,children:"Save Changes"})]})]})})]}),l&&(0,Ge.jsx)(jt,{isOpen:l.isOpen,onClose:h,title:l.title,message:l.message,type:l.type,showCancel:l.showCancel,onConfirm:l.onConfirm,confirmText:l.confirmText,cancelText:l.cancelText})]})},Et=["title","titleId"];function Ct(e,t){let{title:n,titleId:r}=e,a=lt(e,Et);return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},a),n?s.createElement("title",{id:r},n):null,s.createElement("path",{fillRule:"evenodd",d:"M11.78 5.22a.75.75 0 0 1 0 1.06L8.06 10l3.72 3.72a.75.75 0 1 1-1.06 1.06l-4.25-4.25a.75.75 0 0 1 0-1.06l4.25-4.25a.75.75 0 0 1 1.06 0Z",clipRule:"evenodd"}))}const Tt=s.forwardRef(Ct),At=["title","titleId"];function Dt(e,t){let{title:n,titleId:r}=e,a=lt(e,At);return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},a),n?s.createElement("title",{id:r},n):null,s.createElement("path",{fillRule:"evenodd",d:"M8.22 5.22a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 0 1 0 1.06l-4.25 4.25a.75.75 0 0 1-1.06-1.06L11.94 10 8.22 6.28a.75.75 0 0 1 0-1.06Z",clipRule:"evenodd"}))}const Pt=s.forwardRef(Dt);const Ot=function(e){let{currentPage:t,totalPages:n,totalItems:r,itemsPerPage:a,startIndex:i,endIndex:o,onPageChange:l,onItemsPerPageChange:c,itemsPerPageOptions:d=[5,10,20],showItemsPerPage:u=!0,showJumpToPage:h=!0,showResultsInfo:f=!0,className:g=""}=e;const p=()=>{t>1&&l(t-1)},m=()=>{t<n&&l(t+1)};return n<=1?null:(0,Ge.jsxs)("div",{className:"flex items-center justify-between border-t border-gray-700 bg-gray-800 px-4 py-3 sm:px-6 ".concat(g),children:[(0,Ge.jsxs)("div",{className:"flex flex-1 justify-between sm:hidden",children:[(0,Ge.jsx)("button",{onClick:p,disabled:1===t,className:"relative inline-flex items-center rounded-md border px-4 py-2 text-sm font-medium transition-colors ".concat(1===t?"border-gray-600 bg-gray-700 text-gray-500 cursor-not-allowed":"border-gray-600 bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"Previous"}),(0,Ge.jsx)("button",{onClick:m,disabled:t===n,className:"relative ml-3 inline-flex items-center rounded-md border px-4 py-2 text-sm font-medium transition-colors ".concat(t===n?"border-gray-600 bg-gray-700 text-gray-500 cursor-not-allowed":"border-gray-600 bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"Next"})]}),(0,Ge.jsxs)("div",{className:"hidden sm:flex sm:flex-1 sm:items-center sm:justify-between",children:[(0,Ge.jsxs)("div",{className:"flex items-center gap-6",children:[f&&(0,Ge.jsx)("div",{children:(0,Ge.jsxs)("p",{className:"text-sm text-gray-300",children:["Showing ",(0,Ge.jsx)("span",{className:"font-medium",children:i+1})," to"," ",(0,Ge.jsx)("span",{className:"font-medium",children:o})," of"," ",(0,Ge.jsx)("span",{className:"font-medium",children:r})," results"]})}),u&&c&&(0,Ge.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ge.jsx)("span",{className:"text-sm text-gray-400",children:"Show:"}),(0,Ge.jsx)("select",{value:a,onChange:e=>c(parseInt(e.target.value,10)),className:"bg-gray-700 text-white text-sm rounded-md px-2 py-1 border border-gray-600 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500",children:d.map((e=>(0,Ge.jsx)("option",{value:e,children:e},e)))}),(0,Ge.jsx)("span",{className:"text-sm text-gray-400",children:"per page"})]})]}),(0,Ge.jsxs)("div",{className:"flex items-center gap-4",children:[h&&(0,Ge.jsxs)("div",{className:"flex items-center gap-2",children:[(0,Ge.jsx)("span",{className:"text-sm text-gray-400",children:"Go to:"}),(0,Ge.jsx)("input",{type:"number",min:"1",max:n,value:t,onChange:e=>{const t=parseInt(e.target.value,10);t>=1&&t<=n&&l(t)},className:"w-16 bg-gray-700 text-white text-sm rounded-md px-2 py-1 border border-gray-600 focus:border-indigo-500 focus:outline-none focus:ring-1 focus:ring-indigo-500 text-center"}),(0,Ge.jsxs)("span",{className:"text-sm text-gray-400",children:["of ",n]})]}),(0,Ge.jsxs)("nav",{"aria-label":"Pagination",className:"isolate inline-flex -space-x-px rounded-md shadow-sm",children:[(0,Ge.jsxs)("button",{onClick:p,disabled:1===t,className:"relative inline-flex items-center rounded-l-md px-2 py-2 ring-1 ring-inset focus:z-20 focus:outline-offset-0 transition-colors ".concat(1===t?"text-gray-500 ring-gray-600 cursor-not-allowed":"text-gray-400 ring-gray-600 hover:bg-gray-700"),children:[(0,Ge.jsx)("span",{className:"sr-only",children:"Previous"}),(0,Ge.jsx)(Tt,{"aria-hidden":"true",className:"h-5 w-5"})]}),(()=>{const e=[];if(n<=5)for(let t=1;t<=n;t++)e.push(t);else{const r=Math.max(1,t-2),s=Math.min(n,t+2);r>1&&(e.push(1),r>2&&e.push("..."));for(let t=r;t<=s;t++)e.push(t);s<n&&(s<n-1&&e.push("..."),e.push(n))}return e})().map(((e,n)=>(0,Ge.jsx)(s.Fragment,{children:"..."===e?(0,Ge.jsx)("span",{className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold text-gray-400 ring-1 ring-inset ring-gray-600",children:"..."}):(0,Ge.jsx)("button",{onClick:()=>l(e),"aria-current":t===e?"page":void 0,className:"relative inline-flex items-center px-4 py-2 text-sm font-semibold ring-1 ring-inset focus:z-20 focus:outline-offset-0 transition-colors ".concat(t===e?"z-10 bg-indigo-600 text-white focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600":"text-gray-300 ring-gray-600 hover:bg-gray-700"," ").concat(""),children:e})},n))),(0,Ge.jsxs)("button",{onClick:m,disabled:t===n,className:"relative inline-flex items-center rounded-r-md px-2 py-2 ring-1 ring-inset focus:z-20 focus:outline-offset-0 transition-colors ".concat(t===n?"text-gray-500 ring-gray-600 cursor-not-allowed":"text-gray-400 ring-gray-600 hover:bg-gray-700"),children:[(0,Ge.jsx)("span",{className:"sr-only",children:"Next"}),(0,Ge.jsx)(Pt,{"aria-hidden":"true",className:"h-5 w-5"})]})]})]})]})]})};const It=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const[r,a]=(0,s.useState)(1),[i,o]=(0,s.useState)(t);(0,s.useEffect)((()=>{if(n){const r=localStorage.getItem("".concat(n,"_itemsPerPage")),s=localStorage.getItem("".concat(n,"_currentPage"));if(r&&o(parseInt(r,10)),s){const n=parseInt(s,10),i=Math.ceil(e.length/(r||t));n>=1&&n<=i&&a(n)}}}),[n,t,e.length]),(0,s.useEffect)((()=>{const t=Math.ceil(e.length/i);r>t&&t>0&&a(1)}),[e.length,i,r]);const l=(0,s.useMemo)((()=>{const t=e.length,n=Math.ceil(t/i),s=(r-1)*i,a=s+i;return{totalItems:t,totalPages:n,currentData:e.slice(s,a),startIndex:s,endIndex:Math.min(a,t),hasNextPage:r<n,hasPreviousPage:r>1}}),[e,r,i]),c=e=>{e>=1&&e<=l.totalPages&&(a(e),n&&localStorage.setItem("".concat(n,"_currentPage"),e.toString()))};return(0,Oe.A)((0,Oe.A)({currentPage:r,itemsPerPage:i},l),{},{goToPage:c,goToPreviousPage:()=>{l.hasPreviousPage&&c(r-1)},goToNextPage:()=>{l.hasNextPage&&c(r+1)},goToFirstPage:()=>{c(1)},goToLastPage:()=>{c(l.totalPages)},changeItemsPerPage:e=>{o(e),a(1),n&&(localStorage.setItem("".concat(n,"_itemsPerPage"),e.toString()),localStorage.setItem("".concat(n,"_currentPage"),"1"))},resetPagination:()=>{a(1),o(t),n&&(localStorage.removeItem("".concat(n,"_currentPage")),localStorage.removeItem("".concat(n,"_itemsPerPage")))},getPageNumbers:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5;const{totalPages:t}=l,n=[];if(t<=e)for(let r=1;r<=t;r++)n.push(r);else{const s=Math.max(1,r-Math.floor(e/2)),a=Math.min(t,s+e-1),i=Math.max(1,a-e+1);i>1&&(n.push(1),i>2&&n.push("..."));for(let e=i;e<=a;e++)n.push(e);a<t&&(a<t-1&&n.push("..."),n.push(t))}return n},isEmpty:0===l.totalItems,isFirstPage:1===r,isLastPage:r===l.totalPages,debug:{currentPage:r,itemsPerPage:i,totalItems:l.totalItems,totalPages:l.totalPages,startIndex:l.startIndex,endIndex:l.endIndex}})};const Lt=function(e){let{expenses:t,deleteExpense:n,updateExpense:r,dbInitialized:a=!1}=e;const[i,o]=(0,s.useState)(null),[l,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)([]),[h,f]=(0,s.useState)([{id:"food",name:"Food"},{id:"transportation",name:"Transportation"},{id:"entertainment",name:"Entertainment"},{id:"utilities",name:"Utilities"},{id:"housing",name:"Housing"},{id:"healthcare",name:"Healthcare"},{id:"other",name:"Other"}]),{user:g}=Qe(),p=It(t,10,"expenseList");if((0,s.useEffect)((()=>{(async()=>{try{if(a&&g){const e=await Le.d6.getAll(g.id);u(e);const t=await Le.T0.getAll(g.id);t.length>0&&f(t)}else{const e=localStorage.getItem("expense-tags");e&&u(JSON.parse(e));const t=localStorage.getItem("expense-categories");t&&f(JSON.parse(t))}}catch(e){console.error("Error loading tags and categories:",e)}})()}),[a,g]),0===t.length)return(0,Ge.jsx)("div",{className:"bg-gray-800 rounded-lg shadow-lg overflow-hidden",children:(0,Ge.jsx)("div",{className:"p-6 text-center",children:(0,Ge.jsx)("p",{className:"text-gray-400",children:"No expenses added yet. Start adding some!"})})});const m=e=>{const t=h.find((t=>t.id===e));return t?t.name:e},y=e=>{const t=d.find((t=>t.id===e));return t?t.color:"gray"},b=e=>{const t=d.find((t=>t.id===e));return t?t.name:e},x=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return e?e.length<=t?e:e.slice(0,t)+"...":""};return(0,Ge.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg mb-8",children:[(0,Ge.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,Ge.jsx)("h2",{className:"text-xl font-semibold text-indigo-300",children:"Transaction History"})}),(0,Ge.jsx)(Ot,{currentPage:p.currentPage,totalPages:p.totalPages,totalItems:p.totalItems,itemsPerPage:p.itemsPerPage,startIndex:p.startIndex,endIndex:p.endIndex,onPageChange:p.goToPage,onItemsPerPageChange:p.changeItemsPerPage,itemsPerPageOptions:[5,10,20],className:"mb-6 rounded-lg"}),(0,Ge.jsx)("div",{className:"space-y-4",children:p.currentData.map((e=>{return(0,Ge.jsxs)("div",{className:"p-4 rounded-lg mb-4 cursor-pointer transition-all duration-200 hover:bg-gray-600/50 ".concat(e.is_income?"bg-gray-700/80 border-l-4 border-green-500":"bg-gray-700/80 border-l-4 border-red-500"),onClick:()=>(e=>{o(e),c(!0)})(e),children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-start",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white mb-1",children:e.description}),(0,Ge.jsx)("div",{className:"text-sm text-gray-400",children:m(e.category)})]}),(0,Ge.jsxs)("div",{className:"font-medium mr-3 ".concat(e.is_income?"text-green-400":"text-red-400"),children:[e.is_income?"+":"-"," Rp ",(t=e.amount,new Intl.NumberFormat("id-ID").format(t))]})]}),e.notes&&(0,Ge.jsxs)("div",{className:"text-sm text-gray-400 mt-2 bg-gray-800/50 p-2 rounded",children:[(0,Ge.jsx)("span",{className:"font-medium text-xs text-gray-500 block mb-1",children:"Notes:"}),x(e.notes)]}),e.photoUrl&&(0,Ge.jsx)("div",{className:"mt-2",children:(0,Ge.jsx)("img",{src:e.photoUrl,alt:"Receipt",className:"h-16 rounded border border-gray-600 object-cover"})}),(0,Ge.jsxs)("div",{className:"flex justify-between items-center mt-3",children:[(0,Ge.jsx)("div",{className:"flex flex-wrap gap-1",children:e.tags&&e.tags.length>0&&(0,Ge.jsx)("div",{className:"flex flex-wrap gap-1",children:e.tags.map((t=>(0,Ge.jsx)(gt,{color:y(t),children:b(t)},"".concat(e.id,"-").concat(t))))})}),(0,Ge.jsx)("div",{className:"flex items-center",children:(0,Ge.jsx)("div",{className:"text-xs text-gray-500 mr-3",children:new Date(e.date).toLocaleDateString()})})]})]},e.id);var t}))}),(0,Ge.jsx)(Ot,{currentPage:p.currentPage,totalPages:p.totalPages,totalItems:p.totalItems,itemsPerPage:p.itemsPerPage,startIndex:p.startIndex,endIndex:p.endIndex,onPageChange:p.goToPage,onItemsPerPageChange:p.changeItemsPerPage,itemsPerPageOptions:[5,10,20],showItemsPerPage:!1,showJumpToPage:!1,className:"mt-6 rounded-lg"}),l&&i&&(0,Ge.jsx)(Nt,{expense:i,onSave:e=>{r(e),c(!1),o(null)},onCancel:()=>{c(!1),o(null)},onDelete:n,dbInitialized:a})]})};var Mt,Rt,Ft=9e15,Bt=1e9,zt="0123456789abcdef",Ut="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Wt="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",qt={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-Ft,maxE:Ft,crypto:!1},Ht=!0,Vt="[DecimalError] ",Jt=Vt+"Invalid argument: ",Kt=Vt+"Precision limit exceeded",Yt=Vt+"crypto unavailable",Gt="[object Decimal]",$t=Math.floor,Qt=Math.pow,Xt=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Zt=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,en=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,tn=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,nn=1e7,rn=Ut.length-1,sn=Wt.length-1,an={toStringTag:Gt};function on(e){var t,n,r,s=e.length-1,a="",i=e[0];if(s>0){for(a+=i,t=1;t<s;t++)(n=7-(r=e[t]+"").length)&&(a+=bn(n)),a+=r;(n=7-(r=(i=e[t])+"").length)&&(a+=bn(n))}else if(0===i)return"0";for(;i%10===0;)i/=10;return a+i}function ln(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Jt+e)}function cn(e,t,n,r){var s,a,i,o;for(a=e[0];a>=10;a/=10)--t;return--t<0?(t+=7,s=0):(s=Math.ceil((t+1)/7),t%=7),a=Qt(10,7-t),o=e[s]%a|0,null==r?t<3?(0==t?o=o/100|0:1==t&&(o=o/10|0),i=n<4&&99999==o||n>3&&49999==o||5e4==o||0==o):i=(n<4&&o+1==a||n>3&&o+1==a/2)&&(e[s+1]/a/100|0)==Qt(10,t-2)-1||(o==a/2||0==o)&&0==(e[s+1]/a/100|0):t<4?(0==t?o=o/1e3|0:1==t?o=o/100|0:2==t&&(o=o/10|0),i=(r||n<4)&&9999==o||!r&&n>3&&4999==o):i=((r||n<4)&&o+1==a||!r&&n>3&&o+1==a/2)&&(e[s+1]/a/1e3|0)==Qt(10,t-3)-1,i}function dn(e,t,n){for(var r,s,a=[0],i=0,o=e.length;i<o;){for(s=a.length;s--;)a[s]*=t;for(a[0]+=zt.indexOf(e.charAt(i++)),r=0;r<a.length;r++)a[r]>n-1&&(void 0===a[r+1]&&(a[r+1]=0),a[r+1]+=a[r]/n|0,a[r]%=n)}return a.reverse()}an.absoluteValue=an.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),hn(e)},an.ceil=function(){return hn(new this.constructor(this),this.e+1,2)},an.clampedTo=an.clamp=function(e,t){var n=this,r=n.constructor;if(e=new r(e),t=new r(t),!e.s||!t.s)return new r(NaN);if(e.gt(t))throw Error(Jt+t);return n.cmp(e)<0?e:n.cmp(t)>0?t:new r(n)},an.comparedTo=an.cmp=function(e){var t,n,r,s,a=this,i=a.d,o=(e=new a.constructor(e)).d,l=a.s,c=e.s;if(!i||!o)return l&&c?l!==c?l:i===o?0:!i^l<0?1:-1:NaN;if(!i[0]||!o[0])return i[0]?l:o[0]?-c:0;if(l!==c)return l;if(a.e!==e.e)return a.e>e.e^l<0?1:-1;for(t=0,n=(r=i.length)<(s=o.length)?r:s;t<n;++t)if(i[t]!==o[t])return i[t]>o[t]^l<0?1:-1;return r===s?0:r>s^l<0?1:-1},an.cosine=an.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(e,t){var n,r,s;if(t.isZero())return t;r=t.d.length,r<32?s=(1/Cn(4,n=Math.ceil(r/3))).toString():(n=16,s="2.3283064365386962890625e-10");e.precision+=n,t=En(e,1,t.times(s),new e(1));for(var a=n;a--;){var i=t.times(t);t=i.times(i).minus(i).times(8).plus(1)}return e.precision-=n,t}(r,Tn(r,n)),r.precision=e,r.rounding=t,hn(2==Rt||3==Rt?n.neg():n,e,t,!0)):new r(1):new r(NaN)},an.cubeRoot=an.cbrt=function(){var e,t,n,r,s,a,i,o,l,c,d=this,u=d.constructor;if(!d.isFinite()||d.isZero())return new u(d);for(Ht=!1,(a=d.s*Qt(d.s*d,1/3))&&Math.abs(a)!=1/0?r=new u(a.toString()):(n=on(d.d),(a=((e=d.e)-n.length+1)%3)&&(n+=1==a||-2==a?"0":"00"),a=Qt(n,1/3),e=$t((e+1)/3)-(e%3==(e<0?-1:2)),(r=new u(n=a==1/0?"5e"+e:(n=a.toExponential()).slice(0,n.indexOf("e")+1)+e)).s=d.s),i=(e=u.precision)+3;;)if(c=(l=(o=r).times(o).times(o)).plus(d),r=un(c.plus(d).times(o),c.plus(l),i+2,1),on(o.d).slice(0,i)===(n=on(r.d)).slice(0,i)){if("9999"!=(n=n.slice(i-3,i+1))&&(s||"4999"!=n)){+n&&(+n.slice(1)||"5"!=n.charAt(0))||(hn(r,e+1,1),t=!r.times(r).times(r).eq(d));break}if(!s&&(hn(o,e+1,0),o.times(o).times(o).eq(d))){r=o;break}i+=4,s=1}return Ht=!0,hn(r,e,u.rounding,t)},an.decimalPlaces=an.dp=function(){var e,t=this.d,n=NaN;if(t){if(n=7*((e=t.length-1)-$t(this.e/7)),e=t[e])for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n},an.dividedBy=an.div=function(e){return un(this,new this.constructor(e))},an.dividedToIntegerBy=an.divToInt=function(e){var t=this.constructor;return hn(un(this,new t(e),0,1,1),t.precision,t.rounding)},an.equals=an.eq=function(e){return 0===this.cmp(e)},an.floor=function(){return hn(new this.constructor(this),this.e+1,3)},an.greaterThan=an.gt=function(e){return this.cmp(e)>0},an.greaterThanOrEqualTo=an.gte=function(e){var t=this.cmp(e);return 1==t||0===t},an.hyperbolicCosine=an.cosh=function(){var e,t,n,r,s,a=this,i=a.constructor,o=new i(1);if(!a.isFinite())return new i(a.s?1/0:NaN);if(a.isZero())return o;n=i.precision,r=i.rounding,i.precision=n+Math.max(a.e,a.sd())+4,i.rounding=1,(s=a.d.length)<32?t=(1/Cn(4,e=Math.ceil(s/3))).toString():(e=16,t="2.3283064365386962890625e-10"),a=En(i,1,a.times(t),new i(1),!0);for(var l,c=e,d=new i(8);c--;)l=a.times(a),a=o.minus(l.times(d.minus(l.times(d))));return hn(a,i.precision=n,i.rounding=r,!0)},an.hyperbolicSine=an.sinh=function(){var e,t,n,r,s=this,a=s.constructor;if(!s.isFinite()||s.isZero())return new a(s);if(t=a.precision,n=a.rounding,a.precision=t+Math.max(s.e,s.sd())+4,a.rounding=1,(r=s.d.length)<3)s=En(a,2,s,s,!0);else{e=(e=1.4*Math.sqrt(r))>16?16:0|e,s=En(a,2,s=s.times(1/Cn(5,e)),s,!0);for(var i,o=new a(5),l=new a(16),c=new a(20);e--;)i=s.times(s),s=s.times(o.plus(i.times(l.times(i).plus(c))))}return a.precision=t,a.rounding=n,hn(s,t,n,!0)},an.hyperbolicTangent=an.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,un(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)},an.inverseCosine=an.acos=function(){var e=this,t=e.constructor,n=e.abs().cmp(1),r=t.precision,s=t.rounding;return-1!==n?0===n?e.isNeg()?mn(t,r,s):new t(0):new t(NaN):e.isZero()?mn(t,r+4,s).times(.5):(t.precision=r+6,t.rounding=1,e=new t(1).minus(e).div(e.plus(1)).sqrt().atan(),t.precision=r,t.rounding=s,e.times(2))},an.inverseHyperbolicCosine=an.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,Ht=!1,n=n.times(n).minus(1).sqrt().plus(n),Ht=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)},an.inverseHyperbolicSine=an.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,Ht=!1,n=n.times(n).plus(1).sqrt().plus(n),Ht=!0,r.precision=e,r.rounding=t,n.ln())},an.inverseHyperbolicTangent=an.atanh=function(){var e,t,n,r,s=this,a=s.constructor;return s.isFinite()?s.e>=0?new a(s.abs().eq(1)?s.s/0:s.isZero()?s:NaN):(e=a.precision,t=a.rounding,r=s.sd(),Math.max(r,e)<2*-s.e-1?hn(new a(s),e,t,!0):(a.precision=n=r-s.e,s=un(s.plus(1),new a(1).minus(s),n+e,1),a.precision=e+4,a.rounding=1,s=s.ln(),a.precision=e,a.rounding=t,s.times(.5))):new a(NaN)},an.inverseSine=an.asin=function(){var e,t,n,r,s=this,a=s.constructor;return s.isZero()?new a(s):(t=s.abs().cmp(1),n=a.precision,r=a.rounding,-1!==t?0===t?((e=mn(a,n+4,r).times(.5)).s=s.s,e):new a(NaN):(a.precision=n+6,a.rounding=1,s=s.div(new a(1).minus(s.times(s)).sqrt().plus(1)).atan(),a.precision=n,a.rounding=r,s.times(2)))},an.inverseTangent=an.atan=function(){var e,t,n,r,s,a,i,o,l,c=this,d=c.constructor,u=d.precision,h=d.rounding;if(c.isFinite()){if(c.isZero())return new d(c);if(c.abs().eq(1)&&u+4<=sn)return(i=mn(d,u+4,h).times(.25)).s=c.s,i}else{if(!c.s)return new d(NaN);if(u+4<=sn)return(i=mn(d,u+4,h).times(.5)).s=c.s,i}for(d.precision=o=u+10,d.rounding=1,e=n=Math.min(28,o/7+2|0);e;--e)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(Ht=!1,t=Math.ceil(o/7),r=1,l=c.times(c),i=new d(c),s=c;-1!==e;)if(s=s.times(l),a=i.minus(s.div(r+=2)),s=s.times(l),void 0!==(i=a.plus(s.div(r+=2))).d[t])for(e=t;i.d[e]===a.d[e]&&e--;);return n&&(i=i.times(2<<n-1)),Ht=!0,hn(i,d.precision=u,d.rounding=h,!0)},an.isFinite=function(){return!!this.d},an.isInteger=an.isInt=function(){return!!this.d&&$t(this.e/7)>this.d.length-2},an.isNaN=function(){return!this.s},an.isNegative=an.isNeg=function(){return this.s<0},an.isPositive=an.isPos=function(){return this.s>0},an.isZero=function(){return!!this.d&&0===this.d[0]},an.lessThan=an.lt=function(e){return this.cmp(e)<0},an.lessThanOrEqualTo=an.lte=function(e){return this.cmp(e)<1},an.logarithm=an.log=function(e){var t,n,r,s,a,i,o,l,c=this,d=c.constructor,u=d.precision,h=d.rounding;if(null==e)e=new d(10),t=!0;else{if(n=(e=new d(e)).d,e.s<0||!n||!n[0]||e.eq(1))return new d(NaN);t=e.eq(10)}if(n=c.d,c.s<0||!n||!n[0]||c.eq(1))return new d(n&&!n[0]?-1/0:1!=c.s?NaN:n?0:1/0);if(t)if(n.length>1)a=!0;else{for(s=n[0];s%10===0;)s/=10;a=1!==s}if(Ht=!1,i=Sn(c,o=u+5),r=t?pn(d,o+10):Sn(e,o),cn((l=un(i,r,o,1)).d,s=u,h))do{if(i=Sn(c,o+=10),r=t?pn(d,o+10):Sn(e,o),l=un(i,r,o,1),!a){+on(l.d).slice(s+1,s+15)+1==1e14&&(l=hn(l,u+1,0));break}}while(cn(l.d,s+=10,h));return Ht=!0,hn(l,u,h)},an.minus=an.sub=function(e){var t,n,r,s,a,i,o,l,c,d,u,h,f=this,g=f.constructor;if(e=new g(e),!f.d||!e.d)return f.s&&e.s?f.d?e.s=-e.s:e=new g(e.d||f.s!==e.s?f:NaN):e=new g(NaN),e;if(f.s!=e.s)return e.s=-e.s,f.plus(e);if(c=f.d,h=e.d,o=g.precision,l=g.rounding,!c[0]||!h[0]){if(h[0])e.s=-e.s;else{if(!c[0])return new g(3===l?-0:0);e=new g(f)}return Ht?hn(e,o,l):e}if(n=$t(e.e/7),d=$t(f.e/7),c=c.slice(),a=d-n){for((u=a<0)?(t=c,a=-a,i=h.length):(t=h,n=d,i=c.length),a>(r=Math.max(Math.ceil(o/7),i)+2)&&(a=r,t.length=1),t.reverse(),r=a;r--;)t.push(0);t.reverse()}else{for((u=(r=c.length)<(i=h.length))&&(i=r),r=0;r<i;r++)if(c[r]!=h[r]){u=c[r]<h[r];break}a=0}for(u&&(t=c,c=h,h=t,e.s=-e.s),i=c.length,r=h.length-i;r>0;--r)c[i++]=0;for(r=h.length;r>a;){if(c[--r]<h[r]){for(s=r;s&&0===c[--s];)c[s]=nn-1;--c[s],c[r]+=nn}c[r]-=h[r]}for(;0===c[--i];)c.pop();for(;0===c[0];c.shift())--n;return c[0]?(e.d=c,e.e=gn(c,n),Ht?hn(e,o,l):e):new g(3===l?-0:0)},an.modulo=an.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?hn(new r(n),r.precision,r.rounding):(Ht=!1,9==r.modulo?(t=un(n,e.abs(),0,3,1)).s*=e.s:t=un(n,e,0,r.modulo,1),t=t.times(e),Ht=!0,n.minus(t))},an.naturalExponential=an.exp=function(){return _n(this)},an.naturalLogarithm=an.ln=function(){return Sn(this)},an.negated=an.neg=function(){var e=new this.constructor(this);return e.s=-e.s,hn(e)},an.plus=an.add=function(e){var t,n,r,s,a,i,o,l,c,d,u=this,h=u.constructor;if(e=new h(e),!u.d||!e.d)return u.s&&e.s?u.d||(e=new h(e.d||u.s===e.s?u:NaN)):e=new h(NaN),e;if(u.s!=e.s)return e.s=-e.s,u.minus(e);if(c=u.d,d=e.d,o=h.precision,l=h.rounding,!c[0]||!d[0])return d[0]||(e=new h(u)),Ht?hn(e,o,l):e;if(a=$t(u.e/7),r=$t(e.e/7),c=c.slice(),s=a-r){for(s<0?(n=c,s=-s,i=d.length):(n=d,r=a,i=c.length),s>(i=(a=Math.ceil(o/7))>i?a+1:i+1)&&(s=i,n.length=1),n.reverse();s--;)n.push(0);n.reverse()}for((i=c.length)-(s=d.length)<0&&(s=i,n=d,d=c,c=n),t=0;s;)t=(c[--s]=c[s]+d[s]+t)/nn|0,c[s]%=nn;for(t&&(c.unshift(t),++r),i=c.length;0==c[--i];)c.pop();return e.d=c,e.e=gn(c,r),Ht?hn(e,o,l):e},an.precision=an.sd=function(e){var t,n=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(Jt+e);return n.d?(t=yn(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t},an.round=function(){var e=this,t=e.constructor;return hn(new t(e),e.e+1,t.rounding)},an.sine=an.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+7,r.rounding=1,n=function(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:En(e,2,t,t);n=(n=1.4*Math.sqrt(r))>16?16:0|n,t=t.times(1/Cn(5,n)),t=En(e,2,t,t);for(var s,a=new e(5),i=new e(16),o=new e(20);n--;)s=t.times(t),t=t.times(a.plus(s.times(i.times(s).minus(o))));return t}(r,Tn(r,n)),r.precision=e,r.rounding=t,hn(Rt>2?n.neg():n,e,t,!0)):new r(NaN)},an.squareRoot=an.sqrt=function(){var e,t,n,r,s,a,i=this,o=i.d,l=i.e,c=i.s,d=i.constructor;if(1!==c||!o||!o[0])return new d(!c||c<0&&(!o||o[0])?NaN:o?i:1/0);for(Ht=!1,0==(c=Math.sqrt(+i))||c==1/0?(((t=on(o)).length+l)%2==0&&(t+="0"),c=Math.sqrt(t),l=$t((l+1)/2)-(l<0||l%2),r=new d(t=c==1/0?"5e"+l:(t=c.toExponential()).slice(0,t.indexOf("e")+1)+l)):r=new d(c.toString()),n=(l=d.precision)+3;;)if(r=(a=r).plus(un(i,a,n+2,1)).times(.5),on(a.d).slice(0,n)===(t=on(r.d)).slice(0,n)){if("9999"!=(t=t.slice(n-3,n+1))&&(s||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(hn(r,l+1,1),e=!r.times(r).eq(i));break}if(!s&&(hn(a,l+1,0),a.times(a).eq(i))){r=a;break}n+=4,s=1}return Ht=!0,hn(r,l,d.rounding,e)},an.tangent=an.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,(n=n.sin()).s=1,n=un(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,hn(2==Rt||4==Rt?n.neg():n,e,t,!0)):new r(NaN)},an.times=an.mul=function(e){var t,n,r,s,a,i,o,l,c,d=this,u=d.constructor,h=d.d,f=(e=new u(e)).d;if(e.s*=d.s,!h||!h[0]||!f||!f[0])return new u(!e.s||h&&!h[0]&&!f||f&&!f[0]&&!h?NaN:h&&f?0*e.s:e.s/0);for(n=$t(d.e/7)+$t(e.e/7),(l=h.length)<(c=f.length)&&(a=h,h=f,f=a,i=l,l=c,c=i),a=[],r=i=l+c;r--;)a.push(0);for(r=c;--r>=0;){for(t=0,s=l+r;s>r;)o=a[s]+f[r]*h[s-r-1]+t,a[s--]=o%nn|0,t=o/nn|0;a[s]=(a[s]+t)%nn|0}for(;!a[--i];)a.pop();return t?++n:a.shift(),e.d=a,e.e=gn(a,n),Ht?hn(e,u.precision,u.rounding):e},an.toBinary=function(e,t){return An(this,2,e,t)},an.toDecimalPlaces=an.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),void 0===e?n:(ln(e,0,Bt),void 0===t?t=r.rounding:ln(t,0,8),hn(n,e+n.e+1,t))},an.toExponential=function(e,t){var n,r=this,s=r.constructor;return void 0===e?n=fn(r,!0):(ln(e,0,Bt),void 0===t?t=s.rounding:ln(t,0,8),n=fn(r=hn(new s(r),e+1,t),!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n},an.toFixed=function(e,t){var n,r,s=this,a=s.constructor;return void 0===e?n=fn(s):(ln(e,0,Bt),void 0===t?t=a.rounding:ln(t,0,8),n=fn(r=hn(new a(s),e+s.e+1,t),!1,e+r.e+1)),s.isNeg()&&!s.isZero()?"-"+n:n},an.toFraction=function(e){var t,n,r,s,a,i,o,l,c,d,u,h,f=this,g=f.d,p=f.constructor;if(!g)return new p(f);if(c=n=new p(1),r=l=new p(0),i=(a=(t=new p(r)).e=yn(g)-f.e-1)%7,t.d[0]=Qt(10,i<0?7+i:i),null==e)e=a>0?t:c;else{if(!(o=new p(e)).isInt()||o.lt(c))throw Error(Jt+o);e=o.gt(t)?a>0?t:c:o}for(Ht=!1,o=new p(on(g)),d=p.precision,p.precision=a=7*g.length*2;u=un(o,t,0,1,1),1!=(s=n.plus(u.times(r))).cmp(e);)n=r,r=s,s=c,c=l.plus(u.times(s)),l=s,s=t,t=o.minus(u.times(s)),o=s;return s=un(e.minus(n),r,0,1,1),l=l.plus(s.times(c)),n=n.plus(s.times(r)),l.s=c.s=f.s,h=un(c,r,a,1).minus(f).abs().cmp(un(l,n,a,1).minus(f).abs())<1?[c,r]:[l,n],p.precision=d,Ht=!0,h},an.toHexadecimal=an.toHex=function(e,t){return An(this,16,e,t)},an.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),null==e){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),void 0===t?t=r.rounding:ln(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(Ht=!1,n=un(n,e,0,t,1).times(e),Ht=!0,hn(n)):(e.s=n.s,n=e),n},an.toNumber=function(){return+this},an.toOctal=function(e,t){return An(this,8,e,t)},an.toPower=an.pow=function(e){var t,n,r,s,a,i,o=this,l=o.constructor,c=+(e=new l(e));if(!o.d||!e.d||!o.d[0]||!e.d[0])return new l(Qt(+o,c));if((o=new l(o)).eq(1))return o;if(r=l.precision,a=l.rounding,e.eq(1))return hn(o,r,a);if((t=$t(e.e/7))>=e.d.length-1&&(n=c<0?-c:c)<=9007199254740991)return s=xn(l,o,n,r),e.s<0?new l(1).div(s):hn(s,r,a);if((i=o.s)<0){if(t<e.d.length-1)return new l(NaN);if(0==(1&e.d[t])&&(i=1),0==o.e&&1==o.d[0]&&1==o.d.length)return o.s=i,o}return(t=0!=(n=Qt(+o,c))&&isFinite(n)?new l(n+"").e:$t(c*(Math.log("0."+on(o.d))/Math.LN10+o.e+1)))>l.maxE+1||t<l.minE-1?new l(t>0?i/0:0):(Ht=!1,l.rounding=o.s=1,n=Math.min(12,(t+"").length),(s=_n(e.times(Sn(o,r+n)),r)).d&&cn((s=hn(s,r+5,1)).d,r,a)&&(t=r+10,+on((s=hn(_n(e.times(Sn(o,t+n)),t),t+5,1)).d).slice(r+1,r+15)+1==1e14&&(s=hn(s,r+1,0))),s.s=i,Ht=!0,l.rounding=a,hn(s,r,a))},an.toPrecision=function(e,t){var n,r=this,s=r.constructor;return void 0===e?n=fn(r,r.e<=s.toExpNeg||r.e>=s.toExpPos):(ln(e,1,Bt),void 0===t?t=s.rounding:ln(t,0,8),n=fn(r=hn(new s(r),e,t),e<=r.e||r.e<=s.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n},an.toSignificantDigits=an.toSD=function(e,t){var n=this.constructor;return void 0===e?(e=n.precision,t=n.rounding):(ln(e,1,Bt),void 0===t?t=n.rounding:ln(t,0,8)),hn(new n(this),e,t)},an.toString=function(){var e=this,t=e.constructor,n=fn(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n},an.truncated=an.trunc=function(){return hn(new this.constructor(this),this.e+1,1)},an.valueOf=an.toJSON=function(){var e=this,t=e.constructor,n=fn(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};var un=function(){function e(e,t,n){var r,s=0,a=e.length;for(e=e.slice();a--;)r=e[a]*t+s,e[a]=r%n|0,s=r/n|0;return s&&e.unshift(s),e}function t(e,t,n,r){var s,a;if(n!=r)a=n>r?1:-1;else for(s=a=0;s<n;s++)if(e[s]!=t[s]){a=e[s]>t[s]?1:-1;break}return a}function n(e,t,n,r){for(var s=0;n--;)e[n]-=s,s=e[n]<t[n]?1:0,e[n]=s*r+e[n]-t[n];for(;!e[0]&&e.length>1;)e.shift()}return function(r,s,a,i,o,l){var c,d,u,h,f,g,p,m,y,b,x,v,w,_,S,k,j,N,E,C,T=r.constructor,A=r.s==s.s?1:-1,D=r.d,P=s.d;if(!D||!D[0]||!P||!P[0])return new T(r.s&&s.s&&(D?!P||D[0]!=P[0]:P)?D&&0==D[0]||!P?0*A:A/0:NaN);for(l?(f=1,d=r.e-s.e):(l=nn,f=7,d=$t(r.e/f)-$t(s.e/f)),E=P.length,j=D.length,b=(y=new T(A)).d=[],u=0;P[u]==(D[u]||0);u++);if(P[u]>(D[u]||0)&&d--,null==a?(_=a=T.precision,i=T.rounding):_=o?a+(r.e-s.e)+1:a,_<0)b.push(1),g=!0;else{if(_=_/f+2|0,u=0,1==E){for(h=0,P=P[0],_++;(u<j||h)&&_--;u++)S=h*l+(D[u]||0),b[u]=S/P|0,h=S%P|0;g=h||u<j}else{for((h=l/(P[0]+1)|0)>1&&(P=e(P,h,l),D=e(D,h,l),E=P.length,j=D.length),k=E,v=(x=D.slice(0,E)).length;v<E;)x[v++]=0;(C=P.slice()).unshift(0),N=P[0],P[1]>=l/2&&++N;do{h=0,(c=t(P,x,E,v))<0?(w=x[0],E!=v&&(w=w*l+(x[1]||0)),(h=w/N|0)>1?(h>=l&&(h=l-1),1==(c=t(p=e(P,h,l),x,m=p.length,v=x.length))&&(h--,n(p,E<m?C:P,m,l))):(0==h&&(c=h=1),p=P.slice()),(m=p.length)<v&&p.unshift(0),n(x,p,v,l),-1==c&&(c=t(P,x,E,v=x.length))<1&&(h++,n(x,E<v?C:P,v,l)),v=x.length):0===c&&(h++,x=[0]),b[u++]=h,c&&x[0]?x[v++]=D[k]||0:(x=[D[k]],v=1)}while((k++<j||void 0!==x[0])&&_--);g=void 0!==x[0]}b[0]||b.shift()}if(1==f)y.e=d,Mt=g;else{for(u=1,h=b[0];h>=10;h/=10)u++;y.e=u+d*f-1,hn(y,o?a+y.e+1:a,i,g)}return y}}();function hn(e,t,n,r){var s,a,i,o,l,c,d,u,h,f=e.constructor;e:if(null!=t){if(!(u=e.d))return e;for(s=1,o=u[0];o>=10;o/=10)s++;if((a=t-s)<0)a+=7,i=t,l=(d=u[h=0])/Qt(10,s-i-1)%10|0;else if((h=Math.ceil((a+1)/7))>=(o=u.length)){if(!r)break e;for(;o++<=h;)u.push(0);d=l=0,s=1,i=(a%=7)-7+1}else{for(d=o=u[h],s=1;o>=10;o/=10)s++;l=(i=(a%=7)-7+s)<0?0:d/Qt(10,s-i-1)%10|0}if(r=r||t<0||void 0!==u[h+1]||(i<0?d:d%Qt(10,s-i-1)),c=n<4?(l||r)&&(0==n||n==(e.s<0?3:2)):l>5||5==l&&(4==n||r||6==n&&(a>0?i>0?d/Qt(10,s-i):0:u[h-1])%10&1||n==(e.s<0?8:7)),t<1||!u[0])return u.length=0,c?(t-=e.e+1,u[0]=Qt(10,(7-t%7)%7),e.e=-t||0):u[0]=e.e=0,e;if(0==a?(u.length=h,o=1,h--):(u.length=h+1,o=Qt(10,7-a),u[h]=i>0?(d/Qt(10,s-i)%Qt(10,i)|0)*o:0),c)for(;;){if(0==h){for(a=1,i=u[0];i>=10;i/=10)a++;for(i=u[0]+=o,o=1;i>=10;i/=10)o++;a!=o&&(e.e++,u[0]==nn&&(u[0]=1));break}if(u[h]+=o,u[h]!=nn)break;u[h--]=0,o=1}for(a=u.length;0===u[--a];)u.pop()}return Ht&&(e.e>f.maxE?(e.d=null,e.e=NaN):e.e<f.minE&&(e.e=0,e.d=[0])),e}function fn(e,t,n){if(!e.isFinite())return kn(e);var r,s=e.e,a=on(e.d),i=a.length;return t?(n&&(r=n-i)>0?a=a.charAt(0)+"."+a.slice(1)+bn(r):i>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(e.e<0?"e":"e+")+e.e):s<0?(a="0."+bn(-s-1)+a,n&&(r=n-i)>0&&(a+=bn(r))):s>=i?(a+=bn(s+1-i),n&&(r=n-s-1)>0&&(a=a+"."+bn(r))):((r=s+1)<i&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-i)>0&&(s+1===i&&(a+="."),a+=bn(r))),a}function gn(e,t){var n=e[0];for(t*=7;n>=10;n/=10)t++;return t}function pn(e,t,n){if(t>rn)throw Ht=!0,n&&(e.precision=n),Error(Kt);return hn(new e(Ut),t,1,!0)}function mn(e,t,n){if(t>sn)throw Error(Kt);return hn(new e(Wt),t,n,!0)}function yn(e){var t=e.length-1,n=7*t+1;if(t=e[t]){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function bn(e){for(var t="";e--;)t+="0";return t}function xn(e,t,n,r){var s,a=new e(1),i=Math.ceil(r/7+4);for(Ht=!1;;){if(n%2&&Dn((a=a.times(t)).d,i)&&(s=!0),0===(n=$t(n/2))){n=a.d.length-1,s&&0===a.d[n]&&++a.d[n];break}Dn((t=t.times(t)).d,i)}return Ht=!0,a}function vn(e){return 1&e.d[e.d.length-1]}function wn(e,t,n){for(var r,s,a=new e(t[0]),i=0;++i<t.length;){if(!(s=new e(t[i])).s){a=s;break}((r=a.cmp(s))===n||0===r&&a.s===n)&&(a=s)}return a}function _n(e,t){var n,r,s,a,i,o,l,c=0,d=0,u=0,h=e.constructor,f=h.rounding,g=h.precision;if(!e.d||!e.d[0]||e.e>17)return new h(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);for(null==t?(Ht=!1,l=g):l=t,o=new h(.03125);e.e>-2;)e=e.times(o),u+=5;for(l+=r=Math.log(Qt(2,u))/Math.LN10*2+5|0,n=a=i=new h(1),h.precision=l;;){if(a=hn(a.times(e),l,1),n=n.times(++d),on((o=i.plus(un(a,n,l,1))).d).slice(0,l)===on(i.d).slice(0,l)){for(s=u;s--;)i=hn(i.times(i),l,1);if(null!=t)return h.precision=g,i;if(!(c<3&&cn(i.d,l-r,f,c)))return hn(i,h.precision=g,f,Ht=!0);h.precision=l+=10,n=a=o=new h(1),d=0,c++}i=o}}function Sn(e,t){var n,r,s,a,i,o,l,c,d,u,h,f=1,g=e,p=g.d,m=g.constructor,y=m.rounding,b=m.precision;if(g.s<0||!p||!p[0]||!g.e&&1==p[0]&&1==p.length)return new m(p&&!p[0]?-1/0:1!=g.s?NaN:p?0:g);if(null==t?(Ht=!1,d=b):d=t,m.precision=d+=10,r=(n=on(p)).charAt(0),!(Math.abs(a=g.e)<15e14))return c=pn(m,d+2,b).times(a+""),g=Sn(new m(r+"."+n.slice(1)),d-10).plus(c),m.precision=b,null==t?hn(g,b,y,Ht=!0):g;for(;r<7&&1!=r||1==r&&n.charAt(1)>3;)r=(n=on((g=g.times(e)).d)).charAt(0),f++;for(a=g.e,r>1?(g=new m("0."+n),a++):g=new m(r+"."+n.slice(1)),u=g,l=i=g=un(g.minus(1),g.plus(1),d,1),h=hn(g.times(g),d,1),s=3;;){if(i=hn(i.times(h),d,1),on((c=l.plus(un(i,new m(s),d,1))).d).slice(0,d)===on(l.d).slice(0,d)){if(l=l.times(2),0!==a&&(l=l.plus(pn(m,d+2,b).times(a+""))),l=un(l,new m(f),d,1),null!=t)return m.precision=b,l;if(!cn(l.d,d-10,y,o))return hn(l,m.precision=b,y,Ht=!0);m.precision=d+=10,c=i=g=un(u.minus(1),u.plus(1),d,1),h=hn(g.times(g),d,1),s=o=1}l=c,s+=2}}function kn(e){return String(e.s*e.s/0)}function jn(e,t){var n,r,s;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;48===t.charCodeAt(r);r++);for(s=t.length;48===t.charCodeAt(s-1);--s);if(t=t.slice(r,s)){if(s-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%7,n<0&&(r+=7),r<s){for(r&&e.d.push(+t.slice(0,r)),s-=7;r<s;)e.d.push(+t.slice(r,r+=7));r=7-(t=t.slice(r)).length}else r-=s;for(;r--;)t+="0";e.d.push(+t),Ht&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Nn(e,t){var n,r,s,a,i,o,l,c,d;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),tn.test(t))return jn(e,t)}else if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(Zt.test(t))n=16,t=t.toLowerCase();else if(Xt.test(t))n=2;else{if(!en.test(t))throw Error(Jt+t);n=8}for((a=t.search(/p/i))>0?(l=+t.slice(a+1),t=t.substring(2,a)):t=t.slice(2),i=(a=t.indexOf("."))>=0,r=e.constructor,i&&(a=(o=(t=t.replace(".","")).length)-a,s=xn(r,new r(n),a,2*a)),a=d=(c=dn(t,n,nn)).length-1;0===c[a];--a)c.pop();return a<0?new r(0*e.s):(e.e=gn(c,d),e.d=c,Ht=!1,i&&(e=un(e,s,4*o)),l&&(e=e.times(Math.abs(l)<54?Qt(2,l):br.pow(2,l))),Ht=!0,e)}function En(e,t,n,r,s){var a,i,o,l,c=e.precision,d=Math.ceil(c/7);for(Ht=!1,l=n.times(n),o=new e(r);;){if(i=un(o.times(l),new e(t++*t++),c,1),o=s?r.plus(i):r.minus(i),r=un(i.times(l),new e(t++*t++),c,1),void 0!==(i=o.plus(r)).d[d]){for(a=d;i.d[a]===o.d[a]&&a--;);if(-1==a)break}a=o,o=r,r=i,i=a}return Ht=!0,i.d.length=d+1,i}function Cn(e,t){for(var n=e;--t;)n*=e;return n}function Tn(e,t){var n,r=t.s<0,s=mn(e,e.precision,1),a=s.times(.5);if((t=t.abs()).lte(a))return Rt=r?4:1,t;if((n=t.divToInt(s)).isZero())Rt=r?3:2;else{if((t=t.minus(n.times(s))).lte(a))return Rt=vn(n)?r?2:3:r?4:1,t;Rt=vn(n)?r?1:4:r?3:2}return t.minus(s).abs()}function An(e,t,n,r){var s,a,i,o,l,c,d,u,h,f=e.constructor,g=void 0!==n;if(g?(ln(n,1,Bt),void 0===r?r=f.rounding:ln(r,0,8)):(n=f.precision,r=f.rounding),e.isFinite()){for(g?(s=2,16==t?n=4*n-3:8==t&&(n=3*n-2)):s=t,(i=(d=fn(e)).indexOf("."))>=0&&(d=d.replace(".",""),(h=new f(1)).e=d.length-i,h.d=dn(fn(h),10,s),h.e=h.d.length),a=l=(u=dn(d,10,s)).length;0==u[--l];)u.pop();if(u[0]){if(i<0?a--:((e=new f(e)).d=u,e.e=a,u=(e=un(e,h,n,r,0,s)).d,a=e.e,c=Mt),i=u[n],o=s/2,c=c||void 0!==u[n+1],c=r<4?(void 0!==i||c)&&(0===r||r===(e.s<0?3:2)):i>o||i===o&&(4===r||c||6===r&&1&u[n-1]||r===(e.s<0?8:7)),u.length=n,c)for(;++u[--n]>s-1;)u[n]=0,n||(++a,u.unshift(1));for(l=u.length;!u[l-1];--l);for(i=0,d="";i<l;i++)d+=zt.charAt(u[i]);if(g){if(l>1)if(16==t||8==t){for(i=16==t?4:3,--l;l%i;l++)d+="0";for(l=(u=dn(d,s,t)).length;!u[l-1];--l);for(i=1,d="1.";i<l;i++)d+=zt.charAt(u[i])}else d=d.charAt(0)+"."+d.slice(1);d=d+(a<0?"p":"p+")+a}else if(a<0){for(;++a;)d="0"+d;d="0."+d}else if(++a>l)for(a-=l;a--;)d+="0";else a<l&&(d=d.slice(0,a)+"."+d.slice(a))}else d=g?"0p+0":"0";d=(16==t?"0x":2==t?"0b":8==t?"0o":"")+d}else d=kn(e);return e.s<0?"-"+d:d}function Dn(e,t){if(e.length>t)return e.length=t,!0}function Pn(e){return new this(e).abs()}function On(e){return new this(e).acos()}function In(e){return new this(e).acosh()}function Ln(e,t){return new this(e).plus(t)}function Mn(e){return new this(e).asin()}function Rn(e){return new this(e).asinh()}function Fn(e){return new this(e).atan()}function Bn(e){return new this(e).atanh()}function zn(e,t){e=new this(e),t=new this(t);var n,r=this.precision,s=this.rounding,a=r+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(n=t.s<0?mn(this,r,s):new this(0)).s=e.s:!e.d||t.isZero()?(n=mn(this,a,1).times(.5)).s=e.s:t.s<0?(this.precision=a,this.rounding=1,n=this.atan(un(e,t,a,1)),t=mn(this,a,1),this.precision=r,this.rounding=s,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(un(e,t,a,1)):(n=mn(this,a,1).times(t.s>0?.25:.75)).s=e.s:n=new this(NaN),n}function Un(e){return new this(e).cbrt()}function Wn(e){return hn(e=new this(e),e.e+1,2)}function qn(e,t,n){return new this(e).clamp(t,n)}function Hn(e){if(!e||"object"!==typeof e)throw Error(Vt+"Object expected");var t,n,r,s=!0===e.defaults,a=["precision",1,Bt,"rounding",0,8,"toExpNeg",-Ft,0,"toExpPos",0,Ft,"maxE",0,Ft,"minE",-Ft,0,"modulo",0,9];for(t=0;t<a.length;t+=3)if(n=a[t],s&&(this[n]=qt[n]),void 0!==(r=e[n])){if(!($t(r)===r&&r>=a[t+1]&&r<=a[t+2]))throw Error(Jt+n+": "+r);this[n]=r}if(n="crypto",s&&(this[n]=qt[n]),void 0!==(r=e[n])){if(!0!==r&&!1!==r&&0!==r&&1!==r)throw Error(Jt+n+": "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(Yt);this[n]=!0}else this[n]=!1}return this}function Vn(e){return new this(e).cos()}function Jn(e){return new this(e).cosh()}function Kn(e,t){return new this(e).div(t)}function Yn(e){return new this(e).exp()}function Gn(e){return hn(e=new this(e),e.e+1,3)}function $n(){var e,t,n=new this(0);for(Ht=!1,e=0;e<arguments.length;)if((t=new this(arguments[e++])).d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return Ht=!0,new this(1/0);n=t}return Ht=!0,n.sqrt()}function Qn(e){return e instanceof br||e&&e.toStringTag===Gt||!1}function Xn(e){return new this(e).ln()}function Zn(e,t){return new this(e).log(t)}function er(e){return new this(e).log(2)}function tr(e){return new this(e).log(10)}function nr(){return wn(this,arguments,-1)}function rr(){return wn(this,arguments,1)}function sr(e,t){return new this(e).mod(t)}function ar(e,t){return new this(e).mul(t)}function ir(e,t){return new this(e).pow(t)}function or(e){var t,n,r,s,a=0,i=new this(1),o=[];if(void 0===e?e=this.precision:ln(e,1,Bt),r=Math.ceil(e/7),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));a<r;)(s=t[a])>=429e7?t[a]=crypto.getRandomValues(new Uint32Array(1))[0]:o[a++]=s%1e7;else{if(!crypto.randomBytes)throw Error(Yt);for(t=crypto.randomBytes(r*=4);a<r;)(s=t[a]+(t[a+1]<<8)+(t[a+2]<<16)+((127&t[a+3])<<24))>=214e7?crypto.randomBytes(4).copy(t,a):(o.push(s%1e7),a+=4);a=r/4}else for(;a<r;)o[a++]=1e7*Math.random()|0;for(e%=7,(r=o[--a])&&e&&(s=Qt(10,7-e),o[a]=(r/s|0)*s);0===o[a];a--)o.pop();if(a<0)n=0,o=[0];else{for(n=-1;0===o[0];n-=7)o.shift();for(r=1,s=o[0];s>=10;s/=10)r++;r<7&&(n-=7-r)}return i.e=n,i.d=o,i}function lr(e){return hn(e=new this(e),e.e+1,this.rounding)}function cr(e){return(e=new this(e)).d?e.d[0]?e.s:0*e.s:e.s||NaN}function dr(e){return new this(e).sin()}function ur(e){return new this(e).sinh()}function hr(e){return new this(e).sqrt()}function fr(e,t){return new this(e).sub(t)}function gr(){var e=0,t=arguments,n=new this(t[e]);for(Ht=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return Ht=!0,hn(n,this.precision,this.rounding)}function pr(e){return new this(e).tan()}function mr(e){return new this(e).tanh()}function yr(e){return hn(e=new this(e),e.e+1,1)}an[Symbol.for("nodejs.util.inspect.custom")]=an.toString,an[Symbol.toStringTag]="Decimal";var br=an.constructor=function e(t){var n,r,s;function a(e){var t,n,r,s=this;if(!(s instanceof a))return new a(e);if(s.constructor=a,Qn(e))return s.s=e.s,void(Ht?!e.d||e.e>a.maxE?(s.e=NaN,s.d=null):e.e<a.minE?(s.e=0,s.d=[0]):(s.e=e.e,s.d=e.d.slice()):(s.e=e.e,s.d=e.d?e.d.slice():e.d));if("number"===(r=typeof e)){if(0===e)return s.s=1/e<0?-1:1,s.e=0,void(s.d=[0]);if(e<0?(e=-e,s.s=-1):s.s=1,e===~~e&&e<1e7){for(t=0,n=e;n>=10;n/=10)t++;return void(Ht?t>a.maxE?(s.e=NaN,s.d=null):t<a.minE?(s.e=0,s.d=[0]):(s.e=t,s.d=[e]):(s.e=t,s.d=[e]))}return 0*e!==0?(e||(s.s=NaN),s.e=NaN,void(s.d=null)):jn(s,e.toString())}if("string"===r)return 45===(n=e.charCodeAt(0))?(e=e.slice(1),s.s=-1):(43===n&&(e=e.slice(1)),s.s=1),tn.test(e)?jn(s,e):Nn(s,e);if("bigint"===r)return e<0?(e=-e,s.s=-1):s.s=1,jn(s,e.toString());throw Error(Jt+e)}if(a.prototype=an,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.EUCLID=9,a.config=a.set=Hn,a.clone=e,a.isDecimal=Qn,a.abs=Pn,a.acos=On,a.acosh=In,a.add=Ln,a.asin=Mn,a.asinh=Rn,a.atan=Fn,a.atanh=Bn,a.atan2=zn,a.cbrt=Un,a.ceil=Wn,a.clamp=qn,a.cos=Vn,a.cosh=Jn,a.div=Kn,a.exp=Yn,a.floor=Gn,a.hypot=$n,a.ln=Xn,a.log=Zn,a.log10=tr,a.log2=er,a.max=nr,a.min=rr,a.mod=sr,a.mul=ar,a.pow=ir,a.random=or,a.round=lr,a.sign=cr,a.sin=dr,a.sinh=ur,a.sqrt=hr,a.sub=fr,a.sum=gr,a.tan=pr,a.tanh=mr,a.trunc=yr,void 0===t&&(t={}),t&&!0!==t.defaults)for(s=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],n=0;n<s.length;)t.hasOwnProperty(r=s[n++])||(t[r]=this[r]);return a.config(t),a}(qt);Ut=new br(Ut),Wt=new br(Wt);const xr=br;xr.config({precision:10,rounding:xr.ROUND_HALF_UP,toExpNeg:-9,toExpPos:21,minE:-9,maxE:21});class vr{constructor(e){this.user=e,this.pendingOperations=[]}static addToBalance(e,t){const n=new xr(e||0),r=new xr(t||0);return n.plus(r).toNumber()}static subtractFromBalance(e,t){const n=new xr(e||0),r=new xr(t||0);return n.minus(r).toNumber()}static calculateAdjustment(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new xr(e||0);return n?t?r.negated().toNumber():r.toNumber():t?r.toNumber():r.negated().toNumber()}async validateWalletBalance(e,t){var n;let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e||null===(n=this.user)||void 0===n||!n.id)throw new Error("Invalid wallet ID or user not authenticated");const s=(await Le.qF.getAll(this.user.id)).find((t=>t.id===e));if(!s)throw new Error("Wallet with ID ".concat(e," not found"));if(r){const e=new xr(s.balance||0),n=new xr(t||0);if(e.lt(n))throw new Error("Insufficient balance in wallet ".concat(s.name,". Current: ").concat(e.toFixed(2),", Required: ").concat(n.toFixed(2)))}return s}async updateWalletBalance(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3;const r=(0,Oe.A)((0,Oe.A)({},e),{},{balance:new xr(t).toNumber()});let s;for(let i=1;i<=n;i++)try{return await Le.qF.update(r,this.user.id),console.log("Wallet balance updated (attempt ".concat(i,"):"),{walletId:e.id,walletName:e.name,oldBalance:new xr(e.balance).toFixed(2),newBalance:new xr(t).toFixed(2),adjustment:new xr(t).minus(e.balance).toFixed(2)}),r}catch(a){s=a,console.warn("Wallet update attempt ".concat(i," failed:"),a),i<n&&await new Promise((e=>setTimeout(e,1e3*i)))}throw new Error("Failed to update wallet after ".concat(n," attempts: ").concat(s.message))}async addExpenseWithWalletUpdate(e){var t;let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null===(t=this.user)||void 0===t||!t.id)throw new Error("User not authenticated");const s=!e.is_income;if(r.skipBalanceValidation){console.warn("\u26a0\ufe0f Balance validation skipped for expense:",e.id);if(!(await Le.qF.getAll(this.user.id)).find((t=>t.id===e.wallet_id)))throw new Error("Wallet with ID ".concat(e.wallet_id," not found"))}else await this.validateWalletBalance(e.wallet_id,e.amount,s);const a=[];try{const{expenseDB:t}=await Promise.resolve().then(n.bind(n,61)),r=await t.add(e,this.user.id);a.push((()=>t.delete(r.id,this.user.id)));const s=(await Le.qF.getAll(this.user.id)).find((t=>t.id===e.wallet_id));if(!s)throw new Error("Wallet with ID ".concat(e.wallet_id," not found"));const i=vr.calculateAdjustment(e.amount,e.is_income),o=vr.addToBalance(s.balance,i),l=await this.updateWalletBalance(s,o);return a.push((()=>this.updateWalletBalance(l,s.balance))),{expense:r,wallet:l}}catch(i){console.error("Error in addExpenseWithWalletUpdate, rolling back:",i);for(let e=a.length-1;e>=0;e--)try{await a[e]()}catch(o){console.error("Rollback operation failed:",o)}throw i}}async updateExpenseWithWalletUpdate(e){var t;if(null===(t=this.user)||void 0===t||!t.id)throw new Error("User not authenticated");const{data:r,error:s}=await Pe.A.from("expenses").select("*").eq("id",e.id).eq("user_id",this.user.id).single();if(s||!r)throw new Error("Original expense not found or unauthorized");const a=[],i=new Map;try{const t=await Le.qF.getAll(this.user.id),s=t.find((e=>e.id===r.wallet_id)),o=t.find((t=>t.id===e.wallet_id));if(s){if(!o)throw new Error("New wallet ".concat(e.wallet_id," not found"));if(r.wallet_id===e.wallet_id){const t=vr.calculateAdjustment(r.amount,r.is_income,!0),n=vr.calculateAdjustment(e.amount,e.is_income),a=new xr(t).plus(n).toNumber(),o=vr.addToBalance(s.balance,a);if(!e.is_income&&new xr(o).lt(0))throw new Error("Insufficient balance for this operation");i.set(s.id,{wallet:s,newBalance:o,oldBalance:s.balance})}else{const t=vr.calculateAdjustment(r.amount,r.is_income,!0),n=vr.addToBalance(s.balance,t);i.set(s.id,{wallet:s,newBalance:n,oldBalance:s.balance});const a=vr.calculateAdjustment(e.amount,e.is_income),l=vr.addToBalance(o.balance,a);if(!e.is_income&&new xr(l).lt(0))throw new Error("Insufficient balance in destination wallet");i.set(o.id,{wallet:o,newBalance:l,oldBalance:o.balance})}}else{if(console.warn("Original wallet ".concat(r.wallet_id," not found. This may be a deleted wallet. Skipping wallet balance restoration.")),!o)throw new Error("New wallet ".concat(e.wallet_id," not found"));const t=vr.calculateAdjustment(e.amount,e.is_income),n=vr.addToBalance(o.balance,t);if(!e.is_income&&new xr(n).lt(0))throw new Error("Insufficient balance in destination wallet");i.set(o.id,{wallet:o,newBalance:n,oldBalance:o.balance})}for(const[e,n]of i){const e=await this.updateWalletBalance(n.wallet,n.newBalance);a.push((()=>this.updateWalletBalance(e,n.oldBalance)))}const{expenseDB:l}=await Promise.resolve().then(n.bind(n,61));return await l.update(e,this.user.id),a.push((()=>l.update(r,this.user.id))),{expense:e,walletUpdates:Array.from(i.values())}}catch(o){console.error("Error in updateExpenseWithWalletUpdate, rolling back:",o);for(let e=a.length-1;e>=0;e--)try{await a[e]()}catch(l){console.error("Rollback operation failed:",l)}throw o}}async deleteExpenseWithWalletUpdate(e){var t;if(null===(t=this.user)||void 0===t||!t.id)throw new Error("User not authenticated");const{data:r}=await Pe.A.from("expenses").select("*").eq("id",e).eq("user_id",this.user.id).single();if(!r)throw new Error("Expense not found");const s=[];try{const t=(await Le.qF.getAll(this.user.id)).find((e=>e.id===r.wallet_id));if(t){const e=vr.calculateAdjustment(r.amount,r.is_income,!0),n=vr.addToBalance(t.balance,e),a=await this.updateWalletBalance(t,n);s.push((()=>this.updateWalletBalance(a,t.balance)))}const{expenseDB:a}=await Promise.resolve().then(n.bind(n,61));return await a.delete(e,this.user.id),s.push((()=>a.add(r,this.user.id))),{deletedExpense:r,wallet:t}}catch(a){console.error("Error in deleteExpenseWithWalletUpdate, rolling back:",a);for(let e=s.length-1;e>=0;e--)try{await s[e]()}catch(i){console.error("Rollback operation failed:",i)}throw a}}async executeWalletTransfer(e){var t;if(null===(t=this.user)||void 0===t||!t.id)throw new Error("User not authenticated");const{fromWallet:r,toWallet:s,amount:a}=e;if(!r||!s||!a)throw new Error("Invalid transfer data: missing wallet IDs or amount");if(r===s)throw new Error("Cannot transfer to the same wallet");const i=await this.validateWalletBalance(r,a,!0),o=await this.validateWalletBalance(s,0,!1),l=[];try{const t=vr.subtractFromBalance(i.balance,a),r=vr.addToBalance(o.balance,a),s=await this.updateWalletBalance(i,t);l.push((()=>this.updateWalletBalance(s,i.balance)));const c=await this.updateWalletBalance(o,r);l.push((()=>this.updateWalletBalance(c,o.balance)));const{transferDB:d}=await Promise.resolve().then(n.bind(n,61)),u=(0,Oe.A)((0,Oe.A)({},e),{},{id:e.id||Date.now(),fromWalletName:i.name,toWalletName:o.name,amount:new xr(a).toNumber(),timestamp:(new Date).toISOString()}),h=await d.add(u,this.user.id);return l.push((()=>d.delete(h.id,this.user.id))),{transfer:h,sourceWallet:s,destWallet:c}}catch(c){console.error("Error in executeWalletTransfer, rolling back:",c);for(let e=l.length-1;e>=0;e--)try{await l[e]()}catch(d){console.error("Rollback operation failed:",d)}throw c}}async updateWalletTransfer(e,t){var r;if(null===(r=this.user)||void 0===r||!r.id)throw new Error("User not authenticated");const{transferDB:s}=await Promise.resolve().then(n.bind(n,61)),a=await s.getById(e,this.user.id);if(!a)throw new Error("Original transfer not found");const i=[];try{const n=await Le.qF.getAll(this.user.id),r=n.find((e=>e.id===a.fromWallet)),o=n.find((e=>e.id===a.toWallet));if(!r||!o)throw new Error("Original transfer wallets not found");const l=vr.addToBalance(r.balance,a.amount),c=vr.subtractFromBalance(o.balance,a.amount),d=n.find((e=>e.id===t.fromWallet)),u=n.find((e=>e.id===t.toWallet));if(!d||!u)throw new Error("New transfer wallets not found");let h,f;if(h=a.fromWallet===t.fromWallet?l:d.balance,f=a.toWallet===t.toWallet?c:u.balance,h=vr.subtractFromBalance(h,t.amount),f=vr.addToBalance(f,t.amount),new xr(h).lt(0))throw new Error("Insufficient balance in source wallet for this transfer");const g=[];a.fromWallet!==t.fromWallet&&g.push({wallet:r,newBalance:l,oldBalance:r.balance}),a.toWallet!==t.toWallet&&g.push({wallet:o,newBalance:c,oldBalance:o.balance}),g.push({wallet:d,newBalance:h,oldBalance:d.balance}),g.push({wallet:u,newBalance:f,oldBalance:u.balance});for(const e of g){const t=await this.updateWalletBalance(e.wallet,e.newBalance);i.push((()=>this.updateWalletBalance(t,e.oldBalance)))}const p=(0,Oe.A)((0,Oe.A)({},t),{},{id:e,fromWalletName:d.name,toWalletName:u.name,amount:new xr(t.amount).toNumber(),timestamp:(new Date).toISOString()});return await s.update(p,this.user.id),i.push((()=>s.update(a,this.user.id))),{transfer:p,walletUpdates:g}}catch(o){console.error("Error in updateWalletTransfer, rolling back:",o);for(let e=i.length-1;e>=0;e--)try{await i[e]()}catch(l){console.error("Rollback operation failed:",l)}throw o}}async deleteWalletTransfer(e){var t;if(null===(t=this.user)||void 0===t||!t.id)throw new Error("User not authenticated");const{transferDB:r}=await Promise.resolve().then(n.bind(n,61)),s=await r.getById(e,this.user.id);if(!s)throw new Error("Transfer not found");const a=[];try{const t=await Le.qF.getAll(this.user.id),n=t.find((e=>e.id===s.fromWallet)),i=t.find((e=>e.id===s.toWallet));if(!n||!i)throw new Error("One or both wallets involved in this transfer no longer exist");const o=vr.addToBalance(n.balance,s.amount),l=vr.subtractFromBalance(i.balance,s.amount),c=await this.updateWalletBalance(n,o);a.push((()=>this.updateWalletBalance(c,n.balance)));const d=await this.updateWalletBalance(i,l);return a.push((()=>this.updateWalletBalance(d,i.balance))),await r.delete(e,this.user.id),a.push((()=>r.create(s,this.user.id))),{deletedTransfer:s,sourceWallet:c,destWallet:d,message:"Transfer deleted: Added ".concat(s.amount," back to ").concat(n.name,", subtracted ").concat(s.amount," from ").concat(i.name)}}catch(i){console.error("Error in deleteWalletTransfer, rolling back:",i);for(let e=a.length-1;e>=0;e--)try{await a[e]()}catch(o){console.error("Rollback operation failed:",o)}throw i}}async correctWalletBalance(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Manual correction";if(null===(n=this.user)||void 0===n||!n.id)throw new Error("User not authenticated");const s=(await Le.qF.getAll(this.user.id)).find((t=>t.id===e));if(!s)throw new Error("Wallet with ID ".concat(e," not found"));const a=s.balance,i=new xr(t).toNumber();console.log("\ud83d\udd27 Correcting wallet balance:",{walletId:s.id,walletName:s.name,oldBalance:new xr(a).toFixed(2),newBalance:new xr(i).toFixed(2),adjustment:new xr(i).minus(a).toFixed(2),reason:r});return{wallet:await this.updateWalletBalance(s,i),oldBalance:a,newBalance:i,adjustment:i-a}}async recalculateWalletBalance(e){var t;if(null===(t=this.user)||void 0===t||!t.id)throw new Error("User not authenticated");const r=(await Le.qF.getAll(this.user.id)).find((t=>t.id===e));if(!r)throw new Error("Wallet with ID ".concat(e," not found"));const{expenseDB:s}=await Promise.resolve().then(n.bind(n,61)),{transferDB:a}=await Promise.resolve().then(n.bind(n,61)),[i,o]=await Promise.all([s.getAll(this.user.id),a.getAll(this.user.id)]),l=i.filter((t=>t.wallet_id===e&&!t.deleted_at)),c=o.filter((t=>t.toWallet===e)),d=o.filter((t=>t.fromWallet===e));let u=new xr(0);l.forEach((e=>{u=e.is_income?u.plus(e.amount):u.minus(e.amount)})),c.forEach((e=>{u=u.plus(e.amount)})),d.forEach((e=>{u=u.minus(e.amount)}));const h=r.balance,f=u.toNumber();console.log("\ud83d\udcca Wallet balance recalculation:",{walletId:r.id,walletName:r.name,oldBalance:new xr(h).toFixed(2),calculatedBalance:new xr(f).toFixed(2),difference:new xr(f).minus(h).toFixed(2),transactions:{expenses:l.length,incomingTransfers:c.length,outgoingTransfers:d.length}});return{wallet:await this.updateWalletBalance(r,f),oldBalance:h,newBalance:f,difference:f-h,transactionCounts:{expenses:l.length,incomingTransfers:c.length,outgoingTransfers:d.length}}}}const wr=e=>new vr(e),_r={addToBalance:vr.addToBalance,subtractFromBalance:vr.subtractFromBalance,calculateAdjustment:vr.calculateAdjustment,formatBalance:e=>new xr(e||0).toFixed(2),hasSufficientBalance:(e,t)=>new xr(e||0).gte(new xr(t||0)),calculatePercentageChange:(e,t)=>{const n=new xr(e||0),r=new xr(t||0);return n.isZero()?r.isZero()?0:100:r.minus(n).div(n).mul(100).toNumber()}};const Sr=function(e){let{expenses:t=[],total:n=0}=e;const r=t.filter((e=>e.is_income)).reduce(((e,t)=>_r.addToBalance(e,t.amount)),0),s=t.filter((e=>!e.is_income)).reduce(((e,t)=>_r.addToBalance(e,t.amount)),0),a=_r.subtractFromBalance(r,s),i=t.filter((e=>!e.is_income)).map((e=>parseFloat(e.amount||0))),o=i.length>0?Math.max(...i):0,l=t.filter((e=>e.is_income)).map((e=>parseFloat(e.amount||0))),c=l.length>0?Math.max(...l):0,d=(t.length>0&&(parseFloat(n),t.length),e=>_r.formatBalance(e));return(0,Ge.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-gray-300 mb-4",children:"Summary"}),(0,Ge.jsxs)("div",{className:"space-y-2",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ge.jsx)("span",{className:"text-gray-400",children:"Total Income:"}),(0,Ge.jsxs)("span",{className:"text-green-400",children:["Rp ",d(r)]})]}),(0,Ge.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ge.jsx)("span",{className:"text-gray-400",children:"Total Expenses:"}),(0,Ge.jsxs)("span",{className:"text-red-400",children:["Rp ",d(s)]})]}),(0,Ge.jsx)("div",{className:"border-t border-gray-700 my-2 pt-2",children:(0,Ge.jsxs)("div",{className:"flex justify-between items-center font-medium",children:[(0,Ge.jsx)("span",{className:"text-gray-300",children:"Net Cash Flow:"}),(0,Ge.jsxs)("span",{className:a>=0?"text-green-400":"text-red-400",children:["Rp ",d(Math.abs(a)),a>=0?" \u2191":" \u2193"]})]})})]})]}),(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-gray-300 mb-4",children:"Highest Values"}),(0,Ge.jsxs)("div",{className:"space-y-2",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ge.jsx)("span",{className:"text-gray-400",children:"Highest Income:"}),(0,Ge.jsxs)("span",{className:"text-green-400",children:["Rp ",d(c)]})]}),(0,Ge.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ge.jsx)("span",{className:"text-gray-400",children:"Highest Expense:"}),(0,Ge.jsxs)("span",{className:"text-red-400",children:["Rp ",d(o)]})]})]})]}),(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 shadow-lg",children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-gray-300 mb-4",children:"Transaction Count"}),(0,Ge.jsxs)("div",{className:"text-gray-400",children:[t.filter((e=>e.is_income)).length," income / ",t.filter((e=>!e.is_income)).length," expense"]})]})]})};var kr=n(705);function jr(e){return e+.5|0}const Nr=(e,t,n)=>Math.max(Math.min(e,n),t);function Er(e){return Nr(jr(2.55*e),0,255)}function Cr(e){return Nr(jr(255*e),0,255)}function Tr(e){return Nr(jr(e/2.55)/100,0,1)}function Ar(e){return Nr(jr(100*e),0,100)}const Dr={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Pr=[..."0123456789ABCDEF"],Or=e=>Pr[15&e],Ir=e=>Pr[(240&e)>>4]+Pr[15&e],Lr=e=>(240&e)>>4===(15&e);function Mr(e){var t=(e=>Lr(e.r)&&Lr(e.g)&&Lr(e.b)&&Lr(e.a))(e)?Or:Ir;return e?"#"+t(e.r)+t(e.g)+t(e.b)+((e,t)=>e<255?t(e):"")(e.a,t):void 0}const Rr=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Fr(e,t,n){const r=t*Math.min(n,1-n),s=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(t+e/30)%12;return n-r*Math.max(Math.min(s-3,9-s,1),-1)};return[s(0),s(8),s(4)]}function Br(e,t,n){const r=function(r){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(r+e/60)%6;return n-n*t*Math.max(Math.min(s,4-s,1),0)};return[r(5),r(3),r(1)]}function zr(e,t,n){const r=Fr(e,1,.5);let s;for(t+n>1&&(s=1/(t+n),t*=s,n*=s),s=0;s<3;s++)r[s]*=1-t-n,r[s]+=t;return r}function Ur(e){const t=e.r/255,n=e.g/255,r=e.b/255,s=Math.max(t,n,r),a=Math.min(t,n,r),i=(s+a)/2;let o,l,c;return s!==a&&(c=s-a,l=i>.5?c/(2-s-a):c/(s+a),o=function(e,t,n,r,s){return e===s?(t-n)/r+(t<n?6:0):t===s?(n-e)/r+2:(e-t)/r+4}(t,n,r,c,s),o=60*o+.5),[0|o,l||0,i]}function Wr(e,t,n,r){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,r)).map(Cr)}function qr(e,t,n){return Wr(Fr,e,t,n)}function Hr(e){return(e%360+360)%360}function Vr(e){const t=Rr.exec(e);let n,r=255;if(!t)return;t[5]!==n&&(r=t[6]?Er(+t[5]):Cr(+t[5]));const s=Hr(+t[2]),a=+t[3]/100,i=+t[4]/100;return n="hwb"===t[1]?function(e,t,n){return Wr(zr,e,t,n)}(s,a,i):"hsv"===t[1]?function(e,t,n){return Wr(Br,e,t,n)}(s,a,i):qr(s,a,i),{r:n[0],g:n[1],b:n[2],a:r}}const Jr={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Kr={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};let Yr;function Gr(e){Yr||(Yr=function(){const e={},t=Object.keys(Kr),n=Object.keys(Jr);let r,s,a,i,o;for(r=0;r<t.length;r++){for(i=o=t[r],s=0;s<n.length;s++)a=n[s],o=o.replace(a,Jr[a]);a=parseInt(Kr[i],16),e[o]=[a>>16&255,a>>8&255,255&a]}return e}(),Yr.transparent=[0,0,0,0]);const t=Yr[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:4===t.length?t[3]:255}}const $r=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;const Qr=e=>e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055,Xr=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function Zr(e,t,n){if(e){let r=Ur(e);r[t]=Math.max(0,Math.min(r[t]+r[t]*n,0===t?360:1)),r=qr(r),e.r=r[0],e.g=r[1],e.b=r[2]}}function es(e,t){return e?Object.assign(t||{},e):e}function ts(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Cr(e[3]))):(t=es(e,{r:0,g:0,b:0,a:1})).a=Cr(t.a),t}function ns(e){return"r"===e.charAt(0)?function(e){const t=$r.exec(e);let n,r,s,a=255;if(t){if(t[7]!==n){const e=+t[7];a=t[8]?Er(e):Nr(255*e,0,255)}return n=+t[1],r=+t[3],s=+t[5],n=255&(t[2]?Er(n):Nr(n,0,255)),r=255&(t[4]?Er(r):Nr(r,0,255)),s=255&(t[6]?Er(s):Nr(s,0,255)),{r:n,g:r,b:s,a:a}}}(e):Vr(e)}class rs{constructor(e){if(e instanceof rs)return e;const t=typeof e;let n;"object"===t?n=ts(e):"string"===t&&(n=function(e){var t,n=e.length;return"#"===e[0]&&(4===n||5===n?t={r:255&17*Dr[e[1]],g:255&17*Dr[e[2]],b:255&17*Dr[e[3]],a:5===n?17*Dr[e[4]]:255}:7!==n&&9!==n||(t={r:Dr[e[1]]<<4|Dr[e[2]],g:Dr[e[3]]<<4|Dr[e[4]],b:Dr[e[5]]<<4|Dr[e[6]],a:9===n?Dr[e[7]]<<4|Dr[e[8]]:255})),t}(e)||Gr(e)||ns(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=es(this._rgb);return e&&(e.a=Tr(e.a)),e}set rgb(e){this._rgb=ts(e)}rgbString(){return this._valid?(e=this._rgb)&&(e.a<255?"rgba(".concat(e.r,", ").concat(e.g,", ").concat(e.b,", ").concat(Tr(e.a),")"):"rgb(".concat(e.r,", ").concat(e.g,", ").concat(e.b,")")):void 0;var e}hexString(){return this._valid?Mr(this._rgb):void 0}hslString(){return this._valid?function(e){if(!e)return;const t=Ur(e),n=t[0],r=Ar(t[1]),s=Ar(t[2]);return e.a<255?"hsla(".concat(n,", ").concat(r,"%, ").concat(s,"%, ").concat(Tr(e.a),")"):"hsl(".concat(n,", ").concat(r,"%, ").concat(s,"%)")}(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,r=e.rgb;let s;const a=t===s?.5:t,i=2*a-1,o=n.a-r.a,l=((i*o===-1?i:(i+o)/(1+i*o))+1)/2;s=1-l,n.r=255&l*n.r+s*r.r+.5,n.g=255&l*n.g+s*r.g+.5,n.b=255&l*n.b+s*r.b+.5,n.a=a*n.a+(1-a)*r.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=function(e,t,n){const r=Xr(Tr(e.r)),s=Xr(Tr(e.g)),a=Xr(Tr(e.b));return{r:Cr(Qr(r+n*(Xr(Tr(t.r))-r))),g:Cr(Qr(s+n*(Xr(Tr(t.g))-s))),b:Cr(Qr(a+n*(Xr(Tr(t.b))-a))),a:e.a+n*(t.a-e.a)}}(this._rgb,e._rgb,t)),this}clone(){return new rs(this.rgb)}alpha(e){return this._rgb.a=Cr(e),this}clearer(e){return this._rgb.a*=1-e,this}greyscale(){const e=this._rgb,t=jr(.3*e.r+.59*e.g+.11*e.b);return e.r=e.g=e.b=t,this}opaquer(e){return this._rgb.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Zr(this._rgb,2,e),this}darken(e){return Zr(this._rgb,2,-e),this}saturate(e){return Zr(this._rgb,1,e),this}desaturate(e){return Zr(this._rgb,1,-e),this}rotate(e){return function(e,t){var n=Ur(e);n[0]=Hr(n[0]+t),n=qr(n),e.r=n[0],e.g=n[1],e.b=n[2]}(this._rgb,e),this}}function ss(){}const as=(()=>{let e=0;return()=>e++})();function is(e){return null===e||void 0===e}function os(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return"[object"===t.slice(0,7)&&"Array]"===t.slice(-6)}function ls(e){return null!==e&&"[object Object]"===Object.prototype.toString.call(e)}function cs(e){return("number"===typeof e||e instanceof Number)&&isFinite(+e)}function ds(e,t){return cs(e)?e:t}function us(e,t){return"undefined"===typeof e?t:e}const hs=(e,t)=>"string"===typeof e&&e.endsWith("%")?parseFloat(e)/100*t:+e;function fs(e,t,n){if(e&&"function"===typeof e.call)return e.apply(n,t)}function gs(e,t,n,r){let s,a,i;if(os(e))if(a=e.length,r)for(s=a-1;s>=0;s--)t.call(n,e[s],s);else for(s=0;s<a;s++)t.call(n,e[s],s);else if(ls(e))for(i=Object.keys(e),a=i.length,s=0;s<a;s++)t.call(n,e[i[s]],i[s])}function ps(e,t){let n,r,s,a;if(!e||!t||e.length!==t.length)return!1;for(n=0,r=e.length;n<r;++n)if(s=e[n],a=t[n],s.datasetIndex!==a.datasetIndex||s.index!==a.index)return!1;return!0}function ms(e){if(os(e))return e.map(ms);if(ls(e)){const t=Object.create(null),n=Object.keys(e),r=n.length;let s=0;for(;s<r;++s)t[n[s]]=ms(e[n[s]]);return t}return e}function ys(e){return-1===["__proto__","prototype","constructor"].indexOf(e)}function bs(e,t,n,r){if(!ys(e))return;const s=t[e],a=n[e];ls(s)&&ls(a)?xs(s,a,r):t[e]=ms(a)}function xs(e,t,n){const r=os(t)?t:[t],s=r.length;if(!ls(e))return e;const a=(n=n||{}).merger||bs;let i;for(let o=0;o<s;++o){if(i=r[o],!ls(i))continue;const t=Object.keys(i);for(let r=0,s=t.length;r<s;++r)a(t[r],e,i,n)}return e}function vs(e,t){return xs(e,t,{merger:ws})}function ws(e,t,n){if(!ys(e))return;const r=t[e],s=n[e];ls(r)&&ls(s)?vs(r,s):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=ms(s))}const _s={"":e=>e,x:e=>e.x,y:e=>e.y};function Ss(e,t){const n=_s[t]||(_s[t]=function(e){const t=function(e){const t=e.split("."),n=[];let r="";for(const s of t)r+=s,r.endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="");return n}(e);return e=>{for(const n of t){if(""===n)break;e=e&&e[n]}return e}}(t));return n(e)}function ks(e){return e.charAt(0).toUpperCase()+e.slice(1)}const js=e=>"undefined"!==typeof e,Ns=e=>"function"===typeof e,Es=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};const Cs=Math.PI,Ts=2*Cs,As=Ts+Cs,Ds=Number.POSITIVE_INFINITY,Ps=Cs/180,Os=Cs/2,Is=Cs/4,Ls=2*Cs/3,Ms=Math.log10,Rs=Math.sign;function Fs(e,t,n){return Math.abs(e-t)<n}function Bs(e){const t=Math.round(e);e=Fs(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(Ms(e))),r=e/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function zs(e){return!function(e){return"symbol"===typeof e||"object"===typeof e&&null!==e&&!(Symbol.toPrimitive in e||"toString"in e||"valueOf"in e)}(e)&&!isNaN(parseFloat(e))&&isFinite(e)}function Us(e,t,n){let r,s,a;for(r=0,s=e.length;r<s;r++)a=e[r][n],isNaN(a)||(t.min=Math.min(t.min,a),t.max=Math.max(t.max,a))}function Ws(e){return e*(Cs/180)}function qs(e){return e*(180/Cs)}function Hs(e){if(!cs(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function Vs(e,t){const n=t.x-e.x,r=t.y-e.y,s=Math.sqrt(n*n+r*r);let a=Math.atan2(r,n);return a<-.5*Cs&&(a+=Ts),{angle:a,distance:s}}function Js(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Ks(e,t){return(e-t+As)%Ts-Cs}function Ys(e){return(e%Ts+Ts)%Ts}function Gs(e,t,n,r){const s=Ys(e),a=Ys(t),i=Ys(n),o=Ys(a-s),l=Ys(i-s),c=Ys(s-a),d=Ys(s-i);return s===a||s===i||r&&a===i||o>l&&c<d}function $s(e,t,n){return Math.max(t,Math.min(n,e))}function Qs(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-6;return e>=Math.min(t,n)-r&&e<=Math.max(t,n)+r}function Xs(e,t,n){n=n||(n=>e[n]<t);let r,s=e.length-1,a=0;for(;s-a>1;)r=a+s>>1,n(r)?a=r:s=r;return{lo:a,hi:s}}const Zs=(e,t,n,r)=>Xs(e,n,r?r=>{const s=e[r][t];return s<n||s===n&&e[r+1][t]===n}:r=>e[r][t]<n),ea=(e,t,n)=>Xs(e,n,(r=>e[r][t]>=n));const ta=["push","pop","shift","splice","unshift"];function na(e,t){const n=e._chartjs;if(!n)return;const r=n.listeners,s=r.indexOf(t);-1!==s&&r.splice(s,1),r.length>0||(ta.forEach((t=>{delete e[t]})),delete e._chartjs)}function ra(e){const t=new Set(e);return t.size===e.length?e:Array.from(t)}const sa="undefined"===typeof window?function(e){return e()}:window.requestAnimationFrame;function aa(e,t){let n=[],r=!1;return function(){for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];n=a,r||(r=!0,sa.call(window,(()=>{r=!1,e.apply(t,n)})))}}const ia=e=>"start"===e?"left":"end"===e?"right":"center",oa=(e,t,n)=>"start"===e?t:"end"===e?n:(t+n)/2;function la(e,t,n){const r=t.length;let s=0,a=r;if(e._sorted){const{iScale:i,vScale:o,_parsed:l}=e,c=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null,d=i.axis,{min:u,max:h,minDefined:f,maxDefined:g}=i.getUserBounds();if(f){if(s=Math.min(Zs(l,d,u).lo,n?r:Zs(t,d,i.getPixelForValue(u)).lo),c){const e=l.slice(0,s+1).reverse().findIndex((e=>!is(e[o.axis])));s-=Math.max(0,e)}s=$s(s,0,r-1)}if(g){let e=Math.max(Zs(l,i.axis,h,!0).hi+1,n?0:Zs(t,d,i.getPixelForValue(h),!0).hi+1);if(c){const t=l.slice(e-1).findIndex((e=>!is(e[o.axis])));e+=Math.max(0,t)}a=$s(e,s,r)-s}else a=r-s}return{start:s,count:a}}function ca(e){const{xScale:t,yScale:n,_scaleRanges:r}=e,s={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!r)return e._scaleRanges=s,!0;const a=r.xmin!==t.min||r.xmax!==t.max||r.ymin!==n.min||r.ymax!==n.max;return Object.assign(r,s),a}const da=e=>0===e||1===e,ua=(e,t,n)=>-Math.pow(2,10*(e-=1))*Math.sin((e-t)*Ts/n),ha=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*Ts/n)+1,fa={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>1-Math.cos(e*Os),easeOutSine:e=>Math.sin(e*Os),easeInOutSine:e=>-.5*(Math.cos(Cs*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>da(e)?e:e<.5?.5*Math.pow(2,10*(2*e-1)):.5*(2-Math.pow(2,-10*(2*e-1))),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>da(e)?e:ua(e,.075,.3),easeOutElastic:e=>da(e)?e:ha(e,.075,.3),easeInOutElastic(e){const t=.1125;return da(e)?e:e<.5?.5*ua(2*e,t,.45):.5+.5*ha(2*e-1,t,.45)},easeInBack(e){const t=1.70158;return e*e*((t+1)*e-t)},easeOutBack(e){const t=1.70158;return(e-=1)*e*((t+1)*e+t)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?e*e*((1+(t*=1.525))*e-t)*.5:.5*((e-=2)*e*((1+(t*=1.525))*e+t)+2)},easeInBounce:e=>1-fa.easeOutBounce(1-e),easeOutBounce(e){const t=7.5625,n=2.75;return e<1/n?t*e*e:e<2/n?t*(e-=1.5/n)*e+.75:e<2.5/n?t*(e-=2.25/n)*e+.9375:t*(e-=2.625/n)*e+.984375},easeInOutBounce:e=>e<.5?.5*fa.easeInBounce(2*e):.5*fa.easeOutBounce(2*e-1)+.5};function ga(e){if(e&&"object"===typeof e){const t=e.toString();return"[object CanvasPattern]"===t||"[object CanvasGradient]"===t}return!1}function pa(e){return ga(e)?e:new rs(e)}function ma(e){return ga(e)?e:new rs(e).saturate(.5).darken(.1).hexString()}const ya=["x","y","borderWidth","radius","tension"],ba=["color","borderColor","backgroundColor"];const xa=new Map;function va(e,t,n){return function(e,t){t=t||{};const n=e+JSON.stringify(t);let r=xa.get(n);return r||(r=new Intl.NumberFormat(e,t),xa.set(n,r)),r}(t,n).format(e)}const wa={values:e=>os(e)?e:""+e,numeric(e,t,n){if(0===e)return"0";const r=this.chart.options.locale;let s,a=e;if(n.length>1){const t=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(t<1e-4||t>1e15)&&(s="scientific"),a=function(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e));return n}(e,n)}const i=Ms(Math.abs(a)),o=isNaN(i)?1:Math.max(Math.min(-1*Math.floor(i),20),0),l={notation:s,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),va(e,r,l)},logarithmic(e,t,n){if(0===e)return"0";const r=n[t].significand||e/Math.pow(10,Math.floor(Ms(e)));return[1,2,3,5,10,15].includes(r)||t>.8*n.length?wa.numeric.call(this,e,t,n):""}};var _a={formatters:wa};const Sa=Object.create(null),ka=Object.create(null);function ja(e,t){if(!t)return e;const n=t.split(".");for(let r=0,s=n.length;r<s;++r){const t=n[r];e=e[t]||(e[t]=Object.create(null))}return e}function Na(e,t,n){return"string"===typeof t?xs(ja(e,t),n):xs(ja(e,""),t)}class Ea{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=e=>e.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(e,t)=>ma(t.backgroundColor),this.hoverBorderColor=(e,t)=>ma(t.borderColor),this.hoverColor=(e,t)=>ma(t.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Na(this,e,t)}get(e){return ja(this,e)}describe(e,t){return Na(ka,e,t)}override(e,t){return Na(Sa,e,t)}route(e,t,n,r){const s=ja(this,e),a=ja(this,n),i="_"+t;Object.defineProperties(s,{[i]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const e=this[i],t=a[r];return ls(e)?Object.assign({},t,e):us(e,t)},set(e){this[i]=e}}})}apply(e){e.forEach((e=>e(this)))}}var Ca=new Ea({_scriptable:e=>!e.startsWith("on"),_indexable:e=>"events"!==e,hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[function(e){e.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),e.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>"onProgress"!==e&&"onComplete"!==e&&"fn"!==e}),e.set("animations",{colors:{type:"color",properties:ba},numbers:{type:"number",properties:ya}}),e.describe("animations",{_fallback:"animation"}),e.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>0|e}}}})},function(e){e.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})},function(e){e.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:_a.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),e.route("scale.ticks","color","","color"),e.route("scale.grid","color","","borderColor"),e.route("scale.border","color","","borderColor"),e.route("scale.title","color","","color"),e.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&"callback"!==e&&"parser"!==e,_indexable:e=>"borderDash"!==e&&"tickBorderDash"!==e&&"dash"!==e}),e.describe("scales",{_fallback:"scale"}),e.describe("scale.ticks",{_scriptable:e=>"backdropPadding"!==e&&"callback"!==e,_indexable:e=>"backdropPadding"!==e})}]);function Ta(e,t,n,r,s){let a=t[s];return a||(a=t[s]=e.measureText(s).width,n.push(s)),a>r&&(r=a),r}function Aa(e,t,n,r){let s=(r=r||{}).data=r.data||{},a=r.garbageCollect=r.garbageCollect||[];r.font!==t&&(s=r.data={},a=r.garbageCollect=[],r.font=t),e.save(),e.font=t;let i=0;const o=n.length;let l,c,d,u,h;for(l=0;l<o;l++)if(u=n[l],void 0===u||null===u||os(u)){if(os(u))for(c=0,d=u.length;c<d;c++)h=u[c],void 0===h||null===h||os(h)||(i=Ta(e,s,a,i,h))}else i=Ta(e,s,a,i,u);e.restore();const f=a.length/2;if(f>n.length){for(l=0;l<f;l++)delete s[a[l]];a.splice(0,f)}return i}function Da(e,t,n){const r=e.currentDevicePixelRatio,s=0!==n?Math.max(n/2,.5):0;return Math.round((t-s)*r)/r+s}function Pa(e,t){(t||e)&&((t=t||e.getContext("2d")).save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore())}function Oa(e,t,n,r){Ia(e,t,n,r,null)}function Ia(e,t,n,r,s){let a,i,o,l,c,d,u,h;const f=t.pointStyle,g=t.rotation,p=t.radius;let m=(g||0)*Ps;if(f&&"object"===typeof f&&(a=f.toString(),"[object HTMLImageElement]"===a||"[object HTMLCanvasElement]"===a))return e.save(),e.translate(n,r),e.rotate(m),e.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),void e.restore();if(!(isNaN(p)||p<=0)){switch(e.beginPath(),f){default:s?e.ellipse(n,r,s/2,p,0,0,Ts):e.arc(n,r,p,0,Ts),e.closePath();break;case"triangle":d=s?s/2:p,e.moveTo(n+Math.sin(m)*d,r-Math.cos(m)*p),m+=Ls,e.lineTo(n+Math.sin(m)*d,r-Math.cos(m)*p),m+=Ls,e.lineTo(n+Math.sin(m)*d,r-Math.cos(m)*p),e.closePath();break;case"rectRounded":c=.516*p,l=p-c,i=Math.cos(m+Is)*l,u=Math.cos(m+Is)*(s?s/2-c:l),o=Math.sin(m+Is)*l,h=Math.sin(m+Is)*(s?s/2-c:l),e.arc(n-u,r-o,c,m-Cs,m-Os),e.arc(n+h,r-i,c,m-Os,m),e.arc(n+u,r+o,c,m,m+Os),e.arc(n-h,r+i,c,m+Os,m+Cs),e.closePath();break;case"rect":if(!g){l=Math.SQRT1_2*p,d=s?s/2:l,e.rect(n-d,r-l,2*d,2*l);break}m+=Is;case"rectRot":u=Math.cos(m)*(s?s/2:p),i=Math.cos(m)*p,o=Math.sin(m)*p,h=Math.sin(m)*(s?s/2:p),e.moveTo(n-u,r-o),e.lineTo(n+h,r-i),e.lineTo(n+u,r+o),e.lineTo(n-h,r+i),e.closePath();break;case"crossRot":m+=Is;case"cross":u=Math.cos(m)*(s?s/2:p),i=Math.cos(m)*p,o=Math.sin(m)*p,h=Math.sin(m)*(s?s/2:p),e.moveTo(n-u,r-o),e.lineTo(n+u,r+o),e.moveTo(n+h,r-i),e.lineTo(n-h,r+i);break;case"star":u=Math.cos(m)*(s?s/2:p),i=Math.cos(m)*p,o=Math.sin(m)*p,h=Math.sin(m)*(s?s/2:p),e.moveTo(n-u,r-o),e.lineTo(n+u,r+o),e.moveTo(n+h,r-i),e.lineTo(n-h,r+i),m+=Is,u=Math.cos(m)*(s?s/2:p),i=Math.cos(m)*p,o=Math.sin(m)*p,h=Math.sin(m)*(s?s/2:p),e.moveTo(n-u,r-o),e.lineTo(n+u,r+o),e.moveTo(n+h,r-i),e.lineTo(n-h,r+i);break;case"line":i=s?s/2:Math.cos(m)*p,o=Math.sin(m)*p,e.moveTo(n-i,r-o),e.lineTo(n+i,r+o);break;case"dash":e.moveTo(n,r),e.lineTo(n+Math.cos(m)*(s?s/2:p),r+Math.sin(m)*p);break;case!1:e.closePath()}e.fill(),t.borderWidth>0&&e.stroke()}}function La(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function Ma(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Ra(e){e.restore()}function Fa(e,t,n,r,s){if(!t)return e.lineTo(n.x,n.y);if("middle"===s){const r=(t.x+n.x)/2;e.lineTo(r,t.y),e.lineTo(r,n.y)}else"after"===s!==!!r?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function Ba(e,t,n,r){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(r?t.cp1x:t.cp2x,r?t.cp1y:t.cp2y,r?n.cp2x:n.cp1x,r?n.cp2y:n.cp1y,n.x,n.y)}function za(e,t,n,r,s){if(s.strikethrough||s.underline){const a=e.measureText(r),i=t-a.actualBoundingBoxLeft,o=t+a.actualBoundingBoxRight,l=n-a.actualBoundingBoxAscent,c=n+a.actualBoundingBoxDescent,d=s.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=s.decorationWidth||2,e.moveTo(i,d),e.lineTo(o,d),e.stroke()}}function Ua(e,t){const n=e.fillStyle;e.fillStyle=t.color,e.fillRect(t.left,t.top,t.width,t.height),e.fillStyle=n}function Wa(e,t,n,r,s){let a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const i=os(t)?t:[t],o=a.strokeWidth>0&&""!==a.strokeColor;let l,c;for(e.save(),e.font=s.string,function(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),is(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}(e,a),l=0;l<i.length;++l)c=i[l],a.backdrop&&Ua(e,a.backdrop),o&&(a.strokeColor&&(e.strokeStyle=a.strokeColor),is(a.strokeWidth)||(e.lineWidth=a.strokeWidth),e.strokeText(c,n,r,a.maxWidth)),e.fillText(c,n,r,a.maxWidth),za(e,n,r,c,a),r+=Number(s.lineHeight);e.restore()}function qa(e,t){const{x:n,y:r,w:s,h:a,radius:i}=t;e.arc(n+i.topLeft,r+i.topLeft,i.topLeft,1.5*Cs,Cs,!0),e.lineTo(n,r+a-i.bottomLeft),e.arc(n+i.bottomLeft,r+a-i.bottomLeft,i.bottomLeft,Cs,Os,!0),e.lineTo(n+s-i.bottomRight,r+a),e.arc(n+s-i.bottomRight,r+a-i.bottomRight,i.bottomRight,Os,0,!0),e.lineTo(n+s,r+i.topRight),e.arc(n+s-i.topRight,r+i.topRight,i.topRight,0,-Os,!0),e.lineTo(n+i.topLeft,r)}const Ha=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Va=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Ja(e,t){const n=(""+e).match(Ha);if(!n||"normal"===n[1])return 1.2*t;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100}return t*e}function Ka(e,t){const n={},r=ls(t),s=r?Object.keys(t):t,a=ls(e)?r?n=>us(e[n],e[t[n]]):t=>e[t]:()=>e;for(const i of s)n[i]=+a(i)||0;return n}function Ya(e){return Ka(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Ga(e){return Ka(e,["topLeft","topRight","bottomLeft","bottomRight"])}function $a(e){const t=Ya(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Qa(e,t){e=e||{},t=t||Ca.font;let n=us(e.size,t.size);"string"===typeof n&&(n=parseInt(n,10));let r=us(e.style,t.style);r&&!(""+r).match(Va)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const s={family:us(e.family,t.family),lineHeight:Ja(us(e.lineHeight,t.lineHeight),n),size:n,style:r,weight:us(e.weight,t.weight),string:""};return s.string=function(e){return!e||is(e.size)||is(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}(s),s}function Xa(e,t,n,r){let s,a,i,o=!0;for(s=0,a=e.length;s<a;++s)if(i=e[s],void 0!==i&&(void 0!==t&&"function"===typeof i&&(i=i(t),o=!1),void 0!==n&&os(i)&&(i=i[n%i.length],o=!1),void 0!==i))return r&&!o&&(r.cacheable=!1),i}function Za(e,t){return Object.assign(Object.create(e),t)}function ei(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[""],n=arguments.length>3?arguments[3]:void 0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:()=>e[0];const s=(arguments.length>2?arguments[2]:void 0)||e;"undefined"===typeof n&&(n=ui("_fallback",e));const a={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:s,_fallback:n,_getTarget:r,override:r=>ei([r,...e],t,s,n)};return new Proxy(a,{deleteProperty:(t,n)=>(delete t[n],delete t._keys,delete e[0][n],!0),get:(n,r)=>ai(n,r,(()=>function(e,t,n,r){let s;for(const a of t)if(s=ui(ri(a,e),n),"undefined"!==typeof s)return si(e,s)?ci(n,r,e,s):s}(r,t,e,n))),getOwnPropertyDescriptor:(e,t)=>Reflect.getOwnPropertyDescriptor(e._scopes[0],t),getPrototypeOf:()=>Reflect.getPrototypeOf(e[0]),has:(e,t)=>hi(e).includes(t),ownKeys:e=>hi(e),set(e,t,n){const s=e._storage||(e._storage=r());return e[t]=s[t]=n,delete e._keys,!0}})}function ti(e,t,n,r){const s={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:ni(e,r),setContext:t=>ti(e,t,n,r),override:s=>ti(e.override(s),t,n,r)};return new Proxy(s,{deleteProperty:(t,n)=>(delete t[n],delete e[n],!0),get:(e,t,n)=>ai(e,t,(()=>function(e,t,n){const{_proxy:r,_context:s,_subProxy:a,_descriptors:i}=e;let o=r[t];Ns(o)&&i.isScriptable(t)&&(o=function(e,t,n,r){const{_proxy:s,_context:a,_subProxy:i,_stack:o}=n;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);o.add(e);let l=t(a,i||r);o.delete(e),si(e,l)&&(l=ci(s._scopes,s,e,l));return l}(t,o,e,n));os(o)&&o.length&&(o=function(e,t,n,r){const{_proxy:s,_context:a,_subProxy:i,_descriptors:o}=n;if("undefined"!==typeof a.index&&r(e))return t[a.index%t.length];if(ls(t[0])){const n=t,r=s._scopes.filter((e=>e!==n));t=[];for(const l of n){const n=ci(r,s,e,l);t.push(ti(n,a,i&&i[e],o))}}return t}(t,o,e,i.isIndexable));si(t,o)&&(o=ti(o,s,a&&a[t],i));return o}(e,t,n))),getOwnPropertyDescriptor:(t,n)=>t._descriptors.allKeys?Reflect.has(e,n)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,n),getPrototypeOf:()=>Reflect.getPrototypeOf(e),has:(t,n)=>Reflect.has(e,n),ownKeys:()=>Reflect.ownKeys(e),set:(t,n,r)=>(e[n]=r,delete t[n],!0)})}function ni(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{scriptable:!0,indexable:!0};const{_scriptable:n=t.scriptable,_indexable:r=t.indexable,_allKeys:s=t.allKeys}=e;return{allKeys:s,scriptable:n,indexable:r,isScriptable:Ns(n)?n:()=>n,isIndexable:Ns(r)?r:()=>r}}const ri=(e,t)=>e?e+ks(t):t,si=(e,t)=>ls(t)&&"adapters"!==e&&(null===Object.getPrototypeOf(t)||t.constructor===Object);function ai(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t)||"constructor"===t)return e[t];const r=n();return e[t]=r,r}function ii(e,t,n){return Ns(e)?e(t,n):e}const oi=(e,t)=>!0===e?t:"string"===typeof e?Ss(t,e):void 0;function li(e,t,n,r,s){for(const a of t){const t=oi(n,a);if(t){e.add(t);const a=ii(t._fallback,n,s);if("undefined"!==typeof a&&a!==n&&a!==r)return a}else if(!1===t&&"undefined"!==typeof r&&n!==r)return null}return!1}function ci(e,t,n,r){const s=t._rootScopes,a=ii(t._fallback,n,r),i=[...e,...s],o=new Set;o.add(r);let l=di(o,i,n,a||n,r);return null!==l&&(("undefined"===typeof a||a===n||(l=di(o,i,a,l,r),null!==l))&&ei(Array.from(o),[""],s,a,(()=>function(e,t,n){const r=e._getTarget();t in r||(r[t]={});const s=r[t];if(os(s)&&ls(n))return n;return s||{}}(t,n,r))))}function di(e,t,n,r,s){for(;n;)n=li(e,t,n,r,s);return n}function ui(e,t){for(const n of t){if(!n)continue;const t=n[e];if("undefined"!==typeof t)return t}}function hi(e){let t=e._keys;return t||(t=e._keys=function(e){const t=new Set;for(const n of e)for(const e of Object.keys(n).filter((e=>!e.startsWith("_"))))t.add(e);return Array.from(t)}(e._scopes)),t}function fi(e,t,n,r){const{iScale:s}=e,{key:a="r"}=this._parsing,i=new Array(r);let o,l,c,d;for(o=0,l=r;o<l;++o)c=o+n,d=t[c],i[o]={r:s.parse(Ss(d,a),c)};return i}const gi=Number.EPSILON||1e-14,pi=(e,t)=>t<e.length&&!e[t].skip&&e[t],mi=e=>"x"===e?"y":"x";function yi(e,t,n,r){const s=e.skip?t:e,a=t,i=n.skip?t:n,o=Js(a,s),l=Js(i,a);let c=o/(o+l),d=l/(o+l);c=isNaN(c)?0:c,d=isNaN(d)?0:d;const u=r*c,h=r*d;return{previous:{x:a.x-u*(i.x-s.x),y:a.y-u*(i.y-s.y)},next:{x:a.x+h*(i.x-s.x),y:a.y+h*(i.y-s.y)}}}function bi(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"x";const n=mi(t),r=e.length,s=Array(r).fill(0),a=Array(r);let i,o,l,c=pi(e,0);for(i=0;i<r;++i)if(o=l,l=c,c=pi(e,i+1),l){if(c){const e=c[t]-l[t];s[i]=0!==e?(c[n]-l[n])/e:0}a[i]=o?c?Rs(s[i-1])!==Rs(s[i])?0:(s[i-1]+s[i])/2:s[i-1]:s[i]}!function(e,t,n){const r=e.length;let s,a,i,o,l,c=pi(e,0);for(let d=0;d<r-1;++d)l=c,c=pi(e,d+1),l&&c&&(Fs(t[d],0,gi)?n[d]=n[d+1]=0:(s=n[d]/t[d],a=n[d+1]/t[d],o=Math.pow(s,2)+Math.pow(a,2),o<=9||(i=3/Math.sqrt(o),n[d]=s*i*t[d],n[d+1]=a*i*t[d])))}(e,s,a),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"x";const r=mi(n),s=e.length;let a,i,o,l=pi(e,0);for(let c=0;c<s;++c){if(i=o,o=l,l=pi(e,c+1),!o)continue;const s=o[n],d=o[r];i&&(a=(s-i[n])/3,o["cp1".concat(n)]=s-a,o["cp1".concat(r)]=d-a*t[c]),l&&(a=(l[n]-s)/3,o["cp2".concat(n)]=s+a,o["cp2".concat(r)]=d+a*t[c])}}(e,a,t)}function xi(e,t,n){return Math.max(Math.min(e,n),t)}function vi(e,t,n,r,s){let a,i,o,l;if(t.spanGaps&&(e=e.filter((e=>!e.skip))),"monotone"===t.cubicInterpolationMode)bi(e,s);else{let n=r?e[e.length-1]:e[0];for(a=0,i=e.length;a<i;++a)o=e[a],l=yi(n,o,e[Math.min(a+1,i-(r?0:1))%i],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,n=o}t.capBezierPoints&&function(e,t){let n,r,s,a,i,o=La(e[0],t);for(n=0,r=e.length;n<r;++n)i=a,a=o,o=n<r-1&&La(e[n+1],t),a&&(s=e[n],i&&(s.cp1x=xi(s.cp1x,t.left,t.right),s.cp1y=xi(s.cp1y,t.top,t.bottom)),o&&(s.cp2x=xi(s.cp2x,t.left,t.right),s.cp2y=xi(s.cp2y,t.top,t.bottom)))}(e,n)}function wi(){return"undefined"!==typeof window&&"undefined"!==typeof document}function _i(e){let t=e.parentNode;return t&&"[object ShadowRoot]"===t.toString()&&(t=t.host),t}function Si(e,t,n){let r;return"string"===typeof e?(r=parseInt(e,10),-1!==e.indexOf("%")&&(r=r/100*t.parentNode[n])):r=e,r}const ki=e=>e.ownerDocument.defaultView.getComputedStyle(e,null);const ji=["top","right","bottom","left"];function Ni(e,t,n){const r={};n=n?"-"+n:"";for(let s=0;s<4;s++){const a=ji[s];r[a]=parseFloat(e[t+"-"+a+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}function Ei(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:r}=t,s=ki(n),a="border-box"===s.boxSizing,i=Ni(s,"padding"),o=Ni(s,"border","width"),{x:l,y:c,box:d}=function(e,t){const n=e.touches,r=n&&n.length?n[0]:e,{offsetX:s,offsetY:a}=r;let i,o,l=!1;if(((e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot))(s,a,e.target))i=s,o=a;else{const e=t.getBoundingClientRect();i=r.clientX-e.left,o=r.clientY-e.top,l=!0}return{x:i,y:o,box:l}}(e,n),u=i.left+(d&&o.left),h=i.top+(d&&o.top);let{width:f,height:g}=t;return a&&(f-=i.width+o.width,g-=i.height+o.height),{x:Math.round((l-u)/f*n.width/r),y:Math.round((c-h)/g*n.height/r)}}const Ci=e=>Math.round(10*e)/10;function Ti(e,t,n,r){const s=ki(e),a=Ni(s,"margin"),i=Si(s.maxWidth,e,"clientWidth")||Ds,o=Si(s.maxHeight,e,"clientHeight")||Ds,l=function(e,t,n){let r,s;if(void 0===t||void 0===n){const a=e&&_i(e);if(a){const e=a.getBoundingClientRect(),i=ki(a),o=Ni(i,"border","width"),l=Ni(i,"padding");t=e.width-l.width-o.width,n=e.height-l.height-o.height,r=Si(i.maxWidth,a,"clientWidth"),s=Si(i.maxHeight,a,"clientHeight")}else t=e.clientWidth,n=e.clientHeight}return{width:t,height:n,maxWidth:r||Ds,maxHeight:s||Ds}}(e,t,n);let{width:c,height:d}=l;if("content-box"===s.boxSizing){const e=Ni(s,"border","width"),t=Ni(s,"padding");c-=t.width+e.width,d-=t.height+e.height}c=Math.max(0,c-a.width),d=Math.max(0,r?c/r:d-a.height),c=Ci(Math.min(c,i,l.maxWidth)),d=Ci(Math.min(d,o,l.maxHeight)),c&&!d&&(d=Ci(c/2));return(void 0!==t||void 0!==n)&&r&&l.height&&d>l.height&&(d=l.height,c=Ci(Math.floor(d*r))),{width:c,height:d}}function Ai(e,t,n){const r=t||1,s=Math.floor(e.height*r),a=Math.floor(e.width*r);e.height=Math.floor(e.height),e.width=Math.floor(e.width);const i=e.canvas;return i.style&&(n||!i.style.height&&!i.style.width)&&(i.style.height="".concat(e.height,"px"),i.style.width="".concat(e.width,"px")),(e.currentDevicePixelRatio!==r||i.height!==s||i.width!==a)&&(e.currentDevicePixelRatio=r,i.height=s,i.width=a,e.ctx.setTransform(r,0,0,r,0,0),!0)}const Di=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};wi()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch(pu){}return e}();function Pi(e,t){const n=function(e,t){return ki(e).getPropertyValue(t)}(e,t),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Oi(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function Ii(e,t,n,r){return{x:e.x+n*(t.x-e.x),y:"middle"===r?n<.5?e.y:t.y:"after"===r?n<1?e.y:t.y:n>0?t.y:e.y}}function Li(e,t,n,r){const s={x:e.cp2x,y:e.cp2y},a={x:t.cp1x,y:t.cp1y},i=Oi(e,s,n),o=Oi(s,a,n),l=Oi(a,t,n),c=Oi(i,o,n),d=Oi(o,l,n);return Oi(c,d,n)}function Mi(e,t,n){return e?function(e,t){return{x:n=>e+e+t-n,setWidth(e){t=e},textAlign:e=>"center"===e?e:"right"===e?"left":"right",xPlus:(e,t)=>e-t,leftForLtr:(e,t)=>e-t}}(t,n):{x:e=>e,setWidth(e){},textAlign:e=>e,xPlus:(e,t)=>e+t,leftForLtr:(e,t)=>e}}function Ri(e,t){let n,r;"ltr"!==t&&"rtl"!==t||(n=e.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=r)}function Fi(e,t){void 0!==t&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function Bi(e){return"angle"===e?{between:Gs,compare:Ks,normalize:Ys}:{between:Qs,compare:(e,t)=>e-t,normalize:e=>e}}function zi(e){let{start:t,end:n,count:r,loop:s,style:a}=e;return{start:t%r,end:n%r,loop:s&&(n-t+1)%r===0,style:a}}function Ui(e,t,n){if(!n)return[e];const{property:r,start:s,end:a}=n,i=t.length,{compare:o,between:l,normalize:c}=Bi(r),{start:d,end:u,loop:h,style:f}=function(e,t,n){const{property:r,start:s,end:a}=n,{between:i,normalize:o}=Bi(r),l=t.length;let c,d,{start:u,end:h,loop:f}=e;if(f){for(u+=l,h+=l,c=0,d=l;c<d&&i(o(t[u%l][r]),s,a);++c)u--,h--;u%=l,h%=l}return h<u&&(h+=l),{start:u,end:h,loop:f,style:e.style}}(e,t,n),g=[];let p,m,y,b=!1,x=null;const v=()=>b||l(s,y,p)&&0!==o(s,y),w=()=>!b||0===o(a,p)||l(a,y,p);for(let _=d,S=d;_<=u;++_)m=t[_%i],m.skip||(p=c(m[r]),p!==y&&(b=l(p,s,a),null===x&&v()&&(x=0===o(p,s)?_:S),null!==x&&w()&&(g.push(zi({start:x,end:_,loop:h,count:i,style:f})),x=null),S=_,y=p));return null!==x&&g.push(zi({start:x,end:u,loop:h,count:i,style:f})),g}function Wi(e,t){const n=[],r=e.segments;for(let s=0;s<r.length;s++){const a=Ui(r[s],e.points,t);a.length&&n.push(...a)}return n}function qi(e,t,n,r){return r&&r.setContext&&n?function(e,t,n,r){const s=e._chart.getContext(),a=Hi(e.options),{_datasetIndex:i,options:{spanGaps:o}}=e,l=n.length,c=[];let d=a,u=t[0].start,h=u;function f(e,t,r,s){const a=o?-1:1;if(e!==t){for(e+=l;n[e%l].skip;)e-=a;for(;n[t%l].skip;)t+=a;e%l!==t%l&&(c.push({start:e%l,end:t%l,loop:r,style:s}),d=s,u=t%l)}}for(const g of t){u=o?u:g.start;let e,t=n[u%l];for(h=u+1;h<=g.end;h++){const a=n[h%l];e=Hi(r.setContext(Za(s,{type:"segment",p0:t,p1:a,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:i}))),Vi(e,d)&&f(u,h-1,g.loop,d),t=a,d=e}u<h-1&&f(u,h-1,g.loop,d)}return c}(e,t,n,r):t}function Hi(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Vi(e,t){if(!t)return!1;const n=[],r=function(e,t){return ga(t)?(n.includes(t)||n.push(t),n.indexOf(t)):t};return JSON.stringify(e,r)!==JSON.stringify(t,r)}function Ji(e,t,n){return e.options.clip?e[n]:t[n]}function Ki(e,t){const n=t._clip;if(n.disabled)return!1;const r=function(e,t){const{xScale:n,yScale:r}=e;return n&&r?{left:Ji(n,t,"left"),right:Ji(n,t,"right"),top:Ji(r,t,"top"),bottom:Ji(r,t,"bottom")}:t}(t,e.chartArea);return{left:!1===n.left?0:r.left-(!0===n.left?0:n.left),right:!1===n.right?e.width:r.right+(!0===n.right?0:n.right),top:!1===n.top?0:r.top-(!0===n.top?0:n.top),bottom:!1===n.bottom?e.height:r.bottom+(!0===n.bottom?0:n.bottom)}}class Yi{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,r){const s=t.listeners[r],a=t.duration;s.forEach((r=>r({chart:e,initial:t.initial,numSteps:a,currentStep:Math.min(n-t.start,a)})))}_refresh(){this._request||(this._running=!0,this._request=sa.call(window,(()=>{this._update(),this._request=null,this._running&&this._refresh()})))}_update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=0;this._charts.forEach(((n,r)=>{if(!n.running||!n.items.length)return;const s=n.items;let a,i=s.length-1,o=!1;for(;i>=0;--i)a=s[i],a._active?(a._total>n.duration&&(n.duration=a._total),a.tick(e),o=!0):(s[i]=s[s.length-1],s.pop());o&&(r.draw(),this._notify(r,n,e,"progress")),s.length||(n.running=!1,this._notify(r,n,e,"complete"),n.initial=!1),t+=s.length})),this._lastDate=e,0===t&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){t&&t.length&&this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce(((e,t)=>Math.max(e,t._duration)),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!!(t&&t.running&&t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let r=n.length-1;for(;r>=0;--r)n[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Gi=new Yi;const $i="transparent",Qi={boolean:(e,t,n)=>n>.5?t:e,color(e,t,n){const r=pa(e||$i),s=r.valid&&pa(t||$i);return s&&s.valid?s.mix(r,n).hexString():t},number:(e,t,n)=>e+(t-e)*n};class Xi{constructor(e,t,n,r){const s=t[n];r=Xa([e.to,r,s,e.from]);const a=Xa([e.from,s,r]);this._active=!0,this._fn=e.fn||Qi[e.type||typeof a],this._easing=fa[e.easing]||fa.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=a,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const r=this._target[this._prop],s=n-this._start,a=this._duration-s;this._start=n,this._duration=Math.floor(Math.max(a,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=Xa([e.to,t,r,e.from]),this._from=Xa([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,r=this._prop,s=this._from,a=this._loop,i=this._to;let o;if(this._active=s!==i&&(a||t<n),!this._active)return this._target[r]=i,void this._notify(!0);t<0?this._target[r]=s:(o=t/n%2,o=a&&o>1?2-o:o,o=this._easing(Math.min(1,Math.max(0,o))),this._target[r]=this._fn(s,i,o))}wait(){const e=this._promises||(this._promises=[]);return new Promise(((t,n)=>{e.push({res:t,rej:n})}))}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let r=0;r<n.length;r++)n[r][t]()}}class Zi{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!ls(e))return;const t=Object.keys(Ca.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach((r=>{const s=e[r];if(!ls(s))return;const a={};for(const e of t)a[e]=s[e];(os(s.properties)&&s.properties||[r]).forEach((e=>{e!==r&&n.has(e)||n.set(e,a)}))}))}_animateOptions(e,t){const n=t.options,r=function(e,t){if(!t)return;let n=e.options;if(!n)return void(e.options=t);n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}}));return n}(e,n);if(!r)return[];const s=this._createAnimations(r,n);return n.$shared&&function(e,t){const n=[],r=Object.keys(t);for(let s=0;s<r.length;s++){const t=e[r[s]];t&&t.active()&&n.push(t.wait())}return Promise.all(n)}(e.options.$animations,n).then((()=>{e.options=n}),(()=>{})),s}_createAnimations(e,t){const n=this._properties,r=[],s=e.$animations||(e.$animations={}),a=Object.keys(t),i=Date.now();let o;for(o=a.length-1;o>=0;--o){const l=a[o];if("$"===l.charAt(0))continue;if("options"===l){r.push(...this._animateOptions(e,t));continue}const c=t[l];let d=s[l];const u=n.get(l);if(d){if(u&&d.active()){d.update(u,c,i);continue}d.cancel()}u&&u.duration?(s[l]=d=new Xi(u,e,l,c),r.push(d)):e[l]=c}return r}update(e,t){if(0===this._properties.size)return void Object.assign(e,t);const n=this._createAnimations(e,t);return n.length?(Gi.add(this._chart,n),!0):void 0}}function eo(e,t){const n=e&&e.options||{},r=n.reverse,s=void 0===n.min?t:0,a=void 0===n.max?t:0;return{start:r?a:s,end:r?s:a}}function to(e,t){const n=[],r=e._getSortedDatasetMetas(t);let s,a;for(s=0,a=r.length;s<a;++s)n.push(r[s].index);return n}function no(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const s=e.keys,a="single"===r.mode;let i,o,l,c;if(null===t)return;let d=!1;for(i=0,o=s.length;i<o;++i){if(l=+s[i],l===n){if(d=!0,r.all)continue;break}c=e.values[l],cs(c)&&(a||0===t||Rs(t)===Rs(c))&&(t+=c)}return d||r.all?t:0}function ro(e,t){const n=e&&e.options.stacked;return n||void 0===n&&void 0!==t.stack}function so(e,t,n){const r=e[t]||(e[t]={});return r[n]||(r[n]={})}function ao(e,t,n,r){for(const s of t.getMatchingVisibleMetas(r).reverse()){const t=e[s.index];if(n&&t>0||!n&&t<0)return s.index}return null}function io(e,t){const{chart:n,_cachedMeta:r}=e,s=n._stacks||(n._stacks={}),{iScale:a,vScale:i,index:o}=r,l=a.axis,c=i.axis,d=function(e,t,n){return"".concat(e.id,".").concat(t.id,".").concat(n.stack||n.type)}(a,i,r),u=t.length;let h;for(let f=0;f<u;++f){const e=t[f],{[l]:n,[c]:a}=e;h=(e._stacks||(e._stacks={}))[c]=so(s,d,n),h[o]=a,h._top=ao(h,i,!0,r.type),h._bottom=ao(h,i,!1,r.type);(h._visualValues||(h._visualValues={}))[o]=a}}function oo(e,t){const n=e.scales;return Object.keys(n).filter((e=>n[e].axis===t)).shift()}function lo(e,t){const n=e.controller.index,r=e.vScale&&e.vScale.axis;if(r){t=t||e._parsed;for(const e of t){const t=e._stacks;if(!t||void 0===t[r]||void 0===t[r][n])return;delete t[r][n],void 0!==t[r]._visualValues&&void 0!==t[r]._visualValues[n]&&delete t[r]._visualValues[n]}}}const co=e=>"reset"===e||"none"===e,uo=(e,t)=>t?e:Object.assign({},e);class ho{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=ro(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&lo(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),r=(e,t,n,r)=>"x"===e?t:"r"===e?r:n,s=t.xAxisID=us(n.xAxisID,oo(e,"x")),a=t.yAxisID=us(n.yAxisID,oo(e,"y")),i=t.rAxisID=us(n.rAxisID,oo(e,"r")),o=t.indexAxis,l=t.iAxisID=r(o,s,a,i),c=t.vAxisID=r(o,a,s,i);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(a),t.rScale=this.getScaleForId(i),t.iScale=this.getScaleForId(l),t.vScale=this.getScaleForId(c)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&na(this._data,this),e._stacked&&lo(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(ls(t)){const e=this._cachedMeta;this._data=function(e,t){const{iScale:n,vScale:r}=t,s="x"===n.axis?"x":"y",a="x"===r.axis?"x":"y",i=Object.keys(e),o=new Array(i.length);let l,c,d;for(l=0,c=i.length;l<c;++l)d=i[l],o[l]={[s]:d,[a]:e[d]};return o}(t,e)}else if(n!==t){if(n){na(n,this);const e=this._cachedMeta;lo(e),e._parsed=[]}t&&Object.isExtensible(t)&&(s=this,(r=t)._chartjs?r._chartjs.listeners.push(s):(Object.defineProperty(r,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[s]}}),ta.forEach((e=>{const t="_onData"+ks(e),n=r[e];Object.defineProperty(r,e,{configurable:!0,enumerable:!1,value(){for(var e=arguments.length,s=new Array(e),a=0;a<e;a++)s[a]=arguments[a];const i=n.apply(this,s);return r._chartjs.listeners.forEach((e=>{"function"===typeof e[t]&&e[t](...s)})),i}})})))),this._syncList=[],this._data=t}var r,s}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let r=!1;this._dataCheck();const s=t._stacked;t._stacked=ro(t.vScale,t),t.stack!==n.stack&&(r=!0,lo(t),t.stack=n.stack),this._resyncElements(e),(r||s!==t._stacked)&&(io(this,t._parsed),t._stacked=ro(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:r}=this,{iScale:s,_stacked:a}=n,i=s.axis;let o,l,c,d=0===e&&t===r.length||n._sorted,u=e>0&&n._parsed[e-1];if(!1===this._parsing)n._parsed=r,n._sorted=!0,c=r;else{c=os(r[e])?this.parseArrayData(n,r,e,t):ls(r[e])?this.parseObjectData(n,r,e,t):this.parsePrimitiveData(n,r,e,t);const s=()=>null===l[i]||u&&l[i]<u[i];for(o=0;o<t;++o)n._parsed[o+e]=l=c[o],d&&(s()&&(d=!1),u=l);n._sorted=d}a&&io(this,c)}parsePrimitiveData(e,t,n,r){const{iScale:s,vScale:a}=e,i=s.axis,o=a.axis,l=s.getLabels(),c=s===a,d=new Array(r);let u,h,f;for(u=0,h=r;u<h;++u)f=u+n,d[u]={[i]:c||s.parse(l[f],f),[o]:a.parse(t[f],f)};return d}parseArrayData(e,t,n,r){const{xScale:s,yScale:a}=e,i=new Array(r);let o,l,c,d;for(o=0,l=r;o<l;++o)c=o+n,d=t[c],i[o]={x:s.parse(d[0],c),y:a.parse(d[1],c)};return i}parseObjectData(e,t,n,r){const{xScale:s,yScale:a}=e,{xAxisKey:i="x",yAxisKey:o="y"}=this._parsing,l=new Array(r);let c,d,u,h;for(c=0,d=r;c<d;++c)u=c+n,h=t[u],l[c]={x:s.parse(Ss(h,i),u),y:a.parse(Ss(h,o),u)};return l}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const r=this.chart,s=this._cachedMeta,a=t[e.axis];return no({keys:to(r,!0),values:t._stacks[e.axis]._visualValues},a,s.index,{mode:n})}updateRangeFromParsed(e,t,n,r){const s=n[t.axis];let a=null===s?NaN:s;const i=r&&n._stacks[t.axis];r&&i&&(r.values=i,a=no(r,s,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,t){const n=this._cachedMeta,r=n._parsed,s=n._sorted&&e===n.iScale,a=r.length,i=this._getOtherScale(e),o=((e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:to(n,!0),values:null})(t,n,this.chart),l={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:c,max:d}=function(e){const{min:t,max:n,minDefined:r,maxDefined:s}=e.getUserBounds();return{min:r?t:Number.NEGATIVE_INFINITY,max:s?n:Number.POSITIVE_INFINITY}}(i);let u,h;function f(){h=r[u];const t=h[i.axis];return!cs(h[e.axis])||c>t||d<t}for(u=0;u<a&&(f()||(this.updateRangeFromParsed(l,e,h,o),!s));++u);if(s)for(u=a-1;u>=0;--u)if(!f()){this.updateRangeFromParsed(l,e,h,o);break}return l}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let r,s,a;for(r=0,s=t.length;r<s;++r)a=t[r][e.axis],cs(a)&&n.push(a);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,r=t.vScale,s=this.getParsed(e);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:r?""+r.getLabelForValue(s[r.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=function(e){let t,n,r,s;return ls(e)?(t=e.top,n=e.right,r=e.bottom,s=e.left):t=n=r=s=e,{top:t,right:n,bottom:r,left:s,disabled:!1===e}}(us(this.options.clip,function(e,t,n){if(!1===n)return!1;const r=eo(e,n),s=eo(t,n);return{top:s.end,right:r.end,bottom:s.start,left:r.start}}(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,r=n.data||[],s=t.chartArea,a=[],i=this._drawStart||0,o=this._drawCount||r.length-i,l=this.options.drawActiveElementsOnTop;let c;for(n.dataset&&n.dataset.draw(e,s,i,o),c=i;c<i+o;++c){const t=r[c];t.hidden||(t.active&&l?a.push(t):t.draw(e,s))}for(c=0;c<a.length;++c)a[c].draw(e,s)}getStyle(e,t){const n=t?"active":"default";return void 0===e&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const r=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const t=this._cachedMeta.data[e];s=t.$context||(t.$context=function(e,t,n){return Za(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}(this.getContext(),e,t)),s.parsed=this.getParsed(e),s.raw=r.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=function(e,t){return Za(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}(this.chart.getContext(),this.index)),s.dataset=r,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=n,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"default",n=arguments.length>2?arguments[2]:void 0;const r="active"===t,s=this._cachedDataOpts,a=e+"-"+t,i=s[a],o=this.enableOptionSharing&&js(n);if(i)return uo(i,o);const l=this.chart.config,c=l.datasetElementScopeKeys(this._type,e),d=r?["".concat(e,"Hover"),"hover",e,""]:[e,""],u=l.getOptionScopes(this.getDataset(),c),h=Object.keys(Ca.elements[e]),f=l.resolveNamedOptions(u,h,(()=>this.getContext(n,r,t)),d);return f.$shared&&(f.$shared=o,s[a]=Object.freeze(uo(f,o))),f}_resolveAnimations(e,t,n){const r=this.chart,s=this._cachedDataOpts,a="animation-".concat(t),i=s[a];if(i)return i;let o;if(!1!==r.options.animation){const r=this.chart.config,s=r.datasetAnimationScopeKeys(this._type,t),a=r.getOptionScopes(this.getDataset(),s);o=r.createResolver(a,this.getContext(e,n,t))}const l=new Zi(r,o&&o.animations);return o&&o._cacheable&&(s[a]=Object.freeze(l)),l}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||co(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),r=this._sharedOptions,s=this.getSharedOptions(n),a=this.includeOptions(t,s)||s!==r;return this.updateSharedOptions(s,t,n),{sharedOptions:s,includeOptions:a}}updateElement(e,t,n,r){co(r)?Object.assign(e,n):this._resolveAnimations(t,r).update(e,n)}updateSharedOptions(e,t,n){e&&!co(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,r){e.active=r;const s=this.getStyle(t,r);this._resolveAnimations(t,n,r).update(e,{options:!r&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[i,o,l]of this._syncList)this[i](o,l);this._syncList=[];const r=n.length,s=t.length,a=Math.min(s,r);a&&this.parse(0,a),s>r?this._insertElements(r,s-r,e):s<r&&this._removeElements(s,r-s)}_insertElements(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=this._cachedMeta,s=r.data,a=e+t;let i;const o=e=>{for(e.length+=t,i=e.length-1;i>=a;i--)e[i]=e[i-t]};for(o(s),i=e;i<a;++i)s[i]=new this.dataElementType;this._parsing&&o(r._parsed),this.parse(e,t),n&&this.updateElements(s,e,t,"reset")}updateElements(e,t,n,r){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const r=n._parsed.splice(e,t);n._stacked&&lo(n,r)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,r]=e;this[t](n,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function fo(e){const t=e.iScale,n=function(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let r=[];for(let t=0,s=n.length;t<s;t++)r=r.concat(n[t].controller.getAllParsedValues(e));e._cache.$bar=ra(r.sort(((e,t)=>e-t)))}return e._cache.$bar}(t,e.type);let r,s,a,i,o=t._length;const l=()=>{32767!==a&&-32768!==a&&(js(i)&&(o=Math.min(o,Math.abs(a-i)||o)),i=a)};for(r=0,s=n.length;r<s;++r)a=t.getPixelForValue(n[r]),l();for(i=void 0,r=0,s=t.ticks.length;r<s;++r)a=t.getPixelForTick(r),l();return o}function go(e,t,n,r){return os(e)?function(e,t,n,r){const s=n.parse(e[0],r),a=n.parse(e[1],r),i=Math.min(s,a),o=Math.max(s,a);let l=i,c=o;Math.abs(i)>Math.abs(o)&&(l=o,c=i),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:s,end:a,min:i,max:o}}(e,t,n,r):t[n.axis]=n.parse(e,r),t}function po(e,t,n,r){const s=e.iScale,a=e.vScale,i=s.getLabels(),o=s===a,l=[];let c,d,u,h;for(c=n,d=n+r;c<d;++c)h=t[c],u={},u[s.axis]=o||s.parse(i[c],c),l.push(go(h,u,a,c));return l}function mo(e){return e&&void 0!==e.barStart&&void 0!==e.barEnd}function yo(e,t,n,r){let s=t.borderSkipped;const a={};if(!s)return void(e.borderSkipped=a);if(!0===s)return void(e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0});const{start:i,end:o,reverse:l,top:c,bottom:d}=function(e){let t,n,r,s,a;return e.horizontal?(t=e.base>e.x,n="left",r="right"):(t=e.base<e.y,n="bottom",r="top"),t?(s="end",a="start"):(s="start",a="end"),{start:n,end:r,reverse:t,top:s,bottom:a}}(e);"middle"===s&&n&&(e.enableBorderRadius=!0,(n._top||0)===r?s=c:(n._bottom||0)===r?s=d:(a[bo(d,i,o,l)]=!0,s=c)),a[bo(s,i,o,l)]=!0,e.borderSkipped=a}function bo(e,t,n,r){var s,a,i;return r?(i=n,e=xo(e=(s=e)===(a=t)?i:s===i?a:s,n,t)):e=xo(e,t,n),e}function xo(e,t,n){return"start"===e?t:"end"===e?n:e}function vo(e,t,n){let{inflateAmount:r}=t;e.inflateAmount="auto"===r?1===n?.33:0:r}(0,kr.A)(ho,"defaults",{}),(0,kr.A)(ho,"datasetElementType",null),(0,kr.A)(ho,"dataElementType",null);class wo extends ho{parsePrimitiveData(e,t,n,r){return po(e,t,n,r)}parseArrayData(e,t,n,r){return po(e,t,n,r)}parseObjectData(e,t,n,r){const{iScale:s,vScale:a}=e,{xAxisKey:i="x",yAxisKey:o="y"}=this._parsing,l="x"===s.axis?i:o,c="x"===a.axis?i:o,d=[];let u,h,f,g;for(u=n,h=n+r;u<h;++u)g=t[u],f={},f[s.axis]=s.parse(Ss(g,l),u),d.push(go(Ss(g,c),f,a,u));return d}updateRangeFromParsed(e,t,n,r){super.updateRangeFromParsed(e,t,n,r);const s=n._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:r}=t,s=this.getParsed(e),a=s._custom,i=mo(a)?"["+a.start+", "+a.end+"]":""+r.getLabelForValue(s[r.axis]);return{label:""+n.getLabelForValue(s[n.axis]),value:i}}initialize(){this.enableOptionSharing=!0,super.initialize();this._cachedMeta.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,r){const s="reset"===r,{index:a,_cachedMeta:{vScale:i}}=this,o=i.getBasePixel(),l=i.isHorizontal(),c=this._getRuler(),{sharedOptions:d,includeOptions:u}=this._getSharedOptions(t,r);for(let h=t;h<t+n;h++){const t=this.getParsed(h),n=s||is(t[i.axis])?{base:o,head:o}:this._calculateBarValuePixels(h),f=this._calculateBarIndexPixels(h,c),g=(t._stacks||{})[i.axis],p={horizontal:l,base:n.base,enableBorderRadius:!g||mo(t._custom)||a===g._top||a===g._bottom,x:l?n.head:f.center,y:l?f.center:n.head,height:l?f.size:Math.abs(n.size),width:l?Math.abs(n.size):f.size};u&&(p.options=d||this.resolveDataElementOptions(h,e[h].active?"active":r));const m=p.options||e[h].options;yo(p,m,g,a),vo(p,m,c.ratio),this.updateElement(e[h],h,p,r)}}_getStacks(e,t){const{iScale:n}=this._cachedMeta,r=n.getMatchingVisibleMetas(this._type).filter((e=>e.controller.options.grouped)),s=n.options.stacked,a=[],i=this._cachedMeta.controller.getParsed(t),o=i&&i[n.axis],l=e=>{const t=e._parsed.find((e=>e[n.axis]===o)),r=t&&t[e.vScale.axis];if(is(r)||isNaN(r))return!0};for(const c of r)if((void 0===t||!l(c))&&((!1===s||-1===a.indexOf(c.stack)||void 0===s&&void 0===c.stack)&&a.push(c.stack),c.index===e))break;return a.length||a.push(void 0),a}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,t,n){const r=this._getStacks(e,n),s=void 0!==t?r.indexOf(t):-1;return-1===s?r.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,n=t.iScale,r=[];let s,a;for(s=0,a=t.data.length;s<a;++s)r.push(n.getPixelForValue(this.getParsed(s)[n.axis],s));const i=e.barThickness;return{min:i||fo(t),pixels:r,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:i?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:n,index:r},options:{base:s,minBarLength:a}}=this,i=s||0,o=this.getParsed(e),l=o._custom,c=mo(l);let d,u,h=o[t.axis],f=0,g=n?this.applyStack(t,o,n):h;g!==h&&(f=g-h,g=h),c&&(h=l.barStart,g=l.barEnd-l.barStart,0!==h&&Rs(h)!==Rs(l.barEnd)&&(f=0),f+=h);const p=is(s)||c?f:s;let m=t.getPixelForValue(p);if(d=this.chart.getDataVisibility(e)?t.getPixelForValue(f+g):m,u=d-m,Math.abs(u)<a){u=function(e,t,n){return 0!==e?Rs(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}(u,t,i)*a,h===i&&(m-=u/2);const e=t.getPixelForDecimal(0),s=t.getPixelForDecimal(1),l=Math.min(e,s),f=Math.max(e,s);m=Math.max(Math.min(m,f),l),d=m+u,n&&!c&&(o._stacks[t.axis]._visualValues[r]=t.getValueForPixel(d)-t.getValueForPixel(m))}if(m===t.getPixelForValue(i)){const e=Rs(u)*t.getLineWidthForValue(i)/2;m+=e,u-=e}return{size:u,base:m,head:d,center:d+u/2}}_calculateBarIndexPixels(e,t){const n=t.scale,r=this.options,s=r.skipNull,a=us(r.maxBarThickness,1/0);let i,o;if(t.grouped){const n=s?this._getStackCount(e):t.stackCount,l="flex"===r.barThickness?function(e,t,n,r){const s=t.pixels,a=s[e];let i=e>0?s[e-1]:null,o=e<s.length-1?s[e+1]:null;const l=n.categoryPercentage;null===i&&(i=a-(null===o?t.end-t.start:o-a)),null===o&&(o=a+a-i);const c=a-(a-Math.min(i,o))/2*l;return{chunk:Math.abs(o-i)/2*l/r,ratio:n.barPercentage,start:c}}(e,t,r,n):function(e,t,n,r){const s=n.barThickness;let a,i;return is(s)?(a=t.min*n.categoryPercentage,i=n.barPercentage):(a=s*r,i=1),{chunk:a/r,ratio:i,start:t.pixels[e]-a/2}}(e,t,r,n),c=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0);i=l.start+l.chunk*c+l.chunk/2,o=Math.min(a,l.chunk*l.ratio)}else i=n.getPixelForValue(this.getParsed(e)[n.axis],e),o=Math.min(a,t.min*t.ratio);return{base:i-o/2,head:i+o/2,center:i,size:o}}draw(){const e=this._cachedMeta,t=e.vScale,n=e.data,r=n.length;let s=0;for(;s<r;++s)null===this.getParsed(s)[t.axis]||n[s].hidden||n[s].draw(this._ctx)}}(0,kr.A)(wo,"id","bar"),(0,kr.A)(wo,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),(0,kr.A)(wo,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});class _o extends ho{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,t,n,r){const s=super.parsePrimitiveData(e,t,n,r);for(let a=0;a<s.length;a++)s[a]._custom=this.resolveDataElementOptions(a+n).radius;return s}parseArrayData(e,t,n,r){const s=super.parseArrayData(e,t,n,r);for(let a=0;a<s.length;a++){const e=t[n+a];s[a]._custom=us(e[2],this.resolveDataElementOptions(a+n).radius)}return s}parseObjectData(e,t,n,r){const s=super.parseObjectData(e,t,n,r);for(let a=0;a<s.length;a++){const e=t[n+a];s[a]._custom=us(e&&e.r&&+e.r,this.resolveDataElementOptions(a+n).radius)}return s}getMaxOverflow(){const e=this._cachedMeta.data;let t=0;for(let n=e.length-1;n>=0;--n)t=Math.max(t,e[n].size(this.resolveDataElementOptions(n))/2);return t>0&&t}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart.data.labels||[],{xScale:r,yScale:s}=t,a=this.getParsed(e),i=r.getLabelForValue(a.x),o=s.getLabelForValue(a.y),l=a._custom;return{label:n[e]||"",value:"("+i+", "+o+(l?", "+l:"")+")"}}update(e){const t=this._cachedMeta.data;this.updateElements(t,0,t.length,e)}updateElements(e,t,n,r){const s="reset"===r,{iScale:a,vScale:i}=this._cachedMeta,{sharedOptions:o,includeOptions:l}=this._getSharedOptions(t,r),c=a.axis,d=i.axis;for(let u=t;u<t+n;u++){const t=e[u],n=!s&&this.getParsed(u),h={},f=h[c]=s?a.getPixelForDecimal(.5):a.getPixelForValue(n[c]),g=h[d]=s?i.getBasePixel():i.getPixelForValue(n[d]);h.skip=isNaN(f)||isNaN(g),l&&(h.options=o||this.resolveDataElementOptions(u,t.active?"active":r),s&&(h.options.radius=0)),this.updateElement(t,u,h,r)}}resolveDataElementOptions(e,t){const n=this.getParsed(e);let r=super.resolveDataElementOptions(e,t);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const s=r.radius;return"active"!==t&&(r.radius=0),r.radius+=us(n&&n._custom,s),r}}(0,kr.A)(_o,"id","bubble"),(0,kr.A)(_o,"defaults",{datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}}),(0,kr.A)(_o,"overrides",{scales:{x:{type:"linear"},y:{type:"linear"}}});class So extends ho{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,r=this._cachedMeta;if(!1===this._parsing)r._parsed=n;else{let s,a,i=e=>+n[e];if(ls(n[e])){const{key:e="value"}=this._parsing;i=t=>+Ss(n[t],e)}for(s=e,a=e+t;s<a;++s)r._parsed[s]=i(s)}}_getRotation(){return Ws(this.options.rotation-90)}_getCircumference(){return Ws(this.options.circumference)}_getRotationExtents(){let e=Ts,t=-Ts;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const r=this.chart.getDatasetMeta(n).controller,s=r._getRotation(),a=r._getCircumference();e=Math.min(e,s),t=Math.max(t,s+a)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,r=this._cachedMeta,s=r.data,a=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,i=Math.max((Math.min(n.width,n.height)-a)/2,0),o=Math.min((l=this.options.cutout,c=i,"string"===typeof l&&l.endsWith("%")?parseFloat(l)/100:+l/c),1);var l,c;const d=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:g,offsetX:p,offsetY:m}=function(e,t,n){let r=1,s=1,a=0,i=0;if(t<Ts){const o=e,l=o+t,c=Math.cos(o),d=Math.sin(o),u=Math.cos(l),h=Math.sin(l),f=(e,t,r)=>Gs(e,o,l,!0)?1:Math.max(t,t*n,r,r*n),g=(e,t,r)=>Gs(e,o,l,!0)?-1:Math.min(t,t*n,r,r*n),p=f(0,c,u),m=f(Os,d,h),y=g(Cs,c,u),b=g(Cs+Os,d,h);r=(p-y)/2,s=(m-b)/2,a=-(p+y)/2,i=-(m+b)/2}return{ratioX:r,ratioY:s,offsetX:a,offsetY:i}}(h,u,o),y=(n.width-a)/f,b=(n.height-a)/g,x=Math.max(Math.min(y,b)/2,0),v=hs(this.options.radius,x),w=(v-Math.max(v*o,0))/this._getVisibleDatasetWeightTotal();this.offsetX=p*v,this.offsetY=m*v,r.total=this.calculateTotal(),this.outerRadius=v-w*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-w*d,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const n=this.options,r=this._cachedMeta,s=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||null===r._parsed[e]||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*s/Ts)}updateElements(e,t,n,r){const s="reset"===r,a=this.chart,i=a.chartArea,o=a.options.animation,l=(i.left+i.right)/2,c=(i.top+i.bottom)/2,d=s&&o.animateScale,u=d?0:this.innerRadius,h=d?0:this.outerRadius,{sharedOptions:f,includeOptions:g}=this._getSharedOptions(t,r);let p,m=this._getRotation();for(p=0;p<t;++p)m+=this._circumference(p,s);for(p=t;p<t+n;++p){const t=this._circumference(p,s),n=e[p],a={x:l+this.offsetX,y:c+this.offsetY,startAngle:m,endAngle:m+t,circumference:t,outerRadius:h,innerRadius:u};g&&(a.options=f||this.resolveDataElementOptions(p,n.active?"active":r)),m+=t,this.updateElement(n,p,a,r)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n,r=0;for(n=0;n<t.length;n++){const s=e._parsed[n];null===s||isNaN(s)||!this.chart.getDataVisibility(n)||t[n].hidden||(r+=Math.abs(s))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Ts*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,r=n.data.labels||[],s=va(t._parsed[e],n.options.locale);return{label:r[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const n=this.chart;let r,s,a,i,o;if(!e)for(r=0,s=n.data.datasets.length;r<s;++r)if(n.isDatasetVisible(r)){a=n.getDatasetMeta(r),e=a.data,i=a.controller;break}if(!e)return 0;for(r=0,s=e.length;r<s;++r)o=i.resolveDataElementOptions(r),"inner"!==o.borderAlign&&(t=Math.max(t,o.borderWidth||0,o.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,r=e.length;n<r;++n){const e=this.resolveDataElementOptions(n);t=Math.max(t,e.offset||0,e.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(us(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}(0,kr.A)(So,"id","doughnut"),(0,kr.A)(So,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),(0,kr.A)(So,"descriptors",{_scriptable:e=>"spacing"!==e,_indexable:e=>"spacing"!==e&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),(0,kr.A)(So,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:r}}=e.legend.options;return t.labels.map(((t,s)=>{const a=e.getDatasetMeta(0).controller.getStyle(s);return{text:t,fillStyle:a.backgroundColor,strokeStyle:a.borderColor,fontColor:r,lineWidth:a.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(s),index:s}}))}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});class ko extends ho{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:n,data:r=[],_dataset:s}=t,a=this.chart._animationsDisabled;let{start:i,count:o}=la(t,r,a);this._drawStart=i,this._drawCount=o,ca(t)&&(i=0,o=r.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!s._decimated,n.points=r;const l=this.resolveDatasetElementOptions(e);this.options.showLine||(l.borderWidth=0),l.segment=this.options.segment,this.updateElement(n,void 0,{animated:!a,options:l},e),this.updateElements(r,i,o,e)}updateElements(e,t,n,r){const s="reset"===r,{iScale:a,vScale:i,_stacked:o,_dataset:l}=this._cachedMeta,{sharedOptions:c,includeOptions:d}=this._getSharedOptions(t,r),u=a.axis,h=i.axis,{spanGaps:f,segment:g}=this.options,p=zs(f)?f:Number.POSITIVE_INFINITY,m=this.chart._animationsDisabled||s||"none"===r,y=t+n,b=e.length;let x=t>0&&this.getParsed(t-1);for(let v=0;v<b;++v){const n=e[v],f=m?n:{};if(v<t||v>=y){f.skip=!0;continue}const b=this.getParsed(v),w=is(b[h]),_=f[u]=a.getPixelForValue(b[u],v),S=f[h]=s||w?i.getBasePixel():i.getPixelForValue(o?this.applyStack(i,b,o):b[h],v);f.skip=isNaN(_)||isNaN(S)||w,f.stop=v>0&&Math.abs(b[u]-x[u])>p,g&&(f.parsed=b,f.raw=l.data[v]),d&&(f.options=c||this.resolveDataElementOptions(v,n.active?"active":r)),m||this.updateElement(n,v,f,r),x=b}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,r=e.data||[];if(!r.length)return n;const s=r[0].size(this.resolveDataElementOptions(0)),a=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(n,s,a)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}(0,kr.A)(ko,"id","line"),(0,kr.A)(ko,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),(0,kr.A)(ko,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class jo extends ho{constructor(e,t){super(e,t),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,r=n.data.labels||[],s=va(t._parsed[e].r,n.options.locale);return{label:r[e]||"",value:s}}parseObjectData(e,t,n,r){return fi.bind(this)(e,t,n,r)}update(e){const t=this._cachedMeta.data;this._updateRadius(),this.updateElements(t,0,t.length,e)}getMinMax(){const e=this._cachedMeta,t={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach(((e,n)=>{const r=this.getParsed(n).r;!isNaN(r)&&this.chart.getDataVisibility(n)&&(r<t.min&&(t.min=r),r>t.max&&(t.max=r))})),t}_updateRadius(){const e=this.chart,t=e.chartArea,n=e.options,r=Math.min(t.right-t.left,t.bottom-t.top),s=Math.max(r/2,0),a=(s-Math.max(n.cutoutPercentage?s/100*n.cutoutPercentage:1,0))/e.getVisibleDatasetCount();this.outerRadius=s-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(e,t,n,r){const s="reset"===r,a=this.chart,i=a.options.animation,o=this._cachedMeta.rScale,l=o.xCenter,c=o.yCenter,d=o.getIndexAngle(0)-.5*Cs;let u,h=d;const f=360/this.countVisibleElements();for(u=0;u<t;++u)h+=this._computeAngle(u,r,f);for(u=t;u<t+n;u++){const t=e[u];let n=h,g=h+this._computeAngle(u,r,f),p=a.getDataVisibility(u)?o.getDistanceFromCenterForValue(this.getParsed(u).r):0;h=g,s&&(i.animateScale&&(p=0),i.animateRotate&&(n=g=d));const m={x:l,y:c,innerRadius:0,outerRadius:p,startAngle:n,endAngle:g,options:this.resolveDataElementOptions(u,t.active?"active":r)};this.updateElement(t,u,m,r)}}countVisibleElements(){const e=this._cachedMeta;let t=0;return e.data.forEach(((e,n)=>{!isNaN(this.getParsed(n).r)&&this.chart.getDataVisibility(n)&&t++})),t}_computeAngle(e,t,n){return this.chart.getDataVisibility(e)?Ws(this.resolveDataElementOptions(e,t).angle||n):0}}(0,kr.A)(jo,"id","polarArea"),(0,kr.A)(jo,"defaults",{dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0}),(0,kr.A)(jo,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n,color:r}}=e.legend.options;return t.labels.map(((t,s)=>{const a=e.getDatasetMeta(0).controller.getStyle(s);return{text:t,fillStyle:a.backgroundColor,strokeStyle:a.borderColor,fontColor:r,lineWidth:a.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(s),index:s}}))}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}});class No extends So{}(0,kr.A)(No,"id","pie"),(0,kr.A)(No,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});class Eo extends ho{getLabelAndValue(e){const t=this._cachedMeta.vScale,n=this.getParsed(e);return{label:t.getLabels()[e],value:""+t.getLabelForValue(n[t.axis])}}parseObjectData(e,t,n,r){return fi.bind(this)(e,t,n,r)}update(e){const t=this._cachedMeta,n=t.dataset,r=t.data||[],s=t.iScale.getLabels();if(n.points=r,"resize"!==e){const t=this.resolveDatasetElementOptions(e);this.options.showLine||(t.borderWidth=0);const a={_loop:!0,_fullLoop:s.length===r.length,options:t};this.updateElement(n,void 0,a,e)}this.updateElements(r,0,r.length,e)}updateElements(e,t,n,r){const s=this._cachedMeta.rScale,a="reset"===r;for(let i=t;i<t+n;i++){const t=e[i],n=this.resolveDataElementOptions(i,t.active?"active":r),o=s.getPointPositionForValue(i,this.getParsed(i).r),l=a?s.xCenter:o.x,c=a?s.yCenter:o.y,d={x:l,y:c,angle:o.angle,skip:isNaN(l)||isNaN(c),options:n};this.updateElement(t,i,d,r)}}}(0,kr.A)(Eo,"id","radar"),(0,kr.A)(Eo,"defaults",{datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}}),(0,kr.A)(Eo,"overrides",{aspectRatio:1,scales:{r:{type:"radialLinear"}}});class Co extends ho{getLabelAndValue(e){const t=this._cachedMeta,n=this.chart.data.labels||[],{xScale:r,yScale:s}=t,a=this.getParsed(e),i=r.getLabelForValue(a.x),o=s.getLabelForValue(a.y);return{label:n[e]||"",value:"("+i+", "+o+")"}}update(e){const t=this._cachedMeta,{data:n=[]}=t,r=this.chart._animationsDisabled;let{start:s,count:a}=la(t,n,r);if(this._drawStart=s,this._drawCount=a,ca(t)&&(s=0,a=n.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:s,_dataset:a}=t;s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!a._decimated,s.points=n;const i=this.resolveDatasetElementOptions(e);i.segment=this.options.segment,this.updateElement(s,void 0,{animated:!r,options:i},e)}else this.datasetElementType&&(delete t.dataset,this.datasetElementType=!1);this.updateElements(n,s,a,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,t,n,r){const s="reset"===r,{iScale:a,vScale:i,_stacked:o,_dataset:l}=this._cachedMeta,c=this.resolveDataElementOptions(t,r),d=this.getSharedOptions(c),u=this.includeOptions(r,d),h=a.axis,f=i.axis,{spanGaps:g,segment:p}=this.options,m=zs(g)?g:Number.POSITIVE_INFINITY,y=this.chart._animationsDisabled||s||"none"===r;let b=t>0&&this.getParsed(t-1);for(let x=t;x<t+n;++x){const t=e[x],n=this.getParsed(x),c=y?t:{},g=is(n[f]),v=c[h]=a.getPixelForValue(n[h],x),w=c[f]=s||g?i.getBasePixel():i.getPixelForValue(o?this.applyStack(i,n,o):n[f],x);c.skip=isNaN(v)||isNaN(w)||g,c.stop=x>0&&Math.abs(n[h]-b[h])>m,p&&(c.parsed=n,c.raw=l.data[x]),u&&(c.options=d||this.resolveDataElementOptions(x,t.active?"active":r)),y||this.updateElement(t,x,c,r),b=n}this.updateSharedOptions(d,r,c)}getMaxOverflow(){const e=this._cachedMeta,t=e.data||[];if(!this.options.showLine){let e=0;for(let n=t.length-1;n>=0;--n)e=Math.max(e,t[n].size(this.resolveDataElementOptions(n))/2);return e>0&&e}const n=e.dataset,r=n.options&&n.options.borderWidth||0;if(!t.length)return r;const s=t[0].size(this.resolveDataElementOptions(0)),a=t[t.length-1].size(this.resolveDataElementOptions(t.length-1));return Math.max(r,s,a)/2}}(0,kr.A)(Co,"id","scatter"),(0,kr.A)(Co,"defaults",{datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1}),(0,kr.A)(Co,"overrides",{interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}});function To(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Ao{static override(e){Object.assign(Ao.prototype,e)}constructor(e){(0,kr.A)(this,"options",void 0),this.options=e||{}}init(){}formats(){return To()}parse(){return To()}format(){return To()}add(){return To()}diff(){return To()}startOf(){return To()}endOf(){return To()}}var Do=Ao;function Po(e,t,n,r){const{controller:s,data:a,_sorted:i}=e,o=s._cachedMeta.iScale,l=e.dataset&&e.dataset.options?e.dataset.options.spanGaps:null;if(o&&t===o.axis&&"r"!==t&&i&&a.length){const i=o._reversePixels?ea:Zs;if(!r){const r=i(a,t,n);if(l){const{vScale:t}=s._cachedMeta,{_parsed:n}=e,a=n.slice(0,r.lo+1).reverse().findIndex((e=>!is(e[t.axis])));r.lo-=Math.max(0,a);const i=n.slice(r.hi).findIndex((e=>!is(e[t.axis])));r.hi+=Math.max(0,i)}return r}if(s._sharedOptions){const e=a[0],r="function"===typeof e.getRange&&e.getRange(t);if(r){const e=i(a,t,n-r),s=i(a,t,n+r);return{lo:e.lo,hi:s.hi}}}}return{lo:0,hi:a.length-1}}function Oo(e,t,n,r,s){const a=e.getSortedVisibleDatasetMetas(),i=n[t];for(let o=0,l=a.length;o<l;++o){const{index:e,data:n}=a[o],{lo:l,hi:c}=Po(a[o],t,i,s);for(let t=l;t<=c;++t){const s=n[t];s.skip||r(s,e,t)}}}function Io(e,t,n,r,s){const a=[];if(!s&&!e.isPointInArea(t))return a;return Oo(e,n,t,(function(n,i,o){(s||La(n,e.chartArea,0))&&n.inRange(t.x,t.y,r)&&a.push({element:n,datasetIndex:i,index:o})}),!0),a}function Lo(e,t,n,r,s,a){let i=[];const o=function(e){const t=-1!==e.indexOf("x"),n=-1!==e.indexOf("y");return function(e,r){const s=t?Math.abs(e.x-r.x):0,a=n?Math.abs(e.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(a,2))}}(n);let l=Number.POSITIVE_INFINITY;return Oo(e,n,t,(function(n,c,d){const u=n.inRange(t.x,t.y,s);if(r&&!u)return;const h=n.getCenterPoint(s);if(!(!!a||e.isPointInArea(h))&&!u)return;const f=o(t,h);f<l?(i=[{element:n,datasetIndex:c,index:d}],l=f):f===l&&i.push({element:n,datasetIndex:c,index:d})})),i}function Mo(e,t,n,r,s,a){return a||e.isPointInArea(t)?"r"!==n||r?Lo(e,t,n,r,s,a):function(e,t,n,r){let s=[];return Oo(e,n,t,(function(e,n,a){const{startAngle:i,endAngle:o}=e.getProps(["startAngle","endAngle"],r),{angle:l}=Vs(e,{x:t.x,y:t.y});Gs(l,i,o)&&s.push({element:e,datasetIndex:n,index:a})})),s}(e,t,n,s):[]}function Ro(e,t,n,r,s){const a=[],i="x"===n?"inXRange":"inYRange";let o=!1;return Oo(e,n,t,((e,r,l)=>{e[i]&&e[i](t[n],s)&&(a.push({element:e,datasetIndex:r,index:l}),o=o||e.inRange(t.x,t.y,s))})),r&&!o?[]:a}var Fo={evaluateInteractionItems:Oo,modes:{index(e,t,n,r){const s=Ei(t,e),a=n.axis||"x",i=n.includeInvisible||!1,o=n.intersect?Io(e,s,a,r,i):Mo(e,s,a,!1,r,i),l=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach((e=>{const t=o[0].index,n=e.data[t];n&&!n.skip&&l.push({element:n,datasetIndex:e.index,index:t})})),l):[]},dataset(e,t,n,r){const s=Ei(t,e),a=n.axis||"xy",i=n.includeInvisible||!1;let o=n.intersect?Io(e,s,a,r,i):Mo(e,s,a,!1,r,i);if(o.length>0){const t=o[0].datasetIndex,n=e.getDatasetMeta(t).data;o=[];for(let e=0;e<n.length;++e)o.push({element:n[e],datasetIndex:t,index:e})}return o},point:(e,t,n,r)=>Io(e,Ei(t,e),n.axis||"xy",r,n.includeInvisible||!1),nearest(e,t,n,r){const s=Ei(t,e),a=n.axis||"xy",i=n.includeInvisible||!1;return Mo(e,s,a,n.intersect,r,i)},x:(e,t,n,r)=>Ro(e,Ei(t,e),"x",n.intersect,r),y:(e,t,n,r)=>Ro(e,Ei(t,e),"y",n.intersect,r)}};const Bo=["left","top","right","bottom"];function zo(e,t){return e.filter((e=>e.pos===t))}function Uo(e,t){return e.filter((e=>-1===Bo.indexOf(e.pos)&&e.box.axis===t))}function Wo(e,t){return e.sort(((e,n)=>{const r=t?n:e,s=t?e:n;return r.weight===s.weight?r.index-s.index:r.weight-s.weight}))}function qo(e,t){const n=function(e){const t={};for(const n of e){const{stack:e,pos:r,stackWeight:s}=n;if(!e||!Bo.includes(r))continue;const a=t[e]||(t[e]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=s}return t}(e),{vBoxMaxWidth:r,hBoxMaxHeight:s}=t;let a,i,o;for(a=0,i=e.length;a<i;++a){o=e[a];const{fullSize:i}=o.box,l=n[o.stack],c=l&&o.stackWeight/l.weight;o.horizontal?(o.width=c?c*r:i&&t.availableWidth,o.height=s):(o.width=r,o.height=c?c*s:i&&t.availableHeight)}return n}function Ho(e,t,n,r){return Math.max(e[n],t[n])+Math.max(e[r],t[r])}function Vo(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function Jo(e,t,n,r){const{pos:s,box:a}=n,i=e.maxPadding;if(!ls(s)){n.size&&(e[s]-=n.size);const t=r[n.stack]||{size:0,count:1};t.size=Math.max(t.size,n.horizontal?a.height:a.width),n.size=t.size/t.count,e[s]+=n.size}a.getPadding&&Vo(i,a.getPadding());const o=Math.max(0,t.outerWidth-Ho(i,e,"left","right")),l=Math.max(0,t.outerHeight-Ho(i,e,"top","bottom")),c=o!==e.w,d=l!==e.h;return e.w=o,e.h=l,n.horizontal?{same:c,other:d}:{same:d,other:c}}function Ko(e,t){const n=t.maxPadding;function r(e){const r={left:0,top:0,right:0,bottom:0};return e.forEach((e=>{r[e]=Math.max(t[e],n[e])})),r}return r(e?["left","right"]:["top","bottom"])}function Yo(e,t,n,r){const s=[];let a,i,o,l,c,d;for(a=0,i=e.length,c=0;a<i;++a){o=e[a],l=o.box,l.update(o.width||t.w,o.height||t.h,Ko(o.horizontal,t));const{same:i,other:u}=Jo(t,n,o,r);c|=i&&s.length,d=d||u,l.fullSize||s.push(o)}return c&&Yo(s,t,n,r)||d}function Go(e,t,n,r,s){e.top=n,e.left=t,e.right=t+r,e.bottom=n+s,e.width=r,e.height=s}function $o(e,t,n,r){const s=n.padding;let{x:a,y:i}=t;for(const o of e){const e=o.box,l=r[o.stack]||{count:1,placed:0,weight:1},c=o.stackWeight/l.weight||1;if(o.horizontal){const r=t.w*c,a=l.size||e.height;js(l.start)&&(i=l.start),e.fullSize?Go(e,s.left,i,n.outerWidth-s.right-s.left,a):Go(e,t.left+l.placed,i,r,a),l.start=i,l.placed+=r,i=e.bottom}else{const r=t.h*c,i=l.size||e.width;js(l.start)&&(a=l.start),e.fullSize?Go(e,a,s.top,i,n.outerHeight-s.bottom-s.top):Go(e,a,t.top+l.placed,i,r),l.start=a,l.placed+=r,a=e.right}}t.x=a,t.y=i}var Qo={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;-1!==n&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,r){if(!e)return;const s=$a(e.options.layout.padding),a=Math.max(t-s.width,0),i=Math.max(n-s.height,0),o=function(e){const t=function(e){const t=[];let n,r,s,a,i,o;for(n=0,r=(e||[]).length;n<r;++n)s=e[n],({position:a,options:{stack:i,stackWeight:o=1}}=s),t.push({index:n,box:s,pos:a,horizontal:s.isHorizontal(),weight:s.weight,stack:i&&a+i,stackWeight:o});return t}(e),n=Wo(t.filter((e=>e.box.fullSize)),!0),r=Wo(zo(t,"left"),!0),s=Wo(zo(t,"right")),a=Wo(zo(t,"top"),!0),i=Wo(zo(t,"bottom")),o=Uo(t,"x"),l=Uo(t,"y");return{fullSize:n,leftAndTop:r.concat(a),rightAndBottom:s.concat(l).concat(i).concat(o),chartArea:zo(t,"chartArea"),vertical:r.concat(s).concat(l),horizontal:a.concat(i).concat(o)}}(e.boxes),l=o.vertical,c=o.horizontal;gs(e.boxes,(e=>{"function"===typeof e.beforeLayout&&e.beforeLayout()}));const d=l.reduce(((e,t)=>t.box.options&&!1===t.box.options.display?e:e+1),0)||1,u=Object.freeze({outerWidth:t,outerHeight:n,padding:s,availableWidth:a,availableHeight:i,vBoxMaxWidth:a/2/d,hBoxMaxHeight:i/2}),h=Object.assign({},s);Vo(h,$a(r));const f=Object.assign({maxPadding:h,w:a,h:i,x:s.left,y:s.top},s),g=qo(l.concat(c),u);Yo(o.fullSize,f,u,g),Yo(l,f,u,g),Yo(c,f,u,g)&&Yo(l,f,u,g),function(e){const t=e.maxPadding;function n(n){const r=Math.max(t[n]-e[n],0);return e[n]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}(f),$o(o.leftAndTop,f,u,g),f.x+=f.w,f.y+=f.h,$o(o.rightAndBottom,f,u,g),e.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},gs(o.chartArea,(t=>{const n=t.box;Object.assign(n,e.chartArea),n.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})}))}};class Xo{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,r){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):n)}}isAttached(e){return!0}updateConfig(e){}}class Zo extends Xo{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const el="$chartjs",tl={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},nl=e=>null===e||""===e;const rl=!!Di&&{passive:!0};function sl(e,t,n){e&&e.canvas&&e.canvas.removeEventListener(t,n,rl)}function al(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function il(e,t,n){const r=e.canvas,s=new MutationObserver((e=>{let t=!1;for(const n of e)t=t||al(n.addedNodes,r),t=t&&!al(n.removedNodes,r);t&&n()}));return s.observe(document,{childList:!0,subtree:!0}),s}function ol(e,t,n){const r=e.canvas,s=new MutationObserver((e=>{let t=!1;for(const n of e)t=t||al(n.removedNodes,r),t=t&&!al(n.addedNodes,r);t&&n()}));return s.observe(document,{childList:!0,subtree:!0}),s}const ll=new Map;let cl=0;function dl(){const e=window.devicePixelRatio;e!==cl&&(cl=e,ll.forEach(((t,n)=>{n.currentDevicePixelRatio!==e&&t()})))}function ul(e,t,n){const r=e.canvas,s=r&&_i(r);if(!s)return;const a=aa(((e,t)=>{const r=s.clientWidth;n(e,t),r<s.clientWidth&&n()}),window),i=new ResizeObserver((e=>{const t=e[0],n=t.contentRect.width,r=t.contentRect.height;0===n&&0===r||a(n,r)}));return i.observe(s),function(e,t){ll.size||window.addEventListener("resize",dl),ll.set(e,t)}(e,a),i}function hl(e,t,n){n&&n.disconnect(),"resize"===t&&function(e){ll.delete(e),ll.size||window.removeEventListener("resize",dl)}(e)}function fl(e,t,n){const r=e.canvas,s=aa((t=>{null!==e.ctx&&n(function(e,t){const n=tl[e.type]||e.type,{x:r,y:s}=Ei(e,t);return{type:n,chart:t,native:e,x:void 0!==r?r:null,y:void 0!==s?s:null}}(t,e))}),e);return function(e,t,n){e&&e.addEventListener(t,n,rl)}(r,t,s),s}class gl extends Xo{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(function(e,t){const n=e.style,r=e.getAttribute("height"),s=e.getAttribute("width");if(e[el]={initial:{height:r,width:s,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",nl(s)){const t=Pi(e,"width");void 0!==t&&(e.width=t)}if(nl(r))if(""===e.style.height)e.height=e.width/(t||2);else{const t=Pi(e,"height");void 0!==t&&(e.height=t)}}(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[el])return!1;const n=t[el].initial;["height","width"].forEach((e=>{const r=n[e];is(r)?t.removeAttribute(e):t.setAttribute(e,r)}));const r=n.style||{};return Object.keys(r).forEach((e=>{t.style[e]=r[e]})),t.width=t.width,delete t[el],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const r=e.$proxies||(e.$proxies={}),s={attach:il,detach:ol,resize:ul}[t]||fl;r[t]=s(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),r=n[t];if(!r)return;({attach:hl,detach:hl,resize:hl}[t]||sl)(e,t,r),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,r){return Ti(e,t,n,r)}isAttached(e){const t=e&&_i(e);return!(!t||!t.isConnected)}}class pl{constructor(){(0,kr.A)(this,"x",void 0),(0,kr.A)(this,"y",void 0),(0,kr.A)(this,"active",!1),(0,kr.A)(this,"options",void 0),(0,kr.A)(this,"$animations",void 0)}tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return zs(this.x)&&zs(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const r={};return e.forEach((e=>{r[e]=n[e]&&n[e].active()?n[e]._to:this[e]})),r}}function ml(e,t){const n=e.options.ticks,r=function(e){const t=e.options.offset,n=e._tickSize(),r=e._length/n+(t?0:1),s=e._maxLength/n;return Math.floor(Math.min(r,s))}(e),s=Math.min(n.maxTicksLimit||r,r),a=n.major.enabled?function(e){const t=[];let n,r;for(n=0,r=e.length;n<r;n++)e[n].major&&t.push(n);return t}(t):[],i=a.length,o=a[0],l=a[i-1],c=[];if(i>s)return function(e,t,n,r){let s,a=0,i=n[0];for(r=Math.ceil(r),s=0;s<e.length;s++)s===i&&(t.push(e[s]),a++,i=n[a*r])}(t,c,a,i/s),c;const d=function(e,t,n){const r=function(e){const t=e.length;let n,r;if(t<2)return!1;for(r=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==r)return!1;return r}(e),s=t.length/n;if(!r)return Math.max(s,1);const a=function(e){const t=[],n=Math.sqrt(e);let r;for(r=1;r<n;r++)e%r===0&&(t.push(r),t.push(e/r));return n===(0|n)&&t.push(n),t.sort(((e,t)=>e-t)).pop(),t}(r);for(let i=0,o=a.length-1;i<o;i++){const e=a[i];if(e>s)return e}return Math.max(s,1)}(a,t,s);if(i>0){let e,n;const r=i>1?Math.round((l-o)/(i-1)):null;for(yl(t,c,d,is(r)?0:o-r,o),e=0,n=i-1;e<n;e++)yl(t,c,d,a[e],a[e+1]);return yl(t,c,d,l,is(r)?t.length:l+r),c}return yl(t,c,d),c}function yl(e,t,n,r,s){const a=us(r,0),i=Math.min(us(s,e.length),e.length);let o,l,c,d=0;for(n=Math.ceil(n),s&&(o=s-r,n=o/Math.floor(o/n)),c=a;c<0;)d++,c=Math.round(a+d*n);for(l=Math.max(a,0);l<i;l++)l===c&&(t.push(e[l]),d++,c=Math.round(a+d*n))}(0,kr.A)(pl,"defaults",{}),(0,kr.A)(pl,"defaultRoutes",void 0);const bl=(e,t,n)=>"top"===t||"left"===t?e[t]+n:e[t]-n,xl=(e,t)=>Math.min(t||e,e);function vl(e,t){const n=[],r=e.length/t,s=e.length;let a=0;for(;a<s;a+=r)n.push(e[Math.floor(a)]);return n}function wl(e,t,n){const r=e.ticks.length,s=Math.min(t,r-1),a=e._startPixel,i=e._endPixel,o=1e-6;let l,c=e.getPixelForTick(s);if(!(n&&(l=1===r?Math.max(c-a,i-c):0===t?(e.getPixelForTick(1)-c)/2:(c-e.getPixelForTick(s-1))/2,c+=s<t?l:-l,c<a-o||c>i+o)))return c}function _l(e){return e.drawTicks?e.tickLength:0}function Sl(e,t){if(!e.display)return 0;const n=Qa(e.font,t),r=$a(e.padding);return(os(e.text)?e.text.length:1)*n.lineHeight+r.height}function kl(e,t,n){let r=ia(e);return(n&&"right"!==t||!n&&"right"===t)&&(r=(e=>"left"===e?"right":"right"===e?"left":e)(r)),r}class jl extends pl{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:r}=this;return e=ds(e,Number.POSITIVE_INFINITY),t=ds(t,Number.NEGATIVE_INFINITY),n=ds(n,Number.POSITIVE_INFINITY),r=ds(r,Number.NEGATIVE_INFINITY),{min:ds(e,n),max:ds(t,r),minDefined:cs(e),maxDefined:cs(t)}}getMinMax(e){let t,{min:n,max:r,minDefined:s,maxDefined:a}=this.getUserBounds();if(s&&a)return{min:n,max:r};const i=this.getMatchingVisibleMetas();for(let o=0,l=i.length;o<l;++o)t=i[o].controller.getMinMax(this,e),s||(n=Math.min(n,t.min)),a||(r=Math.max(r,t.max));return n=a&&n>r?r:n,r=s&&n>r?n:r,{min:ds(n,ds(r,n)),max:ds(r,ds(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chart.chartArea;return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){fs(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:r,grace:s,ticks:a}=this.options,i=a.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=function(e,t,n){const{min:r,max:s}=e,a=hs(t,(s-r)/2),i=(e,t)=>n&&0===e?0:e+t;return{min:i(r,-Math.abs(a)),max:i(s,a)}}(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const o=i<this.ticks.length;this._convertTicksToLabels(o?vl(this.ticks,i):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||"auto"===a.source)&&(this.ticks=ml(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),o&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e,t,n=this.options.reverse;this.isHorizontal()?(e=this.left,t=this.right):(e=this.top,t=this.bottom,n=!n),this._startPixel=e,this._endPixel=t,this._reversePixels=n,this._length=t-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){fs(this.options.afterUpdate,[this])}beforeSetDimensions(){fs(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){fs(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),fs(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){fs(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,r,s;for(n=0,r=e.length;n<r;n++)s=e[n],s.label=fs(t.callback,[s.value,n,e],this)}afterTickToLabelConversion(){fs(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){fs(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=xl(this.ticks.length,e.ticks.maxTicksLimit),r=t.minRotation||0,s=t.maxRotation;let a,i,o,l=r;if(!this._isVisible()||!t.display||r>=s||n<=1||!this.isHorizontal())return void(this.labelRotation=r);const c=this._getLabelSizes(),d=c.widest.width,u=c.highest.height,h=$s(this.chart.width-d,0,this.maxWidth);a=e.offset?this.maxWidth/n:h/(n-1),d+6>a&&(a=h/(n-(e.offset?.5:1)),i=this.maxHeight-_l(e.grid)-t.padding-Sl(e.title,this.chart.options.font),o=Math.sqrt(d*d+u*u),l=qs(Math.min(Math.asin($s((c.highest.height+6)/a,-1,1)),Math.asin($s(i/o,-1,1))-Math.asin($s(u/o,-1,1)))),l=Math.max(r,Math.min(s,l))),this.labelRotation=l}afterCalculateLabelRotation(){fs(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){fs(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:r,grid:s}}=this,a=this._isVisible(),i=this.isHorizontal();if(a){const a=Sl(r,t.options.font);if(i?(e.width=this.maxWidth,e.height=_l(s)+a):(e.height=this.maxHeight,e.width=_l(s)+a),n.display&&this.ticks.length){const{first:t,last:r,widest:s,highest:a}=this._getLabelSizes(),o=2*n.padding,l=Ws(this.labelRotation),c=Math.cos(l),d=Math.sin(l);if(i){const t=n.mirror?0:d*s.width+c*a.height;e.height=Math.min(this.maxHeight,e.height+t+o)}else{const t=n.mirror?0:c*s.width+d*a.height;e.width=Math.min(this.maxWidth,e.width+t+o)}this._calculatePadding(t,r,d,c)}}this._handleMargins(),i?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,r){const{ticks:{align:s,padding:a},position:i}=this.options,o=0!==this.labelRotation,l="top"!==i&&"x"===this.axis;if(this.isHorizontal()){const i=this.getPixelForTick(0)-this.left,c=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,u=0;o?l?(d=r*e.width,u=n*t.height):(d=n*e.height,u=r*t.width):"start"===s?u=t.width:"end"===s?d=e.width:"inner"!==s&&(d=e.width/2,u=t.width/2),this.paddingLeft=Math.max((d-i+a)*this.width/(this.width-i),0),this.paddingRight=Math.max((u-c+a)*this.width/(this.width-c),0)}else{let n=t.height/2,r=e.height/2;"start"===s?(n=0,r=e.height):"end"===s&&(n=t.height,r=0),this.paddingTop=n+a,this.paddingBottom=r+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){fs(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return"top"===t||"bottom"===t||"x"===e}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){let t,n;for(this.beforeTickToLabelConversion(),this.generateTickLabels(e),t=0,n=e.length;t<n;t++)is(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=vl(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:r,_longestTextCache:s}=this,a=[],i=[],o=Math.floor(t/xl(t,n));let l,c,d,u,h,f,g,p,m,y,b,x=0,v=0;for(l=0;l<t;l+=o){if(u=e[l].label,h=this._resolveTickFontOptions(l),r.font=f=h.string,g=s[f]=s[f]||{data:{},gc:[]},p=h.lineHeight,m=y=0,is(u)||os(u)){if(os(u))for(c=0,d=u.length;c<d;++c)b=u[c],is(b)||os(b)||(m=Ta(r,g.data,g.gc,m,b),y+=p)}else m=Ta(r,g.data,g.gc,m,u),y=p;a.push(m),i.push(y),x=Math.max(m,x),v=Math.max(y,v)}!function(e,t){gs(e,(e=>{const n=e.gc,r=n.length/2;let s;if(r>t){for(s=0;s<r;++s)delete e.data[n[s]];n.splice(0,r)}}))}(s,t);const w=a.indexOf(x),_=i.indexOf(v),S=e=>({width:a[e]||0,height:i[e]||0});return{first:S(0),last:S(t-1),widest:S(w),highest:S(_),widths:a,heights:i}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return $s(this._alignToPixels?Da(this.chart,t,0):t,-32768,32767)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=function(e,t,n){return Za(e,{tick:n,index:t,type:"tick"})}(this.getContext(),e,n))}return this.$context||(this.$context=Za(this.chart.getContext(),{scale:this,type:"scale"}))}_tickSize(){const e=this.options.ticks,t=Ws(this.labelRotation),n=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),s=this._getLabelSizes(),a=e.autoSkipPadding||0,i=s?s.widest.width+a:0,o=s?s.highest.height+a:0;return this.isHorizontal()?o*n>i*r?i/n:o/r:o*r<i*n?o/n:i/r}_isVisible(){const e=this.options.display;return"auto"!==e?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,r=this.options,{grid:s,position:a,border:i}=r,o=s.offset,l=this.isHorizontal(),c=this.ticks.length+(o?1:0),d=_l(s),u=[],h=i.setContext(this.getContext()),f=h.display?h.width:0,g=f/2,p=function(e){return Da(n,e,f)};let m,y,b,x,v,w,_,S,k,j,N,E;if("top"===a)m=p(this.bottom),w=this.bottom-d,S=m-g,j=p(e.top)+g,E=e.bottom;else if("bottom"===a)m=p(this.top),j=e.top,E=p(e.bottom)-g,w=m+g,S=this.top+d;else if("left"===a)m=p(this.right),v=this.right-d,_=m-g,k=p(e.left)+g,N=e.right;else if("right"===a)m=p(this.left),k=e.left,N=p(e.right)-g,v=m+g,_=this.left+d;else if("x"===t){if("center"===a)m=p((e.top+e.bottom)/2+.5);else if(ls(a)){const e=Object.keys(a)[0],t=a[e];m=p(this.chart.scales[e].getPixelForValue(t))}j=e.top,E=e.bottom,w=m+g,S=w+d}else if("y"===t){if("center"===a)m=p((e.left+e.right)/2);else if(ls(a)){const e=Object.keys(a)[0],t=a[e];m=p(this.chart.scales[e].getPixelForValue(t))}v=m-g,_=v-d,k=e.left,N=e.right}const C=us(r.ticks.maxTicksLimit,c),T=Math.max(1,Math.ceil(c/C));for(y=0;y<c;y+=T){const e=this.getContext(y),t=s.setContext(e),r=i.setContext(e),a=t.lineWidth,c=t.color,d=r.dash||[],h=r.dashOffset,f=t.tickWidth,g=t.tickColor,p=t.tickBorderDash||[],m=t.tickBorderDashOffset;b=wl(this,y,o),void 0!==b&&(x=Da(n,b,a),l?v=_=k=N=x:w=S=j=E=x,u.push({tx1:v,ty1:w,tx2:_,ty2:S,x1:k,y1:j,x2:N,y2:E,width:a,color:c,borderDash:d,borderDashOffset:h,tickWidth:f,tickColor:g,tickBorderDash:p,tickBorderDashOffset:m}))}return this._ticksLength=c,this._borderValue=m,u}_computeLabelItems(e){const t=this.axis,n=this.options,{position:r,ticks:s}=n,a=this.isHorizontal(),i=this.ticks,{align:o,crossAlign:l,padding:c,mirror:d}=s,u=_l(n.grid),h=u+c,f=d?-c:h,g=-Ws(this.labelRotation),p=[];let m,y,b,x,v,w,_,S,k,j,N,E,C="middle";if("top"===r)w=this.bottom-f,_=this._getXAxisLabelAlignment();else if("bottom"===r)w=this.top+f,_=this._getXAxisLabelAlignment();else if("left"===r){const e=this._getYAxisLabelAlignment(u);_=e.textAlign,v=e.x}else if("right"===r){const e=this._getYAxisLabelAlignment(u);_=e.textAlign,v=e.x}else if("x"===t){if("center"===r)w=(e.top+e.bottom)/2+h;else if(ls(r)){const e=Object.keys(r)[0],t=r[e];w=this.chart.scales[e].getPixelForValue(t)+h}_=this._getXAxisLabelAlignment()}else if("y"===t){if("center"===r)v=(e.left+e.right)/2-h;else if(ls(r)){const e=Object.keys(r)[0],t=r[e];v=this.chart.scales[e].getPixelForValue(t)}_=this._getYAxisLabelAlignment(u).textAlign}"y"===t&&("start"===o?C="top":"end"===o&&(C="bottom"));const T=this._getLabelSizes();for(m=0,y=i.length;m<y;++m){b=i[m],x=b.label;const e=s.setContext(this.getContext(m));S=this.getPixelForTick(m)+s.labelOffset,k=this._resolveTickFontOptions(m),j=k.lineHeight,N=os(x)?x.length:1;const t=N/2,n=e.color,o=e.textStrokeColor,c=e.textStrokeWidth;let u,h=_;if(a?(v=S,"inner"===_&&(h=m===y-1?this.options.reverse?"left":"right":0===m?this.options.reverse?"right":"left":"center"),E="top"===r?"near"===l||0!==g?-N*j+j/2:"center"===l?-T.highest.height/2-t*j+j:-T.highest.height+j/2:"near"===l||0!==g?j/2:"center"===l?T.highest.height/2-t*j:T.highest.height-N*j,d&&(E*=-1),0===g||e.showLabelBackdrop||(v+=j/2*Math.sin(g))):(w=S,E=(1-N)*j/2),e.showLabelBackdrop){const t=$a(e.backdropPadding),n=T.heights[m],r=T.widths[m];let s=E-t.top,a=0-t.left;switch(C){case"middle":s-=n/2;break;case"bottom":s-=n}switch(_){case"center":a-=r/2;break;case"right":a-=r;break;case"inner":m===y-1?a-=r:m>0&&(a-=r/2)}u={left:a,top:s,width:r+t.width,height:n+t.height,color:e.backdropColor}}p.push({label:x,font:k,textOffset:E,options:{rotation:g,color:n,strokeColor:o,strokeWidth:c,textAlign:h,textBaseline:C,translation:[v,w],backdrop:u}})}return p}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Ws(this.labelRotation))return"top"===e?"left":"right";let n="center";return"start"===t.align?n="left":"end"===t.align?n="right":"inner"===t.align&&(n="inner"),n}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:r,padding:s}}=this.options,a=e+s,i=this._getLabelSizes().widest.width;let o,l;return"left"===t?r?(l=this.right+s,"near"===n?o="left":"center"===n?(o="center",l+=i/2):(o="right",l+=i)):(l=this.right-a,"near"===n?o="right":"center"===n?(o="center",l-=i/2):(o="left",l=this.left)):"right"===t?r?(l=this.left+s,"near"===n?o="right":"center"===n?(o="center",l-=i/2):(o="left",l-=i)):(l=this.left+a,"near"===n?o="left":"center"===n?(o="center",l+=i/2):(o="right",l=this.right)):o="right",{textAlign:o,x:l}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;return"left"===t||"right"===t?{top:0,left:this.left,bottom:e.height,right:this.right}:"top"===t||"bottom"===t?{top:this.top,left:0,bottom:this.bottom,right:e.width}:void 0}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:r,width:s,height:a}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,r,s,a),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const n=this.ticks.findIndex((t=>t.value===e));if(n>=0){return t.setContext(this.getContext(n)).lineWidth}return 0}drawGrid(e){const t=this.options.grid,n=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,a;const i=(e,t,r)=>{r.width&&r.color&&(n.save(),n.lineWidth=r.width,n.strokeStyle=r.color,n.setLineDash(r.borderDash||[]),n.lineDashOffset=r.borderDashOffset,n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(t.x,t.y),n.stroke(),n.restore())};if(t.display)for(s=0,a=r.length;s<a;++s){const e=r[s];t.drawOnChartArea&&i({x:e.x1,y:e.y1},{x:e.x2,y:e.y2},e),t.drawTicks&&i({x:e.tx1,y:e.ty1},{x:e.tx2,y:e.ty2},{color:e.tickColor,width:e.tickWidth,borderDash:e.tickBorderDash,borderDashOffset:e.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:r}}=this,s=n.setContext(this.getContext()),a=n.display?s.width:0;if(!a)return;const i=r.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let l,c,d,u;this.isHorizontal()?(l=Da(e,this.left,a)-a/2,c=Da(e,this.right,i)+i/2,d=u=o):(d=Da(e,this.top,a)-a/2,u=Da(e,this.bottom,i)+i/2,l=c=o),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(l,d),t.lineTo(c,u),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const t=this.ctx,n=this._computeLabelArea();n&&Ma(t,n);const r=this.getLabelItems(e);for(const s of r){const e=s.options,n=s.font;Wa(t,s.label,0,s.textOffset,n,e)}n&&Ra(t)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:r}}=this;if(!n.display)return;const s=Qa(n.font),a=$a(n.padding),i=n.align;let o=s.lineHeight/2;"bottom"===t||"center"===t||ls(t)?(o+=a.bottom,os(n.text)&&(o+=s.lineHeight*(n.text.length-1))):o+=a.top;const{titleX:l,titleY:c,maxWidth:d,rotation:u}=function(e,t,n,r){const{top:s,left:a,bottom:i,right:o,chart:l}=e,{chartArea:c,scales:d}=l;let u,h,f,g=0;const p=i-s,m=o-a;if(e.isHorizontal()){if(h=oa(r,a,o),ls(n)){const e=Object.keys(n)[0],r=n[e];f=d[e].getPixelForValue(r)+p-t}else f="center"===n?(c.bottom+c.top)/2+p-t:bl(e,n,t);u=o-a}else{if(ls(n)){const e=Object.keys(n)[0],r=n[e];h=d[e].getPixelForValue(r)-m+t}else h="center"===n?(c.left+c.right)/2-m+t:bl(e,n,t);f=oa(r,i,s),g="left"===n?-Os:Os}return{titleX:h,titleY:f,maxWidth:u,rotation:g}}(this,o,t,i);Wa(e,n.text,0,0,s,{color:n.color,maxWidth:d,rotation:u,textAlign:kl(i,t,r),textBaseline:"middle",translation:[l,c]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=us(e.grid&&e.grid.z,-1),r=us(e.border&&e.border.z,0);return this._isVisible()&&this.draw===jl.prototype.draw?[{z:n,draw:e=>{this.drawBackground(),this.drawGrid(e),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:t,draw:e=>{this.drawLabels(e)}}]:[{z:t,draw:e=>{this.draw(e)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",r=[];let s,a;for(s=0,a=t.length;s<a;++s){const a=t[s];a[n]!==this.id||e&&a.type!==e||r.push(a)}return r}_resolveTickFontOptions(e){return Qa(this.options.ticks.setContext(this.getContext(e)).font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Nl{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;(function(e){return"id"in e&&"defaults"in e})(t)&&(n=this.register(t));const r=this.items,s=e.id,a=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in r||(r[s]=e,function(e,t,n){const r=xs(Object.create(null),[n?Ca.get(n):{},Ca.get(t),e.defaults]);Ca.set(t,r),e.defaultRoutes&&function(e,t){Object.keys(t).forEach((n=>{const r=n.split("."),s=r.pop(),a=[e].concat(r).join("."),i=t[n].split("."),o=i.pop(),l=i.join(".");Ca.route(a,s,l,o)}))}(t,e.defaultRoutes);e.descriptors&&Ca.describe(t,e.descriptors)}(e,a,n),this.override&&Ca.override(e.id,e.overrides)),a}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,r=this.scope;n in t&&delete t[n],r&&n in Ca[r]&&(delete Ca[r][n],this.override&&delete Sa[n])}}class El{constructor(){this.controllers=new Nl(ho,"datasets",!0),this.elements=new Nl(pl,"elements"),this.plugins=new Nl(Object,"plugins"),this.scales=new Nl(jl,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t)}remove(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t)}addControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.controllers)}addElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.elements)}addPlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.plugins)}addScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("register",t,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.controllers)}removeElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.elements)}removePlugins(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.plugins)}removeScales(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._each("unregister",t,this.scales)}_each(e,t,n){[...t].forEach((t=>{const r=n||this._getRegistryForType(t);n||r.isForType(t)||r===this.plugins&&t.id?this._exec(e,r,t):gs(t,(t=>{const r=n||this._getRegistryForType(t);this._exec(e,r,t)}))}))}_exec(e,t,n){const r=ks(e);fs(n["before"+r],[],n),t[e](n),fs(n["after"+r],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const r=t.get(e);if(void 0===r)throw new Error('"'+e+'" is not a registered '+n+".");return r}}var Cl=new El;class Tl{constructor(){this._init=[]}notify(e,t,n,r){"beforeInit"===t&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=r?this._descriptors(e).filter(r):this._descriptors(e),a=this._notify(s,e,t,n);return"afterDestroy"===t&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),a}_notify(e,t,n,r){r=r||{};for(const s of e){const e=s.plugin;if(!1===fs(e[n],[t,r,s.options],e)&&r.cancelable)return!1}return!0}invalidate(){is(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,r=us(n.options&&n.options.plugins,{}),s=function(e){const t={},n=[],r=Object.keys(Cl.plugins.items);for(let a=0;a<r.length;a++)n.push(Cl.getPlugin(r[a]));const s=e.plugins||[];for(let a=0;a<s.length;a++){const e=s[a];-1===n.indexOf(e)&&(n.push(e),t[e.id]=!0)}return{plugins:n,localIds:t}}(n);return!1!==r||t?function(e,t,n,r){let{plugins:s,localIds:a}=t;const i=[],o=e.getContext();for(const l of s){const t=l.id,s=Al(n[t],r);null!==s&&i.push({plugin:l,options:Dl(e.config,{plugin:l,local:a[t]},s,o)})}return i}(e,s,r,t):[]}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,r=(e,t)=>e.filter((e=>!t.some((t=>e.plugin.id===t.plugin.id))));this._notify(r(t,n),e,"stop"),this._notify(r(n,t),e,"start")}}function Al(e,t){return t||!1!==e?!0===e?{}:e:null}function Dl(e,t,n,r){let{plugin:s,local:a}=t;const i=e.pluginScopeKeys(s),o=e.getOptionScopes(n,i);return a&&s.defaults&&o.push(s.defaults),e.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Pl(e,t){const n=Ca.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function Ol(e){if("x"===e||"y"===e||"r"===e)return e}function Il(e){if(Ol(e))return e;for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(const a of n){const t=a.axis||("top"===(s=a.position)||"bottom"===s?"x":"left"===s||"right"===s?"y":void 0)||e.length>1&&Ol(e[0].toLowerCase());if(t)return t}var s;throw new Error("Cannot determine type of '".concat(e,"' axis. Please provide 'axis' or 'position' option."))}function Ll(e,t,n){if(n[t+"AxisID"]===e)return{axis:t}}function Ml(e,t){const n=Sa[e.type]||{scales:{}},r=t.scales||{},s=Pl(e.type,t),a=Object.create(null);return Object.keys(r).forEach((t=>{const i=r[t];if(!ls(i))return console.error("Invalid scale configuration for scale: ".concat(t));if(i._proxy)return console.warn("Ignoring resolver passed as options for scale: ".concat(t));const o=Il(t,i,function(e,t){if(t.data&&t.data.datasets){const n=t.data.datasets.filter((t=>t.xAxisID===e||t.yAxisID===e));if(n.length)return Ll(e,"x",n[0])||Ll(e,"y",n[0])}return{}}(t,e),Ca.scales[i.type]),l=function(e,t){return e===t?"_index_":"_value_"}(o,s),c=n.scales||{};a[t]=vs(Object.create(null),[{axis:o},i,c[o],c[l]])})),e.data.datasets.forEach((n=>{const s=n.type||e.type,i=n.indexAxis||Pl(s,t),o=(Sa[s]||{}).scales||{};Object.keys(o).forEach((e=>{const t=function(e,t){let n=e;return"_index_"===e?n=t:"_value_"===e&&(n="x"===t?"y":"x"),n}(e,i),s=n[t+"AxisID"]||t;a[s]=a[s]||Object.create(null),vs(a[s],[{axis:t},r[s],o[e]])}))})),Object.keys(a).forEach((e=>{const t=a[e];vs(t,[Ca.scales[t.type],Ca.scale])})),a}function Rl(e){const t=e.options||(e.options={});t.plugins=us(t.plugins,{}),t.scales=Ml(e,t)}function Fl(e){return(e=e||{}).datasets=e.datasets||[],e.labels=e.labels||[],e}const Bl=new Map,zl=new Set;function Ul(e,t){let n=Bl.get(e);return n||(n=t(),Bl.set(e,n),zl.add(n)),n}const Wl=(e,t,n)=>{const r=Ss(t,n);void 0!==r&&e.add(r)};class ql{constructor(e){this._config=function(e){return(e=e||{}).data=Fl(e.data),Rl(e),e}(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Fl(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Rl(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Ul(e,(()=>[["datasets.".concat(e),""]]))}datasetAnimationScopeKeys(e,t){return Ul("".concat(e,".transition.").concat(t),(()=>[["datasets.".concat(e,".transitions.").concat(t),"transitions.".concat(t)],["datasets.".concat(e),""]]))}datasetElementScopeKeys(e,t){return Ul("".concat(e,"-").concat(t),(()=>[["datasets.".concat(e,".elements.").concat(t),"datasets.".concat(e),"elements.".concat(t),""]]))}pluginScopeKeys(e){const t=e.id,n=this.type;return Ul("".concat(n,"-plugin-").concat(t),(()=>[["plugins.".concat(t),...e.additionalOptionScopes||[]]]))}_cachedScopes(e,t){const n=this._scopeCache;let r=n.get(e);return r&&!t||(r=new Map,n.set(e,r)),r}getOptionScopes(e,t,n){const{options:r,type:s}=this,a=this._cachedScopes(e,n),i=a.get(t);if(i)return i;const o=new Set;t.forEach((t=>{e&&(o.add(e),t.forEach((t=>Wl(o,e,t)))),t.forEach((e=>Wl(o,r,e))),t.forEach((e=>Wl(o,Sa[s]||{},e))),t.forEach((e=>Wl(o,Ca,e))),t.forEach((e=>Wl(o,ka,e)))}));const l=Array.from(o);return 0===l.length&&l.push(Object.create(null)),zl.has(t)&&a.set(t,l),l}chartOptionScopes(){const{options:e,type:t}=this;return[e,Sa[t]||{},Ca.datasets[t]||{},{type:t},Ca,ka]}resolveNamedOptions(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[""];const s={$shared:!0},{resolver:a,subPrefixes:i}=Hl(this._resolverCache,e,r);let o=a;if(function(e,t){const{isScriptable:n,isIndexable:r}=ni(e);for(const s of t){const t=n(s),a=r(s),i=(a||t)&&e[s];if(t&&(Ns(i)||Vl(i))||a&&os(i))return!0}return!1}(a,t)){s.$shared=!1;o=ti(a,n=Ns(n)?n():n,this.createResolver(e,n,i))}for(const l of t)s[l]=o[l];return s}createResolver(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[""],r=arguments.length>3?arguments[3]:void 0;const{resolver:s}=Hl(this._resolverCache,e,n);return ls(t)?ti(s,t,void 0,r):s}}function Hl(e,t,n){let r=e.get(t);r||(r=new Map,e.set(t,r));const s=n.join();let a=r.get(s);if(!a){a={resolver:ei(t,n),subPrefixes:n.filter((e=>!e.toLowerCase().includes("hover")))},r.set(s,a)}return a}const Vl=e=>ls(e)&&Object.getOwnPropertyNames(e).some((t=>Ns(e[t])));const Jl=["top","bottom","left","right","chartArea"];function Kl(e,t){return"top"===e||"bottom"===e||-1===Jl.indexOf(e)&&"x"===t}function Yl(e,t){return function(n,r){return n[e]===r[e]?n[t]-r[t]:n[e]-r[e]}}function Gl(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),fs(n&&n.onComplete,[e],t)}function $l(e){const t=e.chart,n=t.options.animation;fs(n&&n.onProgress,[e],t)}function Ql(e){return wi()&&"string"===typeof e?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const Xl={},Zl=e=>{const t=Ql(e);return Object.values(Xl).filter((e=>e.canvas===t)).pop()};function ec(e,t,n){const r=Object.keys(e);for(const s of r){const r=+s;if(r>=t){const a=e[s];delete e[s],(n>0||r>t)&&(e[r+n]=a)}}}class tc{static register(){Cl.add(...arguments),nc()}static unregister(){Cl.remove(...arguments),nc()}constructor(e,t){const n=this.config=new ql(t),r=Ql(e),s=Zl(r);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const a=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||function(e){return!wi()||"undefined"!==typeof OffscreenCanvas&&e instanceof OffscreenCanvas?Zo:gl}(r)),this.platform.updateConfig(n);const i=this.platform.acquireContext(r,a.aspectRatio),o=i&&i.canvas,l=o&&o.height,c=o&&o.width;this.id=as(),this.ctx=i,this.canvas=o,this.width=c,this.height=l,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Tl,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=function(e,t){let n;return function(){for(var r=arguments.length,s=new Array(r),a=0;a<r;a++)s[a]=arguments[a];return t?(clearTimeout(n),n=setTimeout(e,t,s)):e.apply(this,s),t}}((e=>this.update(e)),a.resizeDelay||0),this._dataChanges=[],Xl[this.id]=this,i&&o?(Gi.listen(this,"complete",Gl),Gi.listen(this,"progress",$l),this._initialize(),this.attached&&this.update()):console.error("Failed to create chart: can't acquire context from the given item")}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:r,_aspectRatio:s}=this;return is(e)?t&&s?s:r?n/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Cl}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Ai(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Pa(this.canvas,this.ctx),this}stop(){return Gi.stop(this),this}resize(e,t){Gi.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,r=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(r,e,t,s),i=n.devicePixelRatio||this.platform.getDevicePixelRatio(),o=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,Ai(this,i,!0)&&(this.notifyPlugins("resize",{size:a}),fs(n.onResize,[this,a],this),this.attached&&this._doResize(o)&&this.render())}ensureScalesHaveIDs(){gs(this.options.scales||{},((e,t)=>{e.id=t}))}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,r=Object.keys(n).reduce(((e,t)=>(e[t]=!1,e)),{});let s=[];t&&(s=s.concat(Object.keys(t).map((e=>{const n=t[e],r=Il(e,n),s="r"===r,a="x"===r;return{options:n,dposition:s?"chartArea":a?"bottom":"left",dtype:s?"radialLinear":a?"category":"linear"}})))),gs(s,(t=>{const s=t.options,a=s.id,i=Il(a,s),o=us(s.type,t.dtype);void 0!==s.position&&Kl(s.position,i)===Kl(t.dposition)||(s.position=t.dposition),r[a]=!0;let l=null;if(a in n&&n[a].type===o)l=n[a];else{l=new(Cl.getScale(o))({id:a,type:o,ctx:this.ctx,chart:this}),n[l.id]=l}l.init(s,e)})),gs(r,((e,t)=>{e||delete n[t]})),gs(n,(e=>{Qo.configure(this,e,e.options),Qo.addBox(this,e)}))}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort(((e,t)=>e.index-t.index)),n>t){for(let e=t;e<n;++e)this._destroyDatasetMeta(e);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(Yl("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach(((e,n)=>{0===t.filter((t=>t===e._dataset)).length&&this._destroyDatasetMeta(n)}))}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,r;for(this._removeUnreferencedMetasets(),n=0,r=t.length;n<r;n++){const r=t[n];let s=this.getDatasetMeta(n);const a=r.type||this.config.type;if(s.type&&s.type!==a&&(this._destroyDatasetMeta(n),s=this.getDatasetMeta(n)),s.type=a,s.indexAxis=r.indexAxis||Pl(a,this.options),s.order=r.order||0,s.index=n,s.label=""+r.label,s.visible=this.isDatasetVisible(n),s.controller)s.controller.updateIndex(n),s.controller.linkScales();else{const t=Cl.getController(a),{datasetElementType:r,dataElementType:i}=Ca.datasets[a];Object.assign(t,{dataElementType:Cl.getElement(i),datasetElementType:r&&Cl.getElement(r)}),s.controller=new t(this,n),e.push(s.controller)}}return this._updateMetasets(),e}_resetElements(){gs(this.data.datasets,((e,t)=>{this.getDatasetMeta(t).controller.reset()}),this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),!1===this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0}))return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let l=0,c=this.data.datasets.length;l<c;l++){const{controller:e}=this.getDatasetMeta(l),t=!r&&-1===s.indexOf(e);e.buildOrUpdateElements(t),a=Math.max(+e.getMaxOverflow(),a)}a=this._minPadding=n.layout.autoPadding?a:0,this._updateLayout(a),r||gs(s,(e=>{e.reset()})),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(Yl("z","_idx"));const{_active:i,_lastEvent:o}=this;o?this._eventHandler(o,!0):i.length&&this._updateHoverStyles(i,i,!0),this.render()}_updateScales(){gs(this.scales,(e=>{Qo.removeBox(this,e)})),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);Es(t,n)&&!!this._responsiveListeners===e.responsive||(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:r,count:s}of t){ec(e,r,"_removeElements"===n?-s:s)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=t=>new Set(e.filter((e=>e[0]===t)).map(((e,t)=>t+","+e.splice(1).join(",")))),r=n(0);for(let s=1;s<t;s++)if(!Es(r,n(s)))return;return Array.from(r).map((e=>e.split(","))).map((e=>({method:e[1],start:+e[2],count:+e[3]})))}_updateLayout(e){if(!1===this.notifyPlugins("beforeLayout",{cancelable:!0}))return;Qo.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],gs(this.boxes,(e=>{n&&"chartArea"===e.position||(e.configure&&e.configure(),this._layers.push(...e._layers()))}),this),this._layers.forEach(((e,t)=>{e._idx=t})),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(!1!==this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})){for(let e=0,t=this.data.datasets.length;e<t;++e)this.getDatasetMeta(e).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,Ns(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),r={meta:n,index:e,mode:t,cancelable:!0};!1!==this.notifyPlugins("beforeDatasetUpdate",r)&&(n.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){!1!==this.notifyPlugins("beforeRender",{cancelable:!0})&&(Gi.has(this)?this.attached&&!Gi.running(this)&&Gi.start(this):(this.draw(),Gl({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:e,height:t}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(e,t)}if(this.clear(),this.width<=0||this.height<=0)return;if(!1===this.notifyPlugins("beforeDraw",{cancelable:!0}))return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let r,s;for(r=0,s=t.length;r<s;++r){const s=t[r];e&&!s.visible||n.push(s)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(!1===this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0}))return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n={meta:e,index:e.index,cancelable:!0},r=Ki(this,e);!1!==this.notifyPlugins("beforeDatasetDraw",n)&&(r&&Ma(t,r),e.controller.draw(),r&&Ra(t),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return La(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,r){const s=Fo.modes[t];return"function"===typeof s?s(this,e,n,r):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let r=n.filter((e=>e&&e._dataset===t)).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(r)),r}getContext(){return this.$context||(this.$context=Za(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return"boolean"===typeof n.hidden?!n.hidden:!t.hidden}setDatasetVisibility(e,t){this.getDatasetMeta(e).hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const r=n?"show":"hide",s=this.getDatasetMeta(e),a=s.controller._resolveAnimations(void 0,r);js(t)?(s.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),a.update(s,{visible:n}),this.update((t=>t.datasetIndex===e?r:void 0)))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),Gi.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Pa(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Xl[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(){return this.canvas.toDataURL(...arguments)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(n,r)=>{t.addEventListener(this,n,r),e[n]=r},r=(e,t,n)=>{e.offsetX=t,e.offsetY=n,this._eventHandler(e)};gs(this.options.events,(e=>n(e,r)))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(n,r)=>{t.addEventListener(this,n,r),e[n]=r},r=(n,r)=>{e[n]&&(t.removeEventListener(this,n,r),delete e[n])},s=(e,t)=>{this.canvas&&this.resize(e,t)};let a;const i=()=>{r("attach",i),this.attached=!0,this.resize(),n("resize",s),n("detach",a)};a=()=>{this.attached=!1,r("resize",s),this._stop(),this._resize(0,0),n("attach",i)},t.isAttached(this.canvas)?i():a()}unbindEvents(){gs(this._listeners,((e,t)=>{this.platform.removeEventListener(this,t,e)})),this._listeners={},gs(this._responsiveListeners,((e,t)=>{this.platform.removeEventListener(this,t,e)})),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const r=n?"set":"remove";let s,a,i,o;for("dataset"===t&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+r+"DatasetHoverStyle"]()),i=0,o=e.length;i<o;++i){a=e[i];const t=a&&this.getDatasetMeta(a.datasetIndex).controller;t&&t[r+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map((e=>{let{datasetIndex:t,index:n}=e;const r=this.getDatasetMeta(t);if(!r)throw new Error("No dataset found at index "+t);return{datasetIndex:t,element:r.data[n],index:n}}));!ps(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return 1===this._plugins._cache.filter((t=>t.plugin.id===e)).length}_updateHoverStyles(e,t,n){const r=this.options.hover,s=(e,t)=>e.filter((e=>!t.some((t=>e.datasetIndex===t.datasetIndex&&e.index===t.index)))),a=s(t,e),i=n?e:s(e,t);a.length&&this.updateHoverStyle(a,r.mode,!1),i.length&&r.mode&&this.updateHoverStyle(i,r.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},r=t=>(t.options.events||this.options.events).includes(e.native.type);if(!1===this.notifyPlugins("beforeEvent",n,r))return;const s=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,r),(s||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:r=[],options:s}=this,a=t,i=this._getActiveElements(e,r,n,a),o=function(e){return"mouseup"===e.type||"click"===e.type||"contextmenu"===e.type}(e),l=function(e,t,n,r){return n&&"mouseout"!==e.type?r?t:e:null}(e,this._lastEvent,n,o);n&&(this._lastEvent=null,fs(s.onHover,[e,i,this],this),o&&fs(s.onClick,[e,i,this],this));const c=!ps(i,r);return(c||t)&&(this._active=i,this._updateHoverStyles(i,r,t)),this._lastEvent=l,c}_getActiveElements(e,t,n,r){if("mouseout"===e.type)return[];if(!n)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,r)}}function nc(){return gs(tc.instances,(e=>e._plugins.invalidate()))}function rc(e,t,n,r){const s=Ka(e.options.borderRadius,["outerStart","outerEnd","innerStart","innerEnd"]);const a=(n-t)/2,i=Math.min(a,r*t/2),o=e=>{const t=(n-Math.min(a,e))*r/2;return $s(e,0,Math.min(a,t))};return{outerStart:o(s.outerStart),outerEnd:o(s.outerEnd),innerStart:$s(s.innerStart,0,i),innerEnd:$s(s.innerEnd,0,i)}}function sc(e,t,n,r){return{x:n+e*Math.cos(t),y:r+e*Math.sin(t)}}function ac(e,t,n,r,s,a){const{x:i,y:o,startAngle:l,pixelMargin:c,innerRadius:d}=t,u=Math.max(t.outerRadius+r+n-c,0),h=d>0?d+r+n+c:0;let f=0;const g=s-l;if(r){const e=((d>0?d-r:0)+(u>0?u-r:0))/2;f=(g-(0!==e?g*e/(e+r):g))/2}const p=(g-Math.max(.001,g*u-n/Cs)/u)/2,m=l+p+f,y=s-p-f,{outerStart:b,outerEnd:x,innerStart:v,innerEnd:w}=rc(t,h,u,y-m),_=u-b,S=u-x,k=m+b/_,j=y-x/S,N=h+v,E=h+w,C=m+v/N,T=y-w/E;if(e.beginPath(),a){const t=(k+j)/2;if(e.arc(i,o,u,k,t),e.arc(i,o,u,t,j),x>0){const t=sc(S,j,i,o);e.arc(t.x,t.y,x,j,y+Os)}const n=sc(E,y,i,o);if(e.lineTo(n.x,n.y),w>0){const t=sc(E,T,i,o);e.arc(t.x,t.y,w,y+Os,T+Math.PI)}const r=(y-w/h+(m+v/h))/2;if(e.arc(i,o,h,y-w/h,r,!0),e.arc(i,o,h,r,m+v/h,!0),v>0){const t=sc(N,C,i,o);e.arc(t.x,t.y,v,C+Math.PI,m-Os)}const s=sc(_,m,i,o);if(e.lineTo(s.x,s.y),b>0){const t=sc(_,k,i,o);e.arc(t.x,t.y,b,m-Os,k)}}else{e.moveTo(i,o);const t=Math.cos(k)*u+i,n=Math.sin(k)*u+o;e.lineTo(t,n);const r=Math.cos(j)*u+i,s=Math.sin(j)*u+o;e.lineTo(r,s)}e.closePath()}function ic(e,t,n,r,s){const{fullCircles:a,startAngle:i,circumference:o,options:l}=t,{borderWidth:c,borderJoinStyle:d,borderDash:u,borderDashOffset:h}=l,f="inner"===l.borderAlign;if(!c)return;e.setLineDash(u||[]),e.lineDashOffset=h,f?(e.lineWidth=2*c,e.lineJoin=d||"round"):(e.lineWidth=c,e.lineJoin=d||"bevel");let g=t.endAngle;if(a){ac(e,t,n,r,g,s);for(let t=0;t<a;++t)e.stroke();isNaN(o)||(g=i+(o%Ts||Ts))}f&&function(e,t,n){const{startAngle:r,pixelMargin:s,x:a,y:i,outerRadius:o,innerRadius:l}=t;let c=s/o;e.beginPath(),e.arc(a,i,o,r-c,n+c),l>s?(c=s/l,e.arc(a,i,l,n+c,r-c,!0)):e.arc(a,i,s,n+Os,r-Os),e.closePath(),e.clip()}(e,t,g),a||(ac(e,t,n,r,g,s),e.stroke())}(0,kr.A)(tc,"defaults",Ca),(0,kr.A)(tc,"instances",Xl),(0,kr.A)(tc,"overrides",Sa),(0,kr.A)(tc,"registry",Cl),(0,kr.A)(tc,"version","4.4.9"),(0,kr.A)(tc,"getChart",Zl);class oc extends pl{constructor(e){super(),(0,kr.A)(this,"circumference",void 0),(0,kr.A)(this,"endAngle",void 0),(0,kr.A)(this,"fullCircles",void 0),(0,kr.A)(this,"innerRadius",void 0),(0,kr.A)(this,"outerRadius",void 0),(0,kr.A)(this,"pixelMargin",void 0),(0,kr.A)(this,"startAngle",void 0),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,n){const r=this.getProps(["x","y"],n),{angle:s,distance:a}=Vs(r,{x:e,y:t}),{startAngle:i,endAngle:o,innerRadius:l,outerRadius:c,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],n),u=(this.options.spacing+this.options.borderWidth)/2,h=us(d,o-i),f=Gs(s,i,o)&&i!==o,g=h>=Ts||f,p=Qs(a,l+u,c+u);return g&&p}getCenterPoint(e){const{x:t,y:n,startAngle:r,endAngle:s,innerRadius:a,outerRadius:i}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:o,spacing:l}=this.options,c=(r+s)/2,d=(a+i+l+o)/2;return{x:t+Math.cos(c)*d,y:n+Math.sin(c)*d}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:n}=this,r=(t.offset||0)/4,s=(t.spacing||0)/2,a=t.circular;if(this.pixelMargin="inner"===t.borderAlign?.33:0,this.fullCircles=n>Ts?Math.floor(n/Ts):0,0===n||this.innerRadius<0||this.outerRadius<0)return;e.save();const i=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(i)*r,Math.sin(i)*r);const o=r*(1-Math.sin(Math.min(Cs,n||0)));e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,function(e,t,n,r,s){const{fullCircles:a,startAngle:i,circumference:o}=t;let l=t.endAngle;if(a){ac(e,t,n,r,l,s);for(let t=0;t<a;++t)e.fill();isNaN(o)||(l=i+(o%Ts||Ts))}ac(e,t,n,r,l,s),e.fill()}(e,this,o,s,a),ic(e,this,o,s,a),e.restore()}}function lc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;e.lineCap=us(n.borderCapStyle,t.borderCapStyle),e.setLineDash(us(n.borderDash,t.borderDash)),e.lineDashOffset=us(n.borderDashOffset,t.borderDashOffset),e.lineJoin=us(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=us(n.borderWidth,t.borderWidth),e.strokeStyle=us(n.borderColor,t.borderColor)}function cc(e,t,n){e.lineTo(n.x,n.y)}function dc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.length,{start:s=0,end:a=r-1}=n,{start:i,end:o}=t,l=Math.max(s,i),c=Math.min(a,o),d=s<i&&a<i||s>o&&a>o;return{count:r,start:l,loop:t.loop,ilen:c<l&&!d?r+c-l:c-l}}function uc(e,t,n,r){const{points:s,options:a}=t,{count:i,start:o,loop:l,ilen:c}=dc(s,n,r),d=function(e){return e.stepped?Fa:e.tension||"monotone"===e.cubicInterpolationMode?Ba:cc}(a);let u,h,f,{move:g=!0,reverse:p}=r||{};for(u=0;u<=c;++u)h=s[(o+(p?c-u:u))%i],h.skip||(g?(e.moveTo(h.x,h.y),g=!1):d(e,f,h,p,a.stepped),f=h);return l&&(h=s[(o+(p?c:0))%i],d(e,f,h,p,a.stepped)),!!l}function hc(e,t,n,r){const s=t.points,{count:a,start:i,ilen:o}=dc(s,n,r),{move:l=!0,reverse:c}=r||{};let d,u,h,f,g,p,m=0,y=0;const b=e=>(i+(c?o-e:e))%a,x=()=>{f!==g&&(e.lineTo(m,g),e.lineTo(m,f),e.lineTo(m,p))};for(l&&(u=s[b(0)],e.moveTo(u.x,u.y)),d=0;d<=o;++d){if(u=s[b(d)],u.skip)continue;const t=u.x,n=u.y,r=0|t;r===h?(n<f?f=n:n>g&&(g=n),m=(y*m+t)/++y):(x(),e.lineTo(t,n),h=r,y=0,f=g=n),p=n}x()}function fc(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&"monotone"!==t.cubicInterpolationMode&&!t.stepped&&!n?hc:uc}(0,kr.A)(oc,"id","arc"),(0,kr.A)(oc,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0}),(0,kr.A)(oc,"defaultRoutes",{backgroundColor:"backgroundColor"}),(0,kr.A)(oc,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e});const gc="function"===typeof Path2D;function pc(e,t,n,r){gc&&!t.options.segment?function(e,t,n,r){let s=t._path;s||(s=t._path=new Path2D,t.path(s,n,r)&&s.closePath()),lc(e,t.options),e.stroke(s)}(e,t,n,r):function(e,t,n,r){const{segments:s,options:a}=t,i=fc(t);for(const o of s)lc(e,a,o.style),e.beginPath(),i(e,t,o,{start:n,end:n+r-1})&&e.closePath(),e.stroke()}(e,t,n,r)}class mc extends pl{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this.options;if((n.tension||"monotone"===n.cubicInterpolationMode)&&!n.stepped&&!this._pointsUpdated){const r=n.spanGaps?this._loop:this._fullLoop;vi(this._points,n,e,r,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=function(e,t){const n=e.points,r=e.options.spanGaps,s=n.length;if(!s)return[];const a=!!e._loop,{start:i,end:o}=function(e,t,n,r){let s=0,a=t-1;if(n&&!r)for(;s<t&&!e[s].skip;)s++;for(;s<t&&e[s].skip;)s++;for(s%=t,n&&(a+=s);a>s&&e[a%t].skip;)a--;return a%=t,{start:s,end:a}}(n,s,a,r);return qi(e,!0===r?[{start:i,end:o,loop:a}]:function(e,t,n,r){const s=e.length,a=[];let i,o=t,l=e[t];for(i=t+1;i<=n;++i){const n=e[i%s];n.skip||n.stop?l.skip||(r=!1,a.push({start:t%s,end:(i-1)%s,loop:r}),t=o=n.stop?i:null):(o=i,l.skip&&(t=i)),l=n}return null!==o&&a.push({start:t%s,end:o%s,loop:r}),a}(n,i,o<i?o+s:o,!!e._fullLoop&&0===i&&o===s-1),n,t)}(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this.options,r=e[t],s=this.points,a=Wi(this,{property:t,start:r,end:r});if(!a.length)return;const i=[],o=function(e){return e.stepped?Ii:e.tension||"monotone"===e.cubicInterpolationMode?Li:Oi}(n);let l,c;for(l=0,c=a.length;l<c;++l){const{start:c,end:d}=a[l],u=s[c],h=s[d];if(u===h){i.push(u);continue}const f=o(u,h,Math.abs((r-u[t])/(h[t]-u[t])),n.stepped);f[t]=e[t],i.push(f)}return 1===i.length?i[0]:i}pathSegment(e,t,n){return fc(this)(e,this,t,n)}path(e,t,n){const r=this.segments,s=fc(this);let a=this._loop;t=t||0,n=n||this.points.length-t;for(const i of r)a&=s(e,this,i,{start:t,end:t+n-1});return!!a}draw(e,t,n,r){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),pc(e,this,n,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function yc(e,t,n,r){const s=e.options,{[n]:a}=e.getProps([n],r);return Math.abs(t-a)<s.radius+s.hitRadius}(0,kr.A)(mc,"id","line"),(0,kr.A)(mc,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),(0,kr.A)(mc,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),(0,kr.A)(mc,"descriptors",{_scriptable:!0,_indexable:e=>"borderDash"!==e&&"fill"!==e});class bc extends pl{constructor(e){super(),(0,kr.A)(this,"parsed",void 0),(0,kr.A)(this,"skip",void 0),(0,kr.A)(this,"stop",void 0),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,n){const r=this.options,{x:s,y:a}=this.getProps(["x","y"],n);return Math.pow(e-s,2)+Math.pow(t-a,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,t){return yc(this,e,"x",t)}inYRange(e,t){return yc(this,e,"y",t)}getCenterPoint(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}size(e){let t=(e=e||this.options||{}).radius||0;t=Math.max(t,t&&e.hoverRadius||0);return 2*(t+(t&&e.borderWidth||0))}draw(e,t){const n=this.options;this.skip||n.radius<.1||!La(this,t,this.size(n)/2)||(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.fillStyle=n.backgroundColor,Oa(e,n,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function xc(e,t){const{x:n,y:r,base:s,width:a,height:i}=e.getProps(["x","y","base","width","height"],t);let o,l,c,d,u;return e.horizontal?(u=i/2,o=Math.min(n,s),l=Math.max(n,s),c=r-u,d=r+u):(u=a/2,o=n-u,l=n+u,c=Math.min(r,s),d=Math.max(r,s)),{left:o,top:c,right:l,bottom:d}}function vc(e,t,n,r){return e?0:$s(t,n,r)}function wc(e){const t=xc(e),n=t.right-t.left,r=t.bottom-t.top,s=function(e,t,n){const r=e.options.borderWidth,s=e.borderSkipped,a=Ya(r);return{t:vc(s.top,a.top,0,n),r:vc(s.right,a.right,0,t),b:vc(s.bottom,a.bottom,0,n),l:vc(s.left,a.left,0,t)}}(e,n/2,r/2),a=function(e,t,n){const{enableBorderRadius:r}=e.getProps(["enableBorderRadius"]),s=e.options.borderRadius,a=Ga(s),i=Math.min(t,n),o=e.borderSkipped,l=r||ls(s);return{topLeft:vc(!l||o.top||o.left,a.topLeft,0,i),topRight:vc(!l||o.top||o.right,a.topRight,0,i),bottomLeft:vc(!l||o.bottom||o.left,a.bottomLeft,0,i),bottomRight:vc(!l||o.bottom||o.right,a.bottomRight,0,i)}}(e,n/2,r/2);return{outer:{x:t.left,y:t.top,w:n,h:r,radius:a},inner:{x:t.left+s.l,y:t.top+s.t,w:n-s.l-s.r,h:r-s.t-s.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,a.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(s.b,s.r))}}}}function _c(e,t,n,r){const s=null===t,a=null===n,i=e&&!(s&&a)&&xc(e,r);return i&&(s||Qs(t,i.left,i.right))&&(a||Qs(n,i.top,i.bottom))}function Sc(e,t){e.rect(t.x,t.y,t.w,t.h)}function kc(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=e.x!==n.x?-t:0,s=e.y!==n.y?-t:0,a=(e.x+e.w!==n.x+n.w?t:0)-r,i=(e.y+e.h!==n.y+n.h?t:0)-s;return{x:e.x+r,y:e.y+s,w:e.w+a,h:e.h+i,radius:e.radius}}(0,kr.A)(bc,"id","point"),(0,kr.A)(bc,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),(0,kr.A)(bc,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});class jc extends pl{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:n,backgroundColor:r}}=this,{inner:s,outer:a}=wc(this),i=(o=a.radius).topLeft||o.topRight||o.bottomLeft||o.bottomRight?qa:Sc;var o;e.save(),a.w===s.w&&a.h===s.h||(e.beginPath(),i(e,kc(a,t,s)),e.clip(),i(e,kc(s,-t,a)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),i(e,kc(s,t)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,n){return _c(this,e,t,n)}inXRange(e,t){return _c(this,e,null,t)}inYRange(e,t){return _c(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+r)/2:t,y:s?n:(n+r)/2}}getRange(e){return"x"===e?this.width/2:this.height/2}}(0,kr.A)(jc,"id","bar"),(0,kr.A)(jc,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),(0,kr.A)(jc,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const Nc=(e,t)=>{let{boxHeight:n=t,boxWidth:r=t}=e;return e.usePointStyle&&(n=Math.min(n,t),r=e.pointStyleWidth||Math.min(r,t)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(t,n)}};class Ec extends pl{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=fs(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter((t=>e.filter(t,this.chart.data)))),e.sort&&(t=t.sort(((t,n)=>e.sort(t,n,this.chart.data)))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display)return void(this.width=this.height=0);const n=e.labels,r=Qa(n.font),s=r.size,a=this._computeTitleHeight(),{boxWidth:i,itemHeight:o}=Nc(n,s);let l,c;t.font=r.string,this.isHorizontal()?(l=this.maxWidth,c=this._fitRows(a,s,i,o)+10):(c=this.maxHeight,l=this._fitCols(a,r,i,o)+10),this.width=Math.min(l,e.maxWidth||this.maxWidth),this.height=Math.min(c,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,r){const{ctx:s,maxWidth:a,options:{labels:{padding:i}}}=this,o=this.legendHitBoxes=[],l=this.lineWidths=[0],c=r+i;let d=e;s.textAlign="left",s.textBaseline="middle";let u=-1,h=-c;return this.legendItems.forEach(((e,f)=>{const g=n+t/2+s.measureText(e.text).width;(0===f||l[l.length-1]+g+2*i>a)&&(d+=c,l[l.length-(f>0?0:1)]=0,h+=c,u++),o[f]={left:0,top:h,row:u,width:g,height:r},l[l.length-1]+=g+i})),d}_fitCols(e,t,n,r){const{ctx:s,maxHeight:a,options:{labels:{padding:i}}}=this,o=this.legendHitBoxes=[],l=this.columnSizes=[],c=a-e;let d=i,u=0,h=0,f=0,g=0;return this.legendItems.forEach(((e,a)=>{const{itemWidth:p,itemHeight:m}=function(e,t,n,r,s){const a=function(e,t,n,r){let s=e.text;s&&"string"!==typeof s&&(s=s.reduce(((e,t)=>e.length>t.length?e:t)));return t+n.size/2+r.measureText(s).width}(r,e,t,n),i=function(e,t,n){let r=e;"string"!==typeof t.text&&(r=Cc(t,n));return r}(s,r,t.lineHeight);return{itemWidth:a,itemHeight:i}}(n,t,s,e,r);a>0&&h+m+2*i>c&&(d+=u+i,l.push({width:u,height:h}),f+=u+i,g++,u=h=0),o[a]={left:f,top:h,col:g,width:p,height:m},u=Math.max(u,p),h+=m+i})),d+=u,l.push({width:u,height:h}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:r},rtl:s}}=this,a=Mi(s,this.left,this.width);if(this.isHorizontal()){let s=0,i=oa(n,this.left+r,this.right-this.lineWidths[s]);for(const o of t)s!==o.row&&(s=o.row,i=oa(n,this.left+r,this.right-this.lineWidths[s])),o.top+=this.top+e+r,o.left=a.leftForLtr(a.x(i),o.width),i+=o.width+r}else{let s=0,i=oa(n,this.top+e+r,this.bottom-this.columnSizes[s].height);for(const o of t)o.col!==s&&(s=o.col,i=oa(n,this.top+e+r,this.bottom-this.columnSizes[s].height)),o.top=i,o.left+=this.left+r,o.left=a.leftForLtr(a.x(o.left),o.width),i+=o.height+r}}isHorizontal(){return"top"===this.options.position||"bottom"===this.options.position}draw(){if(this.options.display){const e=this.ctx;Ma(e,this),this._draw(),Ra(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:r}=this,{align:s,labels:a}=e,i=Ca.color,o=Mi(e.rtl,this.left,this.width),l=Qa(a.font),{padding:c}=a,d=l.size,u=d/2;let h;this.drawTitle(),r.textAlign=o.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=l.string;const{boxWidth:f,boxHeight:g,itemHeight:p}=Nc(a,d),m=this.isHorizontal(),y=this._computeTitleHeight();h=m?{x:oa(s,this.left+c,this.right-n[0]),y:this.top+c+y,line:0}:{x:this.left+c,y:oa(s,this.top+y+c,this.bottom-t[0].height),line:0},Ri(this.ctx,e.textDirection);const b=p+c;this.legendItems.forEach(((x,v)=>{r.strokeStyle=x.fontColor,r.fillStyle=x.fontColor;const w=r.measureText(x.text).width,_=o.textAlign(x.textAlign||(x.textAlign=a.textAlign)),S=f+u+w;let k=h.x,j=h.y;o.setWidth(this.width),m?v>0&&k+S+c>this.right&&(j=h.y+=b,h.line++,k=h.x=oa(s,this.left+c,this.right-n[h.line])):v>0&&j+b>this.bottom&&(k=h.x=k+t[h.line].width+c,h.line++,j=h.y=oa(s,this.top+y+c,this.bottom-t[h.line].height));if(function(e,t,n){if(isNaN(f)||f<=0||isNaN(g)||g<0)return;r.save();const s=us(n.lineWidth,1);if(r.fillStyle=us(n.fillStyle,i),r.lineCap=us(n.lineCap,"butt"),r.lineDashOffset=us(n.lineDashOffset,0),r.lineJoin=us(n.lineJoin,"miter"),r.lineWidth=s,r.strokeStyle=us(n.strokeStyle,i),r.setLineDash(us(n.lineDash,[])),a.usePointStyle){const i={radius:g*Math.SQRT2/2,pointStyle:n.pointStyle,rotation:n.rotation,borderWidth:s},l=o.xPlus(e,f/2);Ia(r,i,l,t+u,a.pointStyleWidth&&f)}else{const a=t+Math.max((d-g)/2,0),i=o.leftForLtr(e,f),l=Ga(n.borderRadius);r.beginPath(),Object.values(l).some((e=>0!==e))?qa(r,{x:i,y:a,w:f,h:g,radius:l}):r.rect(i,a,f,g),r.fill(),0!==s&&r.stroke()}r.restore()}(o.x(k),j,x),k=((e,t,n,r)=>e===(r?"left":"right")?n:"center"===e?(t+n)/2:t)(_,k+f+u,m?k+S:this.right,e.rtl),function(e,t,n){Wa(r,n.text,e,t+p/2,l,{strikethrough:n.hidden,textAlign:o.textAlign(n.textAlign)})}(o.x(k),j,x),m)h.x+=S+c;else if("string"!==typeof x.text){const e=l.lineHeight;h.y+=Cc(x,e)+c}else h.y+=b})),Fi(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=Qa(t.font),r=$a(t.padding);if(!t.display)return;const s=Mi(e.rtl,this.left,this.width),a=this.ctx,i=t.position,o=n.size/2,l=r.top+o;let c,d=this.left,u=this.width;if(this.isHorizontal())u=Math.max(...this.lineWidths),c=this.top+l,d=oa(e.align,d,this.right-u);else{const t=this.columnSizes.reduce(((e,t)=>Math.max(e,t.height)),0);c=l+oa(e.align,this.top,this.bottom-t-e.labels.padding-this._computeTitleHeight())}const h=oa(i,d,d+u);a.textAlign=s.textAlign(ia(i)),a.textBaseline="middle",a.strokeStyle=t.color,a.fillStyle=t.color,a.font=n.string,Wa(a,t.text,h,c,n)}_computeTitleHeight(){const e=this.options.title,t=Qa(e.font),n=$a(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,r,s;if(Qs(e,this.left,this.right)&&Qs(t,this.top,this.bottom))for(s=this.legendHitBoxes,n=0;n<s.length;++n)if(r=s[n],Qs(e,r.left,r.left+r.width)&&Qs(t,r.top,r.top+r.height))return this.legendItems[n];return null}handleEvent(e){const t=this.options;if(!function(e,t){if(("mousemove"===e||"mouseout"===e)&&(t.onHover||t.onLeave))return!0;if(t.onClick&&("click"===e||"mouseup"===e))return!0;return!1}(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if("mousemove"===e.type||"mouseout"===e.type){const a=this._hoveredItem,i=(s=n,null!==(r=a)&&null!==s&&r.datasetIndex===s.datasetIndex&&r.index===s.index);a&&!i&&fs(t.onLeave,[e,a,this],this),this._hoveredItem=n,n&&!i&&fs(t.onHover,[e,n,this],this)}else n&&fs(t.onClick,[e,n,this],this);var r,s}}function Cc(e,t){return t*(e.text?e.text.length:0)}var Tc={id:"legend",_element:Ec,start(e,t,n){const r=e.legend=new Ec({ctx:e.ctx,options:n,chart:e});Qo.configure(e,r,n),Qo.addBox(e,r)},stop(e){Qo.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const r=e.legend;Qo.configure(e,r,n),r.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const r=t.datasetIndex,s=n.chart;s.isDatasetVisible(r)?(s.hide(r),t.hidden=!0):(s.show(r),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:s,color:a,useBorderRadius:i,borderRadius:o}}=e.legend.options;return e._getSortedDatasetMetas().map((e=>{const l=e.controller.getStyle(n?0:void 0),c=$a(l.borderWidth);return{text:t[e.index].label,fillStyle:l.backgroundColor,fontColor:a,hidden:!e.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(c.width+c.height)/4,strokeStyle:l.borderColor,pointStyle:r||l.pointStyle,rotation:l.rotation,textAlign:s||l.textAlign,borderRadius:i&&(o||l.borderRadius),datasetIndex:e.index}}),this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};new WeakMap;const Ac={average(e){if(!e.length)return!1;let t,n,r=new Set,s=0,a=0;for(t=0,n=e.length;t<n;++t){const n=e[t].element;if(n&&n.hasValue()){const e=n.tooltipPosition();r.add(e.x),s+=e.y,++a}}if(0===a||0===r.size)return!1;return{x:[...r].reduce(((e,t)=>e+t))/r.size,y:s/a}},nearest(e,t){if(!e.length)return!1;let n,r,s,a=t.x,i=t.y,o=Number.POSITIVE_INFINITY;for(n=0,r=e.length;n<r;++n){const r=e[n].element;if(r&&r.hasValue()){const e=Js(t,r.getCenterPoint());e<o&&(o=e,s=r)}}if(s){const e=s.tooltipPosition();a=e.x,i=e.y}return{x:a,y:i}}};function Dc(e,t){return t&&(os(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function Pc(e){return("string"===typeof e||e instanceof String)&&e.indexOf("\n")>-1?e.split("\n"):e}function Oc(e,t){const{element:n,datasetIndex:r,index:s}=t,a=e.getDatasetMeta(r).controller,{label:i,value:o}=a.getLabelAndValue(s);return{chart:e,label:i,parsed:a.getParsed(s),raw:e.data.datasets[r].data[s],formattedValue:o,dataset:a.getDataset(),dataIndex:s,datasetIndex:r,element:n}}function Ic(e,t){const n=e.chart.ctx,{body:r,footer:s,title:a}=e,{boxWidth:i,boxHeight:o}=t,l=Qa(t.bodyFont),c=Qa(t.titleFont),d=Qa(t.footerFont),u=a.length,h=s.length,f=r.length,g=$a(t.padding);let p=g.height,m=0,y=r.reduce(((e,t)=>e+t.before.length+t.lines.length+t.after.length),0);if(y+=e.beforeBody.length+e.afterBody.length,u&&(p+=u*c.lineHeight+(u-1)*t.titleSpacing+t.titleMarginBottom),y){p+=f*(t.displayColors?Math.max(o,l.lineHeight):l.lineHeight)+(y-f)*l.lineHeight+(y-1)*t.bodySpacing}h&&(p+=t.footerMarginTop+h*d.lineHeight+(h-1)*t.footerSpacing);let b=0;const x=function(e){m=Math.max(m,n.measureText(e).width+b)};return n.save(),n.font=c.string,gs(e.title,x),n.font=l.string,gs(e.beforeBody.concat(e.afterBody),x),b=t.displayColors?i+2+t.boxPadding:0,gs(r,(e=>{gs(e.before,x),gs(e.lines,x),gs(e.after,x)})),b=0,n.font=d.string,gs(e.footer,x),n.restore(),m+=g.width,{width:m,height:p}}function Lc(e,t,n,r){const{x:s,width:a}=n,{width:i,chartArea:{left:o,right:l}}=e;let c="center";return"center"===r?c=s<=(o+l)/2?"left":"right":s<=a/2?c="left":s>=i-a/2&&(c="right"),function(e,t,n,r){const{x:s,width:a}=r,i=n.caretSize+n.caretPadding;return"left"===e&&s+a+i>t.width||"right"===e&&s-a-i<0||void 0}(c,e,t,n)&&(c="center"),c}function Mc(e,t,n){const r=n.yAlign||t.yAlign||function(e,t){const{y:n,height:r}=t;return n<r/2?"top":n>e.height-r/2?"bottom":"center"}(e,n);return{xAlign:n.xAlign||t.xAlign||Lc(e,t,n,r),yAlign:r}}function Rc(e,t,n,r){const{caretSize:s,caretPadding:a,cornerRadius:i}=e,{xAlign:o,yAlign:l}=n,c=s+a,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:f}=Ga(i);let g=function(e,t){let{x:n,width:r}=e;return"right"===t?n-=r:"center"===t&&(n-=r/2),n}(t,o);const p=function(e,t,n){let{y:r,height:s}=e;return"top"===t?r+=n:r-="bottom"===t?s+n:s/2,r}(t,l,c);return"center"===l?"left"===o?g+=c:"right"===o&&(g-=c):"left"===o?g-=Math.max(d,h)+s:"right"===o&&(g+=Math.max(u,f)+s),{x:$s(g,0,r.width-t.width),y:$s(p,0,r.height-t.height)}}function Fc(e,t,n){const r=$a(n.padding);return"center"===t?e.x+e.width/2:"right"===t?e.x+e.width-r.right:e.x+r.left}function Bc(e){return Dc([],Pc(e))}function zc(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}const Uc={beforeTitle:ss,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,r=n?n.length:0;if(this&&this.options&&"dataset"===this.options.mode)return t.dataset.label||"";if(t.label)return t.label;if(r>0&&t.dataIndex<r)return n[t.dataIndex]}return""},afterTitle:ss,beforeBody:ss,beforeLabel:ss,label(e){if(this&&this.options&&"dataset"===this.options.mode)return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return is(n)||(t+=n),t},labelColor(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const t=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:ss,afterBody:ss,beforeFooter:ss,footer:ss,afterFooter:ss};function Wc(e,t,n,r){const s=e[t].call(n,r);return"undefined"===typeof s?Uc[t].call(n,r):s}class qc extends pl{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),r=n.enabled&&t.options.animation&&n.animations,s=new Zi(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=(e=this.chart.getContext(),t=this,n=this._tooltipItems,Za(e,{tooltip:t,tooltipItems:n,type:"tooltip"})));var e,t,n}getTitle(e,t){const{callbacks:n}=t,r=Wc(n,"beforeTitle",this,e),s=Wc(n,"title",this,e),a=Wc(n,"afterTitle",this,e);let i=[];return i=Dc(i,Pc(r)),i=Dc(i,Pc(s)),i=Dc(i,Pc(a)),i}getBeforeBody(e,t){return Bc(Wc(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,r=[];return gs(e,(e=>{const t={before:[],lines:[],after:[]},s=zc(n,e);Dc(t.before,Pc(Wc(s,"beforeLabel",this,e))),Dc(t.lines,Wc(s,"label",this,e)),Dc(t.after,Pc(Wc(s,"afterLabel",this,e))),r.push(t)})),r}getAfterBody(e,t){return Bc(Wc(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,r=Wc(n,"beforeFooter",this,e),s=Wc(n,"footer",this,e),a=Wc(n,"afterFooter",this,e);let i=[];return i=Dc(i,Pc(r)),i=Dc(i,Pc(s)),i=Dc(i,Pc(a)),i}_createItems(e){const t=this._active,n=this.chart.data,r=[],s=[],a=[];let i,o,l=[];for(i=0,o=t.length;i<o;++i)l.push(Oc(this.chart,t[i]));return e.filter&&(l=l.filter(((t,r,s)=>e.filter(t,r,s,n)))),e.itemSort&&(l=l.sort(((t,r)=>e.itemSort(t,r,n)))),gs(l,(t=>{const n=zc(e.callbacks,t);r.push(Wc(n,"labelColor",this,t)),s.push(Wc(n,"labelPointStyle",this,t)),a.push(Wc(n,"labelTextColor",this,t))})),this.labelColors=r,this.labelPointStyles=s,this.labelTextColors=a,this.dataPoints=l,l}update(e,t){const n=this.options.setContext(this.getContext()),r=this._active;let s,a=[];if(r.length){const e=Ac[n.position].call(this,r,this._eventPosition);a=this._createItems(n),this.title=this.getTitle(a,n),this.beforeBody=this.getBeforeBody(a,n),this.body=this.getBody(a,n),this.afterBody=this.getAfterBody(a,n),this.footer=this.getFooter(a,n);const t=this._size=Ic(this,n),i=Object.assign({},e,t),o=Mc(this.chart,n,i),l=Rc(n,i,o,this.chart);this.xAlign=o.xAlign,this.yAlign=o.yAlign,s={opacity:1,x:l.x,y:l.y,width:t.width,height:t.height,caretX:e.x,caretY:e.y}}else 0!==this.opacity&&(s={opacity:0});this._tooltipItems=a,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,r){const s=this.getCaretPosition(e,n,r);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,n){const{xAlign:r,yAlign:s}=this,{caretSize:a,cornerRadius:i}=n,{topLeft:o,topRight:l,bottomLeft:c,bottomRight:d}=Ga(i),{x:u,y:h}=e,{width:f,height:g}=t;let p,m,y,b,x,v;return"center"===s?(x=h+g/2,"left"===r?(p=u,m=p-a,b=x+a,v=x-a):(p=u+f,m=p+a,b=x-a,v=x+a),y=p):(m="left"===r?u+Math.max(o,c)+a:"right"===r?u+f-Math.max(l,d)-a:this.caretX,"top"===s?(b=h,x=b-a,p=m-a,y=m+a):(b=h+g,x=b+a,p=m+a,y=m-a),v=b),{x1:p,x2:m,x3:y,y1:b,y2:x,y3:v}}drawTitle(e,t,n){const r=this.title,s=r.length;let a,i,o;if(s){const l=Mi(n.rtl,this.x,this.width);for(e.x=Fc(this,n.titleAlign,n),t.textAlign=l.textAlign(n.titleAlign),t.textBaseline="middle",a=Qa(n.titleFont),i=n.titleSpacing,t.fillStyle=n.titleColor,t.font=a.string,o=0;o<s;++o)t.fillText(r[o],l.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+i,o+1===s&&(e.y+=n.titleMarginBottom-i)}}_drawColorBox(e,t,n,r,s){const a=this.labelColors[n],i=this.labelPointStyles[n],{boxHeight:o,boxWidth:l}=s,c=Qa(s.bodyFont),d=Fc(this,"left",s),u=r.x(d),h=o<c.lineHeight?(c.lineHeight-o)/2:0,f=t.y+h;if(s.usePointStyle){const t={radius:Math.min(l,o)/2,pointStyle:i.pointStyle,rotation:i.rotation,borderWidth:1},n=r.leftForLtr(u,l)+l/2,c=f+o/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,Oa(e,t,n,c),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,Oa(e,t,n,c)}else{e.lineWidth=ls(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;const t=r.leftForLtr(u,l),n=r.leftForLtr(r.xPlus(u,1),l-2),i=Ga(a.borderRadius);Object.values(i).some((e=>0!==e))?(e.beginPath(),e.fillStyle=s.multiKeyBackground,qa(e,{x:t,y:f,w:l,h:o,radius:i}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),qa(e,{x:n,y:f+1,w:l-2,h:o-2,radius:i}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(t,f,l,o),e.strokeRect(t,f,l,o),e.fillStyle=a.backgroundColor,e.fillRect(n,f+1,l-2,o-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:r}=this,{bodySpacing:s,bodyAlign:a,displayColors:i,boxHeight:o,boxWidth:l,boxPadding:c}=n,d=Qa(n.bodyFont);let u=d.lineHeight,h=0;const f=Mi(n.rtl,this.x,this.width),g=function(n){t.fillText(n,f.x(e.x+h),e.y+u/2),e.y+=u+s},p=f.textAlign(a);let m,y,b,x,v,w,_;for(t.textAlign=a,t.textBaseline="middle",t.font=d.string,e.x=Fc(this,p,n),t.fillStyle=n.bodyColor,gs(this.beforeBody,g),h=i&&"right"!==p?"center"===a?l/2+c:l+2+c:0,x=0,w=r.length;x<w;++x){for(m=r[x],y=this.labelTextColors[x],t.fillStyle=y,gs(m.before,g),b=m.lines,i&&b.length&&(this._drawColorBox(t,e,x,f,n),u=Math.max(d.lineHeight,o)),v=0,_=b.length;v<_;++v)g(b[v]),u=d.lineHeight;gs(m.after,g)}h=0,u=d.lineHeight,gs(this.afterBody,g),e.y-=s}drawFooter(e,t,n){const r=this.footer,s=r.length;let a,i;if(s){const o=Mi(n.rtl,this.x,this.width);for(e.x=Fc(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=o.textAlign(n.footerAlign),t.textBaseline="middle",a=Qa(n.footerFont),t.fillStyle=n.footerColor,t.font=a.string,i=0;i<s;++i)t.fillText(r[i],o.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+n.footerSpacing}}drawBackground(e,t,n,r){const{xAlign:s,yAlign:a}=this,{x:i,y:o}=e,{width:l,height:c}=n,{topLeft:d,topRight:u,bottomLeft:h,bottomRight:f}=Ga(r.cornerRadius);t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(i+d,o),"top"===a&&this.drawCaret(e,t,n,r),t.lineTo(i+l-u,o),t.quadraticCurveTo(i+l,o,i+l,o+u),"center"===a&&"right"===s&&this.drawCaret(e,t,n,r),t.lineTo(i+l,o+c-f),t.quadraticCurveTo(i+l,o+c,i+l-f,o+c),"bottom"===a&&this.drawCaret(e,t,n,r),t.lineTo(i+h,o+c),t.quadraticCurveTo(i,o+c,i,o+c-h),"center"===a&&"left"===s&&this.drawCaret(e,t,n,r),t.lineTo(i,o+d),t.quadraticCurveTo(i,o,i+d,o),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,r=n&&n.x,s=n&&n.y;if(r||s){const n=Ac[e.position].call(this,this._active,this._eventPosition);if(!n)return;const a=this._size=Ic(this,e),i=Object.assign({},n,this._size),o=Mc(t,e,i),l=Rc(e,i,o,t);r._to===l.x&&s._to===l.y||(this.xAlign=o.xAlign,this.yAlign=o.yAlign,this.width=a.width,this.height=a.height,this.caretX=n.x,this.caretY=n.y,this._resolveAnimations().update(this,l))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const r={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const a=$a(t.padding),i=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&i&&(e.save(),e.globalAlpha=n,this.drawBackground(s,e,r,t),Ri(e,t.textDirection),s.y+=a.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),Fi(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,r=e.map((e=>{let{datasetIndex:t,index:n}=e;const r=this.chart.getDatasetMeta(t);if(!r)throw new Error("Cannot find a dataset at index "+t);return{datasetIndex:t,element:r.data[n],index:n}})),s=!ps(n,r),a=this._positionChanged(r,t);(s||a)&&(this._active=r,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,s=this._active||[],a=this._getActiveElements(e,s,t,n),i=this._positionChanged(a,e),o=t||!ps(a,s)||i;return o&&(this._active=a,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),o}_getActiveElements(e,t,n,r){const s=this.options;if("mouseout"===e.type)return[];if(!r)return t.filter((e=>this.chart.data.datasets[e.datasetIndex]&&void 0!==this.chart.getDatasetMeta(e.datasetIndex).controller.getParsed(e.index)));const a=this.chart.getElementsAtEventForMode(e,s.mode,s,n);return s.reverse&&a.reverse(),a}_positionChanged(e,t){const{caretX:n,caretY:r,options:s}=this,a=Ac[s.position].call(this,e,t);return!1!==a&&(n!==a.x||r!==a.y)}}(0,kr.A)(qc,"positioners",Ac);var Hc={id:"tooltip",_element:qc,positioners:Ac,afterInit(e,t,n){n&&(e.tooltip=new qc({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(!1===e.notifyPlugins("beforeTooltipDraw",(0,Oe.A)((0,Oe.A)({},n),{},{cancelable:!0})))return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Uc},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>"filter"!==e&&"itemSort"!==e&&"external"!==e,_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};function Vc(e,t,n,r){const s=e.indexOf(t);if(-1===s)return((e,t,n,r)=>("string"===typeof t?(n=e.push(t)-1,r.unshift({index:n,label:t})):isNaN(t)&&(n=null),n))(e,t,n,r);return s!==e.lastIndexOf(t)?n:s}function Jc(e){const t=this.getLabels();return e>=0&&e<t.length?t[e]:e}class Kc extends jl{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const e=this.getLabels();for(const{index:n,label:r}of t)e[n]===r&&e.splice(n,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(is(e))return null;const n=this.getLabels();return((e,t)=>null===e?null:$s(Math.round(e),0,t))(t=isFinite(t)&&n[t]===e?t:Vc(n,e,us(t,e),this._addedLabels),n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:n,max:r}=this.getMinMax(!0);"ticks"===this.options.bounds&&(e||(n=0),t||(r=this.getLabels().length-1)),this.min=n,this.max=r}buildTicks(){const e=this.min,t=this.max,n=this.options.offset,r=[];let s=this.getLabels();s=0===e&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let a=e;a<=t;a++)r.push({value:a});return r}getLabelForValue(e){return Jc.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return"number"!==typeof e&&(e=this.parse(e)),null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function Yc(e,t){const n=[],{bounds:r,step:s,min:a,max:i,precision:o,count:l,maxTicks:c,maxDigits:d,includeBounds:u}=e,h=s||1,f=c-1,{min:g,max:p}=t,m=!is(a),y=!is(i),b=!is(l),x=(p-g)/(d+1);let v,w,_,S,k=Bs((p-g)/f/h)*h;if(k<1e-14&&!m&&!y)return[{value:g},{value:p}];S=Math.ceil(p/k)-Math.floor(g/k),S>f&&(k=Bs(S*k/f/h)*h),is(o)||(v=Math.pow(10,o),k=Math.ceil(k*v)/v),"ticks"===r?(w=Math.floor(g/k)*k,_=Math.ceil(p/k)*k):(w=g,_=p),m&&y&&s&&function(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}((i-a)/s,k/1e3)?(S=Math.round(Math.min((i-a)/k,c)),k=(i-a)/S,w=a,_=i):b?(w=m?a:w,_=y?i:_,S=l-1,k=(_-w)/S):(S=(_-w)/k,S=Fs(S,Math.round(S),k/1e3)?Math.round(S):Math.ceil(S));const j=Math.max(Hs(k),Hs(w));v=Math.pow(10,is(o)?j:o),w=Math.round(w*v)/v,_=Math.round(_*v)/v;let N=0;for(m&&(u&&w!==a?(n.push({value:a}),w<a&&N++,Fs(Math.round((w+N*k)*v)/v,a,Gc(a,x,e))&&N++):w<a&&N++);N<S;++N){const e=Math.round((w+N*k)*v)/v;if(y&&e>i)break;n.push({value:e})}return y&&u&&_!==i?n.length&&Fs(n[n.length-1].value,i,Gc(i,x,e))?n[n.length-1].value=i:n.push({value:i}):y&&_!==i||n.push({value:_}),n}function Gc(e,t,n){let{horizontal:r,minRotation:s}=n;const a=Ws(s),i=(r?Math.sin(a):Math.cos(a))||.001,o=.75*t*(""+e).length;return Math.min(t/i,o)}(0,kr.A)(Kc,"id","category"),(0,kr.A)(Kc,"defaults",{ticks:{callback:Jc}});class $c extends jl{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return is(e)||("number"===typeof e||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:r,max:s}=this;const a=e=>r=t?r:e,i=e=>s=n?s:e;if(e){const e=Rs(r),t=Rs(s);e<0&&t<0?i(0):e>0&&t>0&&a(0)}if(r===s){let t=0===s?1:Math.abs(.05*s);i(s+t),e||a(r-t)}this.min=r,this.max=s}getTickLimit(){const e=this.options.ticks;let t,{maxTicksLimit:n,stepSize:r}=e;return r?(t=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,t>1e3&&(console.warn("scales.".concat(this.id,".ticks.stepSize: ").concat(r," would result generating up to ").concat(t," ticks. Limiting to 1000.")),t=1e3)):(t=this.computeTickLimit(),n=n||11),n&&(t=Math.min(n,t)),t}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const r=Yc({maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:!1!==t.includeBounds},this._range||this);return"ticks"===e.bounds&&Us(r,this,"value"),e.reverse?(r.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),r}configure(){const e=this.ticks;let t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const r=(n-t)/Math.max(e.length-1,1)/2;t-=r,n+=r}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return va(e,this.chart.options.locale,this.options.ticks.format)}}class Qc extends $c{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=cs(e)?e:0,this.max=cs(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,n=Ws(this.options.ticks.minRotation),r=(e?Math.sin(n):Math.cos(n))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/r))}getPixelForValue(e){return null===e?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}(0,kr.A)(Qc,"id","linear"),(0,kr.A)(Qc,"defaults",{ticks:{callback:_a.formatters.numeric}});const Xc=e=>Math.floor(Ms(e)),Zc=(e,t)=>Math.pow(10,Xc(e)+t);function ed(e){return 1===e/Math.pow(10,Xc(e))}function td(e,t,n){const r=Math.pow(10,n),s=Math.floor(e/r);return Math.ceil(t/r)-s}function nd(e,t){let{min:n,max:r}=t;n=ds(e.min,n);const s=[],a=Xc(n);let i=function(e,t){let n=Xc(t-e);for(;td(e,t,n)>10;)n++;for(;td(e,t,n)<10;)n--;return Math.min(n,Xc(e))}(n,r),o=i<0?Math.pow(10,Math.abs(i)):1;const l=Math.pow(10,i),c=a>i?Math.pow(10,a):0,d=Math.round((n-c)*o)/o,u=Math.floor((n-c)/l/10)*l*10;let h=Math.floor((d-u)/Math.pow(10,i)),f=ds(e.min,Math.round((c+u+h*Math.pow(10,i))*o)/o);for(;f<r;)s.push({value:f,major:ed(f),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(i++,h=2,o=i>=0?1:o),f=Math.round((c+u+h*Math.pow(10,i))*o)/o;const g=ds(e.max,f);return s.push({value:g,major:ed(g),significand:h}),s}class rd extends jl{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,t){const n=$c.prototype.parse.apply(this,[e,t]);if(0!==n)return cs(n)&&n>0?n:null;this._zero=!0}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=cs(e)?Math.max(0,e):null,this.max=cs(t)?Math.max(0,t):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!cs(this._userMin)&&(this.min=e===Zc(this.min,0)?Zc(this.min,-1):Zc(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let n=this.min,r=this.max;const s=t=>n=e?n:t,a=e=>r=t?r:e;n===r&&(n<=0?(s(1),a(10)):(s(Zc(n,-1)),a(Zc(r,1)))),n<=0&&s(Zc(r,-1)),r<=0&&a(Zc(n,1)),this.min=n,this.max=r}buildTicks(){const e=this.options,t=nd({min:this._userMin,max:this._userMax},this);return"ticks"===e.bounds&&Us(t,this,"value"),e.reverse?(t.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),t}getLabelForValue(e){return void 0===e?"0":va(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=Ms(e),this._valueRange=Ms(this.max)-Ms(e)}getPixelForValue(e){return void 0!==e&&0!==e||(e=this.min),null===e||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(Ms(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const t=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+t*this._valueRange)}}function sd(e){const t=e.ticks;if(t.display&&e.display){const e=$a(t.backdropPadding);return us(t.font&&t.font.size,Ca.font.size)+e.height}return 0}function ad(e,t,n,r,s){return e===r||e===s?{start:t-n/2,end:t+n/2}:e<r||e>s?{start:t-n,end:t}:{start:t,end:t+n}}function id(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),r=[],s=[],a=e._pointLabels.length,i=e.options.pointLabels,o=i.centerPointLabels?Cs/a:0;for(let u=0;u<a;u++){const a=i.setContext(e.getPointLabelContext(u));s[u]=a.padding;const h=e.getPointPosition(u,e.drawingArea+s[u],o),f=Qa(a.font),g=(l=e.ctx,c=f,d=os(d=e._pointLabels[u])?d:[d],{w:Aa(l,c.string,d),h:d.length*c.lineHeight});r[u]=g;const p=Ys(e.getIndexAngle(u)+o),m=Math.round(qs(p));od(n,t,p,ad(m,h.x,g.w,0,180),ad(m,h.y,g.h,90,270))}var l,c,d;e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=function(e,t,n){const r=[],s=e._pointLabels.length,a=e.options,{centerPointLabels:i,display:o}=a.pointLabels,l={extra:sd(a)/2,additionalAngle:i?Cs/s:0};let c;for(let d=0;d<s;d++){l.padding=n[d],l.size=t[d];const s=ld(e,d,l);r.push(s),"auto"===o&&(s.visible=cd(s,c),s.visible&&(c=s))}return r}(e,r,s)}function od(e,t,n,r,s){const a=Math.abs(Math.sin(n)),i=Math.abs(Math.cos(n));let o=0,l=0;r.start<t.l?(o=(t.l-r.start)/a,e.l=Math.min(e.l,t.l-o)):r.end>t.r&&(o=(r.end-t.r)/a,e.r=Math.max(e.r,t.r+o)),s.start<t.t?(l=(t.t-s.start)/i,e.t=Math.min(e.t,t.t-l)):s.end>t.b&&(l=(s.end-t.b)/i,e.b=Math.max(e.b,t.b+l))}function ld(e,t,n){const r=e.drawingArea,{extra:s,additionalAngle:a,padding:i,size:o}=n,l=e.getPointPosition(t,r+s+i,a),c=Math.round(qs(Ys(l.angle+Os))),d=function(e,t,n){90===n||270===n?e-=t/2:(n>270||n<90)&&(e-=t);return e}(l.y,o.h,c),u=function(e){if(0===e||180===e)return"center";if(e<180)return"left";return"right"}(c),h=function(e,t,n){"right"===n?e-=t:"center"===n&&(e-=t/2);return e}(l.x,o.w,u);return{visible:!0,x:l.x,y:d,textAlign:u,left:h,top:d,right:h+o.w,bottom:d+o.h}}function cd(e,t){if(!t)return!0;const{left:n,top:r,right:s,bottom:a}=e;return!(La({x:n,y:r},t)||La({x:n,y:a},t)||La({x:s,y:r},t)||La({x:s,y:a},t))}function dd(e,t,n){const{left:r,top:s,right:a,bottom:i}=n,{backdropColor:o}=t;if(!is(o)){const n=Ga(t.borderRadius),l=$a(t.backdropPadding);e.fillStyle=o;const c=r-l.left,d=s-l.top,u=a-r+l.width,h=i-s+l.height;Object.values(n).some((e=>0!==e))?(e.beginPath(),qa(e,{x:c,y:d,w:u,h:h,radius:n}),e.fill()):e.fillRect(c,d,u,h)}}function ud(e,t,n,r){const{ctx:s}=e;if(n)s.arc(e.xCenter,e.yCenter,t,0,Ts);else{let n=e.getPointPosition(0,t);s.moveTo(n.x,n.y);for(let a=1;a<r;a++)n=e.getPointPosition(a,t),s.lineTo(n.x,n.y)}}(0,kr.A)(rd,"id","logarithmic"),(0,kr.A)(rd,"defaults",{ticks:{callback:_a.formatters.logarithmic,major:{enabled:!0}}});class hd extends $c{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=$a(sd(this.options)/2),t=this.width=this.maxWidth-e.width,n=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+t/2+e.left),this.yCenter=Math.floor(this.top+n/2+e.top),this.drawingArea=Math.floor(Math.min(t,n)/2)}determineDataLimits(){const{min:e,max:t}=this.getMinMax(!1);this.min=cs(e)&&!isNaN(e)?e:0,this.max=cs(t)&&!isNaN(t)?t:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/sd(this.options))}generateTickLabels(e){$c.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map(((e,t)=>{const n=fs(this.options.pointLabels.callback,[e,t],this);return n||0===n?n:""})).filter(((e,t)=>this.chart.getDataVisibility(t)))}fit(){const e=this.options;e.display&&e.pointLabels.display?id(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,t,n,r){this.xCenter+=Math.floor((e-t)/2),this.yCenter+=Math.floor((n-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,t,n,r))}getIndexAngle(e){return Ys(e*(Ts/(this._pointLabels.length||1))+Ws(this.options.startAngle||0))}getDistanceFromCenterForValue(e){if(is(e))return NaN;const t=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*t:(e-this.min)*t}getValueForDistanceFromCenter(e){if(is(e))return NaN;const t=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-t:this.min+t}getPointLabelContext(e){const t=this._pointLabels||[];if(e>=0&&e<t.length){const n=t[e];return function(e,t,n){return Za(e,{label:n,index:t,type:"pointLabel"})}(this.getContext(),e,n)}}getPointPosition(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const r=this.getIndexAngle(e)-Os+n;return{x:Math.cos(r)*t+this.xCenter,y:Math.sin(r)*t+this.yCenter,angle:r}}getPointPositionForValue(e,t){return this.getPointPosition(e,this.getDistanceFromCenterForValue(t))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:t,top:n,right:r,bottom:s}=this._pointLabelItems[e];return{left:t,top:n,right:r,bottom:s}}drawBackground(){const{backgroundColor:e,grid:{circular:t}}=this.options;if(e){const n=this.ctx;n.save(),n.beginPath(),ud(this,this.getDistanceFromCenterForValue(this._endValue),t,this._pointLabels.length),n.closePath(),n.fillStyle=e,n.fill(),n.restore()}}drawGrid(){const e=this.ctx,t=this.options,{angleLines:n,grid:r,border:s}=t,a=this._pointLabels.length;let i,o,l;if(t.pointLabels.display&&function(e,t){const{ctx:n,options:{pointLabels:r}}=e;for(let s=t-1;s>=0;s--){const t=e._pointLabelItems[s];if(!t.visible)continue;const a=r.setContext(e.getPointLabelContext(s));dd(n,a,t);const i=Qa(a.font),{x:o,y:l,textAlign:c}=t;Wa(n,e._pointLabels[s],o,l+i.lineHeight/2,i,{color:a.color,textAlign:c,textBaseline:"middle"})}}(this,a),r.display&&this.ticks.forEach(((e,t)=>{if(0!==t||0===t&&this.min<0){o=this.getDistanceFromCenterForValue(e.value);const n=this.getContext(t),i=r.setContext(n),l=s.setContext(n);!function(e,t,n,r,s){const a=e.ctx,i=t.circular,{color:o,lineWidth:l}=t;!i&&!r||!o||!l||n<0||(a.save(),a.strokeStyle=o,a.lineWidth=l,a.setLineDash(s.dash||[]),a.lineDashOffset=s.dashOffset,a.beginPath(),ud(e,n,i,r),a.closePath(),a.stroke(),a.restore())}(this,i,o,a,l)}})),n.display){for(e.save(),i=a-1;i>=0;i--){const r=n.setContext(this.getPointLabelContext(i)),{color:s,lineWidth:a}=r;a&&s&&(e.lineWidth=a,e.strokeStyle=s,e.setLineDash(r.borderDash),e.lineDashOffset=r.borderDashOffset,o=this.getDistanceFromCenterForValue(t.reverse?this.min:this.max),l=this.getPointPosition(i,o),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(l.x,l.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,t=this.options,n=t.ticks;if(!n.display)return;const r=this.getIndexAngle(0);let s,a;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach(((r,i)=>{if(0===i&&this.min>=0&&!t.reverse)return;const o=n.setContext(this.getContext(i)),l=Qa(o.font);if(s=this.getDistanceFromCenterForValue(this.ticks[i].value),o.showLabelBackdrop){e.font=l.string,a=e.measureText(r.label).width,e.fillStyle=o.backdropColor;const t=$a(o.backdropPadding);e.fillRect(-a/2-t.left,-s-l.size/2-t.top,a+t.width,l.size+t.height)}Wa(e,r.label,0,-s,l,{color:o.color,strokeColor:o.textStrokeColor,strokeWidth:o.textStrokeWidth})})),e.restore()}drawTitle(){}}(0,kr.A)(hd,"id","radialLinear"),(0,kr.A)(hd,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:_a.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback:e=>e,padding:5,centerPointLabels:!1}}),(0,kr.A)(hd,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),(0,kr.A)(hd,"descriptors",{angleLines:{_fallback:"grid"}});const fd={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},gd=Object.keys(fd);function pd(e,t){return e-t}function md(e,t){if(is(t))return null;const n=e._adapter,{parser:r,round:s,isoWeekday:a}=e._parseOpts;let i=t;return"function"===typeof r&&(i=r(i)),cs(i)||(i="string"===typeof r?n.parse(i,r):n.parse(i)),null===i?null:(s&&(i="week"!==s||!zs(a)&&!0!==a?n.startOf(i,s):n.startOf(i,"isoWeek",a)),+i)}function yd(e,t,n,r){const s=gd.length;for(let a=gd.indexOf(e);a<s-1;++a){const e=fd[gd[a]],s=e.steps?e.steps:Number.MAX_SAFE_INTEGER;if(e.common&&Math.ceil((n-t)/(s*e.size))<=r)return gd[a]}return gd[s-1]}function bd(e,t,n){if(n){if(n.length){const{lo:r,hi:s}=Xs(n,t);e[n[r]>=t?n[r]:n[s]]=!0}}else e[t]=!0}function xd(e,t,n){const r=[],s={},a=t.length;let i,o;for(i=0;i<a;++i)o=t[i],s[o]=i,r.push({value:o,major:!1});return 0!==a&&n?function(e,t,n,r){const s=e._adapter,a=+s.startOf(t[0].value,r),i=t[t.length-1].value;let o,l;for(o=a;o<=i;o=+s.add(o,1,r))l=n[o],l>=0&&(t[l].major=!0);return t}(e,r,s,n):r}class vd extends jl{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=e.time||(e.time={}),r=this._adapter=new Do(e.adapters.date);r.init(t),vs(n.displayFormats,r.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return void 0===e?null:md(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:r,max:s,minDefined:a,maxDefined:i}=this.getUserBounds();function o(e){a||isNaN(e.min)||(r=Math.min(r,e.min)),i||isNaN(e.max)||(s=Math.max(s,e.max))}a&&i||(o(this._getLabelBounds()),"ticks"===e.bounds&&"labels"===e.ticks.source||o(this.getMinMax(!1))),r=cs(r)&&!isNaN(r)?r:+t.startOf(Date.now(),n),s=cs(s)&&!isNaN(s)?s:+t.endOf(Date.now(),n)+1,this.min=Math.min(r,s-1),this.max=Math.max(r+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,r="labels"===n.source?this.getLabelTimestamps():this._generate();"ticks"===e.bounds&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const s=this.min,a=function(e,t,n){let r=0,s=e.length;for(;r<s&&e[r]<t;)r++;for(;s>r&&e[s-1]>n;)s--;return r>0||s<e.length?e.slice(r,s):e}(r,s,this.max);return this._unit=t.unit||(n.autoSkip?yd(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):function(e,t,n,r,s){for(let a=gd.length-1;a>=gd.indexOf(n);a--){const n=gd[a];if(fd[n].common&&e._adapter.diff(s,r,n)>=t-1)return n}return gd[n?gd.indexOf(n):0]}(this,a.length,t.minUnit,this.min,this.max)),this._majorUnit=n.major.enabled&&"year"!==this._unit?function(e){for(let t=gd.indexOf(e)+1,n=gd.length;t<n;++t)if(fd[gd[t]].common)return gd[t]}(this._unit):void 0,this.initOffsets(r),e.reverse&&a.reverse(),xd(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map((e=>+e.value)))}initOffsets(){let e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=0,s=0;this.options.offset&&n.length&&(e=this.getDecimalForValue(n[0]),r=1===n.length?1-e:(this.getDecimalForValue(n[1])-e)/2,t=this.getDecimalForValue(n[n.length-1]),s=1===n.length?t:(t-this.getDecimalForValue(n[n.length-2]))/2);const a=n.length<3?.5:.25;r=$s(r,0,a),s=$s(s,0,a),this._offsets={start:r,end:s,factor:1/(r+1+s)}}_generate(){const e=this._adapter,t=this.min,n=this.max,r=this.options,s=r.time,a=s.unit||yd(s.minUnit,t,n,this._getLabelCapacity(t)),i=us(r.ticks.stepSize,1),o="week"===a&&s.isoWeekday,l=zs(o)||!0===o,c={};let d,u,h=t;if(l&&(h=+e.startOf(h,"isoWeek",o)),h=+e.startOf(h,l?"day":a),e.diff(n,t,a)>1e5*i)throw new Error(t+" and "+n+" are too far apart with stepSize of "+i+" "+a);const f="data"===r.ticks.source&&this.getDataTimestamps();for(d=h,u=0;d<n;d=+e.add(d,i,a),u++)bd(c,d,f);return d!==n&&"ticks"!==r.bounds&&1!==u||bd(c,d,f),Object.keys(c).sort(pd).map((e=>+e))}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const n=this.options.time.displayFormats,r=this._unit,s=t||n[r];return this._adapter.format(e,s)}_tickFormatFunction(e,t,n,r){const s=this.options,a=s.ticks.callback;if(a)return fs(a,[e,t,n],this);const i=s.time.displayFormats,o=this._unit,l=this._majorUnit,c=o&&i[o],d=l&&i[l],u=n[t],h=l&&d&&u&&u.major;return this._adapter.format(e,r||(h?d:c))}generateTickLabels(e){let t,n,r;for(t=0,n=e.length;t<n;++t)r=e[t],r.label=this._tickFormatFunction(r.value,t,e)}getDecimalForValue(e){return null===e?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,r=Ws(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(r),a=Math.sin(r),i=this._resolveTickFontOptions(0).size;return{w:n*s+i*a,h:n*a+i*s}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,r=n[t.unit]||n.millisecond,s=this._tickFormatFunction(e,0,xd(this,[e],this._majorUnit),r),a=this._getLabelSize(s),i=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return i>0?i:1}getDataTimestamps(){let e,t,n=this._cache.data||[];if(n.length)return n;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(e=0,t=r.length;e<t;++e)n=n.concat(r[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(n)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const r=this.getLabels();for(t=0,n=r.length;t<n;++t)e.push(md(this,r[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return ra(e.sort(pd))}}function wd(e,t,n){let r,s,a,i,o=0,l=e.length-1;n?(t>=e[o].pos&&t<=e[l].pos&&({lo:o,hi:l}=Zs(e,"pos",t)),({pos:r,time:a}=e[o]),({pos:s,time:i}=e[l])):(t>=e[o].time&&t<=e[l].time&&({lo:o,hi:l}=Zs(e,"time",t)),({time:r,pos:a}=e[o]),({time:s,pos:i}=e[l]));const c=s-r;return c?a+(i-a)*(t-r)/c:a}(0,kr.A)(vd,"id","time"),(0,kr.A)(vd,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});class _d extends vd{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=wd(t,this.min),this._tableRange=wd(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:n}=this,r=[],s=[];let a,i,o,l,c;for(a=0,i=e.length;a<i;++a)l=e[a],l>=t&&l<=n&&r.push(l);if(r.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(a=0,i=r.length;a<i;++a)c=r[a+1],o=r[a-1],l=r[a],Math.round((c+o)/2)!==l&&s.push({time:l,pos:a/(i-1)});return s}_generate(){const e=this.min,t=this.max;let n=super.getDataTimestamps();return n.includes(e)&&n.length||n.splice(0,0,e),n.includes(t)&&1!==n.length||n.push(t),n.sort(((e,t)=>e-t))}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),n=this.getLabelTimestamps();return e=t.length&&n.length?this.normalize(t.concat(n)):t.length?t:n,e=this._cache.all=e,e}getDecimalForValue(e){return(wd(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return wd(this._table,n*this._tableRange+this._minPos,!0)}}(0,kr.A)(_d,"id","timeseries"),(0,kr.A)(_d,"defaults",vd.defaults);const Sd=["height","width","redraw","datasetIdKey","type","data","options","plugins","fallbackContent","updateMode"],kd="label";function jd(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function Nd(e,t){e.labels=t}function Ed(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:kd;const r=[];e.datasets=t.map((t=>{const s=e.datasets.find((e=>e[n]===t[n]));return s&&t.data&&!r.includes(s)?(r.push(s),Object.assign(s,t),s):(0,Oe.A)({},t)}))}function Cd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kd;const n={labels:[],datasets:[]};return Nd(n,e.labels),Ed(n,e.datasets,t),n}function Td(e,t){const{height:n=150,width:r=300,redraw:a=!1,datasetIdKey:i,type:o,data:l,options:c,plugins:d=[],fallbackContent:u,updateMode:h}=e,f=lt(e,Sd),g=(0,s.useRef)(null),p=(0,s.useRef)(null),m=()=>{g.current&&(p.current=new tc(g.current,{type:o,data:Cd(l,i),options:c&&(0,Oe.A)({},c),plugins:d}),jd(t,p.current))},y=()=>{jd(t,null),p.current&&(p.current.destroy(),p.current=null)};return(0,s.useEffect)((()=>{!a&&p.current&&c&&function(e,t){const n=e.options;n&&t&&Object.assign(n,t)}(p.current,c)}),[a,c]),(0,s.useEffect)((()=>{!a&&p.current&&Nd(p.current.config.data,l.labels)}),[a,l.labels]),(0,s.useEffect)((()=>{!a&&p.current&&l.datasets&&Ed(p.current.config.data,l.datasets,i)}),[a,l.datasets]),(0,s.useEffect)((()=>{p.current&&(a?(y(),setTimeout(m)):p.current.update(h))}),[a,c,l.labels,l.datasets,h]),(0,s.useEffect)((()=>{p.current&&(y(),setTimeout(m))}),[o]),(0,s.useEffect)((()=>(m(),()=>y())),[]),s.createElement("canvas",(0,Oe.A)({ref:g,role:"img",height:n,width:r},f),u)}const Ad=(0,s.forwardRef)(Td);function Dd(e,t){return tc.register(t),(0,s.forwardRef)(((t,n)=>s.createElement(Ad,(0,Oe.A)((0,Oe.A)({},t),{},{ref:n,type:e}))))}const Pd=Dd("pie",No);tc.register(oc,Hc,Tc);const Od=function(e){let{expenses:t,categories:n=[]}=e;const r=t.filter((e=>!e.is_income)),s=t.filter((e=>e.is_income)),a=r.reduce(((e,t)=>{const{category:n,amount:r}=t;return e[n]=(e[n]||0)+r,e}),{}),i=s.reduce(((e,t)=>{const{category:n,amount:r}=t;return e[n]=(e[n]||0)+r,e}),{}),o=e=>{const t=[],r=[],s=[];return Object.keys(e).forEach((a=>{const i=(e=>{const t=n.find((t=>t.id===e));return t?{name:t.name,color:ut(t.color)||"gray"}:{name:e.charAt(0).toUpperCase()+e.slice(1),color:"gray"}})(a);t.push(i.name),r.push(e[a]),s.push(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8;const n={blue:"54, 162, 235",green:"75, 192, 192",yellow:"255, 206, 86",indigo:"153, 102, 255",purple:"153, 102, 255",pink:"255, 99, 132",lime:"201, 203, 207",rose:"255, 99, 132",teal:"75, 192, 192",cyan:"54, 162, 235",orange:"255, 159, 64",gray:"201, 203, 207",red:"255, 99, 132"};return"rgba(".concat(n[e]||n.gray,", ").concat(t,")")}(i.color))})),{labels:t,datasets:[{data:r,backgroundColor:s,borderColor:s.map((e=>e.replace("0.8","1"))),borderWidth:2,hoverBackgroundColor:s.map((e=>e.replace("0.8","0.9"))),hoverBorderWidth:3}]}},l=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{color:"#D1D5DB",padding:20,font:{size:12},usePointStyle:!0,pointStyle:"circle"}},title:{display:!1},tooltip:{backgroundColor:"rgba(31, 41, 55, 0.9)",titleColor:"#F3F4F6",bodyColor:"#D1D5DB",borderColor:"#6B7280",borderWidth:1,cornerRadius:8,displayColors:!0,callbacks:{label:function(t){const n=t.dataset.data.reduce(((e,t)=>e+t),0),r=n>0?(t.raw/n*100).toFixed(1):0,s=e?"+":"-";return"".concat(t.label,": ").concat(s," Rp ").concat(new Intl.NumberFormat("id-ID").format(t.raw)," (").concat(r,"%)")}}}},layout:{padding:{top:10,bottom:10}}}};return 0===t.length?null:(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Object.keys(a).length>0&&(0,Ge.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg",children:[(0,Ge.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Ge.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full mr-3"}),(0,Ge.jsx)("h2",{className:"text-xl font-semibold text-red-300",children:"Expenses by Category"})]}),(0,Ge.jsx)("div",{style:{height:"350px"},children:(0,Ge.jsx)(Pd,{data:o(a),options:l(!1)})})]}),Object.keys(i).length>0&&(0,Ge.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg",children:[(0,Ge.jsxs)("div",{className:"flex items-center mb-4",children:[(0,Ge.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-3"}),(0,Ge.jsx)("h2",{className:"text-xl font-semibold text-green-300",children:"Income by Category"})]}),(0,Ge.jsx)("div",{style:{height:"350px"},children:(0,Ge.jsx)(Pd,{data:o(i),options:l(!0)})})]})]}),0===Object.keys(a).length&&0===Object.keys(i).length&&(0,Ge.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg text-center",children:[(0,Ge.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-300",children:"Transaction Breakdown"}),(0,Ge.jsx)("p",{className:"text-gray-400",children:"No transactions to display. Start adding some expenses or income!"})]})]})};const Id=class{static detectDuplicate(e,t){if(!e||!t)return{isDuplicate:!1,confidence:0,reasons:[]};const n=[];let r=0;if(e.id===t.id)return{isDuplicate:!0,confidence:100,reasons:["Identical transaction ID"]};Math.abs(parseFloat(e.amount)-parseFloat(t.amount))<.01&&(r+=35,n.push("Same amount"));const s=(e.description||e.name||"").toLowerCase().trim(),a=(t.description||t.name||"").toLowerCase().trim();s&&a&&(s===a?(r+=30,n.push("Identical description")):this.calculateSimilarity(s,a)>.8?(r+=20,n.push("Very similar description")):this.calculateSimilarity(s,a)>.6&&(r+=10,n.push("Similar description")));const i=new Date(e.date),o=new Date(t.date),l=Math.abs(i.getTime()-o.getTime())/36e5;this.isSameDay(i,o)?(r+=25,n.push("Same date")):l<=24?(r+=15,n.push("Within 24 hours")):l<=48&&(r+=5,n.push("Within 48 hours")),e.category===t.category&&e.category&&(r+=10,n.push("Same category"));const c=e.wallet_id||e.walletId;c===(t.wallet_id||t.walletId)&&c&&(r+=10,n.push("Same wallet"));(e.is_income||e.isIncome)===(t.is_income||t.isIncome)&&(r+=5,n.push("Same transaction type"));const d=(e.notes||"").toLowerCase().trim(),u=(t.notes||"").toLowerCase().trim();d&&u&&d===u&&(r+=5,n.push("Identical notes"));const h=new Date(e.created_at||e.date),f=new Date(t.created_at||t.date),g=Math.abs(h.getTime()-f.getTime())/6e4;g<=5?(r+=15,n.push("Created within 5 minutes")):g<=30&&(r+=10,n.push("Created within 30 minutes"));const p=Math.min(r,100);return{isDuplicate:p>=65,confidence:p,reasons:n,score:r}}static findDuplicates(e){const t=[],n=new Set;for(let r=0;r<e.length;r++){if(n.has(r))continue;const s=e[r],a=[s];for(let t=r+1;t<e.length;t++){if(n.has(t))continue;const r=e[t];this.detectDuplicate(s,r).isDuplicate&&(a.push(r),n.add(t))}a.length>1&&t.push({transactions:a,count:a.length}),n.add(r)}return t}static removeDuplicates(e){const t=this.findDuplicates(e),n=new Set;return t.forEach((e=>{const t=e.transactions.sort(((e,t)=>{const n=new Date(e.last_modified||e.updated_at||e.created_at||e.date);return new Date(t.last_modified||t.updated_at||t.created_at||t.date).getTime()-n.getTime()}));for(let r=1;r<t.length;r++)n.add(t[r].id)})),e.filter((e=>!n.has(e.id)))}static calculateSimilarity(e,t){if(!e||!t)return 0;const n=e.length>t.length?e:t,r=e.length>t.length?t:e;if(0===n.length)return 1;const s=this.levenshteinDistance(n,r);return(n.length-s)/n.length}static levenshteinDistance(e,t){const n=[];for(let r=0;r<=t.length;r++)n[r]=[r];for(let r=0;r<=e.length;r++)n[0][r]=r;for(let r=1;r<=t.length;r++)for(let s=1;s<=e.length;s++)t.charAt(r-1)===e.charAt(s-1)?n[r][s]=n[r-1][s-1]:n[r][s]=Math.min(n[r-1][s-1]+1,n[r][s-1]+1,n[r-1][s]+1);return n[t.length][e.length]}static isSameDay(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}static generateFingerprint(e){const t=parseFloat(e.amount||0).toFixed(2),n=(e.description||e.name||"").toLowerCase().trim(),r=new Date(e.date).toISOString().split("T")[0],s=e.wallet_id||e.walletId||"",a=e.is_income||e.isIncome?"income":"expense";return"".concat(t,"-").concat(n,"-").concat(r,"-").concat(s,"-").concat(a)}static checkBeforeAdd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const r=[],s=[],a=[];t.forEach((t=>{const n=this.detectDuplicate(e,t);n.isDuplicate?r.push((0,Oe.A)({transaction:t},n)):n.confidence>40&&s.push((0,Oe.A)({transaction:t},n))}));const i=new Date(Date.now()-6048e5);return n.forEach((t=>{if(t.deleted_at&&new Date(t.deleted_at)>i){const n=this.detectDuplicate(e,t);n.isDuplicate&&a.push((0,Oe.A)({transaction:t,deletedAt:t.deleted_at},n))}})),{hasDuplicates:r.length>0,duplicates:r,suggestions:s,deletedDuplicates:a,hasDeletedDuplicates:a.length>0}}static checkAgainstRecentlyDeleted(e,t){const n=[],r=new Date(Date.now()-864e5);return t.forEach((t=>{if(t.deleted_at&&new Date(t.deleted_at)>r){const r=this.detectDuplicate(e,t);r.isDuplicate&&n.push((0,Oe.A)({deletedTransaction:t,deletedAt:t.deleted_at},r))}})),{isRestoringDeleted:n.length>0,matches:n}}};class Ld{static async runDiagnostics(){console.group("\ud83d\udd0d Supabase Diagnostics");const e={timestamp:(new Date).toISOString(),browser:this.getBrowserInfo(),network:await this.checkNetworkConnectivity(),supabase:await this.checkSupabaseConnectivity(),auth:await this.checkAuthStatus(),cors:await this.checkCorsHeaders(),recommendations:[]};return e.recommendations=this.generateRecommendations(e),console.log("\ud83d\udcca Diagnostic Results:",e),console.groupEnd(),e}static getBrowserInfo(){return{userAgent:navigator.userAgent,language:navigator.language,onLine:navigator.onLine,cookieEnabled:navigator.cookieEnabled,platform:navigator.platform,vendor:navigator.vendor}}static async checkNetworkConnectivity(){const e={online:navigator.onLine,googleReachable:!1,supabaseStatusReachable:!1};try{await fetch("https://www.google.com/favicon.ico",{method:"HEAD",mode:"no-cors",cache:"no-cache"});e.googleReachable=!0}catch(t){console.warn("Google connectivity test failed:",t.message)}try{await fetch("https://status.supabase.com",{method:"HEAD",mode:"no-cors",cache:"no-cache"});e.supabaseStatusReachable=!0}catch(t){console.warn("Supabase status page test failed:",t.message)}return e}static async checkSupabaseConnectivity(){const e={urlValid:!1,apiKeyValid:!1,restApiReachable:!1,authApiReachable:!1,error:null};try{const r=Pe.A.supabaseUrl;e.urlValid=r&&r.startsWith("https://")&&r.includes(".supabase.co");const s=Pe.A.supabaseKey;e.apiKeyValid=s&&s.startsWith("eyJ")&&s.length>100;try{const{data:t,error:n}=await Pe.A.from("expenses").select("count",{count:"exact"}).limit(0);n?(e.error=n,"42P01"===n.code&&(e.restApiReachable=!0)):e.restApiReachable=!0}catch(t){e.error=t,console.warn("REST API test failed:",t)}try{const{data:t,error:n}=await Pe.A.auth.getSession();e.authApiReachable=!0}catch(n){console.warn("Auth API test failed:",n)}}catch(r){e.error=r,console.error("Supabase connectivity test failed:",r)}return e}static async checkAuthStatus(){const e={hasSession:!1,userAuthenticated:!1,sessionValid:!1,error:null};try{const{data:{session:t},error:n}=await Pe.A.auth.getSession();n?e.error=n:(e.hasSession=!!t,e.userAuthenticated=!(null===t||void 0===t||!t.user),e.sessionValid=!(null===t||void 0===t||!t.expires_at)&&new Date(1e3*t.expires_at)>new Date)}catch(t){e.error=t,console.error("Auth status check failed:",t)}return e}static async checkCorsHeaders(){const e={corsHeadersPresent:!1,allowedOrigins:null,allowedMethods:null,allowedHeaders:null,error:null};try{const t=await fetch(Pe.A.supabaseUrl+"/rest/v1/",{method:"OPTIONS",headers:{Origin:window.location.origin,"Access-Control-Request-Method":"GET","Access-Control-Request-Headers":"apikey, authorization, content-type"}});e.corsHeadersPresent=t.headers.has("access-control-allow-origin"),e.allowedOrigins=t.headers.get("access-control-allow-origin"),e.allowedMethods=t.headers.get("access-control-allow-methods"),e.allowedHeaders=t.headers.get("access-control-allow-headers")}catch(t){e.error=t,console.warn("CORS headers check failed:",t)}return e}static generateRecommendations(e){var t;const n=[];return e.network.online||n.push({priority:"high",category:"network",issue:"Device appears to be offline",solution:"Check your internet connection and try again"}),e.network.googleReachable||n.push({priority:"high",category:"network",issue:"Basic internet connectivity failed",solution:"Check firewall, proxy settings, or network restrictions"}),e.supabase.urlValid||n.push({priority:"critical",category:"config",issue:"Invalid Supabase URL format",solution:"Check your Supabase URL in src/utils/supabase.js - it should be https://your-project.supabase.co"}),e.supabase.apiKeyValid||n.push({priority:"critical",category:"config",issue:"Invalid API key format",solution:'Check your Supabase anon key in src/utils/supabase.js - it should start with "eyJ"'}),e.supabase.restApiReachable||n.push({priority:"high",category:"connectivity",issue:"Cannot reach Supabase REST API",solution:"Check if your Supabase project is active and the URL/key are correct"}),e.cors.corsHeadersPresent||n.push({priority:"medium",category:"cors",issue:"CORS headers not detected",solution:"This might be normal for Supabase, but if you're getting CORS errors, try using a different browser or check for browser extensions blocking requests"}),e.auth.error&&n.push({priority:"medium",category:"auth",issue:"Authentication error detected",solution:"Try signing out and signing back in, or check if your session has expired"}),"42P01"===(null===(t=e.supabase.error)||void 0===t?void 0:t.code)&&n.push({priority:"high",category:"database",issue:"Database tables not found",solution:"Run the SQL setup script from MIGRATION-GUIDE.md in your Supabase SQL Editor"}),n}static async testOperation(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"select";console.group("\ud83e\uddea Testing ".concat(e," operation"));try{let t;switch(e){case"select":t=await Pe.A.from("expenses").select("count",{count:"exact"}).limit(0);break;case"insert":t=await Pe.A.from("expenses").insert({amount:0,description:"test",date:(new Date).toISOString().split("T")[0],user_id:"test"});break;case"auth":t=await Pe.A.auth.getSession();break;default:throw new Error("Unknown operation: ".concat(e))}return console.log("\u2705 ".concat(e," operation successful:"),t),{success:!0,result:t}}catch(t){console.error("\u274c ".concat(e," operation failed:"),t);const n=this.analyzeError(t);return console.log("\ud83d\udd0d Error analysis:",n),{success:!1,error:t,analysis:n}}finally{console.groupEnd()}}static analyzeError(e){var t,n,r,s;const a={type:"unknown",likely_cause:"Unknown error",suggestions:[]};return null!==(t=e.message)&&void 0!==t&&t.includes("NetworkError")||null!==(n=e.message)&&void 0!==n&&n.includes("fetch")?(a.type="network",a.likely_cause="Network connectivity or CORS issue",a.suggestions=["Check internet connection","Try in incognito mode","Check browser console for CORS errors","Verify Supabase project is active"]):"42P01"===e.code?(a.type="database",a.likely_cause="Database tables not created",a.suggestions=["Run the SQL setup script in Supabase SQL Editor","Check MIGRATION-GUIDE.md for setup instructions"]):"PGRST116"===e.code?(a.type="data",a.likely_cause="No data found (this might be normal)",a.suggestions=["This error is often normal when no data exists","Try adding some data first"]):(null!==(r=e.message)&&void 0!==r&&r.includes("JWT")||null!==(s=e.message)&&void 0!==s&&s.includes("auth"))&&(a.type="authentication",a.likely_cause="Authentication or authorization issue",a.suggestions=["Check if user is logged in","Verify API key is correct","Check RLS policies in Supabase"]),a}}"undefined"!==typeof window&&(window.SupabaseDiagnostics=Ld,console.log("\ud83d\udd27 SupabaseDiagnostics available globally. Try: SupabaseDiagnostics.runDiagnostics()"));const Md=Ld;const Rd=function(e){let{onClose:t}=e;const[n,r]=(0,s.useState)(null),[a,i]=(0,s.useState)(!1),o=async e=>{console.log("Testing ".concat(e," operation..."));const t=await Md.testOperation(e);console.log("".concat(e," test result:"),t)};return(0,Ge.jsx)("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-lg max-w-4xl w-full max-h-[90vh] overflow-y-auto p-6 border border-gray-700",children:[(0,Ge.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Ge.jsxs)("div",{className:"flex items-center",children:[(0,Ge.jsx)("div",{className:"w-12 h-12 bg-red-600 rounded-full flex items-center justify-center mr-4",children:(0,Ge.jsx)("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("h2",{className:"text-2xl font-bold text-white",children:"CORS/Network Error Troubleshooting"}),(0,Ge.jsx)("p",{className:"text-gray-400",children:"Diagnose and fix connectivity issues"})]})]}),(0,Ge.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-white transition-colors",children:(0,Ge.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white mb-4",children:"Quick Actions"}),(0,Ge.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Ge.jsx)("button",{onClick:async()=>{i(!0);try{const e=await Md.runDiagnostics();r(e)}catch(e){console.error("Failed to run diagnostics:",e)}finally{i(!1)}},disabled:a,className:"bg-indigo-600 hover:bg-indigo-700 text-white py-3 px-4 rounded-md transition-colors disabled:opacity-50",children:a?"Running...":"\ud83d\udd0d Run Diagnostics"}),(0,Ge.jsx)("button",{onClick:()=>o("select"),className:"bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-md transition-colors",children:"\ud83e\uddea Test Database"}),(0,Ge.jsx)("button",{onClick:()=>o("auth"),className:"bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-md transition-colors",children:"\ud83d\udd10 Test Auth"})]})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white mb-4",children:"Common Solutions"}),(0,Ge.jsxs)("div",{className:"space-y-4",children:[(0,Ge.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,Ge.jsx)("h4",{className:"font-medium text-white mb-2",children:"1. Check Internet Connection"}),(0,Ge.jsx)("p",{className:"text-gray-300 text-sm mb-2",children:"Ensure you have a stable internet connection and can access other websites."}),(0,Ge.jsx)("button",{onClick:()=>window.open("https://www.google.com","_blank"),className:"text-indigo-400 hover:text-indigo-300 text-sm",children:"Test with Google \u2192"})]}),(0,Ge.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,Ge.jsx)("h4",{className:"font-medium text-white mb-2",children:"2. Try Incognito/Private Mode"}),(0,Ge.jsx)("p",{className:"text-gray-300 text-sm",children:"Browser extensions or cached data might be interfering. Try opening the app in incognito/private mode."})]}),(0,Ge.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,Ge.jsx)("h4",{className:"font-medium text-white mb-2",children:"3. Check Supabase Status"}),(0,Ge.jsx)("p",{className:"text-gray-300 text-sm mb-2",children:"Verify that Supabase services are operational."}),(0,Ge.jsx)("button",{onClick:()=>window.open("https://status.supabase.com","_blank"),className:"text-indigo-400 hover:text-indigo-300 text-sm",children:"Check Supabase Status \u2192"})]}),(0,Ge.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,Ge.jsx)("h4",{className:"font-medium text-white mb-2",children:"4. Verify Configuration"}),(0,Ge.jsx)("p",{className:"text-gray-300 text-sm",children:"Check that your Supabase URL and API key are correctly configured in the app."}),(0,Ge.jsxs)("div",{className:"mt-2 text-xs text-gray-400 font-mono bg-gray-800 p-2 rounded",children:["URL: ",window.location.origin,(0,Ge.jsx)("br",{}),"Supabase URL: https://mplrakcyrohgkqdhzpry.supabase.co"]})]}),(0,Ge.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,Ge.jsx)("h4",{className:"font-medium text-white mb-2",children:"5. Database Setup"}),(0,Ge.jsx)("p",{className:"text-gray-300 text-sm mb-2",children:"Ensure your Supabase database tables are properly created."}),(0,Ge.jsx)("button",{onClick:()=>window.open("https://app.supabase.io","_blank"),className:"text-indigo-400 hover:text-indigo-300 text-sm",children:"Open Supabase Dashboard \u2192"})]})]})]}),n&&(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white mb-4",children:"Diagnostic Results"}),(0,Ge.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[(0,Ge.jsxs)("div",{className:"p-3 rounded-lg ".concat(n.network.online?"bg-green-900":"bg-red-900"),children:[(0,Ge.jsx)("div",{className:"text-sm text-gray-300",children:"Network"}),(0,Ge.jsx)("div",{className:"font-medium text-white",children:n.network.online?"\u2705 Online":"\u274c Offline"})]}),(0,Ge.jsxs)("div",{className:"p-3 rounded-lg ".concat(n.supabase.restApiReachable?"bg-green-900":"bg-red-900"),children:[(0,Ge.jsx)("div",{className:"text-sm text-gray-300",children:"Supabase API"}),(0,Ge.jsx)("div",{className:"font-medium text-white",children:n.supabase.restApiReachable?"\u2705 Reachable":"\u274c Unreachable"})]}),(0,Ge.jsxs)("div",{className:"p-3 rounded-lg ".concat(n.auth.userAuthenticated?"bg-green-900":"bg-yellow-900"),children:[(0,Ge.jsx)("div",{className:"text-sm text-gray-300",children:"Authentication"}),(0,Ge.jsx)("div",{className:"font-medium text-white",children:n.auth.userAuthenticated?"\u2705 Authenticated":"\u26a0\ufe0f Not Authenticated"})]}),(0,Ge.jsxs)("div",{className:"p-3 rounded-lg ".concat(n.cors.corsHeadersPresent?"bg-green-900":"bg-yellow-900"),children:[(0,Ge.jsx)("div",{className:"text-sm text-gray-300",children:"CORS"}),(0,Ge.jsx)("div",{className:"font-medium text-white",children:n.cors.corsHeadersPresent?"\u2705 Headers Present":"\u26a0\ufe0f No Headers"})]})]}),n.recommendations.length>0&&(0,Ge.jsxs)("div",{className:"bg-yellow-900/50 border border-yellow-800 rounded-lg p-4",children:[(0,Ge.jsx)("h4",{className:"font-medium text-yellow-200 mb-3",children:"Recommendations"}),(0,Ge.jsx)("div",{className:"space-y-2",children:n.recommendations.map(((e,t)=>(0,Ge.jsxs)("div",{className:"flex items-start",children:[(0,Ge.jsx)("span",{className:"inline-block w-2 h-2 rounded-full mt-2 mr-3 ".concat("critical"===e.priority?"bg-red-500":"high"===e.priority?"bg-orange-500":"bg-yellow-500")}),(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("div",{className:"text-yellow-200 font-medium",children:e.issue}),(0,Ge.jsx)("div",{className:"text-yellow-300 text-sm",children:e.solution})]})]},t)))})]}),(0,Ge.jsxs)("details",{className:"mt-4",children:[(0,Ge.jsx)("summary",{className:"cursor-pointer text-gray-400 hover:text-white",children:"View Raw Diagnostic Data"}),(0,Ge.jsx)("pre",{className:"mt-2 text-xs text-gray-300 bg-gray-900 p-4 rounded-lg overflow-x-auto",children:JSON.stringify(n,null,2)})]})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white mb-4",children:"Manual Troubleshooting Steps"}),(0,Ge.jsxs)("div",{className:"space-y-3 text-sm text-gray-300",children:[(0,Ge.jsxs)("div",{className:"flex items-start",children:[(0,Ge.jsx)("span",{className:"inline-block w-6 h-6 bg-indigo-600 text-white rounded-full text-center text-xs leading-6 mr-3 mt-0.5",children:"1"}),(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("strong",{children:"Open Browser Console:"})," Press F12 and check the Console tab for detailed error messages."]})]}),(0,Ge.jsxs)("div",{className:"flex items-start",children:[(0,Ge.jsx)("span",{className:"inline-block w-6 h-6 bg-indigo-600 text-white rounded-full text-center text-xs leading-6 mr-3 mt-0.5",children:"2"}),(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("strong",{children:"Check Network Tab:"})," Look for failed requests and their status codes."]})]}),(0,Ge.jsxs)("div",{className:"flex items-start",children:[(0,Ge.jsx)("span",{className:"inline-block w-6 h-6 bg-indigo-600 text-white rounded-full text-center text-xs leading-6 mr-3 mt-0.5",children:"3"}),(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("strong",{children:"Try Different Browser:"})," Test in Chrome, Firefox, or Safari to isolate browser-specific issues."]})]}),(0,Ge.jsxs)("div",{className:"flex items-start",children:[(0,Ge.jsx)("span",{className:"inline-block w-6 h-6 bg-indigo-600 text-white rounded-full text-center text-xs leading-6 mr-3 mt-0.5",children:"4"}),(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("strong",{children:"Check Firewall/Antivirus:"})," Temporarily disable to see if they're blocking requests."]})]}),(0,Ge.jsxs)("div",{className:"flex items-start",children:[(0,Ge.jsx)("span",{className:"inline-block w-6 h-6 bg-indigo-600 text-white rounded-full text-center text-xs leading-6 mr-3 mt-0.5",children:"5"}),(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("strong",{children:"Contact Support:"})," If issues persist, contact your system administrator or Supabase support."]})]})]})]}),(0,Ge.jsx)("div",{className:"flex justify-end",children:(0,Ge.jsx)("button",{onClick:t,className:"bg-gray-600 hover:bg-gray-700 text-white py-2 px-6 rounded-md transition-colors",children:"Close"})})]})})};const Fd=function(e){let{expenses:t,onCleanupComplete:n,dbInitialized:r=!1}=e;const{user:a}=Qe(),{showSuccess:i,showError:o,showWarning:l}=pt(),[c,d]=(0,s.useState)([]),[u,h]=(0,s.useState)(!1),[f,g]=(0,s.useState)(!1),[p,m]=(0,s.useState)(new Set),[y,b]=(0,s.useState)(!1),[x,v]=(0,s.useState)(!1),w=()=>{h(!0);try{const e=Id.findDuplicates(t);d(e),0===e.length?i("No duplicate transactions found!"):l("Found ".concat(e.length," groups of duplicate transactions."))}catch(e){console.error("Error scanning for duplicates:",e),o("Failed to scan for duplicates.")}finally{h(!1)}};(0,s.useEffect)((()=>{t.length>0&&w()}),[t]);const _=e=>{const t=parseFloat(e.amount||0),n=new Date(e.date).toLocaleDateString(),r=e.description||e.name||"No description",s=e.is_income||e.isIncome?"Income":"Expense";return"".concat(r," - $").concat(t.toFixed(2)," (").concat(s,") - ").concat(n)};return 0!==c.length||u?(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,Ge.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white",children:"Duplicate Transaction Cleanup"}),(0,Ge.jsx)("p",{className:"text-gray-400 text-sm",children:c.length>0?"Found ".concat(c.length," groups of duplicate transactions"):"Scanning for duplicate transactions..."})]}),(0,Ge.jsxs)("div",{className:"flex gap-2",children:[(0,Ge.jsx)("button",{onClick:w,disabled:u,className:"px-3 py-2 bg-gray-700 text-white rounded-md hover:bg-gray-600 transition-colors disabled:opacity-50",children:u?"Scanning...":"Rescan"}),x&&(0,Ge.jsx)("button",{onClick:()=>b(!0),className:"px-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:"\ud83d\udd27 Troubleshoot Network Issues"})]})]}),c.length>0&&(0,Ge.jsxs)(Ge.Fragment,{children:[(0,Ge.jsxs)("div",{className:"flex items-center justify-between mb-4 p-3 bg-gray-700 rounded-md",children:[(0,Ge.jsxs)("div",{className:"flex items-center gap-4",children:[(0,Ge.jsxs)("span",{className:"text-sm text-gray-300",children:[p.size," of ",c.length," groups selected"]}),(0,Ge.jsxs)("div",{className:"flex gap-2",children:[(0,Ge.jsx)("button",{onClick:()=>{const e=new Set(c.map(((e,t)=>t)));m(e)},className:"text-xs px-2 py-1 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition-colors",children:"Select All"}),(0,Ge.jsx)("button",{onClick:()=>{m(new Set)},className:"text-xs px-2 py-1 bg-gray-600 text-white rounded hover:bg-gray-500 transition-colors",children:"Deselect All"})]})]}),(0,Ge.jsx)("button",{onClick:async()=>{if(0===p.size)return void l("Please select duplicate groups to remove.");const e="This will remove ".concat(Array.from(p).reduce(((e,t)=>e+(c[t].transactions.length-1)),0)," duplicate transactions, keeping the most recent version of each. This action cannot be undone.\n\nContinue?");if(!window.confirm(e))return;g(!0);let t=0,s=0;try{for(const e of p){const n=c[e].transactions.sort(((e,t)=>{const n=new Date(e.last_modified||e.updated_at||e.created_at||e.date);return new Date(t.last_modified||t.updated_at||t.created_at||t.date).getTime()-n.getTime()}));for(let e=1;e<n.length;e++)try{if(r&&a)await Le.expenseDB.delete(n[e].id,a.id),Ue.trackCleanedDuplicate(n[e].id,"manual_duplicate_cleanup");else{const t=JSON.parse(localStorage.getItem("expenses")||"[]").filter((t=>t.id!==n[e].id));localStorage.setItem("expenses",JSON.stringify(t)),Ue.trackCleanedDuplicate(n[e].id,"manual_duplicate_cleanup_local")}t++}catch(f){var d,u,h;console.error("Failed to remove duplicate transaction ".concat(n[e].id,":"),f),(null!==(d=f.message)&&void 0!==d&&d.includes("NetworkError")||null!==(u=f.message)&&void 0!==u&&u.includes("CORS")||null!==(h=f.message)&&void 0!==h&&h.includes("fetch"))&&(console.warn("\ud83d\udea8 CORS/Network error detected during duplicate cleanup"),v(!0),Md.runDiagnostics().then((e=>{console.log("\ud83d\udd0d Diagnostic results for CORS error:",e);e.recommendations.filter((e=>"cors"===e.category||"network"===e.category||"connectivity"===e.category)).map((e=>e.solution)).join("\n")&&o("Network/CORS Error: ".concat(f.message,'\n\nClick "Troubleshoot Network Issues" for detailed help.'))}))),s++}}t>0&&(i("Successfully removed ".concat(t," duplicate transactions.")),n&&n(),m(new Set),setTimeout((()=>{w()}),1e3)),s>0&&o("Failed to remove ".concat(s," transactions. Please try again."))}catch(f){console.error("Error during duplicate removal:",f),o("Failed to remove duplicates. Please try again.")}finally{g(!1)}},disabled:0===p.size||f,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Removing...":"Remove Selected (".concat(Array.from(p).reduce(((e,t)=>e+(c[t].transactions.length-1)),0)," transactions)")})]}),(0,Ge.jsx)("div",{className:"space-y-4",children:c.map(((e,t)=>(0,Ge.jsxs)("div",{className:"border border-gray-700 rounded-lg p-4",children:[(0,Ge.jsx)("div",{className:"flex items-center justify-between mb-3",children:(0,Ge.jsxs)("div",{className:"flex items-center",children:[(0,Ge.jsx)("input",{type:"checkbox",checked:p.has(t),onChange:()=>(e=>{const t=new Set(p);t.has(e)?t.delete(e):t.add(e),m(t)})(t),className:"mr-3 h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"}),(0,Ge.jsxs)("h4",{className:"text-white font-medium",children:["Duplicate Group ",t+1]}),(0,Ge.jsxs)("span",{className:"ml-2 px-2 py-1 bg-yellow-600 text-yellow-100 text-xs rounded",children:[e.count," duplicates"]})]})}),(0,Ge.jsx)("div",{className:"space-y-2",children:e.transactions.map(((e,t)=>{const n=0===t;return(0,Ge.jsxs)("div",{className:"p-3 rounded-md text-sm ".concat(n?"bg-green-900 border border-green-700":"bg-red-900 border border-red-700"),children:[(0,Ge.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Ge.jsx)("span",{className:"text-gray-300",children:_(e)}),(0,Ge.jsx)("span",{className:"px-2 py-1 text-xs rounded ".concat(n?"bg-green-700 text-green-100":"bg-red-700 text-red-100"),children:n?"Keep (Newest)":"Will Remove"})]}),(0,Ge.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["ID: ",e.id," | Modified: ",new Date(e.last_modified||e.created_at||e.date).toLocaleString()]})]},e.id)}))})]},t)))})]}),y&&(0,Ge.jsx)(Rd,{onClose:()=>b(!1)})]}):(0,Ge.jsx)("div",{className:"bg-gray-800 rounded-lg p-6",children:(0,Ge.jsxs)("div",{className:"text-center",children:[(0,Ge.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 bg-green-100 rounded-full flex items-center justify-center",children:(0,Ge.jsx)("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"No Duplicates Found"}),(0,Ge.jsx)("p",{className:"text-gray-400 mb-4",children:"Your transactions look clean!"}),(0,Ge.jsx)("button",{onClick:w,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",children:"Scan Again"})]})})};function Bd(e){let{open:t,onClose:n,onConfirm:r,title:s,message:a}=e;return t?(0,Ge.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Ge.jsx)("div",{className:"flex items-center justify-center w-12 h-12 mx-auto mb-4 bg-red-100 rounded-full",children:(0,Ge.jsx)("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,Ge.jsx)("h3",{className:"text-lg font-semibold text-white mb-2 text-center",children:s}),(0,Ge.jsx)("p",{className:"text-gray-300 mb-6 text-center",children:a}),(0,Ge.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,Ge.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-500 transition-colors",onClick:n,children:"Cancel"}),(0,Ge.jsx)("button",{type:"button",className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",onClick:r,children:"Delete"})]})]})}):null}function zd(e){let{open:t,onClose:n,onSave:r,category:a=null}=e;const[i,o]=(0,s.useState)(""),[l,c]=(0,s.useState)("blue"),[d,u]=(0,s.useState)("");(0,s.useEffect)((()=>{t&&(a?(o(a.name),c(ut(a.color)||"blue")):(o(""),c("blue")),u(""))}),[t,a]);return t?(0,Ge.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[(0,Ge.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:a?"Edit Category":"Add New Category"}),d&&(0,Ge.jsx)("div",{className:"mb-4 text-sm text-red-500",children:d}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-200",children:"Name"}),(0,Ge.jsx)("input",{type:"text",value:i,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Category name",autoFocus:!0})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-200",children:"Preview"}),(0,Ge.jsx)("div",{className:"mb-4",children:(0,Ge.jsx)(gt,{color:l,children:i||"Category Preview"})})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-200",children:"Color"}),(0,Ge.jsx)("div",{className:"grid grid-cols-6 gap-2",children:ht.map((e=>(0,Ge.jsx)("button",{className:"w-8 h-8 rounded-full ".concat(dt(e)," ").concat(l===e?"ring-2 ring-offset-2 ring-offset-gray-800 ring-white":""),onClick:()=>c(e)},e)))})]}),(0,Ge.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,Ge.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-500",onClick:n,children:"Cancel"}),(0,Ge.jsx)("button",{type:"button",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",onClick:()=>{i.trim()?(r({name:i.trim(),color:dt(l)}),u("")):u("Name is required")},children:a?"Save Changes":"Add Category"})]})]})}):null}function Ud(e){let{open:t,onClose:n,onSave:r,tag:a=null}=e;const[i,o]=(0,s.useState)(""),[l,c]=(0,s.useState)("blue"),[d,u]=(0,s.useState)("");(0,s.useEffect)((()=>{t&&(a?(o(a.name),c(a.color||"blue")):(o(""),c("blue")),u(""))}),[t,a]);return t?(0,Ge.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md",children:[(0,Ge.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:a?"Edit Tag":"Add New Tag"}),d&&(0,Ge.jsx)("div",{className:"mb-4 text-sm text-red-500",children:d}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-200",children:"Name"}),(0,Ge.jsx)("input",{type:"text",value:i,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Tag name",autoFocus:!0})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-200",children:"Preview"}),(0,Ge.jsx)("div",{className:"mb-4",children:(0,Ge.jsx)(gt,{color:l,children:i||"Tag Preview"})})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-200",children:"Color"}),(0,Ge.jsx)("div",{className:"grid grid-cols-6 gap-2",children:ht.map((e=>(0,Ge.jsx)("button",{className:"w-8 h-8 rounded-full ".concat(dt(e)," ").concat(l===e?"ring-2 ring-offset-2 ring-offset-gray-800 ring-white":""),onClick:()=>c(e)},e)))})]}),(0,Ge.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,Ge.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-500",onClick:n,children:"Cancel"}),(0,Ge.jsx)("button",{type:"button",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700",onClick:()=>{i.trim()?(r({name:i.trim(),color:l}),u("")):u("Name is required")},children:a?"Save Changes":"Add Tag"})]})]})}):null}const Wd=function(e){let{dbInitialized:t=!1}=e;const{user:n}=Qe(),{showError:r,showSuccess:a,showWarning:i,showInfo:o}=pt(),[l,c]=(0,s.useState)("categories"),[d,u]=(0,s.useState)([]),[h,f]=(0,s.useState)([]),[g,p]=(0,s.useState)([]),[m,y]=(0,s.useState)(""),[b,x]=(0,s.useState)(!0),[v,w]=(0,s.useState)(!1),[_,S]=(0,s.useState)(!1),[k,j]=(0,s.useState)(null),[N,E]=(0,s.useState)(null),[C,T]=(0,s.useState)(!1),[A,D]=(0,s.useState)(null),[P,O]=(0,s.useState)(""),[I,L]=(0,s.useState)(""),M=async()=>{try{if(t&&n){const e=await Le.T0.getAll(n.id);u(e);const t=await Le.d6.getAll(n.id);f(t);const r=await Le.expenseDB.getAll(n.id);p(r)}else R()}catch(m){console.error("Error loading data:",m),R()}finally{x(!1)}};(0,s.useEffect)((()=>{M()}),[t,n]);const R=()=>{const e=localStorage.getItem("expense-categories");if(e)u(JSON.parse(e));else{const e=[{id:"food",name:"Food",color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"},{id:"transportation",name:"Transportation",color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300"},{id:"entertainment",name:"Entertainment",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300"},{id:"utilities",name:"Utilities",color:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300"},{id:"housing",name:"Housing",color:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"},{id:"healthcare",name:"Healthcare",color:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300"},{id:"other",name:"Other",color:"bg-lime-100 text-lime-800 dark:bg-lime-900 dark:text-lime-300"}];u(e),He("expense-categories",JSON.stringify(e))}const t=localStorage.getItem("expense-tags");if(t)f(JSON.parse(t));else{const e=[{id:"essential",name:"Essential",color:"blue"},{id:"recurring",name:"Recurring",color:"green"},{id:"emergency",name:"Emergency",color:"red"},{id:"personal",name:"Personal",color:"purple"},{id:"work",name:"Work",color:"indigo"}];f(e),He("expense-tags",JSON.stringify(e))}const n=localStorage.getItem("expenses");p(n?JSON.parse(n):[])};(0,s.useEffect)((()=>{!t&&d.length>0&&He("expense-categories",JSON.stringify(d))}),[d,t]),(0,s.useEffect)((()=>{!t&&h.length>0&&He("expense-tags",JSON.stringify(h))}),[h,t]);const F=async e=>{try{if(t&&n){await Le.T0.delete(e,n.id);const t=await Le.T0.getAll(n.id);u(t)}else{const t=d.filter((t=>t.id!==e));u(t),He("expense-categories",JSON.stringify(t))}T(!1)}catch(m){console.error("Error deleting category:",m),y("Failed to delete category. Please try again."),T(!1)}},B=async e=>{try{if(t&&n){await Le.d6.delete(e,n.id);const t=await Le.d6.getAll(n.id);f(t)}else{const t=h.filter((t=>t.id!==e));f(t),He("expense-tags",JSON.stringify(t))}yt(),T(!1)}catch(m){console.error("Error deleting tag:",m),y("Failed to delete tag. Please try again."),T(!1)}},z=async()=>{try{x(!0),T(!1);const e=await Le.T0.cleanupDuplicates(n.id),t=await Le.d6.cleanupDuplicates(n.id);await M();const r=e.duplicatesRemoved+t.duplicatesRemoved;r>0?a("Cleanup completed! Removed ".concat(r," duplicates:\n- Categories: ").concat(e.duplicatesRemoved,"\n- Tags: ").concat(t.duplicatesRemoved)):o("No duplicates found!")}catch(m){console.error("Error cleaning up duplicates:",m),r("Failed to cleanup duplicates: ".concat(m.message))}finally{x(!1)}},U=async()=>{try{if(x(!0),t&&n){const e=await Le.expenseDB.getAll(n.id);let t=0;for(const r of e)try{await Le.expenseDB.delete(r.id,n.id),t++}catch(m){console.error("Failed to delete expense ".concat(r.id,":"),m)}a("Successfully deleted ".concat(t," transactions from cloud storage."))}else localStorage.removeItem("expenses"),a("Successfully deleted ".concat(g.length," transactions from local storage."));if(n){const e="duplicateDetectionRun_".concat(n.id);sessionStorage.removeItem(e)}await M(),T(!1)}catch(m){console.error("Error deleting all transactions:",m),r("Failed to delete all transactions. Please try again.")}finally{x(!1)}},W=async()=>{try{if(x(!0),t&&n){const[e,t,r]=await Promise.all([Le.expenseDB.getAll(n.id),Le.T0.getAll(n.id),Le.d6.getAll(n.id)]);let s=0;for(const a of e)try{await Le.expenseDB.delete(a.id,n.id),s++}catch(m){console.error("Failed to delete expense ".concat(a.id,":"),m)}for(const a of t)try{await Le.T0.delete(a.id,n.id)}catch(m){console.error("Failed to delete category ".concat(a.id,":"),m)}for(const a of r)try{await Le.d6.delete(a.id,n.id)}catch(m){console.error("Failed to delete tag ".concat(a.id,":"),m)}a("Successfully reset all data. Deleted ".concat(s," transactions, ").concat(t.length," categories, and ").concat(r.length," tags."))}else localStorage.removeItem("expenses"),localStorage.removeItem("expense-categories"),localStorage.removeItem("expense-tags"),localStorage.removeItem("wallets"),localStorage.removeItem("transfers"),localStorage.removeItem("budgets"),localStorage.removeItem("recurring"),a("Successfully reset all local data.");if(n){const e="duplicateDetectionRun_".concat(n.id);sessionStorage.removeItem(e)}await M(),T(!1)}catch(m){console.error("Error resetting all data:",m),r("Failed to reset all data. Please try again.")}finally{x(!1)}};return b?(0,Ge.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,Ge.jsx)("div",{className:"text-indigo-400",children:(0,Ge.jsxs)("svg",{className:"animate-spin h-8 w-8 mr-3",viewBox:"0 0 24 24",children:[(0,Ge.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,Ge.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,Ge.jsx)("p",{className:"text-indigo-300",children:"Loading..."})]}):(0,Ge.jsxs)("div",{className:"pb-20 mb-16",children:[(0,Ge.jsx)("h2",{className:"text-xl font-semibold mb-6 text-indigo-300",children:"Settings"}),(0,Ge.jsxs)("div",{className:"mb-4 text-sm",children:[(0,Ge.jsxs)("span",{className:"inline-flex items-center text-gray-400",children:[(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z",clipRule:"evenodd"})}),"Storage: ",t?"Supabase":"LocalStorage"]}),t&&n&&(0,Ge.jsx)("button",{onClick:async()=>{t&&n?(O("Cleanup Duplicates"),L("This will remove duplicate categories and tags (keeping the oldest version of each). This action cannot be undone. Continue?"),D((()=>()=>z())),T(!0)):i("Cleanup is only available when using the cloud database.")},className:"ml-4 text-xs px-3 py-1 bg-orange-600 hover:bg-orange-700 text-white rounded-md transition-colors",disabled:b,children:"\ud83e\uddf9 Cleanup Duplicates"}),(navigator.userAgent.includes("Arc")||navigator.userAgent.includes("Chrome"))&&(0,Ge.jsx)("button",{onClick:()=>{if(window.StorageDebugger)window.StorageDebugger.arcBrowserCleanup();else{console.warn("StorageDebugger not available");const e=JSON.stringify(localStorage).length,t=["user","auth","supabase.auth.token","sb-mplrakcyrohgkqdhzpry-auth-token"],n=Object.keys(localStorage);let r=0;n.forEach((e=>{if(!t.some((t=>e.includes(t))))try{localStorage.removeItem(e),r++}catch(pu){console.warn("Failed to remove key:",e)}}));const s=e-JSON.stringify(localStorage).length;a("Arc cleanup complete! Removed ".concat(r," items, freed ").concat((s/1024).toFixed(2)," KB")),s>51200&&window.confirm("Significant cleanup performed. Reload page for best performance?")&&window.location.reload()}},className:"ml-2 text-xs px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors",children:"\ud83c\udf10 Arc Cleanup"})]}),(0,Ge.jsxs)("div",{className:"flex border-b border-gray-700 mb-6",children:[(0,Ge.jsx)("button",{className:"py-2 px-4 font-medium ".concat("categories"===l?"text-indigo-400 border-b-2 border-indigo-400":"text-gray-400 hover:text-gray-300"),onClick:()=>c("categories"),children:"Categories"}),(0,Ge.jsx)("button",{className:"py-2 px-4 font-medium ".concat("tags"===l?"text-indigo-400 border-b-2 border-indigo-400":"text-gray-400 hover:text-gray-300"),onClick:()=>c("tags"),children:"Tags"}),(0,Ge.jsx)("button",{className:"py-2 px-4 font-medium ".concat("duplicates"===l?"text-indigo-400 border-b-2 border-indigo-400":"text-gray-400 hover:text-gray-300"),onClick:()=>c("duplicates"),children:"Duplicates"}),(0,Ge.jsx)("button",{className:"py-2 px-4 font-medium ".concat("data"===l?"text-indigo-400 border-b-2 border-indigo-400":"text-gray-400 hover:text-gray-300"),onClick:()=>c("data"),children:"Data Management"})]}),m&&(0,Ge.jsx)("div",{className:"bg-red-900 text-white p-3 rounded mb-4",children:m}),"categories"===l&&(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-lg overflow-hidden",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-gray-700",children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white",children:"Categories"}),(0,Ge.jsx)("button",{onClick:()=>{j(null),w(!0)},className:"px-3 py-1 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition-colors duration-300",children:"Add Category"})]}),(0,Ge.jsx)("div",{className:"p-4 flex flex-wrap gap-2 mb-4 border-b border-gray-700",children:d.map((e=>(0,Ge.jsx)(gt,{color:ut(e.color),children:e.name},e.id)))}),0===d.length?(0,Ge.jsx)("div",{className:"p-4 text-gray-400",children:"No categories defined."}):(0,Ge.jsx)("ul",{children:d.map((e=>(0,Ge.jsx)("li",{className:"border-b border-gray-700 last:border-b-0",children:(0,Ge.jsxs)("div",{className:"flex justify-between items-center p-4",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("div",{className:"text-white font-medium",children:e.name}),(0,Ge.jsxs)("div",{className:"text-gray-400 text-sm",children:["ID: ",e.id]})]}),(0,Ge.jsxs)("div",{className:"flex gap-2",children:[(0,Ge.jsx)("button",{onClick:()=>{j(e),w(!0)},className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors duration-300",children:"Edit"}),(0,Ge.jsx)("button",{onClick:()=>(async e=>{const t=d.find((t=>t.id===e));O("Delete Category"),L('Are you sure you want to delete the category "'.concat(null===t||void 0===t?void 0:t.name,'"? This action cannot be undone.')),D((()=>()=>F(e))),T(!0)})(e.id),className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors duration-300",children:"Delete"})]})]})},e.id)))})]}),"tags"===l&&(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-lg overflow-hidden",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-gray-700",children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white",children:"Tags"}),(0,Ge.jsx)("button",{onClick:()=>{E(null),S(!0)},className:"px-3 py-1 bg-indigo-600 text-white rounded hover:bg-indigo-700 transition-colors duration-300",children:"Add Tag"})]}),(0,Ge.jsx)("div",{className:"p-4 flex flex-wrap gap-2 mb-4 border-b border-gray-700",children:h.map((e=>(0,Ge.jsx)(gt,{color:e.color,children:e.name},e.id)))}),0===h.length?(0,Ge.jsx)("div",{className:"p-4 text-gray-400",children:"No tags defined."}):(0,Ge.jsx)("ul",{children:h.map((e=>(0,Ge.jsx)("li",{className:"border-b border-gray-700 last:border-b-0",children:(0,Ge.jsxs)("div",{className:"flex justify-between items-center p-4",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("div",{className:"text-white font-medium",children:e.name}),(0,Ge.jsxs)("div",{className:"text-gray-400 text-sm",children:["ID: ",e.id]})]}),(0,Ge.jsxs)("div",{className:"flex gap-2",children:[(0,Ge.jsx)("button",{onClick:()=>{E(e),S(!0)},className:"px-3 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors duration-300",children:"Edit"}),(0,Ge.jsx)("button",{onClick:()=>(async e=>{const t=h.find((t=>t.id===e));O("Delete Tag"),L('Are you sure you want to delete the tag "'.concat(null===t||void 0===t?void 0:t.name,'"? This action cannot be undone.')),D((()=>()=>B(e))),T(!0)})(e.id),className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 transition-colors duration-300",children:"Delete"})]})]})},e.id)))})]}),"duplicates"===l&&(0,Ge.jsx)(Fd,{expenses:g,onCleanupComplete:M,dbInitialized:t}),"data"===l&&(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-lg overflow-hidden",children:[(0,Ge.jsxs)("div",{className:"p-4 border-b border-gray-700",children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"Data Management"}),(0,Ge.jsx)("p",{className:"text-gray-400 text-sm",children:"Manage your transaction data and perform bulk operations."})]}),(0,Ge.jsxs)("div",{className:"p-6 space-y-6",children:[(0,Ge.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,Ge.jsx)("h4",{className:"text-white font-medium mb-3",children:"Transaction Statistics"}),(0,Ge.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("span",{className:"text-gray-400",children:"Total Transactions:"}),(0,Ge.jsx)("span",{className:"text-white ml-2 font-medium",children:g.length})]}),(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("span",{className:"text-gray-400",children:"Storage Type:"}),(0,Ge.jsx)("span",{className:"text-white ml-2 font-medium",children:t?"Cloud (Supabase)":"Local Storage"})]})]})]}),(0,Ge.jsxs)("div",{className:"bg-red-900/20 border border-red-700 rounded-lg p-4",children:[(0,Ge.jsxs)("h4",{className:"text-red-400 font-medium mb-3 flex items-center",children:[(0,Ge.jsx)("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})}),"Danger Zone"]}),(0,Ge.jsx)("p",{className:"text-gray-300 text-sm mb-4",children:"These actions are permanent and cannot be undone. Please proceed with caution."}),(0,Ge.jsxs)("div",{className:"space-y-3",children:[(0,Ge.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-800 rounded border border-gray-600",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("h5",{className:"text-white font-medium",children:"Delete All Transactions"}),(0,Ge.jsx)("p",{className:"text-gray-400 text-sm",children:"Permanently remove all transaction records from your account."})]}),(0,Ge.jsx)("button",{onClick:()=>{O("Delete All Transactions"),L("Are you sure you want to delete ALL ".concat(g.length," transactions? This action cannot be undone and will permanently remove all your transaction history.")),D((()=>U)),T(!0)},disabled:0===g.length||b,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:bg-gray-600 disabled:cursor-not-allowed transition-colors duration-300",children:b?"Processing...":"Delete All"})]}),(0,Ge.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-800 rounded border border-gray-600",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("h5",{className:"text-white font-medium",children:"Reset All Data"}),(0,Ge.jsx)("p",{className:"text-gray-400 text-sm",children:"Delete all transactions, categories, and tags. Reset to default state."})]}),(0,Ge.jsx)("button",{onClick:()=>{O("Reset All Data"),L("Are you sure you want to reset ALL data? This will delete all transactions, categories, and tags, and restore default settings. This action cannot be undone."),D((()=>W)),T(!0)},disabled:b,className:"px-4 py-2 bg-red-700 text-white rounded hover:bg-red-800 disabled:bg-gray-600 disabled:cursor-not-allowed transition-colors duration-300",children:b?"Processing...":"Reset All"})]})]})]}),(0,Ge.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,Ge.jsx)("h4",{className:"text-white font-medium mb-3",children:"Export Data"}),(0,Ge.jsx)("p",{className:"text-gray-400 text-sm mb-4",children:"Download your transaction data as a JSON file for backup or migration purposes."}),(0,Ge.jsx)("button",{onClick:async()=>{try{x(!0);const e={timestamp:(new Date).toISOString(),version:"1.0",user:n?{id:n.id,email:n.email}:null,storage:t?"supabase":"localStorage",data:{expenses:g,categories:d,tags:h},statistics:{totalTransactions:g.length,totalCategories:d.length,totalTags:h.length}},r=JSON.stringify(e,null,2),s=new Blob([r],{type:"application/json"}),i=URL.createObjectURL(s),o=document.createElement("a");o.href=i,o.download="expense-tracker-export-".concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(i),a("Data exported successfully!")}catch(m){console.error("Error exporting data:",m),r("Failed to export data. Please try again.")}finally{x(!1)}},disabled:0===g.length||b,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed transition-colors duration-300",children:b?"Exporting...":"Export Data"})]})]})]}),(0,Ge.jsx)(zd,{open:v,onClose:()=>{w(!1),j(null)},onSave:async e=>{try{if(k){const r=(0,Oe.A)((0,Oe.A)({},k),{},{name:e.name,color:e.color});if(t&&n)await Le.T0.update(r,n.id);else{const e=d.map((e=>e.id===k.id?r:e));u(e),He("expense-categories",JSON.stringify(e))}}else{const r={name:e.name,color:e.color},s=(0,Oe.A)({id:e.name.trim().toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")},r);if(d.find((e=>e.id===s.id)))return void i("A category with this name already exists!");if(t&&n)await Le.T0.add(r,n.id);else{const e=[...d,s];u(e),He("expense-categories",JSON.stringify(e))}}await M(),w(!1),j(null)}catch(m){console.error("Error saving category:",m),r("Failed to save category: ".concat(m.message))}},category:k}),(0,Ge.jsx)(Ud,{open:_,onClose:()=>{S(!1),E(null)},onSave:async e=>{try{if(N){const r=(0,Oe.A)((0,Oe.A)({},N),{},{name:e.name,color:e.color});if(t&&n)await Le.d6.update(r,n.id);else{const e=h.map((e=>e.id===N.id?r:e));f(e),He("expense-tags",JSON.stringify(e))}yt()}else{const r={name:e.name,color:e.color},s=(0,Oe.A)({id:e.name.trim().toLowerCase().replace(/\s+/g,"-").replace(/[^a-z0-9-]/g,"")},r);if(h.find((e=>e.id===s.id)))return void i("A tag with this name already exists!");if(t&&n)await Le.d6.add(r,n.id);else{const e=[...h,s];f(e),He("expense-tags",JSON.stringify(e))}yt()}await M(),S(!1),E(null)}catch(m){console.error("Error saving tag:",m),r("Failed to save tag: ".concat(m.message))}},tag:N}),(0,Ge.jsx)(Bd,{open:C,onClose:()=>T(!1),onConfirm:A,title:P,message:I})]})};const qd=function(e){let{isOpen:t,onClose:n,children:r}=e;return(0,s.useEffect)((()=>{const e=e=>{"Escape"===e.key&&n()};return t&&window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[t,n]),(0,s.useEffect)((()=>(document.body.style.overflow=t?"hidden":"",()=>{document.body.style.overflow=""})),[t]),t?(0,Ge.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4",onClick:n,children:(0,Ge.jsx)("div",{className:"relative max-w-lg w-full h-[80vh] flex flex-col bg-gray-800 rounded-lg shadow-lg overflow-hidden",onClick:e=>e.stopPropagation(),children:r})}):null},Hd=e=>{let{dbInitialized:t,refresh:n=0}=e;const{user:r}=Qe(),{notification:a,showError:i,showSuccess:o,showConfirm:l,hideNotification:c}=pt(),[d,u]=(0,s.useState)([]),[h,f]=(0,s.useState)([]),[g,p]=(0,s.useState)({}),[m,y]=(0,s.useState)(!0),[b,x]=(0,s.useState)(!1),[v,w]=(0,s.useState)(null),[_,S]=(0,s.useState)(null),[k,j]=(0,s.useState)((()=>{const e=new Date;return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"))})),[N,E]=(0,s.useState)({category:"",amount:"",period:"monthly",startDate:(new Date).toISOString().slice(0,10),notes:""});(0,s.useEffect)((()=>{(async()=>{y(!0);try{if(t&&r){const e=await Le.T0.getAll(r.id);f(e);const t=await Le.mh.getAll(r.id);u(t),await C()}else{const e=JSON.parse(localStorage.getItem("expense-categories")||"[]");f(e.length>0?e:A());const t=JSON.parse(localStorage.getItem("budgets")||"[]");u(t);const n=JSON.parse(localStorage.getItem("expenses")||"[]");T(n)}}catch(e){console.error("Error loading budget data:",e)}finally{y(!1)}})()}),[t,k,n,r]);const C=async()=>{try{const e=await Le.expenseDB.getAll(r.id);T(e)}catch(e){console.error("Error loading expenses for budget:",e)}},T=e=>{const[t,n]=k.split("-").map(Number),r=e.filter((e=>{if(!e.date)return!1;const r=new Date(e.date);return r.getFullYear()===t&&r.getMonth()===n-1&&!e.is_income})).reduce(((e,t)=>{const n=t.category||"other";return e[n]||(e[n]={total:0,expenses:[]}),e[n].total+=parseFloat(t.amount||0),e[n].expenses.push(t),e}),{});p(r)},A=()=>[{id:"food",name:"Food"},{id:"transportation",name:"Transportation"},{id:"entertainment",name:"Entertainment"},{id:"utilities",name:"Utilities"},{id:"housing",name:"Housing"},{id:"healthcare",name:"Healthcare"},{id:"other",name:"Other"}],D=e=>{const{name:t,value:n}=e.target;E((e=>(0,Oe.A)((0,Oe.A)({},e),{},{[t]:n})))},P=()=>{w(null),E({category:h.length>0?h[0].id:"",amount:"",period:"monthly",startDate:(new Date).toISOString().slice(0,10),notes:""}),x(!0)},O=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),I=e=>{const t=h.find((t=>t.id===e));return t?t.name:e};return m?(0,Ge.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,Ge.jsx)("div",{className:"text-indigo-400",children:(0,Ge.jsxs)("svg",{className:"animate-spin h-10 w-10 mr-3",viewBox:"0 0 24 24",children:[(0,Ge.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,Ge.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,Ge.jsx)("p",{className:"text-indigo-300 text-lg font-medium",children:"Loading budgets..."})]}):(0,Ge.jsxs)("div",{className:"py-4 pb-24 md:pb-6",children:[(0,Ge.jsxs)("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center mb-6",children:[(0,Ge.jsx)("h2",{className:"text-xl md:text-2xl font-semibold text-indigo-300 mb-4 md:mb-0",children:"Budget Manager"}),(0,Ge.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[(0,Ge.jsx)("div",{className:"w-full sm:w-auto",children:(0,Ge.jsx)("input",{type:"month",value:k,onChange:e=>{j(e.target.value)},className:"w-full rounded-md bg-gray-800 border border-gray-700 text-white px-3 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500"})}),(0,Ge.jsxs)("button",{onClick:P,className:"w-full sm:w-auto px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors flex items-center justify-center",children:[(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Add Budget"]})]})]}),0===d.length?(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 sm:p-8 text-center border border-gray-700",children:[(0,Ge.jsx)("div",{className:"mx-auto w-16 h-16 bg-gray-700 rounded-full flex items-center justify-center mb-4",children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),(0,Ge.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Budgets Set"}),(0,Ge.jsx)("p",{className:"text-gray-400 mb-6",children:"Start managing your finances by setting up a budget for different categories."}),(0,Ge.jsx)("button",{onClick:P,className:"px-6 py-3 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",children:"Create Your First Budget"})]}):(0,Ge.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:d.map((e=>{const n=(e=>{const t=(g[e.category]||{total:0}).total/parseFloat(e.amount)*100;return Math.min(t,100)})(e),s=(e=>(g[e.category]||{total:0}).total>parseFloat(e.amount))(e),a=g[e.category]||{total:0};return(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-4 md:p-6 border border-gray-700 relative",children:[s&&(0,Ge.jsx)("div",{className:"absolute top-3 right-3 bg-red-900/70 text-red-300 text-xs sm:text-sm px-2 sm:px-3 py-1 rounded-full font-medium",children:"Over Budget"}),(0,Ge.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("h3",{className:"text-base md:text-lg font-semibold text-white",children:I(e.category)}),(0,Ge.jsx)("p",{className:"text-gray-400 text-xs md:text-sm",children:"monthly"===e.period?"Monthly Budget":"Weekly Budget"})]}),(0,Ge.jsxs)("div",{className:"flex space-x-2",children:[(0,Ge.jsx)("button",{onClick:()=>(e=>{w(e),E({category:e.category,amount:e.amount,period:e.period||"monthly",startDate:e.startDate||(new Date).toISOString().slice(0,10),notes:e.notes||""}),x(!0)})(e),className:"p-1.5 md:p-2 text-gray-400 hover:text-white transition-colors","aria-label":"Edit budget",children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 md:h-5 md:w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ge.jsx)("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})})}),(0,Ge.jsx)("button",{onClick:()=>(async e=>{l("Are you sure you want to delete this budget? This action cannot be undone.",(async()=>{try{if(t&&r){await Le.mh.delete(e,r.id);const t=await Le.mh.getAll(r.id);u(t)}else{const t=JSON.parse(localStorage.getItem("budgets")||"[]").filter((t=>t.id!==e));He("budgets",JSON.stringify(t)),u(t)}o("Budget deleted successfully.")}catch(n){console.error("Error deleting budget:",n),i("Failed to delete budget. Please try again.")}}),"Delete Budget")})(e.id),className:"p-1.5 md:p-2 text-gray-400 hover:text-red-500 transition-colors","aria-label":"Delete budget",children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 md:h-5 md:w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z",clipRule:"evenodd"})})})]})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,Ge.jsx)("div",{className:"font-semibold text-white text-sm md:text-base",children:O(a.total)}),(0,Ge.jsxs)("div",{className:"text-gray-400 text-sm md:text-base",children:["of ",O(e.amount)]})]}),(0,Ge.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2.5 md:h-3 mb-1",children:(0,Ge.jsx)("div",{className:"h-2.5 md:h-3 rounded-full ".concat(n>90?"bg-red-500":n>70?"bg-yellow-500":"bg-green-500"),style:{width:"".concat(n,"%")}})}),(0,Ge.jsx)("div",{className:"text-xs text-gray-400",children:s?"".concat(O(a.total-e.amount)," over budget"):"".concat(O(e.amount-a.total)," remaining")})]}),e.notes&&(0,Ge.jsx)("div",{className:"text-xs md:text-sm text-gray-400 mt-3 border-t border-gray-700 pt-2 md:pt-3",children:(0,Ge.jsx)("p",{children:e.notes})})]},e.id)}))}),(0,Ge.jsx)(qd,{isOpen:b,onClose:()=>x(!1),children:(0,Ge.jsxs)("div",{className:"p-6",children:[(0,Ge.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:v?"Edit Budget":"Add New Budget"}),(0,Ge.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!N.category||!N.amount)return void i("Please enter both category and amount.");const n={category:N.category,amount:parseFloat(N.amount),period:N.period,start_date:N.startDate,notes:N.notes,created_at:(new Date).toISOString()};try{if(v)if(n.id=v.id,t&&r)await Le.mh.update(n,r.id);else{const e=JSON.parse(localStorage.getItem("budgets")||"[]").map((e=>e.id===v.id?n:e));He("budgets",JSON.stringify(e)),u(e)}else if(t&&r)await Le.mh.add(n,r.id);else{n.id=Date.now();const e=JSON.parse(localStorage.getItem("budgets")||"[]");e.push(n),He("budgets",JSON.stringify(e)),u(e)}if(t&&r){const e=await Le.mh.getAll(r.id);u(e)}x(!1)}catch(s){console.error("Error saving budget:",s),i("Failed to save budget. Please try again.")}},children:[(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block text-gray-300 text-sm font-medium mb-2",children:"Category"}),(0,Ge.jsx)("select",{name:"category",value:N.category,onChange:D,className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0,children:h.map((e=>(0,Ge.jsx)("option",{value:e.id,children:e.name},e.id)))})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block text-gray-300 text-sm font-medium mb-2",children:"Budget Amount"}),(0,Ge.jsx)("input",{type:"number",name:"amount",value:N.amount,onChange:D,className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"0",min:"0",required:!0})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block text-gray-300 text-sm font-medium mb-2",children:"Period"}),(0,Ge.jsxs)("select",{name:"period",value:N.period,onChange:D,className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[(0,Ge.jsx)("option",{value:"monthly",children:"Monthly"}),(0,Ge.jsx)("option",{value:"weekly",children:"Weekly"})]})]}),(0,Ge.jsxs)("div",{className:"mb-4 relative",children:[(0,Ge.jsx)("label",{className:"block text-gray-300 text-sm font-medium mb-2",children:"Start Date"}),(0,Ge.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer",placeholder:"Select date",readOnly:!0,value:N.startDate?(e=>{if(!e)return"";return("string"===typeof e?new Date(e):e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})(N.startDate):"",onClick:()=>S("startDate")}),"startDate"===_&&(0,Ge.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 date-picker-container",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Ge.jsx)("h4",{className:"text-lg font-medium text-white",children:"Select Start Date"}),(0,Ge.jsx)("button",{type:"button",className:"text-gray-400 hover:text-white p-2 rounded-full",onClick:()=>S(null),children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ge.jsx)(_t,{value:{start:N.startDate?new Date(N.startDate):null,end:null},onChange:e=>{if(e.start){const t=e.start.toISOString().slice(0,10);E((e=>(0,Oe.A)((0,Oe.A)({},e),{},{startDate:t})))}S(null)},onClose:()=>S(null),isSingleDatePicker:!0,pickerLabel:"Select Start Date"})]})})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("label",{className:"block text-gray-300 text-sm font-medium mb-2",children:"Notes (Optional)"}),(0,Ge.jsx)("textarea",{name:"notes",value:N.notes,onChange:D,className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",rows:"3",placeholder:"Add any details or reminders about this budget"})]}),(0,Ge.jsxs)("div",{className:"flex justify-end",children:[(0,Ge.jsx)("button",{type:"button",onClick:()=>x(!1),className:"mr-4 px-4 py-2 bg-gray-700 text-white rounded-md hover:bg-gray-600 transition-colors",children:"Cancel"}),(0,Ge.jsx)("button",{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",children:v?"Save Changes":"Create Budget"})]})]})]})}),a&&(0,Ge.jsx)(jt,{isOpen:a.isOpen,onClose:c,title:a.title,message:a.message,type:a.type,showCancel:a.showCancel,onConfirm:a.onConfirm,confirmText:a.confirmText,cancelText:a.cancelText})]})},Vd=e=>{let{dbInitialized:t,refreshWallets:n}=e;const[r,a]=(0,s.useState)([]),[i,o]=(0,s.useState)([]),[l,c]=(0,s.useState)(!0),[d,u]=(0,s.useState)(!1),[h,f]=(0,s.useState)(!1),[g,p]=(0,s.useState)(""),[m,y]=(0,s.useState)(null),[b,x]=(0,s.useState)(null),[v,w]=(0,s.useState)(""),_=(0,s.useRef)(!0),{user:S}=Qe(),[k,j]=(0,s.useState)({fromWallet:"",toWallet:"",amount:"",date:(new Date).toISOString().slice(0,10),notes:"",photoUrl:""});(0,s.useEffect)((()=>{_.current=!0;return(()=>{try{const e=JSON.parse(localStorage.getItem("wallets")||"[]"),t=JSON.parse(localStorage.getItem("wallet-transfers")||"[]");e.length>0?a(e):a(E()),t.length>0&&o(t.sort(((e,t)=>new Date(t.date)-new Date(e.date)))),console.log("Loaded initial data from localStorage:",{wallets:e.length,transfers:t.length})}catch(g){console.error("Error loading initial localStorage data:",g),a(E()),o([])}})(),()=>{_.current=!1}}),[]),(0,s.useEffect)((()=>{(async()=>{if(!_.current)return;c(!0);const e=setTimeout((()=>{if(_.current){console.warn("Loading timeout reached, forcing localStorage fallback"),c(!1);const e=JSON.parse(localStorage.getItem("wallets")||"[]");if(e.length>0)a(e);else{const e=E();a(e),He("wallets",JSON.stringify(e))}const t=JSON.parse(localStorage.getItem("wallet-transfers")||"[]");o(t.sort(((e,t)=>new Date(t.date)-new Date(e.date))))}}),1e3);try{if(t&&null!==S&&void 0!==S&&S.id){const e=await Le.qF.getAll(S.id);if(_.current)if(e.length>0)a(e);else{const e=JSON.parse(localStorage.getItem("wallets")||"[]");if(e.length>0)a(e);else{const e=E();a(e)}}try{const e=await Le.transferDB.getAll(S.id);_.current&&o(e.sort(((e,t)=>new Date(t.date)-new Date(e.date))))}catch(n){console.error("Error loading transfers:",n),_.current&&o([]);const e=JSON.parse(localStorage.getItem("wallet-transfers")||"[]");_.current&&o(e.sort(((e,t)=>new Date(t.date)-new Date(e.date))))}}else{console.log("Loading from localStorage - dbInitialized:",t,"user:",!!S);const e=JSON.parse(localStorage.getItem("wallets")||"[]");if(_.current)if(e.length>0)a(e);else{const e=E();a(e),He("wallets",JSON.stringify(e))}const n=JSON.parse(localStorage.getItem("wallet-transfers")||"[]");_.current&&o(n.sort(((e,t)=>new Date(t.date)-new Date(e.date))))}}catch(g){if(console.error("Error loading wallet data:",g),_.current){p("Failed to load wallets. Using default data.");const e=JSON.parse(localStorage.getItem("wallets")||"[]");if(e.length>0)a(e);else{const e=E();a(e),He("wallets",JSON.stringify(e))}const t=JSON.parse(localStorage.getItem("wallet-transfers")||"[]");o(t.sort(((e,t)=>new Date(t.date)-new Date(e.date))))}}finally{clearTimeout(e),_.current&&c(!1)}})()}),[t,S]);const N=()=>{c(!1),p(""),0===r.length&&a(E()),0===i.length&&o([])},E=()=>[{id:"cash",name:"Cash",type:"cash",balance:0},{id:"bank",name:"Bank Account",type:"bank",balance:0},{id:"credit",name:"Credit Card",type:"credit_card",balance:0},{id:"ewallet",name:"E-Wallet",type:"e_wallet",balance:0}],C=e=>{const{name:t,value:n}=e.target;j((e=>(0,Oe.A)((0,Oe.A)({},e),{},{[t]:n}))),g&&p("")},T=()=>{y(null),j({fromWallet:r.length>=2?r[0].id:"",toWallet:r.length>=2?r[1].id:"",amount:"",date:(new Date).toISOString().slice(0,10),notes:"",photoUrl:""}),x(null),w(""),f(!0)},A=async e=>{if(e.preventDefault(),!k.fromWallet||!k.toWallet||!k.amount)return void p("Please fill in all required fields");if(k.fromWallet===k.toWallet)return void p("Source and destination wallets cannot be the same");const t=parseFloat(k.amount);if(t<=0)p("Amount must be greater than 0");else{u(!0),p("");try{if(m){const e=wr(S),n=await e.updateWalletTransfer(m.id,{fromWallet:k.fromWallet,toWallet:k.toWallet,amount:t,date:k.date||(new Date).toISOString().slice(0,10),notes:k.notes||"",photoUrl:v||""});if(console.log("Transfer updated successfully:",n),_.current){const e=await Le.qF.getAll(S.id);a(e);const t=await Le.transferDB.getAll(S.id);o(t.sort(((e,t)=>new Date(t.date)-new Date(e.date))))}}else{const e=wr(S),n=await e.executeWalletTransfer({fromWallet:k.fromWallet,toWallet:k.toWallet,amount:t,date:k.date||(new Date).toISOString().slice(0,10),notes:k.notes||"",photoUrl:v||""});if(console.log("Transfer created successfully:",n),_.current){const e=await Le.qF.getAll(S.id);a(e);const t=await Le.transferDB.getAll(S.id);o(t.sort(((e,t)=>new Date(t.date)-new Date(e.date))))}}_.current&&(j({fromWallet:"",toWallet:"",amount:"",date:(new Date).toISOString().slice(0,10),notes:"",photoUrl:""}),x(null),w(""),y(null),f(!1)),n&&n()}catch(g){console.error("Error processing transfer:",g),p(g.message||"Failed to process transfer. Please try again.")}finally{u(!1)}}},D=e=>_r.formatBalance(e),P=e=>(e=>{const t=r.find((t=>t.id===e));if(t)return t.name;if("string"===typeof e){const t={cash:"Cash",bank:"Bank Account",credit:"Credit Card",ewallet:"E-Wallet",credit_card:"Credit Card",e_wallet:"E-Wallet",savings:"Savings Account"};if(t[e])return"".concat(t[e]," (Deleted)")}return"Wallet ".concat(e," (Deleted)")})(e);return l?(0,Ge.jsxs)("div",{className:"py-4",children:[(0,Ge.jsxs)("div",{className:"flex justify-center items-center py-12",children:[(0,Ge.jsx)("div",{className:"text-indigo-400",children:(0,Ge.jsxs)("svg",{className:"animate-spin h-10 w-10 mr-3",viewBox:"0 0 24 24",children:[(0,Ge.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),(0,Ge.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),(0,Ge.jsx)("p",{className:"text-indigo-300 text-lg font-medium",children:"Loading wallet data..."})]}),(0,Ge.jsxs)("div",{className:"text-center mt-4",children:[(0,Ge.jsx)("p",{className:"text-gray-500 text-sm",children:"Taking too long?"}),(0,Ge.jsx)("button",{onClick:N,className:"mt-2 text-sm bg-gray-700 text-red-400 px-3 py-1.5 rounded hover:bg-gray-600",children:"Skip Loading"})]})]}):(0,Ge.jsxs)("div",{className:"py-4",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Ge.jsx)("h2",{className:"text-xl font-semibold text-indigo-300",children:"Wallet Transfers"}),(0,Ge.jsxs)("button",{onClick:T,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors flex items-center",children:[(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})}),"New Transfer"]})]}),g&&(0,Ge.jsx)("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-800 rounded-md",children:(0,Ge.jsxs)("div",{className:"flex items-start",children:[(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 mt-0.5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),(0,Ge.jsxs)("div",{className:"flex-1",children:[(0,Ge.jsx)("p",{className:"text-red-400 text-sm",children:g}),g.includes("NotFoundError")||g.includes("database")?(0,Ge.jsx)("button",{onClick:async()=>{if(window.confirm("This will refresh the page. Continue?"))try{window.location.reload()}catch(g){console.error("Error resetting:",g),c(!1)}},className:"mt-2 text-xs bg-red-800 text-red-200 px-3 py-1 rounded hover:bg-red-700 transition-colors",children:"Reset Database Schema"}):null]})]})}),0===i.length?(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-8 text-center border border-gray-700",children:[(0,Ge.jsx)("div",{className:"mx-auto w-16 h-16 bg-gray-700 rounded-full flex items-center justify-center mb-4",children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-indigo-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"})})}),(0,Ge.jsx)("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Transfer History"}),(0,Ge.jsx)("p",{className:"text-gray-400 mb-6",children:"Transfer money between your wallets to keep track of all your funds."}),(0,Ge.jsx)("button",{onClick:T,className:"px-6 py-3 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors",children:"Make Your First Transfer"})]}):(0,Ge.jsx)("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg",children:(0,Ge.jsx)("div",{className:"space-y-4",children:i.map((e=>{return(0,Ge.jsxs)("div",{className:"p-4 rounded-lg cursor-pointer transition-transform hover:scale-[1.01] hover:shadow-md bg-gray-700/80 border-l-4 border-indigo-500",onClick:()=>(e=>{y(e),j({fromWallet:e.fromWallet,toWallet:e.toWallet,amount:e.amount.toString(),date:e.date,notes:e.notes||"",photoUrl:e.photoUrl||""}),e.photoUrl?w(e.photoUrl):w(""),x(null),f(!0)})(e),children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsxs)("div",{className:"font-medium text-white",children:[e.fromWalletName||P(e.fromWallet)," \u2192 ",e.toWalletName||P(e.toWallet)]}),(0,Ge.jsx)("div",{className:"text-sm text-gray-400 mt-1",children:"Wallet Transfer"})]}),(0,Ge.jsx)("div",{className:"font-medium mr-3 text-indigo-400",children:D(e.amount)})]}),e.notes&&(0,Ge.jsxs)("div",{className:"text-sm text-gray-400 mt-2 bg-gray-800/50 p-2 rounded",children:[(0,Ge.jsx)("span",{className:"font-medium text-xs text-gray-500 block mb-1",children:"Notes:"}),e.notes]}),e.photoUrl&&(0,Ge.jsx)("div",{className:"mt-3",children:(0,Ge.jsx)("img",{src:e.photoUrl,alt:"Transfer receipt",className:"max-h-32 rounded-md object-cover"})}),(0,Ge.jsxs)("div",{className:"flex justify-between items-center mt-3",children:[(0,Ge.jsx)("div",{className:"flex flex-wrap gap-1",children:(0,Ge.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-900 text-indigo-300",children:"Transfer"})}),(0,Ge.jsx)("div",{className:"flex items-center",children:(0,Ge.jsx)("div",{className:"text-xs text-gray-500",children:(t=e.date,new Date(t).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"}))})})]})]},e.id);var t}))})}),(0,Ge.jsx)(qd,{isOpen:h,onClose:()=>f(!1),children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-lg w-full max-w-md flex flex-col h-[80vh]",children:[(0,Ge.jsx)("div",{className:"sticky top-0 left-0 right-0 px-6 py-4 bg-gray-800 border-b border-gray-700 z-10",children:(0,Ge.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ge.jsx)("h2",{className:"text-xl font-semibold text-indigo-300",children:m?"Edit Transfer":"New Transfer"}),(0,Ge.jsx)("button",{type:"button",className:"text-gray-400 hover:text-white p-2 rounded-full bg-gray-700 bg-opacity-50",onClick:()=>f(!1),children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,Ge.jsxs)("div",{className:"p-6 pt-2 flex-1 overflow-auto",children:[g&&(0,Ge.jsx)("div",{className:"mb-4 p-3 bg-red-900/50 border border-red-800 rounded-md",children:(0,Ge.jsx)("p",{className:"text-red-400 text-sm",children:g})}),(0,Ge.jsxs)("form",{onSubmit:A,children:[(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-300",children:"From Wallet"}),(0,Ge.jsxs)("select",{name:"fromWallet",value:k.fromWallet,onChange:C,className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0,children:[(0,Ge.jsx)("option",{value:"",disabled:!0,children:"Select source wallet"}),r.map((e=>(0,Ge.jsxs)("option",{value:e.id,children:[e.name," (",D(e.balance),")"]},"from-".concat(e.id))))]})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-300",children:"To Wallet"}),(0,Ge.jsxs)("select",{name:"toWallet",value:k.toWallet,onChange:C,className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0,children:[(0,Ge.jsx)("option",{value:"",disabled:!0,children:"Select destination wallet"}),r.map((e=>(0,Ge.jsx)("option",{value:e.id,children:e.name},"to-".concat(e.id))))]})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-300",children:"Amount"}),(0,Ge.jsx)("input",{type:"number",name:"amount",value:k.amount,onChange:C,className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"0",min:"0.01",step:"0.01",required:!0})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-300",children:"Date"}),(0,Ge.jsx)("input",{type:"date",name:"date",value:k.date,onChange:C,className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500"})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-300",children:"Notes (Optional)"}),(0,Ge.jsx)("textarea",{name:"notes",value:k.notes,onChange:C,className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 min-h-[80px]",placeholder:"Add any details about this transfer"})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block mb-2 font-medium text-gray-300",children:"Photo (Optional)"}),(0,Ge.jsx)("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-700 border-dashed rounded-md",children:(0,Ge.jsx)("div",{className:"space-y-1 text-center",children:v?(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("img",{src:v,alt:"Receipt preview",className:"mx-auto h-32 w-auto rounded"}),(0,Ge.jsx)("button",{type:"button",onClick:()=>{x(null),w(""),j((e=>(0,Oe.A)((0,Oe.A)({},e),{},{photoUrl:""})))},className:"mt-2 inline-flex items-center px-2.5 py-1.5 border border-gray-600 text-xs font-medium rounded text-red-300 bg-gray-800 hover:bg-gray-700",children:"Remove Image"})]}):(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-500",stroke:"currentColor",fill:"none",viewBox:"0 0 48 48",children:(0,Ge.jsx)("path",{d:"M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),(0,Ge.jsxs)("div",{className:"flex text-sm text-gray-400",children:[(0,Ge.jsxs)("label",{className:"relative cursor-pointer bg-gray-800 rounded-md font-medium text-indigo-300 hover:text-indigo-400",children:[(0,Ge.jsx)("span",{children:"Upload receipt"}),(0,Ge.jsx)("input",{type:"file",className:"sr-only",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t){x(t);const e=new FileReader;e.onloadend=()=>{w(e.result)},e.readAsDataURL(t)}}})]}),(0,Ge.jsx)("p",{className:"pl-1",children:"or drag and drop"})]}),(0,Ge.jsx)("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 10MB"})]})})})]}),(0,Ge.jsx)("div",{className:"pb-2"})]})]}),(0,Ge.jsx)("div",{className:"sticky bottom-0 left-0 right-0 px-6 py-4 bg-gray-800 border-t border-gray-700 shadow-lg",children:(0,Ge.jsxs)("div",{className:"flex justify-between items-center",children:[m&&(0,Ge.jsx)("button",{type:"button",onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this transfer?"))try{const s=i.find((t=>t.id===e));if(!s)return void(_.current&&p("Transfer not found."));const l=r.find((e=>e.id===s.fromWallet)),c=r.find((e=>e.id===s.toWallet));if(!l||!c){if(console.warn("One or both wallets no longer exist. Proceeding with transfer deletion anyway."),t&&S){await Le.transferDB.delete(e,S.id);const t=await Le.transferDB.getAll(S.id);_.current&&o(t.sort(((e,t)=>new Date(t.date)-new Date(e.date))))}else{const t=JSON.parse(localStorage.getItem("wallet-transfers")||"[]").filter((t=>t.id!==e));He("wallet-transfers",JSON.stringify(t)),_.current&&o(t.sort(((e,t)=>new Date(t.date)-new Date(e.date))))}return _.current&&m&&m.id===e&&(y(null),f(!1),j({fromWallet:"",toWallet:"",amount:"",date:(new Date).toISOString().slice(0,10),notes:"",photoUrl:""}),x(null),w("")),void(n&&n())}if(t&&S){const t=wr(S),n=await t.deleteWalletTransfer(e);if(console.log("Transfer deleted via WalletOperations:",n),_.current){const e=await Le.qF.getAll(S.id);a(e);const t=await Le.transferDB.getAll(S.id);o(t.sort(((e,t)=>new Date(t.date)-new Date(e.date))))}}else{const t=JSON.parse(localStorage.getItem("wallet-transfers")||"[]").filter((t=>t.id!==e));He("wallet-transfers",JSON.stringify(t));const n=JSON.parse(localStorage.getItem("wallets")||"[]"),r=n.findIndex((e=>e.id===s.fromWallet)),i=n.findIndex((e=>e.id===s.toWallet));-1!==r&&-1!==i&&(n[r].balance=_r.addToBalance(n[r].balance,s.amount),n[i].balance=_r.subtractFromBalance(n[i].balance,s.amount),He("wallets",JSON.stringify(n)),a(n)),_.current&&o(t.sort(((e,t)=>new Date(t.date)-new Date(e.date))))}n&&n(),_.current&&m&&m.id===e&&(y(null),f(!1),j({fromWallet:"",toWallet:"",amount:"",date:(new Date).toISOString().slice(0,10),notes:"",photoUrl:""}),x(null),w(""))}catch(g){if(console.error("Error deleting transfer:",g),_.current){p("Failed to delete transfer: ".concat(g.message,". The transfer record will be removed but wallet balances may need manual adjustment."));try{if(t&&S){const e=await Le.transferDB.getAll(S.id);o(e.sort(((e,t)=>new Date(t.date)-new Date(e.date))))}else{const t=JSON.parse(localStorage.getItem("wallet-transfers")||"[]").filter((t=>t.id!==e));He("wallet-transfers",JSON.stringify(t)),o(t.sort(((e,t)=>new Date(t.date)-new Date(e.date))))}}catch(s){console.error("Error refreshing transfers after failed delete:",s)}}}})(m.id),className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors duration-300",children:"Delete"}),!m&&(0,Ge.jsx)("div",{}),(0,Ge.jsxs)("div",{className:"flex gap-2",children:[(0,Ge.jsx)("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-colors duration-300",children:"Cancel"}),(0,Ge.jsx)("button",{type:"button",onClick:A,className:"px-4 py-2 text-white rounded-md transition-colors duration-300 bg-indigo-600 hover:bg-indigo-700",children:m?"Save Changes":"Complete Transfer"})]})]})})]})})]})};const Jd=function(e){let{activeTab:t,onChange:n}=e;return(0,Ge.jsx)("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-900 border-t border-gray-800 z-30 md:hidden",children:(0,Ge.jsxs)("div",{className:"grid grid-cols-5 max-w-lg mx-auto",children:[(0,Ge.jsxs)("button",{onClick:()=>n("home"),className:"flex flex-col items-center py-3 ".concat("home"===t?"text-indigo-400":"text-gray-500 hover:text-gray-300"),children:[(0,Ge.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),(0,Ge.jsx)("span",{className:"text-xs mt-1",children:"Home"})]}),(0,Ge.jsxs)("button",{onClick:()=>n("wallets"),className:"flex flex-col items-center py-3 ".concat("wallets"===t?"text-indigo-400":"text-gray-500 hover:text-gray-300"),children:[(0,Ge.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),(0,Ge.jsx)("span",{className:"text-xs mt-1",children:"Wallets"})]}),(0,Ge.jsxs)("button",{onClick:()=>n("transactions"),className:"flex flex-col items-center py-3 ".concat("transactions"===t?"text-indigo-400":"text-gray-500 hover:text-gray-300"),children:[(0,Ge.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),(0,Ge.jsx)("span",{className:"text-xs mt-1",children:"Transactions"})]}),(0,Ge.jsxs)("button",{onClick:()=>n("budgets"),className:"flex flex-col items-center py-3 ".concat("budgets"===t?"text-indigo-400":"text-gray-500 hover:text-gray-300"),children:[(0,Ge.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a1 1 0 01-2 2h-2a2 2 0 01-2-2z"})}),(0,Ge.jsx)("span",{className:"text-xs mt-1",children:"Budgets"})]}),(0,Ge.jsxs)("button",{onClick:()=>n("settings"),className:"flex flex-col items-center py-3 ".concat("settings"===t?"text-indigo-400":"text-gray-500 hover:text-gray-300"),children:[(0,Ge.jsxs)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),(0,Ge.jsx)("span",{className:"text-xs mt-1",children:"Settings"})]})]})})};const Kd=function(e){let{onClick:t}=e;return(0,Ge.jsx)("button",{className:"fixed right-6 bottom-24 md:bottom-8 w-14 h-14 rounded-full bg-indigo-600 hover:bg-indigo-700 text-white shadow-lg flex items-center justify-center z-40 transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:ring-opacity-50",onClick:t,"aria-label":"Add new expense",children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})},Yd=e=>{let{className:t=""}=e;const{user:n}=Qe(),[r,a]=(0,s.useState)(null),[i,o]=(0,s.useState)(navigator.onLine),[l,c]=(0,s.useState)(!1),[d,u]=(0,s.useState)(null),[h,f]=(0,s.useState)(null),[g,p]=(0,s.useState)(!1);(0,s.useEffect)((()=>{const e=()=>o(!0),t=()=>o(!1);return window.addEventListener("online",e),window.addEventListener("offline",t),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}}),[]),(0,s.useEffect)((()=>{const e=()=>{const e=Ye();if(e){const t=e.getSyncStatus();a(t),c(t.inProgress),u(t.lastSync),f(t.errors.length>0?t.errors[t.errors.length-1]:null),p(!!t.processingQueue)}};e();const t=setInterval(e,5e3);return()=>clearInterval(t)}),[n]);const m=g?{icon:"\u23f3",color:"text-blue-600",bgColor:"bg-blue-100",text:"Processing queue..."}:i?l?{icon:"\ud83d\udd04",color:"text-blue-600",bgColor:"bg-blue-100",text:"Syncing..."}:h?{icon:"\u26a0\ufe0f",color:"text-red-600",bgColor:"bg-red-100",text:"Sync Error"}:null!==r&&void 0!==r&&r.hasLocalChanges?{icon:"\ud83d\udce4",color:"text-yellow-600",bgColor:"bg-yellow-100",text:"Pending"}:{icon:"\u2705",color:"text-green-600",bgColor:"bg-green-100",text:"Synced"}:{icon:"\ud83d\udcf4",color:"text-gray-500",bgColor:"bg-gray-100",text:"Offline"};return(0,Ge.jsxs)("div",{className:"flex items-center space-x-2 ".concat(t),children:[(0,Ge.jsxs)("div",{className:"flex items-center space-x-1 px-2 py-1 rounded-full text-xs font-medium ".concat(m.color," ").concat(m.bgColor),title:"Last sync: ".concat((e=>{if(!e)return"Never";const t=new Date(e),n=new Date-t,r=Math.floor(n/6e4),s=Math.floor(n/36e5),a=Math.floor(n/864e5);return r<1?"Just now":r<60?"".concat(r,"m ago"):s<24?"".concat(s,"h ago"):"".concat(a,"d ago")})(d)),children:[(0,Ge.jsx)("span",{className:l||g?"animate-spin":"",children:m.icon}),(0,Ge.jsx)("span",{className:"hidden sm:inline",children:m.text})]}),i&&!l&&(0,Ge.jsx)("button",{onClick:async()=>{if(!n||l||!i)return;const e=Ye();if(e){c(!0),f(null);try{await e.fullSync("bidirectional"),console.log("Manual sync completed successfully")}catch(t){console.error("Manual sync failed:",t),f({message:t.message,timestamp:(new Date).toISOString()})}finally{c(!1)}}},className:"p-1 text-gray-500 hover:text-gray-700 transition-colors",title:"Manual sync",children:(0,Ge.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),h&&(0,Ge.jsx)("div",{className:"text-xs text-red-600 max-w-xs truncate",title:h.message,children:h.message})]})},Gd=["children","href","current","className","onClick"];function $d(e){let{children:t,href:n,current:r=!1,className:s="",onClick:a}=e,i=lt(e,Gd);const o="py-2 px-3 rounded-md flex items-center gap-2 text-sm font-medium transition-colors duration-200",l=r?"bg-indigo-600 text-white hover:bg-indigo-700":"text-gray-300 hover:bg-gray-800 hover:text-white";return n?(0,Ge.jsx)("a",(0,Oe.A)((0,Oe.A)({href:n,className:"".concat(o," ").concat(l," ").concat(s)},i),{},{children:t})):(0,Ge.jsx)("button",(0,Oe.A)((0,Oe.A)({className:"".concat(o," ").concat(l," ").concat(s),onClick:a,type:"button"},i),{},{children:t}))}const Qd=e=>{let{user:t,signOut:n,activeTab:r,setActiveTab:a,setIsModalOpen:i,hasUnsavedChanges:o=!1,className:l=""}=e;const[c,d]=(0,s.useState)(!1),u=(0,s.useRef)(null);(0,s.useEffect)((()=>{const e=e=>{u.current&&!u.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const h=()=>null!==t&&void 0!==t&&t.email?t.email.split("@")[0]:"User";return(0,Ge.jsx)("nav",{className:"fixed top-0 left-0 right-0 z-30 bg-gray-900 border-b border-gray-800 px-4 py-3 ".concat(l),children:(0,Ge.jsxs)("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[(0,Ge.jsxs)("div",{className:"flex items-center",children:[(0,Ge.jsx)("h1",{className:"text-xl font-bold text-indigo-400",children:"ExpenseTracker"}),o&&(0,Ge.jsxs)("div",{className:"ml-3 flex items-center",children:[(0,Ge.jsx)("div",{className:"h-2 w-2 bg-yellow-500 rounded-full animate-pulse"}),(0,Ge.jsx)("span",{className:"ml-1 text-xs text-yellow-500 hidden sm:inline",children:"Unsaved changes"})]})]}),(0,Ge.jsxs)("div",{className:"hidden md:flex items-center space-x-1",children:[(0,Ge.jsxs)($d,{current:"home"===r,onClick:()=>a("home"),children:[(0,Ge.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Home"]}),(0,Ge.jsxs)($d,{current:"wallets"===r,onClick:()=>a("wallets"),children:[(0,Ge.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),"Wallets"]}),(0,Ge.jsxs)($d,{current:"transactions"===r,onClick:()=>a("transactions"),children:[(0,Ge.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),"Transactions"]}),(0,Ge.jsxs)($d,{current:"budgets"===r,onClick:()=>a("budgets"),children:[(0,Ge.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a1 1 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Budgets"]})]}),(0,Ge.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,Ge.jsx)(Yd,{}),(0,Ge.jsxs)("button",{onClick:()=>i(!0),className:"hidden md:flex items-center px-3 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors duration-200 text-sm font-medium",children:[(0,Ge.jsx)("svg",{className:"h-4 w-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add"]}),(0,Ge.jsxs)("div",{className:"relative",ref:u,children:[(0,Ge.jsxs)("button",{onClick:()=>d(!c),className:"flex items-center space-x-2 px-3 py-2 rounded-md text-gray-300 hover:bg-gray-800 hover:text-white transition-colors duration-200",children:[(0,Ge.jsx)("div",{className:"h-8 w-8 bg-indigo-600 rounded-full flex items-center justify-center text-white text-sm font-medium",children:h().charAt(0).toUpperCase()}),(0,Ge.jsx)("span",{className:"hidden md:block text-sm font-medium",children:h()}),(0,Ge.jsx)("svg",{className:"h-4 w-4 transition-transform duration-200 ".concat(c?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),c&&(0,Ge.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-gray-800 border border-gray-700 rounded-md shadow-lg py-1 z-50",children:[(0,Ge.jsxs)("div",{className:"px-4 py-2 border-b border-gray-700",children:[(0,Ge.jsx)("p",{className:"text-sm font-medium text-white",children:h()}),(0,Ge.jsx)("p",{className:"text-xs text-gray-400",children:null===t||void 0===t?void 0:t.email})]}),(0,Ge.jsxs)("button",{onClick:()=>{a("settings"),d(!1)},className:"w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white flex items-center",children:[(0,Ge.jsxs)("svg",{className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),"Settings"]}),(0,Ge.jsxs)("button",{onClick:()=>window.open("https://tally.so/r/3158k4","_blank"),className:"w-full text-left px-4 py-2 text-sm text-gray-300 hover:bg-gray-700 hover:text-white flex items-center",children:[(0,Ge.jsx)("svg",{className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})}),"Report Bug"]}),(0,Ge.jsxs)("button",{onClick:async()=>{try{await n(),d(!1)}catch(e){console.error("Error signing out:",e)}},className:"w-full text-left px-4 py-2 text-sm text-red-400 hover:bg-gray-700 hover:text-red-300 flex items-center",children:[(0,Ge.jsx)("svg",{className:"h-4 w-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),"Sign Out"]})]})]})]})]})})};const Xd=[{id:"cash",name:"Cash"},{id:"bank",name:"Bank Account"},{id:"credit_card",name:"Credit Card"},{id:"e_wallet",name:"E-Wallet"},{id:"savings",name:"Savings Account"}];const Zd=function(e){let{dbInitialized:t=!1,refresh:n=0}=e;const[r,a]=(0,s.useState)([]),[i,o]=(0,s.useState)(!0),[l,c]=(0,s.useState)({id:"",name:"",type:Xd[0].id,balance:0}),[d,u]=(0,s.useState)(null),[h,f]=(0,s.useState)(!1),{user:g}=Qe(),{showError:p,showWarning:m}=pt();(0,s.useEffect)((()=>{y()}),[t,g,n]);const y=async()=>{o(!0);try{let e=[];e=t&&g?await Le.qF.getAll(g.id):JSON.parse(localStorage.getItem("wallets")||"[]"),a(e)}catch(pu){console.error("Error loading wallets:",pu),a([])}finally{o(!1)}},b=e=>{const{name:t,value:n}=e.target;c((0,Oe.A)((0,Oe.A)({},l),{},{[t]:n}))},x=()=>{c({id:"",name:"",type:Xd[0].id,balance:0}),u(null)},v=()=>{x(),f(!1)},w=e=>{const t=JSON.parse(localStorage.getItem("wallets")||"[]");t.push(e),He("wallets",JSON.stringify(t))},_=e=>{let t=JSON.parse(localStorage.getItem("wallets")||"[]");t=t.map((t=>t.id===e.id?e:t)),He("wallets",JSON.stringify(t))},S=e=>{let t=JSON.parse(localStorage.getItem("wallets")||"[]");t=t.filter((t=>t.id!==e)),He("wallets",JSON.stringify(t))},k=(0,Ge.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg",children:[(0,Ge.jsx)("h2",{className:"text-xl font-semibold mb-4 text-indigo-300",children:d?"Edit Wallet":"Add New Wallet"}),(0,Ge.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!l.name.trim())return;const n=(0,Oe.A)((0,Oe.A)({},l),{},{id:d||l.id||Date.now().toString(),balance:_r.formatBalance(l.balance||0)});try{d?t&&g?await Le.qF.update(n,g.id):_(n):t&&g?await Le.qF.add(n,g.id):w(n),x(),f(!1),y()}catch(r){p("Error saving wallet")}},children:[(0,Ge.jsxs)("div",{className:"mb-3",children:[(0,Ge.jsx)("label",{className:"block mb-1 text-gray-200",children:"Name"}),(0,Ge.jsx)("input",{type:"text",name:"name",value:l.name,onChange:b,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",required:!0})]}),(0,Ge.jsxs)("div",{className:"mb-3",children:[(0,Ge.jsx)("label",{htmlFor:"wallet-type-select",className:"block mb-1 text-gray-200",children:"Type"}),(0,Ge.jsx)(at,{id:"wallet-type-select",name:"type",options:Xd,displayValue:e=>null===e||void 0===e?void 0:e.name,defaultValue:Xd.find((e=>e.id===l.type)),onChange:e=>{const t=null!==e&&void 0!==e&&e.target?e.target.value:e;t&&t.id?c((0,Oe.A)((0,Oe.A)({},l),{},{type:t.id})):console.error("Invalid type selected:",t)},"aria-label":"Select wallet type",children:e=>(0,Ge.jsx)(ot,{value:e,children:e.name})})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block mb-1 text-gray-200",children:"Balance"}),(0,Ge.jsx)("input",{type:"number",name:"balance",value:l.balance,onChange:b,className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500",step:"0.01",min:"0"})]}),(0,Ge.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,Ge.jsx)("button",{type:"button",onClick:v,className:"px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700",children:"Cancel"}),(0,Ge.jsx)("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700",children:d?"Update Wallet":"Add Wallet"})]})]})]});return(0,Ge.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg mx-auto",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,Ge.jsx)("h2",{className:"text-xl font-semibold text-indigo-300",children:"Wallets"}),(0,Ge.jsxs)("button",{onClick:()=>{x(),f(!0)},className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 flex items-center",children:[(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})}),"Add Wallet"]})]}),(0,Ge.jsx)("div",{children:i?(0,Ge.jsx)("div",{className:"text-indigo-300",children:"Loading..."}):0===r.length?(0,Ge.jsxs)("div",{className:"text-gray-400 py-8 text-center",children:[(0,Ge.jsx)("div",{className:"text-indigo-400 mb-2",children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),(0,Ge.jsx)("p",{children:"No wallets found. Add one to get started!"})]}):(0,Ge.jsx)("ul",{className:"space-y-3",children:r.map((e=>{var n,r;return(0,Ge.jsxs)("li",{className:"flex items-center justify-between p-3 bg-gray-700 rounded-lg",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("div",{className:"font-medium text-white",children:e.name}),(0,Ge.jsx)("div",{className:"text-sm text-gray-400",children:(null===(n=Xd.find((t=>t.id===e.type)))||void 0===n?void 0:n.name)||e.type}),(0,Ge.jsxs)("div",{className:"text-sm text-indigo-300",children:["Balance: Rp",(r=e.balance,_r.formatBalance(r))]})]}),(0,Ge.jsxs)("div",{className:"flex gap-2",children:[(0,Ge.jsx)("button",{onClick:()=>(e=>{c(e),u(e.id),f(!0)})(e),className:"px-3 py-1 bg-gray-600 text-indigo-300 rounded hover:bg-gray-500",children:"Edit"}),(0,Ge.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Delete this wallet?"))try{t&&g?await Le.qF.delete(e,g.id):S(e),y()}catch(n){p("Error deleting wallet")}})(e.id),className:"px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700",children:"Delete"})]})]},e.id)}))})}),(0,Ge.jsxs)("div",{className:"mt-8 pt-4 border-t border-gray-700",children:[(0,Ge.jsx)("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Troubleshooting"}),(0,Ge.jsx)("div",{className:"text-xs text-gray-500 mb-2",children:"If you're experiencing database errors, try refreshing the page or clearing your browser cache."}),(0,Ge.jsx)("button",{onClick:async()=>{if(window.confirm("This will reset the database and reload the page. All data will be preserved but this helps fix database errors. Continue?"))try{window.location.reload()}catch(e){m("Failed to reset database. Please try manually clearing site data in your browser settings.")}},className:"px-4 py-2 text-sm bg-gray-700 text-red-400 rounded hover:bg-gray-600",children:"Refresh Data"})]}),(0,Ge.jsx)(qd,{isOpen:h,onClose:v,children:k})]})},eu=e=>new Intl.NumberFormat("id-ID").format(e);const tu=function(e){let{dbInitialized:t=!1,refresh:n=0}=e;const[r,a]=(0,s.useState)([]),[i,o]=(0,s.useState)(!0),[l,c]=(0,s.useState)(0),{user:d}=Qe();(0,s.useEffect)((()=>{u()}),[t,n,d]);const u=async()=>{o(!0);try{let e=[];e=t&&d?await Le.qF.getAll(d.id):JSON.parse(localStorage.getItem("wallets")||"[]"),a(e);const n=e.reduce(((e,t)=>e+parseFloat(t.balance||0)),0);c(n)}catch(pu){console.error("Error loading wallets:",pu),a([]),c(0)}finally{o(!1)}},h=e=>e>0?"text-green-400":e<0?"text-red-400":"text-gray-400",f=e=>{switch(e){case"cash":return(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 00-2 2v4a2 2 0 002 2V6h10a2 2 0 00-2-2H4zm2 6a2 2 0 012-2h8a2 2 0 012 2v4a2 2 0 01-2 2H8a2 2 0 01-2-2v-4zm6 4a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})});case"bank":return(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M10.496 2.132a1 1 0 00-.992 0l-7 4A1 1 0 003 8v7a1 1 0 001 1h12a1 1 0 001-1V8a1 1 0 00.496-1.868l-7-4zM6 9a1 1 0 00-1 1v3a1 1 0 102 0v-3a1 1 0 00-1-1zm3 1a1 1 0 012 0v3a1 1 0 11-2 0v-3zm5-1a1 1 0 00-1 1v3a1 1 0 102 0v-3a1 1 0 00-1-1z",clipRule:"evenodd"})});case"credit_card":return(0,Ge.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[(0,Ge.jsx)("path",{d:"M4 4a2 2 0 00-2 2v1h16V6a2 2 0 00-2-2H4z"}),(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M18 9H2v5a2 2 0 002 2h12a2 2 0 002-2V9zM4 13a1 1 0 011-1h1a1 1 0 110 2H5a1 1 0 01-1-1zm5-1a1 1 0 100 2h1a1 1 0 100-2H9z",clipRule:"evenodd"})]});case"e_wallet":return(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M3 5a2 2 0 012-2h10a2 2 0 012 2v8a2 2 0 01-2 2h-2.22l.123.489.804.804A1 1 0 0113 18H7a1 1 0 01-.707-1.707l.804-.804L7.22 15H5a2 2 0 01-2-2V5zm5.771 7H5V5h10v7H8.771z",clipRule:"evenodd"})});default:return(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M10 2a4 4 0 00-4 4v1H5a1 1 0 00-.994.89l-1 9A1 1 0 004 18h12a1 1 0 00.994-1.11l-1-9A1 1 0 0015 7h-1V6a4 4 0 00-4-4zm2 5V6a2 2 0 10-4 0v1h4zm-6 3a1 1 0 112 0 1 1 0 01-2 0zm7-1a1 1 0 100 2 1 1 0 000-2z",clipRule:"evenodd"})})}};return i?(0,Ge.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg mb-6 animate-pulse",children:[(0,Ge.jsx)("div",{className:"h-6 bg-gray-700 rounded w-1/4 mb-4"}),(0,Ge.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,Ge.jsx)("div",{className:"h-20 bg-gray-700 rounded"}),(0,Ge.jsx)("div",{className:"h-20 bg-gray-700 rounded"})]})]}):0===r.length?(0,Ge.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg mb-6",children:[(0,Ge.jsx)("h2",{className:"text-xl font-semibold mb-4 text-indigo-300",children:"Wallet Balances"}),(0,Ge.jsx)("p",{className:"text-gray-400",children:"No wallets found. Go to the Wallets tab to add one!"})]}):(0,Ge.jsxs)("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg mb-4 mt-4",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Ge.jsx)("h2",{className:"text-xl font-semibold text-indigo-300",children:"Wallet Balances"}),(0,Ge.jsxs)("div",{className:"text-xl font-bold ".concat(h(l)),children:["Rp ",eu(l)]})]}),(0,Ge.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map((e=>(0,Ge.jsxs)("div",{className:"flex items-center p-3 bg-gray-700 rounded-lg",children:[(0,Ge.jsx)("div",{className:"text-indigo-400 mr-3",children:f(e.type)}),(0,Ge.jsxs)("div",{className:"flex-grow",children:[(0,Ge.jsx)("div",{className:"font-medium text-white",children:e.name}),(0,Ge.jsx)("div",{className:"text-xs text-gray-400",children:"bank"===e.type?"Bank Account":"credit_card"===e.type?"Credit Card":"e_wallet"===e.type?"E-Wallet":"Cash"})]}),(0,Ge.jsxs)("div",{className:"text-lg font-semibold ".concat(h(e.balance)),children:["Rp ",eu(e.balance)]})]},e.id)))})]})};const nu=function(e){let{isOpen:t,onClose:n,onApply:r,initialFilters:a,initialSort:i,availableCategories:o=[],availableTags:l=[],availableWallets:c=[]}=e;const[d,u]=(0,s.useState)(a),[h,f]=(0,s.useState)(i),[g,p]=(0,s.useState)([]),[m,y]=(0,s.useState)([]),[b,x]=(0,s.useState)([]);(0,s.useEffect)((()=>{a&&(a.walletId&&"all"!==a.walletId?p(Array.isArray(a.walletId)?a.walletId:[a.walletId]):p([]),a.categoryId&&"all"!==a.categoryId?y(Array.isArray(a.categoryId)?a.categoryId:[a.categoryId]):y([]),x(a.tags||[]))}),[a]),(0,s.useEffect)((()=>{u(a),f(i)}),[a,i]);const v=(e,t)=>{u((n=>(0,Oe.A)((0,Oe.A)({},n),{},{[e]:t})))},w=e=>{let t;"all"===e?(t=[],p(t)):(t=g.includes(e)?g.filter((t=>t!==e)):[...g,e],p(t)),v("walletId",t.length>0?t:"all")},_=e=>{let t;"all"===e?(t=[],y(t)):(t=m.includes(e)?m.filter((t=>t!==e)):[...m,e],y(t)),v("categoryId",t.length>0?t:"all")},S=[{id:"date_desc",name:"Newest to Oldest"},{id:"date_asc",name:"Oldest to Newest"},{id:"amount_desc",name:"Highest to Lowest Amount"},{id:"amount_asc",name:"Lowest to Highest Amount"}],[k,j]=(0,s.useState)(null),N=e=>{if(!e)return"";return("string"===typeof e?new Date(e):e).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})};(0,s.useEffect)((()=>{const e=e=>{k&&!e.target.closest(".date-picker-container")&&j(null)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[k]);const E=e=>e?ut(e.color):"gray",C=e=>e.color||"gray";return(0,Ge.jsx)(qd,{isOpen:t,onClose:n,children:(0,Ge.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-lg mx-4",children:[(0,Ge.jsx)("div",{className:"sticky top-0 left-0 right-0 px-6 py-4 bg-gray-800 border-b border-gray-700 z-10",children:(0,Ge.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white",children:"Filter & Sort"}),(0,Ge.jsx)("button",{type:"button",className:"text-gray-400 hover:text-white p-2 rounded-full bg-gray-700 bg-opacity-50",onClick:n,children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,Ge.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-3",children:[(0,Ge.jsx)("h4",{className:"text-md font-medium text-white",children:"Filter by:"}),(0,Ge.jsx)("button",{type:"button",className:"text-xs px-2 py-1 text-indigo-300 hover:text-indigo-100 transition-colors",onClick:()=>{u({type:"all",walletId:"all",categoryId:"all",tags:[],dateRange:"all",startDate:"",endDate:""}),p([]),y([]),x([]),j(null)},children:"Reset Filters"})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block text-gray-300 mb-2",children:"Type"}),(0,Ge.jsxs)("div",{className:"flex bg-gray-700 rounded-md p-1",children:[(0,Ge.jsx)("button",{type:"button",className:"flex-1 py-2 px-4 rounded ".concat("all"===d.type?"bg-indigo-600 text-white":"text-gray-300"),onClick:()=>v("type","all"),children:"All"}),(0,Ge.jsx)("button",{type:"button",className:"flex-1 py-2 px-4 rounded ".concat("expense"===d.type?"bg-indigo-600 text-white":"text-gray-300"),onClick:()=>v("type","expense"),children:"Expense"}),(0,Ge.jsx)("button",{type:"button",className:"flex-1 py-2 px-4 rounded ".concat("income"===d.type?"bg-green-600 text-white":"text-gray-300"),onClick:()=>v("type","income"),children:"Income"})]})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block text-gray-300 mb-2",children:"Date Range"}),(0,Ge.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,Ge.jsxs)("div",{className:"relative",children:[(0,Ge.jsx)("label",{htmlFor:"startDate",className:"block mb-2 text-sm text-gray-300",children:"Start Date"}),(0,Ge.jsx)("input",{type:"text",id:"startDate",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer",placeholder:"Select date",readOnly:!0,value:d.startDate?N(d.startDate):"",onClick:()=>j("start")}),"start"===k&&(0,Ge.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 date-picker-container",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Ge.jsx)("h4",{className:"text-lg font-medium text-white",children:"Select Start Date"}),(0,Ge.jsx)("button",{type:"button",className:"text-gray-400 hover:text-white p-2 rounded-full",onClick:()=>j(null),children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ge.jsx)(_t,{value:{start:d.startDate?new Date(d.startDate):null,end:null},onChange:e=>{u((t=>(0,Oe.A)((0,Oe.A)({},t),{},{startDate:e.start,dateRange:"custom"}))),j(null)},onClose:()=>j(null),isSingleDatePicker:!0,pickerLabel:"Select Start Date"})]})})]}),(0,Ge.jsxs)("div",{className:"relative",children:[(0,Ge.jsx)("label",{htmlFor:"endDate",className:"block mb-2 text-sm text-gray-300",children:"End Date"}),(0,Ge.jsx)("input",{type:"text",id:"endDate",className:"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer",placeholder:"Select date",readOnly:!0,value:d.endDate?N(d.endDate):"",onClick:()=>j("end")}),"end"===k&&(0,Ge.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 date-picker-container",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Ge.jsx)("h4",{className:"text-lg font-medium text-white",children:"Select End Date"}),(0,Ge.jsx)("button",{type:"button",className:"text-gray-400 hover:text-white p-2 rounded-full",onClick:()=>j(null),children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,Ge.jsx)(_t,{value:{start:null,end:d.endDate?new Date(d.endDate):null},onChange:e=>{u((t=>(0,Oe.A)((0,Oe.A)({},t),{},{endDate:e.end||e.start,dateRange:"custom"}))),j(null)},onClose:()=>j(null),isSingleDatePicker:!0,pickerLabel:"Select End Date"})]})})]})]})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block text-gray-300 mb-2",children:"Wallet"}),(0,Ge.jsx)("div",{className:"bg-gray-700 rounded-md py-2 px-1",children:(0,Ge.jsxs)("div",{className:"flex flex-wrap gap-2 mb-2",children:[(0,Ge.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-md text-xs font-medium cursor-pointer hover:bg-gray-600\n                        ".concat(0===g.length?"bg-indigo-600 text-white":"text-gray-300 bg-gray-800"),onClick:()=>w("all"),children:"All Wallets"}),c.map((e=>(0,Ge.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-md text-xs font-medium cursor-pointer hover:bg-gray-600\n                          ".concat(g.includes(e.id)?"bg-indigo-600 text-white":"text-gray-300 bg-gray-800"),onClick:()=>w(e.id),children:e.name},e.id)))]})})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block text-gray-300 mb-2",children:"Category"}),(0,Ge.jsx)("div",{className:"bg-gray-700 rounded-md py-2 px-1",children:(0,Ge.jsxs)("div",{className:"flex flex-wrap gap-2 mb-2",children:[(0,Ge.jsx)(gt,{color:"gray",className:0===m.length?"ring-2 ring-offset-2 ring-offset-gray-800 ring-indigo-500":"",onClick:()=>_("all"),children:"All Categories"}),o.map((e=>(0,Ge.jsx)(gt,{color:E(e),className:m.includes(e.id)?"ring-2 ring-offset-2 ring-offset-gray-800 ring-indigo-500":"",onClick:()=>_(e.id),children:e.name},e.id)))]})})]}),(0,Ge.jsxs)("div",{className:"mb-4",children:[(0,Ge.jsx)("label",{className:"block text-gray-300 mb-2",children:"Tags"}),(0,Ge.jsxs)("div",{className:"bg-gray-700 rounded-md py-2 px-1",children:[(0,Ge.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:l.map((e=>(0,Ge.jsx)(gt,{color:C(e),className:b.includes(e.id)?"ring-2 ring-offset-2 ring-offset-gray-800 ring-indigo-500":"",onClick:()=>{const t=b.includes(e.id)?b.filter((t=>t!==e.id)):[...b,e.id];var n;x(n=t),v("tags",n)},children:e.name},e.id)))}),0===l.length&&(0,Ge.jsx)("p",{className:"text-gray-500 text-xs px-2",children:"No tags available"})]})]})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("label",{htmlFor:"sort",className:"block text-gray-300 mb-2",children:"Sort by:"}),(0,Ge.jsx)(at,{name:"sort",options:S,displayValue:e=>e.name,defaultValue:S.find((e=>{const[t,n]=e.id.split("_");return h.field===t&&h.order===n})),onChange:e=>{const t=null!==e&&void 0!==e&&e.target?e.target.value:e;t&&t.id&&(e=>{const[t,n]=e.split("_");f({field:t,order:n})})(t.id)},"aria-label":"Sort Options"})]})]}),(0,Ge.jsx)("div",{className:"sticky bottom-0 left-0 right-0 px-6 py-4 bg-gray-800 border-t border-gray-700 shadow-lg",children:(0,Ge.jsx)("button",{type:"button",className:"w-full px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 transition-colors duration-300",onClick:()=>{r(d,h),n()},children:"Apply Filters & Sort"})})]})})})};const ru=function(e){let{expenses:t,deleteExpense:n,updateExpense:r,dbInitialized:a}=e;const{user:i}=Qe(),[o,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)({type:"all",walletId:"all",categoryId:"all",tags:[],dateRange:"all",startDate:"",endDate:""}),[u,h]=(0,s.useState)({field:"date",order:"desc"}),[f,g]=(0,s.useState)([]),[p,m]=(0,s.useState)([]),[y,b]=(0,s.useState)([]),[x,v]=(0,s.useState)([]);return(0,s.useEffect)((()=>{(async()=>{try{if(a&&i){const e=await Le.T0.getAll(i.id);g(e);const t=await Le.d6.getAll(i.id);m(t);const n=await Le.qF.getAll(i.id);b(n)}else{const e=localStorage.getItem("expense-categories");e&&g(JSON.parse(e));const t=localStorage.getItem("expense-tags");t&&m(JSON.parse(t));const n=localStorage.getItem("wallets");n&&b(JSON.parse(n))}}catch(e){console.error("Error loading filter data:",e)}})()}),[a,i]),(0,s.useEffect)((()=>{let e=t;if("all"!==c.type&&(e=e.filter((e=>"income"===c.type?e.isIncome:!e.isIncome))),"all"!==c.walletId&&(e=e.filter((e=>e.walletId===c.walletId))),"all"!==c.categoryId&&(e=e.filter((e=>e.category===c.categoryId))),"all"!==c.dateRange){const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());e=e.filter((e=>{const t=new Date(e.date);switch(t.setHours(0,0,0,0),c.dateRange){case"today":return t.getTime()===n.getTime();case"thisWeek":const e=new Date(n);e.setDate(n.getDate()-n.getDay());const r=new Date(n);return r.setDate(n.getDate()+(6-n.getDay())),t>=e&&t<=r;case"thisMonth":const s=new Date(n.getFullYear(),n.getMonth(),1),a=new Date(n.getFullYear(),n.getMonth()+1,0);return t>=s&&t<=a;default:return!0}}))}const n=[...e].sort(((e,t)=>{const n="amount"===u.field?parseFloat(e.amount):new Date(e.date),r="amount"===u.field?parseFloat(t.amount):new Date(t.date);return"asc"===u.order?n<r?-1:n>r?1:0:n>r?-1:n<r?1:0}));v(n)}),[t,c,u]),(0,Ge.jsxs)("div",{className:"transaction-list-page",children:[(0,Ge.jsxs)("div",{className:"flex justify-between items-center mb-4 mt-4",children:[(0,Ge.jsx)("h2",{className:"text-xl font-semibold text-indigo-300",children:"Transaction History"}),(0,Ge.jsxs)("button",{onClick:()=>l(!0),className:"px-4 py-2 bg-gray-700 text-white rounded-md hover:bg-gray-600 transition-colors flex items-center",children:[(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:(0,Ge.jsx)("path",{fillRule:"evenodd",d:"M3 3a1 1 0 011-1h12a1 1 0 011 1v3a1 1 0 01-.293.707L12 11.414V15a1 1 0 01-.293.707l-2 2A1 1 0 018 17v-5.586L3.293 6.707A1 1 0 013 6V3z",clipRule:"evenodd"})}),"Filter & Sort"]})]}),(0,Ge.jsx)(Lt,{expenses:x,deleteExpense:n,updateExpense:r,dbInitialized:a}),(0,Ge.jsx)(nu,{isOpen:o,onClose:()=>l(!1),onApply:(e,t)=>{d(e),h(t),l(!1)},initialFilters:c,initialSort:u,availableCategories:f,availableTags:p,availableWallets:y})]})},su=e=>{let{error:t,onClose:n}=e;const[r,a]=(0,s.useState)(!1),{showSuccess:i}=pt(),o='-- Create expenses table\nCREATE TABLE expenses (\n  id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,\n  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,\n  amount DECIMAL(12, 2) NOT NULL,\n  description TEXT,\n  category TEXT,\n  date DATE NOT NULL,\n  walletId TEXT NOT NULL,\n  isIncome BOOLEAN DEFAULT FALSE,\n  notes TEXT,\n  photoUrl TEXT,\n  tags TEXT[] DEFAULT \'{}\',\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Create categories table\nCREATE TABLE categories (\n  id TEXT PRIMARY KEY,\n  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,\n  name TEXT NOT NULL,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Create tags table\nCREATE TABLE tags (\n  id TEXT PRIMARY KEY,\n  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,\n  name TEXT NOT NULL,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Create wallets table\nCREATE TABLE wallets (\n  id TEXT PRIMARY KEY,\n  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,\n  name TEXT NOT NULL,\n  type TEXT NOT NULL,\n  balance DECIMAL(12, 2) DEFAULT 0,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Create transfers table\nCREATE TABLE transfers (\n  id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,\n  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,\n  fromWallet TEXT NOT NULL,\n  fromWalletName TEXT,\n  toWallet TEXT NOT NULL,\n  toWalletName TEXT,\n  amount DECIMAL(12, 2) NOT NULL,\n  date DATE NOT NULL,\n  notes TEXT,\n  photoUrl TEXT,\n  timestamp TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Create budgets table\nCREATE TABLE budgets (\n  id BIGINT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,\n  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,\n  category TEXT NOT NULL,\n  amount DECIMAL(12, 2) NOT NULL,\n  period TEXT NOT NULL,\n  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),\n  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()\n);\n\n-- Add row-level security (RLS) policies\nALTER TABLE expenses ENABLE ROW LEVEL SECURITY;\nCREATE POLICY "Users can view their own expenses" ON expenses FOR SELECT USING (auth.uid() = user_id);\nCREATE POLICY "Users can insert their own expenses" ON expenses FOR INSERT WITH CHECK (auth.uid() = user_id);\nCREATE POLICY "Users can update their own expenses" ON expenses FOR UPDATE USING (auth.uid() = user_id);\nCREATE POLICY "Users can delete their own expenses" ON expenses FOR DELETE USING (auth.uid() = user_id);\n\nALTER TABLE categories ENABLE ROW LEVEL SECURITY;\nCREATE POLICY "Users can view their own categories" ON categories FOR SELECT USING (auth.uid() = user_id);\nCREATE POLICY "Users can insert their own categories" ON categories FOR INSERT WITH CHECK (auth.uid() = user_id);\nCREATE POLICY "Users can update their own categories" ON categories FOR UPDATE USING (auth.uid() = user_id);\nCREATE POLICY "Users can delete their own categories" ON categories FOR DELETE USING (auth.uid() = user_id);\n\nALTER TABLE tags ENABLE ROW LEVEL SECURITY;\nCREATE POLICY "Users can view their own tags" ON tags FOR SELECT USING (auth.uid() = user_id);\nCREATE POLICY "Users can insert their own tags" ON tags FOR INSERT WITH CHECK (auth.uid() = user_id);\nCREATE POLICY "Users can update their own tags" ON tags FOR UPDATE USING (auth.uid() = user_id);\nCREATE POLICY "Users can delete their own tags" ON tags FOR DELETE USING (auth.uid() = user_id);\n\nALTER TABLE wallets ENABLE ROW LEVEL SECURITY;\nCREATE POLICY "Users can view their own wallets" ON wallets FOR SELECT USING (auth.uid() = user_id);\nCREATE POLICY "Users can insert their own wallets" ON wallets FOR INSERT WITH CHECK (auth.uid() = user_id);\nCREATE POLICY "Users can update their own wallets" ON wallets FOR UPDATE USING (auth.uid() = user_id);\nCREATE POLICY "Users can delete their own wallets" ON wallets FOR DELETE USING (auth.uid() = user_id);\n\nALTER TABLE transfers ENABLE ROW LEVEL SECURITY;\nCREATE POLICY "Users can view their own transfers" ON transfers FOR SELECT USING (auth.uid() = user_id);\nCREATE POLICY "Users can insert their own transfers" ON transfers FOR INSERT WITH CHECK (auth.uid() = user_id);\nCREATE POLICY "Users can update their own transfers" ON transfers FOR UPDATE USING (auth.uid() = user_id);\nCREATE POLICY "Users can delete their own transfers" ON transfers FOR DELETE USING (auth.uid() = user_id);\n\nALTER TABLE budgets ENABLE ROW LEVEL SECURITY;\nCREATE POLICY "Users can view their own budgets" ON budgets FOR SELECT USING (auth.uid() = user_id);\nCREATE POLICY "Users can insert their own budgets" ON budgets FOR INSERT WITH CHECK (auth.uid() = user_id);\nCREATE POLICY "Users can update their own budgets" ON budgets FOR UPDATE USING (auth.uid() = user_id);\nCREATE POLICY "Users can delete their own budgets" ON budgets FOR DELETE USING (auth.uid() = user_id);';return(0,Ge.jsx)("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,Ge.jsxs)("div",{className:"bg-gray-800 rounded-lg shadow-lg max-w-xl w-full p-6 border border-gray-700",children:[(0,Ge.jsxs)("div",{className:"text-center mb-6",children:[(0,Ge.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full bg-orange-600 mb-4",children:(0,Ge.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,Ge.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,Ge.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:"Database Setup Required"}),(0,Ge.jsx)("p",{className:"text-gray-300 mb-4",children:"The Supabase database tables have not been created yet. You need to run the SQL script in the Supabase SQL Editor to set up your database."}),t&&(0,Ge.jsx)("div",{className:"bg-red-900/50 border border-red-800 rounded-md p-4 mb-4",children:(0,Ge.jsx)("p",{className:"text-red-300 text-sm",children:t})})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("h3",{className:"text-lg font-medium text-white mb-4",children:"Follow these steps:"}),(0,Ge.jsxs)("ol",{className:"text-gray-300 space-y-3 list-decimal list-inside",children:[(0,Ge.jsxs)("li",{children:["Log in to your Supabase dashboard at ",(0,Ge.jsx)("a",{href:"https://app.supabase.io",className:"text-indigo-400 hover:underline",target:"_blank",rel:"noopener noreferrer",children:"app.supabase.io"})]}),(0,Ge.jsx)("li",{children:"Navigate to the SQL Editor in the left sidebar"}),(0,Ge.jsx)("li",{children:"Create a new query"}),(0,Ge.jsx)("li",{children:"Copy and paste the SQL script below"}),(0,Ge.jsx)("li",{children:"Run the script to create all necessary tables"}),(0,Ge.jsx)("li",{children:"Return to this app and refresh the page"})]})]}),(0,Ge.jsxs)("div",{className:"mb-6",children:[(0,Ge.jsx)("button",{onClick:()=>a(!r),className:"bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-800 mb-2 w-full",children:r?"Hide SQL Script":"Show SQL Script"}),r&&(0,Ge.jsxs)("div",{className:"bg-gray-900 rounded-md p-3 mt-2",children:[(0,Ge.jsx)("pre",{className:"text-xs text-gray-300 overflow-x-auto max-h-96 scrollbar-thin scrollbar-thumb-gray-700",children:o}),(0,Ge.jsx)("button",{onClick:()=>{navigator.clipboard.writeText(o),i("SQL Script copied to clipboard!")},className:"mt-2 bg-gray-700 text-gray-300 py-1 px-3 rounded text-sm hover:bg-gray-600",children:"Copy to Clipboard"})]})]}),(0,Ge.jsx)("div",{className:"flex justify-end",children:(0,Ge.jsx)("button",{onClick:n,className:"bg-gray-700 text-white py-2 px-4 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 focus:ring-offset-gray-800",children:"I'll do this later"})})]})})};class au{static async getCurrentUser(){if(window.user)return window.user;if(window.globalUser)return window.globalUser;const e=localStorage.getItem("supabase.auth.token")||localStorage.getItem("sb-mplrakcyrohgkqdhzpry-auth-token");if(e)try{const t=JSON.parse(e);return t.user||t}catch(pu){console.error("Error parsing auth data:",pu)}throw new Error("User not found. Please make sure you are logged in.")}static async listWallets(){try{const e=await this.getCurrentUser(),t=await Le.qF.getAll(e.id);return console.log("\ud83d\udcb0 Current Wallets:"),console.table(t.map((e=>({ID:e.id,Name:e.name,Type:e.type,Balance:parseFloat(e.balance).toFixed(2),"Balance Status":e.balance<0?"\u274c Negative":"\u2705 Positive"})))),t}catch(e){throw console.error("Error listing wallets:",e),e}}static async fixWalletBalance(e,t){try{const n=await this.getCurrentUser(),r=wr(n);console.log("\ud83d\udd27 Fixing wallet ".concat(e," balance to ").concat(t,"..."));const s=await r.correctWalletBalance(e,t,"Manual fix via WalletRepair utility");return console.log("\u2705 Wallet balance fixed successfully!"),console.log("\ud83d\udcca Result:",{walletName:s.wallet.name,oldBalance:s.oldBalance.toFixed(2),newBalance:s.newBalance.toFixed(2),adjustment:s.adjustment.toFixed(2)}),s}catch(n){throw console.error("\u274c Error fixing wallet balance:",n),n}}static async recalculateWalletBalance(e){try{const t=await this.getCurrentUser(),n=wr(t);console.log("\ud83d\udcca Recalculating wallet ".concat(e," balance from transactions..."));const r=await n.recalculateWalletBalance(e);return console.log("\u2705 Wallet balance recalculated!"),console.log("\ud83d\udcca Result:",{walletName:r.wallet.name,oldBalance:r.oldBalance.toFixed(2),calculatedBalance:r.newBalance.toFixed(2),difference:r.difference.toFixed(2),transactionCounts:r.transactionCounts}),r}catch(t){throw console.error("\u274c Error recalculating wallet balance:",t),t}}static async fixAllNegativeBalances(){try{const t=await this.getCurrentUser(),n=(await Le.qF.getAll(t.id)).filter((e=>e.balance<0));if(0===n.length)return console.log("\u2705 No negative wallet balances found!"),[];console.log("\ud83d\udea8 Found ".concat(n.length," wallets with negative balances:")),n.forEach((e=>{console.log("  - ".concat(e.name,": ").concat(e.balance.toFixed(2)))}));if(!window.confirm("Fix ".concat(n.length," negative wallet balances by setting them to 0?")))return console.log("\u274c Operation cancelled by user"),[];const r=wr(t),s=[];for(const a of n)try{const e=await r.correctWalletBalance(a.id,0,"Emergency fix: negative balance reset to zero");s.push(e),console.log("\u2705 Fixed ".concat(a.name,": ").concat(a.balance.toFixed(2)," \u2192 0.00"))}catch(e){console.error("\u274c Failed to fix ".concat(a.name,":"),e)}return console.log("\ud83c\udf89 Fixed ".concat(s.length," out of ").concat(n.length," wallets!")),s}catch(e){throw console.error("\u274c Error fixing negative balances:",e),e}}static async findProblematicWallet(){try{const e=(await this.listWallets()).filter((e=>e.balance<0));return 0===e.length?(console.log("\u2705 No problematic wallets found!"),[]):(console.log("\ud83d\udea8 Problematic wallets (negative balance):"),e.forEach((e=>{console.log("  - ".concat(e.name," (ID: ").concat(e.id,"): ").concat(e.balance.toFixed(2)))})),e)}catch(e){throw console.error("Error finding problematic wallets:",e),e}}static async fixBCAWallet(){try{const e=(await this.listWallets()).find((e=>e.name.toLowerCase().includes("bca")));if(!e)return console.log("\u274c BCA wallet not found"),null;if(console.log("Found BCA wallet: ".concat(e.name," with balance ").concat(e.balance.toFixed(2))),e.balance>=0)return console.log("\u2705 BCA wallet balance is already positive!"),e;const t=window.prompt("BCA wallet has negative balance: ".concat(e.balance.toFixed(2),"\n")+"Enter new balance (or 0 to reset):","0");if(null===t)return console.log("\u274c Operation cancelled"),null;const n=parseFloat(t)||0;return await this.fixWalletBalance(e.id,n)}catch(e){throw console.error("Error fixing BCA wallet:",e),e}}}"undefined"!==typeof window&&(window.WalletRepair=au);const iu=e=>{let{onComplete:t,onSkip:n}=e;const[r,a]=(0,s.useState)(0),i=ne(),o=[{title:"Welcome to ExpenseTracker",subtitle:"Your finances, finally in control",content:"Track every expense, manage all your wallets, and see exactly where your money goes \u2014 all in one place.",illustration:"\ud83d\udcb0",features:["Auto-categorized spending","Unlimited wallets","Budget insights in real-time","Clear financial overviews"]},{title:"Manage Multiple Wallets",subtitle:"One app for all your accounts",content:"Separate your cash, cards, savings, and more. Move funds between wallets instantly \u2014 no spreadsheet needed.",illustration:"\ud83c\udfe6",features:["Unlimited wallets","Real-time balances","Easy internal transfers","Custom wallet labels"]},{title:"Set Budgets That Work",subtitle:"Know your limits before you hit them",content:"Create budgets for your spending categories. Get notified when you're close to the limit and stay in control month after month.",illustration:"\ud83d\udcca",features:["Category-based budgeting","Flexible time periods","Spending alerts","Visual progress tracking"]},{title:"See Where Your Money Goes",subtitle:"Make smarter choices with better data",content:"View trends and breakdowns through interactive charts. Discover where to cut back and where you\u2019re doing well.",illustration:"\ud83d\udcc8",features:["Clear visual insights","Spending by category","Monthly comparisons","Exportable reports"]},{title:"Start Smart. Stay in Control.",subtitle:"All set to master your money",content:"Create your account now to access your data anywhere \u2014 securely, across all devices. Even better, it works offline, so you\u2019re never left guessing, even with no internet.",illustration:"\ud83d\ude80",features:["Secure cloud sync","Access from any device","Automatic backups","**Works fully offline** \u2013 track expenses anytime"]}],l=()=>{i("/signup")},c=(0,s.useCallback)((()=>{i("/signup"),null===n||void 0===n||n()}),[i,n]),d=o[r];return(0,Ge.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 flex items-center justify-center p-2 sm:p-4",children:(0,Ge.jsxs)("div",{className:"w-full max-w-md sm:max-w-2xl md:max-w-4xl mx-auto",children:[(0,Ge.jsx)("div",{className:"flex justify-end mb-2 sm:mb-4",children:(0,Ge.jsx)("button",{onClick:c,className:"text-white/70 hover:text-white transition-colors text-xs sm:text-sm font-medium",children:"Skip onboarding \u2192"})}),(0,Ge.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl sm:rounded-2xl p-4 sm:p-8 md:p-12 shadow-2xl border border-white/20 overflow-y-auto max-h-[80vh]",children:[(0,Ge.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-12 items-center",children:[(0,Ge.jsxs)("div",{className:"space-y-4 sm:space-y-6 order-2 md:order-1",children:[(0,Ge.jsxs)("div",{children:[(0,Ge.jsx)("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-white mb-2 sm:mb-3",children:d.title}),(0,Ge.jsx)("p",{className:"text-lg sm:text-xl text-indigo-200 mb-3 sm:mb-6",children:d.subtitle}),(0,Ge.jsx)("p",{className:"text-white/80 text-base sm:text-lg leading-relaxed",children:d.content})]}),(0,Ge.jsx)("div",{className:"space-y-2 sm:space-y-3",children:d.features.map(((e,t)=>(0,Ge.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[(0,Ge.jsx)("div",{className:"w-2 h-2 bg-indigo-400 rounded-full"}),(0,Ge.jsx)("span",{className:"text-white/90 text-sm sm:text-base",children:e})]},t)))})]}),(0,Ge.jsx)("div",{className:"flex justify-center order-1 md:order-2 mb-4 md:mb-0",children:(0,Ge.jsx)("div",{className:"w-40 h-40 sm:w-60 sm:h-60 md:w-80 md:h-80 bg-white/5 rounded-xl sm:rounded-2xl border-2 border-dashed border-white/30 flex items-center justify-center",children:(0,Ge.jsxs)("div",{className:"text-center",children:[(0,Ge.jsx)("div",{className:"text-6xl sm:text-8xl mb-2 sm:mb-4",children:d.illustration}),(0,Ge.jsxs)("p",{className:"text-white/60 text-xs sm:text-sm",children:["Illustration placeholder",(0,Ge.jsx)("br",{}),d.title]})]})})})]}),(0,Ge.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-8 sm:mt-12 space-y-4 sm:space-y-0",children:[(0,Ge.jsx)("div",{className:"flex space-x-2",children:o.map(((e,t)=>(0,Ge.jsx)("button",{onClick:()=>a(t),className:"w-2.5 h-2.5 sm:w-3 sm:h-3 rounded-full transition-all duration-300 ".concat(t===r?"bg-indigo-400 scale-125":"bg-white/30 hover:bg-white/50")},t)))}),(0,Ge.jsxs)("div",{className:"flex space-x-2 sm:space-x-4",children:[r>0&&(0,Ge.jsx)("button",{onClick:()=>{r>0&&a(r-1)},className:"px-4 py-2 sm:px-6 sm:py-3 text-white border border-white/30 rounded-lg hover:bg-white/10 transition-colors text-xs sm:text-base",children:"Previous"}),(0,Ge.jsx)("button",{onClick:()=>{r<o.length-1?a(r+1):l()},className:"px-6 py-2 sm:px-8 sm:py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors shadow-lg text-xs sm:text-base",children:r===o.length-1?"Get Started":"Next"})]})]}),(0,Ge.jsxs)("div",{className:"mt-6 sm:mt-8",children:[(0,Ge.jsxs)("div",{className:"flex justify-between text-xs sm:text-sm text-white/60 mb-1 sm:mb-2",children:[(0,Ge.jsx)("span",{children:"Progress"}),(0,Ge.jsxs)("span",{children:[r+1," of ",o.length]})]}),(0,Ge.jsx)("div",{className:"w-full bg-white/20 rounded-full h-1.5 sm:h-2",children:(0,Ge.jsx)("div",{className:"bg-gradient-to-r from-indigo-400 to-purple-400 h-1.5 sm:h-2 rounded-full transition-all duration-500 ease-out",style:{width:"".concat((r+1)/o.length*100,"%")}})})]})]}),(0,Ge.jsx)("div",{className:"text-center mt-4 sm:mt-6",children:(0,Ge.jsxs)("p",{className:"text-white/60 text-xs sm:text-sm",children:["Already have an account?"," ",(0,Ge.jsx)("button",{onClick:()=>i("/login"),className:"text-indigo-300 hover:text-indigo-200 font-medium",children:"Sign in here"})]})})]})})},ou=()=>{console.log("\ud83d\uded1 EMERGENCY STOP: Halting all automatic sync processes...");try{const e=Ye();e&&(e.syncStatus.backgroundSyncEnabled=!1,e.backgroundSyncInterval&&(clearTimeout(e.backgroundSyncInterval),e.backgroundSyncInterval=null,console.log("\u2705 Cleared background sync interval")),e.syncStatus.inProgress&&(e.syncStatus.inProgress=!1,console.log("\u2705 Stopped in-progress sync")),e.saveStatusToLocalStorage(),console.log("\u2705 Updated sync status"));return["backgroundSyncEnabled","lastSyncTime","hasLocalChanges","syncStatus"].forEach((e=>{localStorage.removeItem(e)})),localStorage.setItem("automaticSyncStopped","true"),localStorage.setItem("automaticSyncStoppedAt",(new Date).toISOString()),console.log("\u2705 All automatic sync processes stopped successfully"),{success:!0,message:"All automatic sync processes have been stopped",stoppedAt:(new Date).toISOString()}}catch(e){return console.error("\u274c Error stopping automatic sync:",e),{success:!1,error:e.message}}};ou();const lu=()=>{try{console.log("\ud83d\udea8 Performing emergency localStorage cleanup...");const e=navigator.userAgent.includes("Arc")||window.chrome&&window.chrome.webstore||navigator.userAgent.includes("Chrome"),t=JSON.stringify(localStorage).length;console.log("Storage before cleanup:",t,"bytes"),console.log("Browser detected:",e?"Arc/Chrome-based":"Other");const n=e?["user","auth","supabase.auth.token","sb-mplrakcyrohgkqdhzpry-auth-token"]:["user","auth","settings","onboarding","supabase.auth.token"],r=Object.keys(localStorage);let s=0;r.forEach((t=>{if(n.some((e=>t.includes(e))))e&&console.log("\ud83d\udd12 Arc cleanup kept: ".concat(t));else try{localStorage.removeItem(t),s++,e&&console.log("\ud83c\udf10 Arc cleanup removed: ".concat(t))}catch(pu){console.warn("Failed to remove key:",t)}}));const a=JSON.stringify(localStorage).length;return console.log("Storage after cleanup:",a,"bytes"),console.log("\u2705 Emergency cleanup completed, freed up:",t-a,"bytes"),console.log("\ud83d\udcca Removed keys:",s),e&&t-a>102400&&console.warn("\ud83c\udf10 Arc browser: Significant cleanup performed. Consider reloading page."),!0}catch(e){return console.error("Emergency cleanup failed:",e),!1}};lu(),qe.initializeMonitoring();let cu=0,du="";const uu=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"unknown";const n=Date.now();if(t===du&&n-cu<2e3)return console.warn("\ud83d\udea8 Quota error handling for ".concat(t," already attempted recently. Skipping.")),!1;cu=n,du=t,console.warn("\ud83d\udea8 localStorage quota error detected from ".concat(t,":"),e);try{return lu(),qe.emergencyCleanup(),!0}catch(r){return console.error("All cleanup methods failed:",r),!1}};window.addEventListener("error",(e=>{e.error&&(e.error.message.includes("QUOTA")||"QuotaExceededError"===e.error.name||e.error.message.includes("quota exceeded"))&&uu(e.error,"window.error")})),window.addEventListener("unhandledrejection",(e=>{var t,n;if(e.reason&&(null!==(t=e.reason.message)&&void 0!==t&&t.includes("QUOTA")||"QuotaExceededError"===e.reason.name||null!==(n=e.reason.message)&&void 0!==n&&n.includes("quota exceeded"))){uu(e.reason,"unhandledrejection")&&e.preventDefault()}}));const hu=localStorage.setItem;localStorage.setItem=function(e,t){const n="string"===typeof t?t.length:0;if(console.log('[localStorage.setItem] Attempting to set key: "'.concat(e,'", Value size: ').concat(n," chars")),n>512e3)throw console.error("\ud83d\udea8 BLOCKED: Attempted to write ".concat((n/1024).toFixed(2),' KB to key "').concat(e,'" - too large!')),new Error("QUOTA_BYTES quota exceeded - attempted write too large: ".concat((n/1024).toFixed(2)," KB"));n>102400&&console.warn('[localStorage.setItem] WARNING: Large write to key "'.concat(e,'", Size: ').concat((n/1024).toFixed(2)," KB"));const r=JSON.stringify(localStorage).length,s=r+n,a=4194304;if(s>a){console.warn("\ud83d\udea8 Storage limit would be exceeded. Current: ".concat((r/1024).toFixed(2)," KB, Projected: ").concat((s/1024).toFixed(2)," KB")),lu();if(JSON.stringify(localStorage).length+n>a)throw console.error('\ud83d\udea8 Still would exceed limit after cleanup. Blocking write to "'.concat(e,'"')),new Error("QUOTA_BYTES quota exceeded - storage limit reached even after cleanup")}try{return hu.call(this,e,t)}catch(i){if("QuotaExceededError"===i.name||i.message.includes("QUOTA")){console.error('\ud83d\udea8 localStorage.setItem FAILED for key: "'.concat(e,'" due to QuotaExceededError. Value size: ').concat(n," chars")),uu(i,"localStorage.setItem for key: ".concat(e));try{return console.log('[localStorage.setItem] Retrying setItem for key: "'.concat(e,'" after cleanup attempt.')),hu.call(this,e,t)}catch(o){throw console.error('\ud83d\udea8 localStorage.setItem FAILED AGAIN for key: "'.concat(e,'" even after cleanup.'),o),o}}throw console.error('[localStorage.setItem] Error setting key "'.concat(e,'" (not quota related):'),i),i}};const fu=()=>{const{user:e,signOut:t,isSessionValid:r,refreshSession:a}=Qe(),{notification:i,showError:o,hideNotification:l}=pt(),[c,d]=(0,s.useState)("home"),[u,h]=(0,s.useState)([]),[f,g]=(0,s.useState)([]),[p,m]=(0,s.useState)(!0),[y,b]=(0,s.useState)(!1),[x,v]=(0,s.useState)(0),[w,_]=(0,s.useState)(!1),[S,k]=(0,s.useState)(null),[j,N]=(0,s.useState)(!1),[E,C]=(0,s.useState)(!1);(0,s.useEffect)((()=>{const e=()=>{const e="true"===localStorage.getItem("hasLocalChanges"),t=localStorage.getItem("lastSyncTime"),n=Date.now()-3e5,r=e||!t||parseInt(t)<n||!w;C(r)};e();const t=setInterval(e,3e4);return()=>clearInterval(t)}),[w]),(0,s.useEffect)((()=>{const e=e=>{if(E&&w){const t="You have unsaved changes that may not be synced to the cloud. Are you sure you want to leave?";return e.preventDefault(),e.returnValue=t,t}};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[E,w]);const T=()=>{C(!1),localStorage.removeItem("hasLocalChanges"),localStorage.setItem("lastSyncTime",Date.now().toString())},A=()=>{C(!0),localStorage.setItem("hasLocalChanges","true")};(0,s.useEffect)((()=>{(async()=>{try{if(m(!0),e){const e=await(0,Le.e0)();_(e.success),e.success?await D({runDuplicateDetection:!0}):(k(e.message||"Failed to initialize Supabase database"),N(!0),console.error("Supabase initialization failed:",e),O())}}catch(t){console.error("Failed to initialize:",t),O()}finally{m(!1)}})()}),[e]);const D=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{if(!e)return void console.error("Cannot load data: User not authenticated");const n=await Le.expenseDB.getAll(e.id),r="duplicateDetectionRun_".concat(e.id),s="true"===sessionStorage.getItem(r);if(t.runDuplicateDetection&&!s){const e=Id.findDuplicates(n);if(e.length>0){console.warn("Found ".concat(e.length," duplicate groups in loaded data:"),e);const t=Id.removeDuplicates(n);console.log("Removed ".concat(n.length-t.length," duplicate transactions")),h(t),e.length>0&&o("Found and removed ".concat(n.length-t.length," duplicate transactions. Your data has been cleaned up."))}else h(n);sessionStorage.setItem(r,"true")}else h(n);const a=await Le.T0.getAll(e.id);g(a),m(!1)}catch(n){console.error("Error loading data from Supabase:",n),O()}},P=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};await D(e)},O=()=>{const e=localStorage.getItem("expenses");e&&h(JSON.parse(e));const t=localStorage.getItem("expense-categories");if(t)g(JSON.parse(t));else{g([{id:"food",name:"Food",color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300"},{id:"transportation",name:"Transportation",color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300"},{id:"entertainment",name:"Entertainment",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300"},{id:"utilities",name:"Utilities",color:"bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300"},{id:"housing",name:"Housing",color:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300"},{id:"healthcare",name:"Healthcare",color:"bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300"},{id:"other",name:"Other",color:"bg-lime-100 text-lime-800 dark:bg-lime-900 dark:text-lime-300"}])}m(!1)},I=async t=>{try{if(!e)return void console.error("Cannot update expense: User not authenticated");if(!await r()){console.warn("Session expired, attempting to refresh...");try{await a()}catch(n){throw console.error("Session refresh failed, user needs to re-authenticate"),new Error("Your session has expired. Please sign in again.")}}A();const s=wr(e),i=await s.updateExpenseWithWalletUpdate(t);console.log("Expense and wallet updated successfully:",i),await P(),v((e=>e+1)),T()}catch(n){console.error("Error updating expense:",n);let e="Failed to update expense. ";throw n.message.includes("not found")?e+="One of the wallets associated with this expense may have been deleted. Please check your wallets and try again.":n.message.includes("Insufficient balance")?e+=n.message:n.message.includes("session")||n.message.includes("authentication")?e+="Your session has expired. Please sign in again.":e+="Please try again or contact support if the problem persists.",l(),o(e),n}},L=async t=>{try{if(!e)return void console.error("Cannot delete expense: User not authenticated");const n=navigator.userAgent.includes("Arc")||window.chrome&&window.chrome.webstore||navigator.userAgent.includes("Chrome");try{n?(console.log("\ud83c\udf10 Arc browser detected - performing aggressive pre-delete cleanup"),window.StorageDebugger?window.StorageDebugger.arcBrowserCleanup():lu()):qe.performCleanup()}catch(r){console.warn("Cleanup before delete failed:",r)}A();const s=wr(e),a=await s.deleteExpenseWithWalletUpdate(t);console.log("Expense deleted and wallet balance restored:",a),await P(),v((e=>e+1)),T()}catch(s){var n;if(console.error("Error deleting expense:",s),null!==(n=s.message)&&void 0!==n&&n.includes("QUOTA")||"QuotaExceededError"===s.name){console.warn("Quota error during delete, performing emergency cleanup...");const n=navigator.userAgent.includes("Arc")||window.chrome&&window.chrome.webstore||navigator.userAgent.includes("Chrome");try{if(n)if(console.log("\ud83c\udf10 Arc browser quota error - performing nuclear cleanup"),window.StorageDebugger){const e=window.StorageDebugger.arcBrowserCleanup();if(e.success&&e.freedBytes>51200&&window.confirm("Arc browser storage cleaned. Reload page for best performance?"))return void window.location.reload()}else lu();else lu(),qe.emergencyCleanup();const r=wr(e),s=await r.deleteExpenseWithWalletUpdate(t);return console.log("Expense deleted successfully after cleanup:",s),await P(),void v((e=>e+1))}catch(a){return console.error("Delete failed even after cleanup:",a),void o("Failed to delete expense due to storage limitations. Please try refreshing the page or clearing browser data.")}}let r="Failed to delete expense. ";throw s.message.includes("not found")?r+="The expense may have already been deleted.":s.message.includes("session")||s.message.includes("authentication")?r+="Your session has expired. Please sign in again.":r+="Please try again or contact support if the problem persists.",o(r),s}};return(0,Ge.jsxs)(Ge.Fragment,{children:[j&&(0,Ge.jsx)(su,{error:S,onClose:()=>N(!1)}),(0,Ge.jsx)(Qd,{user:e,signOut:t,activeTab:c,setActiveTab:d,setIsModalOpen:b,hasUnsavedChanges:E}),(0,Ge.jsx)("div",{className:"pt-16 pb-20 px-4 bg-gray-50 dark:bg-gray-900 min-h-screen",children:(0,Ge.jsx)("div",{className:"max-w-7xl mx-auto",children:(()=>{if(p)return(0,Ge.jsxs)("div",{className:"flex items-center justify-center h-64",children:[(0,Ge.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,Ge.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading..."})]});switch(c){case"wallets":return(0,Ge.jsxs)("div",{className:"space-y-6",children:[(0,Ge.jsx)(Zd,{dbInitialized:w,refresh:x}),(0,Ge.jsx)(Vd,{dbInitialized:w,refreshWallets:x})]});case"budgets":return(0,Ge.jsx)(Hd,{dbInitialized:w});case"settings":return(0,Ge.jsx)(Wd,{dbInitialized:w});case"transfer":return(0,Ge.jsx)(Vd,{dbInitialized:w,refreshWallets:x});case"transactions":return(0,Ge.jsx)(ru,{expenses:u,deleteExpense:L,updateExpense:I,dbInitialized:w});default:return(0,Ge.jsxs)(Ge.Fragment,{children:[(0,Ge.jsx)(tu,{dbInitialized:w,refresh:x}),(0,Ge.jsx)(Sr,{expenses:u,total:u.reduce(((e,t)=>e+t.amount),0)}),(0,Ge.jsx)(Od,{expenses:u,categories:f}),(0,Ge.jsx)(Lt,{expenses:u,deleteExpense:L,updateExpense:I,dbInitialized:w})]})}})()})}),(0,Ge.jsx)(Jd,{activeTab:c,onChange:d}),(0,Ge.jsx)("div",{className:"md:hidden",children:(0,Ge.jsx)(Kd,{onClick:()=>b(!0)})}),(0,Ge.jsx)(qd,{isOpen:y,onClose:()=>b(!1),title:"Add Transaction",children:(0,Ge.jsx)(kt,{onSubmit:async t=>{try{if(!e)throw console.error("Cannot add expense: User not authenticated"),new Error("User not authenticated");console.log("Adding expense with data:",t);let s=[];try{const{expenseDB:t}=await Promise.resolve().then(n.bind(n,61));s=(await t.getAllIncludingDeleted(e.id)).filter((e=>e.deleted_at))}catch(r){console.warn("Could not fetch recently deleted transactions:",r)}const a=Id.checkBeforeAdd(t,u,s);if(a.hasDeletedDuplicates){const e=a.deletedDuplicates[0],t=new Date(e.deletedAt).toLocaleString(),n=e.reasons.join(", ");console.warn("Transaction matches recently deleted duplicate:",e);if(!window.confirm("\u26a0\ufe0f Warning: This transaction appears to be identical to one that was recently deleted.\n\n"+"Deleted on: ".concat(t,"\n")+"Reasons: ".concat(n,"\n\n")+"This might be a duplicate that was cleaned up. Are you sure you want to add it again?"))return void console.log("User cancelled adding transaction that matches recently deleted duplicate")}if(a.hasDuplicates){const e=a.duplicates.length,t=a.duplicates[0].reasons.join(", ");console.warn("Potential duplicate transaction detected:",a);if(!window.confirm("Warning: This transaction appears to be a duplicate of ".concat(e," existing transaction(s).\n\n")+"Reasons: ".concat(t,"\n\n")+"Do you want to add it anyway?"))return void console.log("User cancelled duplicate transaction")}A();const i=wr(e),o=await i.addExpenseWithWalletUpdate(t);console.log("Expense and wallet updated successfully:",o),v((e=>e+1)),await P(),T()}catch(r){throw console.error("Error adding expense:",r),r}},onClose:()=>b(!1),dbInitialized:w})}),i&&(0,Ge.jsx)(jt,{isOpen:i.isOpen,onClose:l,title:i.title,message:i.message,type:i.type,showCancel:i.showCancel,onConfirm:i.onConfirm,confirmText:i.confirmText,cancelText:i.cancelText})]})};const gu=function(){const{hasSeenOnboarding:e,isLoading:t,completeOnboarding:n}=(()=>{const[e,t]=(0,s.useState)(!1),[n,r]=(0,s.useState)(!0);return(0,s.useEffect)((()=>{const e=localStorage.getItem("onboarding_completed");t("true"===e),r(!1)}),[]),{hasSeenOnboarding:e,isLoading:n,completeOnboarding:()=>{localStorage.setItem("onboarding_completed","true"),t(!0)},resetOnboarding:()=>{localStorage.removeItem("onboarding_completed"),t(!1)}}})();return t?(0,Ge.jsxs)("div",{className:"min-h-screen flex items-center justify-center bg-gray-900",children:[(0,Ge.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"}),(0,Ge.jsx)("span",{className:"ml-2 text-white",children:"Loading..."})]}):(0,Ge.jsxs)(ve,{children:[(0,Ge.jsx)(be,{path:"/onboarding",element:(0,Ge.jsx)(iu,{onComplete:()=>{n()},onSkip:()=>{n()}})}),(0,Ge.jsx)(be,{path:"/login",element:(0,Ge.jsx)(Ze,{})}),(0,Ge.jsx)(be,{path:"/signup",element:(0,Ge.jsx)(et,{})}),(0,Ge.jsx)(be,{path:"/forgot-password",element:(0,Ge.jsx)(tt,{})}),(0,Ge.jsx)(be,{path:"/reset-password",element:(0,Ge.jsx)(nt,{})}),(0,Ge.jsx)(be,{path:"/dashboard",element:(0,Ge.jsx)(rt,{children:(0,Ge.jsx)(fu,{})})}),(0,Ge.jsx)(be,{path:"/",element:e?(0,Ge.jsx)(ye,{to:"/dashboard",replace:!0}):(0,Ge.jsx)(ye,{to:"/onboarding",replace:!0})}),(0,Ge.jsx)(be,{path:"*",element:(0,Ge.jsx)(ye,{to:"/",replace:!0})})]})};i.createRoot(document.getElementById("root")).render((0,Ge.jsx)(s.StrictMode,{children:(0,Ge.jsx)(Xe,{children:(0,Ge.jsx)(Ne,{children:(0,Ge.jsx)(gu,{})})})}))})();
//# sourceMappingURL=main.b13448ac.js.map