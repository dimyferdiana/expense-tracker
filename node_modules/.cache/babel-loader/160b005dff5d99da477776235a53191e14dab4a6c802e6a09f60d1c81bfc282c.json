{"ast":null,"code":"import _objectSpread from\"/Users/ddm/expense-tracker/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect,useRef}from'react';import{Combobox,ComboboxLabel,ComboboxOption}from'./Combobox';import TagSelector,{TagSelectorWithLabel}from'./TagSelector';import{categoryDB,tagDB,walletDB}from'../utils/db';import DateRangePicker from'./DateRangePicker';import Badge from'./Badge';import{getColorName}from'../utils/colors';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function CategoryModal(_ref){let{open,onClose,onSave}=_ref;const[input,setInput]=useState('');const handleSave=()=>{if(input.trim()){onSave(input.trim());setInput('');}};if(!open)return null;return/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-800 rounded-lg p-6 w-full max-w-sm shadow-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-white mb-4\",children:\"Add New Category\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"w-full px-3 py-2 mb-4 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500\",placeholder:\"Category name\",value:input,onChange:e=>setInput(e.target.value),autoFocus:true}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-500\",onClick:onClose,children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700\",onClick:handleSave,children:\"Save\"})]})]})});}function ExpenseForm(_ref2){let{addExpense,dbInitialized=false,onClose}=_ref2;// Get current date and time for default values\nconst now=new Date();const currentDate=now.toISOString().slice(0,10);// YYYY-MM-DD\nconst currentTime=now.toTimeString().slice(0,5);// HH:MM\nconst[formData,setFormData]=useState({name:'',amount:'',category:'food',tags:[],walletId:'cash',isIncome:false,notes:'',photoUrl:'',date:currentDate,time:currentTime});const fileInputRef=useRef(null);const[previewUrl,setPreviewUrl]=useState('');// Add state for date picker\nconst[activeDatePicker,setActiveDatePicker]=useState(null);// 'date' or null\n// Add state for time picker\nconst[activeTimePicker,setActiveTimePicker]=useState(null);// 'time' or null\nconst[categories,setCategories]=useState([{id:'food',name:'Food'},{id:'transportation',name:'Transportation'},{id:'entertainment',name:'Entertainment'},{id:'utilities',name:'Utilities'},{id:'housing',name:'Housing'},{id:'healthcare',name:'Healthcare'},{id:'other',name:'Other'}]);const[tags,setTags]=useState([{id:'essential',name:'Essential'},{id:'recurring',name:'Recurring'},{id:'emergency',name:'Emergency'},{id:'personal',name:'Personal'},{id:'work',name:'Work'}]);const[wallets,setWallets]=useState([{id:'cash',name:'Cash',type:'cash',balance:0},{id:'bank',name:'Bank Account',type:'bank',balance:0},{id:'credit',name:'Credit Card',type:'credit_card',balance:0},{id:'ewallet',name:'E-Wallet',type:'e_wallet',balance:0}]);const[showNewCategoryInput,setShowNewCategoryInput]=useState(false);const[newCategoryName,setNewCategoryName]=useState('');const[categorySearchQuery,setCategorySearchQuery]=useState('');const[selectedCategory,setSelectedCategory]=useState(null);const[showCategoryModal,setShowCategoryModal]=useState(false);// Load categories and tags\nuseEffect(()=>{const loadData=async()=>{try{if(dbInitialized){// Load categories from IndexedDB\nconst categoryData=await categoryDB.getAll();if(categoryData.length>0){setCategories(categoryData);// Set default category if it exists in the loaded categories\nconst defaultCategory=categoryData.find(cat=>cat.id==='food')||categoryData[0];if(defaultCategory){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{category:defaultCategory.id}));}}// Load tags from IndexedDB\nconst tagData=await tagDB.getAll();if(tagData.length>0){setTags(tagData);}// Load wallets from IndexedDB\nconst walletData=await walletDB.getAll();if(walletData.length>0){setWallets(walletData);// Set default wallet if not set\nsetFormData(prev=>_objectSpread(_objectSpread({},prev),{},{walletId:prev.walletId||walletData[0].id}));}}else{// Fallback to localStorage\nloadFromLocalStorage();}}catch(error){console.error('Error loading form data:',error);loadFromLocalStorage();}};loadData();},[dbInitialized]);// Load categories from localStorage if needed\nconst loadFromLocalStorage=()=>{// Load categories\nconst savedCategories=localStorage.getItem('expense-categories');if(savedCategories){const parsedCategories=JSON.parse(savedCategories);setCategories(parsedCategories);// Set default category if it exists in the loaded categories\nconst defaultCategory=parsedCategories.find(cat=>cat.id==='food')||parsedCategories[0];if(defaultCategory){setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{category:defaultCategory.id}));}}// Load tags\nconst savedTags=localStorage.getItem('expense-tags');if(savedTags){setTags(JSON.parse(savedTags));}// Load wallets\nconst savedWallets=localStorage.getItem('wallets');if(savedWallets){const parsedWallets=JSON.parse(savedWallets);setWallets(parsedWallets);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{walletId:prev.walletId||parsedWallets[0].id}));}};const handleChange=e=>{const{name,value}=e.target;setFormData(_objectSpread(_objectSpread({},formData),{},{[name]:value}));};const handleToggleType=()=>{setFormData(_objectSpread(_objectSpread({},formData),{},{isIncome:!formData.isIncome}));};const handlePhotoChange=e=>{const file=e.target.files[0];if(!file)return;// Check file type is image\nif(!file.type.startsWith('image/')){alert('Please select an image file');return;}// Check file size is less than 5MB\nif(file.size>5*1024*1024){alert('File size should be less than 5MB');return;}// Convert to base64 for storage\nconst reader=new FileReader();reader.onload=event=>{setFormData(_objectSpread(_objectSpread({},formData),{},{photoUrl:event.target.result}));setPreviewUrl(event.target.result);};reader.readAsDataURL(file);};const removePhoto=()=>{setFormData(_objectSpread(_objectSpread({},formData),{},{photoUrl:''}));setPreviewUrl('');if(fileInputRef.current){fileInputRef.current.value='';}};const takePicture=()=>{if(fileInputRef.current){fileInputRef.current.click();}};const handleCategoryChange=category=>{setSelectedCategory(category);setFormData(_objectSpread(_objectSpread({},formData),{},{category:category.id}));setCategorySearchQuery('');// Clear search when selecting\n};const handleCategorySearchChange=e=>{setCategorySearchQuery(e.target.value);};const filteredCategories=categories.filter(category=>category.name.toLowerCase().includes(categorySearchQuery.toLowerCase()));const handleTagsChange=selectedTags=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{tags:selectedTags}));};const handleWalletChange=e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{walletId:e.target.value.id}));};const handleAddNewCategoryClick=()=>{setShowCategoryModal(true);};const handleCloseCategoryModal=()=>{setShowCategoryModal(false);};const handleSaveCategory=async name=>{// Generate a random color from the available colors\nconst colors=['bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300','bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300','bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300','bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300','bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300','bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300','bg-lime-100 text-lime-800 dark:bg-lime-900 dark:text-lime-300','bg-rose-100 text-rose-800 dark:bg-rose-900 dark:text-rose-300','bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-300','bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-300','bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300'];const randomColor=colors[Math.floor(Math.random()*colors.length)];const newCategory={id:name.toLowerCase().replace(/\\s+/g,'-'),name,color:randomColor};try{if(dbInitialized){await categoryDB.add(newCategory);}else{const updatedCategories=[...categories,newCategory];setCategories(updatedCategories);localStorage.setItem('expense-categories',JSON.stringify(updatedCategories));}setCategories(prev=>[...prev,newCategory]);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{category:newCategory.id}));setSelectedCategory(newCategory);setShowCategoryModal(false);}catch(error){alert('Failed to add new category.');}};const handleSubmit=async e=>{e.preventDefault();// Validation\nif(!formData.name.trim()||!formData.amount||isNaN(formData.amount)){alert('Please enter valid name and amount');return;}// Determine the final category to use (user could have created a new one)\nlet finalCategory=formData.category;// If a new category name is entered, add it before saving the transaction\nif(showNewCategoryInput&&newCategoryName.trim()){const newCategory={id:newCategoryName.trim().toLowerCase().replace(/\\s+/g,'-'),// Simple ID generation\nname:newCategoryName.trim()};try{if(dbInitialized){await categoryDB.add(newCategory);}else{// Fallback to localStorage\nconst updatedCategories=[...categories,newCategory];setCategories(updatedCategories);localStorage.setItem('expense-categories',JSON.stringify(updatedCategories));}// Update the categories state in the form\nsetCategories(prev=>[...prev,newCategory]);// Use the new category's id for the current transaction\nfinalCategory=newCategory.id;// Reset new category states after saving\nsetNewCategoryName('');setShowNewCategoryInput(false);}catch(error){console.error('Error adding new category on submit:',error);alert('Failed to add new category. Transaction not saved.');return;// Stop submission if new category fails to save\n}}// Ensure all tags are saved to the database\nlet processedTags=[...formData.tags];// Copy the tags array\nif(dbInitialized){try{// Check if all tags exist in the database, save any that don't\nconst allTags=await tagDB.getAll();// Process each tag to ensure it's saved to the database\nfor(let i=0;i<processedTags.length;i++){const tag=processedTags[i];// If it's an object with a name property, it might be a temporary tag\nif(typeof tag==='object'&&tag!==null&&tag.name){// Check if this tag already exists in the database\nconst existingTag=allTags.find(t=>t.id===tag.id||t.name.toLowerCase()===tag.name.toLowerCase());if(existingTag){// Use the existing tag instead\nprocessedTags[i]=existingTag.id;}else{// Tag doesn't exist, add it to the database\ntry{await tagDB.add(tag);// Replace object reference with just the ID\nprocessedTags[i]=tag.id;}catch(tagError){console.error(\"Error saving tag:\",tagError);// Keep as is if we can't save\n}}}}}catch(error){console.error(\"Error processing tags:\",error);// Proceed with original tags if there's an error\n}}// Format the expense object\nconst expenseData={name:formData.name.trim(),amount:parseFloat(formData.amount),category:finalCategory,tags:processedTags,// Use the processed tags\nwalletId:formData.walletId,isIncome:formData.isIncome,notes:formData.notes?formData.notes.trim():'',photoUrl:formData.photoUrl,date:formData.date,// Keep original date format for saving\ntime:formData.time// Keep original time format for saving\n};try{addExpense(expenseData);// Reset form (except category and wallet for convenience)\nsetFormData({name:'',amount:'',category:finalCategory,// Keep the potentially new category for convenience\ntags:[],walletId:formData.walletId,// Keep the same wallet for convenience\nisIncome:false,notes:'',photoUrl:'',date:currentDate,time:currentTime});setPreviewUrl('');if(fileInputRef.current){fileInputRef.current.value='';}}catch(submitError){console.error(\"Error adding expense:\",submitError);alert(\"There was a problem saving your expense. Please try again.\");}};// Helper function to get category color based on category ID\nconst getCategoryColor=category=>{if(!category)return'gray';return getColorName(category.color);};// Format a date string as a human-readable date\nconst formatDateForDisplay=date=>{if(!date)return'';const dateObj=typeof date==='string'?new Date(date):date;return dateObj.toLocaleDateString('en-US',{year:'numeric',month:'short',day:'numeric'});};// Format a time string for display (convert 24h to 12h format)\nconst formatTimeForDisplay=time=>{if(!time)return'';const[hours,minutes]=time.split(':');const h=parseInt(hours,10);const ampm=h>=12?'PM':'AM';const hour12=h%12||12;return\"\".concat(hour12,\":\").concat(minutes,\" \").concat(ampm);};// Generate hours for time picker (00-23)\nconst hours=Array.from({length:24},(_,i)=>i.toString().padStart(2,'0'));// Generate minutes for time picker (00-59)\nconst minutes=Array.from({length:60},(_,i)=>i.toString().padStart(2,'0'));// Handle time selection\nconst handleTimeSelect=(hour,minute)=>{const newTime=\"\".concat(hour,\":\").concat(minute);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{time:newTime}));setActiveTimePicker(null);};return/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col h-full\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"sticky top-0 left-0 right-0 px-6 py-4 bg-gray-800 border-b border-gray-700 z-10\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-semibold text-indigo-300\",children:[\"Add New \",formData.isIncome?'Income':'Expense']}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"text-gray-400 hover:text-white p-2 rounded-full bg-gray-700 bg-opacity-50\",onClick:onClose,children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})})})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 overflow-auto px-6 py-4 pt-2\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"mb-4\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex bg-gray-700 rounded-md p-1\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"flex-1 py-2 px-4 rounded \".concat(!formData.isIncome?'bg-indigo-600 text-white':'text-gray-300'),onClick:()=>!formData.isIncome||handleToggleType(),children:\"Expense\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"flex-1 py-2 px-4 rounded \".concat(formData.isIncome?'bg-green-600 text-white':'text-gray-300'),onClick:()=>formData.isIncome||handleToggleType(),children:\"Income\"})]})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"name\",className:\"block mb-2 font-medium text-gray-300\",children:[formData.isIncome?'Income':'Expense',\" Name\"]}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"name\",name:\"name\",value:formData.name,onChange:handleChange,placeholder:formData.isIncome?\"e.g., Salary\":\"e.g., Groceries\",className:\"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500\",required:true,autoFocus:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"amount\",className:\"block mb-2 font-medium text-gray-300\",children:\"Amount (Rp)\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",id:\"amount\",name:\"amount\",value:formData.amount,onChange:handleChange,placeholder:\"0\",step:\"1000\",min:\"1000\",className:\"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-2 gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"date\",className:\"block mb-2 font-medium text-gray-300\",children:\"Date\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"date\",className:\"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer\",placeholder:\"Select date\",readOnly:true,value:formData.date?formatDateForDisplay(formData.date):'',onClick:()=>setActiveDatePicker('date')}),activeDatePicker==='date'&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 date-picker-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-medium text-white\",children:\"Select Date\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"text-gray-400 hover:text-white p-2 rounded-full\",onClick:()=>setActiveDatePicker(null),children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})})})]}),/*#__PURE__*/_jsx(DateRangePicker,{value:{start:formData.date?new Date(formData.date):null,end:null},onChange:range=>{if(range.start){const dateString=range.start.toISOString().slice(0,10);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{date:dateString}));}setActiveDatePicker(null);},onClose:()=>setActiveDatePicker(null),isSingleDatePicker:true,pickerLabel:\"Select Date\"})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"relative\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"time\",className:\"block mb-2 font-medium text-gray-300\",children:\"Time\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"time\",className:\"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer\",placeholder:\"Select time\",readOnly:true,value:formData.time?formatTimeForDisplay(formData.time):'',onClick:()=>setActiveTimePicker('time')}),activeTimePicker==='time'&&/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 time-picker-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-4\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-lg font-medium text-white\",children:\"Select Time\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"text-gray-400 hover:text-white p-2 rounded-full\",onClick:()=>setActiveTimePicker(null),children:/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5\",fill:\"none\",viewBox:\"0 0 24 24\",stroke:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{strokeLinecap:\"round\",strokeLinejoin:\"round\",strokeWidth:2,d:\"M6 18L18 6M6 6l12 12\"})})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between p-4 bg-gray-700 rounded-lg\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 max-h-60 overflow-y-auto w-1/2 pr-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold text-gray-300 px-2\",children:\"Hour\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-1\",children:hours.map(hour=>/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"w-full text-left px-2 py-1 hover:bg-indigo-600 hover:text-white rounded \".concat(formData.time&&formData.time.split(':')[0]===hour?'bg-indigo-600 text-white':'text-gray-300'),onClick:()=>handleTimeSelect(hour,formData.time.split(':')[1]||'00'),children:hour})},\"hour-\".concat(hour)))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2 max-h-60 overflow-y-auto w-1/2 pl-2\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-xs font-semibold text-gray-300 px-2\",children:\"Minute\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"space-y-1\",children:minutes.map(minute=>/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"w-full text-left px-2 py-1 hover:bg-indigo-600 hover:text-white rounded \".concat(formData.time&&formData.time.split(':')[1]===minute?'bg-indigo-600 text-white':'text-gray-300'),onClick:()=>handleTimeSelect(formData.time.split(':')[0]||'00',minute),children:minute})},\"minute-\".concat(minute)))})]})]})]})})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"wallet\",className:\"block mb-2 font-medium text-gray-300\",children:\"Wallet\"}),wallets.length>0?/*#__PURE__*/_jsx(Combobox,{name:\"wallet\",options:wallets,displayValue:wallet=>wallet===null||wallet===void 0?void 0:wallet.name,defaultValue:wallets.find(w=>w.id===formData.walletId),onChange:handleWalletChange,\"aria-label\":\"Wallet\",children:wallet=>/*#__PURE__*/_jsx(ComboboxOption,{value:wallet,children:/*#__PURE__*/_jsx(ComboboxLabel,{children:wallet.name})})}):/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 py-2\",children:\"No wallets available. Please add some in Wallets.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-2\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"category\",className:\"font-medium text-gray-300\",children:\"Category\"}),!showNewCategoryInput&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"text-xs px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md transition-colors\",onClick:handleAddNewCategoryClick,children:\"+ New Category\"})]}),showNewCategoryInput?/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:newCategoryName,onChange:handleChange,placeholder:\"New category name\",className:\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500\",autoFocus:true}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"relative mb-4\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:categorySearchQuery,onChange:handleCategorySearchChange,placeholder:\"Search categories...\",className:\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500\"})}),categories.length>0?/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-wrap gap-2\",children:filteredCategories.map(category=>/*#__PURE__*/_jsx(Badge,{color:getCategoryColor(category),className:(selectedCategory===null||selectedCategory===void 0?void 0:selectedCategory.id)===category.id?'ring-2 ring-offset-2 ring-offset-gray-800 ring-indigo-500':'',onClick:()=>handleCategoryChange(category),children:category.name},category.id))}):/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-400 py-2\",children:\"No categories available. Please add some in Settings.\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"mb-6\",children:/*#__PURE__*/_jsx(TagSelectorWithLabel,{selectedTags:formData.tags,availableTags:tags,onChange:handleTagsChange,id:\"tags\",dbInitialized:dbInitialized})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"notes\",className:\"block mb-2 font-medium text-gray-300\",children:\"Notes (optional)\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"notes\",name:\"notes\",value:formData.notes,onChange:handleChange,placeholder:\"Add any additional details...\",className:\"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 min-h-[80px]\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block mb-2 font-medium text-gray-300\",children:\"Photo (optional)\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mb-2\",children:[/*#__PURE__*/_jsxs(\"button\",{type:\"button\",onClick:takePicture,className:\"px-4 py-2 bg-gray-700 text-gray-300 rounded-md hover:bg-gray-600 flex items-center\",children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",className:\"h-5 w-5 mr-1\",viewBox:\"0 0 20 20\",fill:\"currentColor\",children:/*#__PURE__*/_jsx(\"path\",{fillRule:\"evenodd\",d:\"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z\",clipRule:\"evenodd\"})}),\"Take Photo\"]}),previewUrl&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:removePhoto,className:\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700\",children:\"Remove Photo\"})]}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",ref:fileInputRef,accept:\"image/*\",capture:\"camera\",className:\"hidden\",onChange:handlePhotoChange}),previewUrl&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-2 relative\",children:/*#__PURE__*/_jsx(\"img\",{src:previewUrl,alt:\"Preview\",className:\"max-h-48 rounded-md border border-gray-600\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"pb-20\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"sticky bottom-0 left-0 right-0 px-6 py-4 bg-gray-800 border-t border-gray-700 shadow-lg\",children:/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-end\",children:/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleSubmit,className:\"px-6 py-2 text-white rounded-md transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 \".concat(formData.isIncome?'bg-green-600 hover:bg-green-700 focus:ring-green-500':'bg-blue-600 hover:bg-blue-700 focus:ring-blue-500'),children:formData.isIncome?'Add Income':'Add Expense'})})}),/*#__PURE__*/_jsx(CategoryModal,{open:showCategoryModal,onClose:handleCloseCategoryModal,onSave:handleSaveCategory})]});}export default ExpenseForm;","map":{"version":3,"names":["React","useState","useEffect","useRef","Combobox","ComboboxLabel","ComboboxOption","TagSelector","TagSelectorWithLabel","categoryDB","tagDB","walletDB","DateRangePicker","Badge","getColorName","jsx","_jsx","jsxs","_jsxs","CategoryModal","_ref","open","onClose","onSave","input","setInput","handleSave","trim","className","children","type","placeholder","value","onChange","e","target","autoFocus","onClick","ExpenseForm","_ref2","addExpense","dbInitialized","now","Date","currentDate","toISOString","slice","currentTime","toTimeString","formData","setFormData","name","amount","category","tags","walletId","isIncome","notes","photoUrl","date","time","fileInputRef","previewUrl","setPreviewUrl","activeDatePicker","setActiveDatePicker","activeTimePicker","setActiveTimePicker","categories","setCategories","id","setTags","wallets","setWallets","balance","showNewCategoryInput","setShowNewCategoryInput","newCategoryName","setNewCategoryName","categorySearchQuery","setCategorySearchQuery","selectedCategory","setSelectedCategory","showCategoryModal","setShowCategoryModal","loadData","categoryData","getAll","length","defaultCategory","find","cat","prev","_objectSpread","tagData","walletData","loadFromLocalStorage","error","console","savedCategories","localStorage","getItem","parsedCategories","JSON","parse","savedTags","savedWallets","parsedWallets","handleChange","handleToggleType","handlePhotoChange","file","files","startsWith","alert","size","reader","FileReader","onload","event","result","readAsDataURL","removePhoto","current","takePicture","click","handleCategoryChange","handleCategorySearchChange","filteredCategories","filter","toLowerCase","includes","handleTagsChange","selectedTags","handleWalletChange","handleAddNewCategoryClick","handleCloseCategoryModal","handleSaveCategory","colors","randomColor","Math","floor","random","newCategory","replace","color","add","updatedCategories","setItem","stringify","handleSubmit","preventDefault","isNaN","finalCategory","processedTags","allTags","i","tag","existingTag","t","tagError","expenseData","parseFloat","submitError","getCategoryColor","formatDateForDisplay","dateObj","toLocaleDateString","year","month","day","formatTimeForDisplay","hours","minutes","split","h","parseInt","ampm","hour12","concat","Array","from","_","toString","padStart","handleTimeSelect","hour","minute","newTime","xmlns","fill","viewBox","stroke","strokeLinecap","strokeLinejoin","strokeWidth","d","onSubmit","htmlFor","required","step","min","readOnly","start","end","range","dateString","isSingleDatePicker","pickerLabel","map","options","displayValue","wallet","defaultValue","w","availableTags","fillRule","clipRule","ref","accept","capture","src","alt"],"sources":["/Users/ddm/expense-tracker/src/components/ExpenseForm.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport { Combobox, ComboboxLabel, ComboboxOption } from './Combobox';\nimport TagSelector, { TagSelectorWithLabel } from './TagSelector';\nimport { categoryDB, tagDB, walletDB } from '../utils/db';\nimport DateRangePicker from './DateRangePicker';\nimport Badge from './Badge';\nimport { getColorName } from '../utils/colors';\n\nfunction CategoryModal({ open, onClose, onSave }) {\n  const [input, setInput] = useState('');\n\n  const handleSave = () => {\n    if (input.trim()) {\n      onSave(input.trim());\n      setInput('');\n    }\n  };\n\n  if (!open) return null;\n  return (\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50\">\n      <div className=\"bg-gray-800 rounded-lg p-6 w-full max-w-sm shadow-lg\">\n        <h3 className=\"text-lg font-semibold text-white mb-4\">Add New Category</h3>\n        <input\n          type=\"text\"\n          className=\"w-full px-3 py-2 mb-4 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500\"\n          placeholder=\"Category name\"\n          value={input}\n          onChange={e => setInput(e.target.value)}\n          autoFocus\n        />\n        <div className=\"flex justify-end gap-2\">\n          <button\n            type=\"button\"\n            className=\"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-500\"\n            onClick={onClose}\n          >\n            Cancel\n          </button>\n          <button\n            type=\"button\"\n            className=\"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700\"\n            onClick={handleSave}\n          >\n            Save\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nfunction ExpenseForm({ addExpense, dbInitialized = false, onClose }) {\n  // Get current date and time for default values\n  const now = new Date();\n  const currentDate = now.toISOString().slice(0, 10); // YYYY-MM-DD\n  const currentTime = now.toTimeString().slice(0, 5); // HH:MM\n\n  const [formData, setFormData] = useState({\n    name: '',\n    amount: '',\n    category: 'food',\n    tags: [],\n    walletId: 'cash',\n    isIncome: false,\n    notes: '',\n    photoUrl: '',\n    date: currentDate,\n    time: currentTime\n  });\n  \n  const fileInputRef = useRef(null);\n  const [previewUrl, setPreviewUrl] = useState('');\n  \n  // Add state for date picker\n  const [activeDatePicker, setActiveDatePicker] = useState(null); // 'date' or null\n  \n  // Add state for time picker\n  const [activeTimePicker, setActiveTimePicker] = useState(null); // 'time' or null\n  \n  const [categories, setCategories] = useState([\n    { id: 'food', name: 'Food' },\n    { id: 'transportation', name: 'Transportation' },\n    { id: 'entertainment', name: 'Entertainment' },\n    { id: 'utilities', name: 'Utilities' },\n    { id: 'housing', name: 'Housing' },\n    { id: 'healthcare', name: 'Healthcare' },\n    { id: 'other', name: 'Other' }\n  ]);\n\n  const [tags, setTags] = useState([\n    { id: 'essential', name: 'Essential' },\n    { id: 'recurring', name: 'Recurring' },\n    { id: 'emergency', name: 'Emergency' },\n    { id: 'personal', name: 'Personal' },\n    { id: 'work', name: 'Work' }\n  ]);\n\n  const [wallets, setWallets] = useState([\n    { id: 'cash', name: 'Cash', type: 'cash', balance: 0 },\n    { id: 'bank', name: 'Bank Account', type: 'bank', balance: 0 },\n    { id: 'credit', name: 'Credit Card', type: 'credit_card', balance: 0 },\n    { id: 'ewallet', name: 'E-Wallet', type: 'e_wallet', balance: 0 },\n  ]);\n\n  const [showNewCategoryInput, setShowNewCategoryInput] = useState(false);\n  const [newCategoryName, setNewCategoryName] = useState('');\n  const [categorySearchQuery, setCategorySearchQuery] = useState('');\n  const [selectedCategory, setSelectedCategory] = useState(null);\n\n  const [showCategoryModal, setShowCategoryModal] = useState(false);\n\n  // Load categories and tags\n  useEffect(() => {\n    const loadData = async () => {\n      try {\n        if (dbInitialized) {\n          // Load categories from IndexedDB\n          const categoryData = await categoryDB.getAll();\n          if (categoryData.length > 0) {\n            setCategories(categoryData);\n            \n            // Set default category if it exists in the loaded categories\n            const defaultCategory = categoryData.find(cat => cat.id === 'food') || categoryData[0];\n            if (defaultCategory) {\n              setFormData(prev => ({ ...prev, category: defaultCategory.id }));\n            }\n          }\n\n          // Load tags from IndexedDB\n          const tagData = await tagDB.getAll();\n          if (tagData.length > 0) {\n            setTags(tagData);\n          }\n\n          // Load wallets from IndexedDB\n          const walletData = await walletDB.getAll();\n          if (walletData.length > 0) {\n            setWallets(walletData);\n            // Set default wallet if not set\n            setFormData(prev => ({ ...prev, walletId: prev.walletId || walletData[0].id }));\n          }\n        } else {\n          // Fallback to localStorage\n          loadFromLocalStorage();\n        }\n      } catch (error) {\n        console.error('Error loading form data:', error);\n        loadFromLocalStorage();\n      }\n    };\n\n    loadData();\n  }, [dbInitialized]);\n\n  // Load categories from localStorage if needed\n  const loadFromLocalStorage = () => {\n    // Load categories\n    const savedCategories = localStorage.getItem('expense-categories');\n    if (savedCategories) {\n      const parsedCategories = JSON.parse(savedCategories);\n      setCategories(parsedCategories);\n      \n      // Set default category if it exists in the loaded categories\n      const defaultCategory = parsedCategories.find(cat => cat.id === 'food') || parsedCategories[0];\n      if (defaultCategory) {\n        setFormData(prev => ({ ...prev, category: defaultCategory.id }));\n      }\n    }\n\n    // Load tags\n    const savedTags = localStorage.getItem('expense-tags');\n    if (savedTags) {\n      setTags(JSON.parse(savedTags));\n    }\n\n    // Load wallets\n    const savedWallets = localStorage.getItem('wallets');\n    if (savedWallets) {\n      const parsedWallets = JSON.parse(savedWallets);\n      setWallets(parsedWallets);\n      setFormData(prev => ({ ...prev, walletId: prev.walletId || parsedWallets[0].id }));\n    }\n  };\n\n  const handleChange = (e) => {\n    const { name, value } = e.target;\n    setFormData({ ...formData, [name]: value });\n  };\n\n  const handleToggleType = () => {\n    setFormData({ ...formData, isIncome: !formData.isIncome });\n  };\n\n  const handlePhotoChange = (e) => {\n    const file = e.target.files[0];\n    if (!file) return;\n    \n    // Check file type is image\n    if (!file.type.startsWith('image/')) {\n      alert('Please select an image file');\n      return;\n    }\n    \n    // Check file size is less than 5MB\n    if (file.size > 5 * 1024 * 1024) {\n      alert('File size should be less than 5MB');\n      return;\n    }\n    \n    // Convert to base64 for storage\n    const reader = new FileReader();\n    reader.onload = (event) => {\n      setFormData({ ...formData, photoUrl: event.target.result });\n      setPreviewUrl(event.target.result);\n    };\n    reader.readAsDataURL(file);\n  };\n\n  const removePhoto = () => {\n    setFormData({ ...formData, photoUrl: '' });\n    setPreviewUrl('');\n    if (fileInputRef.current) {\n      fileInputRef.current.value = '';\n    }\n  };\n\n  const takePicture = () => {\n    if (fileInputRef.current) {\n      fileInputRef.current.click();\n    }\n  };\n\n  const handleCategoryChange = (category) => {\n    setSelectedCategory(category);\n    setFormData({ ...formData, category: category.id });\n    setCategorySearchQuery(''); // Clear search when selecting\n  };\n\n  const handleCategorySearchChange = (e) => {\n    setCategorySearchQuery(e.target.value);\n  };\n\n  const filteredCategories = categories.filter(category =>\n    category.name.toLowerCase().includes(categorySearchQuery.toLowerCase())\n  );\n\n  const handleTagsChange = (selectedTags) => {\n    setFormData(prev => ({\n      ...prev,\n      tags: selectedTags\n    }));\n  };\n\n  const handleWalletChange = (e) => {\n    setFormData({ ...formData, walletId: e.target.value.id });\n  };\n\n  const handleAddNewCategoryClick = () => {\n    setShowCategoryModal(true);\n  };\n\n  const handleCloseCategoryModal = () => {\n    setShowCategoryModal(false);\n  };\n\n  const handleSaveCategory = async (name) => {\n    // Generate a random color from the available colors\n    const colors = [\n      'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300',\n      'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300',\n      'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300',\n      'bg-indigo-100 text-indigo-800 dark:bg-indigo-900 dark:text-indigo-300',\n      'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300',\n      'bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-300',\n      'bg-lime-100 text-lime-800 dark:bg-lime-900 dark:text-lime-300',\n      'bg-rose-100 text-rose-800 dark:bg-rose-900 dark:text-rose-300',\n      'bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-300',\n      'bg-cyan-100 text-cyan-800 dark:bg-cyan-900 dark:text-cyan-300',\n      'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-300'\n    ];\n    const randomColor = colors[Math.floor(Math.random() * colors.length)];\n\n    const newCategory = {\n      id: name.toLowerCase().replace(/\\s+/g, '-'),\n      name,\n      color: randomColor\n    };\n    try {\n      if (dbInitialized) {\n        await categoryDB.add(newCategory);\n      } else {\n        const updatedCategories = [...categories, newCategory];\n        setCategories(updatedCategories);\n        localStorage.setItem('expense-categories', JSON.stringify(updatedCategories));\n      }\n      setCategories(prev => [...prev, newCategory]);\n      setFormData(prev => ({ ...prev, category: newCategory.id }));\n      setSelectedCategory(newCategory);\n      setShowCategoryModal(false);\n    } catch (error) {\n      alert('Failed to add new category.');\n    }\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    \n    // Validation\n    if (!formData.name.trim() || !formData.amount || isNaN(formData.amount)) {\n      alert('Please enter valid name and amount');\n      return;\n    }\n\n    // Determine the final category to use (user could have created a new one)\n    let finalCategory = formData.category;\n    \n    // If a new category name is entered, add it before saving the transaction\n    if (showNewCategoryInput && newCategoryName.trim()) {\n      const newCategory = {\n        id: newCategoryName.trim().toLowerCase().replace(/\\s+/g, '-'), // Simple ID generation\n        name: newCategoryName.trim(),\n      };\n\n      try {\n        if (dbInitialized) {\n          await categoryDB.add(newCategory);\n        } else {\n          // Fallback to localStorage\n          const updatedCategories = [...categories, newCategory];\n          setCategories(updatedCategories);\n          localStorage.setItem('expense-categories', JSON.stringify(updatedCategories));\n        }\n        // Update the categories state in the form\n        setCategories(prev => [...prev, newCategory]);\n        // Use the new category's id for the current transaction\n        finalCategory = newCategory.id;\n\n        // Reset new category states after saving\n        setNewCategoryName('');\n        setShowNewCategoryInput(false);\n\n      } catch (error) {\n        console.error('Error adding new category on submit:', error);\n        alert('Failed to add new category. Transaction not saved.');\n        return; // Stop submission if new category fails to save\n      }\n    }\n    \n    // Ensure all tags are saved to the database\n    let processedTags = [...formData.tags]; // Copy the tags array\n    \n    if (dbInitialized) {\n      try {\n        // Check if all tags exist in the database, save any that don't\n        const allTags = await tagDB.getAll();\n        \n        // Process each tag to ensure it's saved to the database\n        for (let i = 0; i < processedTags.length; i++) {\n          const tag = processedTags[i];\n          \n          // If it's an object with a name property, it might be a temporary tag\n          if (typeof tag === 'object' && tag !== null && tag.name) {\n            // Check if this tag already exists in the database\n            const existingTag = allTags.find(t => \n              t.id === tag.id || \n              t.name.toLowerCase() === tag.name.toLowerCase()\n            );\n            \n            if (existingTag) {\n              // Use the existing tag instead\n              processedTags[i] = existingTag.id;\n            } else {\n              // Tag doesn't exist, add it to the database\n              try {\n                await tagDB.add(tag);\n                // Replace object reference with just the ID\n                processedTags[i] = tag.id;\n              } catch (tagError) {\n                console.error(\"Error saving tag:\", tagError);\n                // Keep as is if we can't save\n              }\n            }\n          }\n        }\n      } catch (error) {\n        console.error(\"Error processing tags:\", error);\n        // Proceed with original tags if there's an error\n      }\n    }\n    \n    // Format the expense object\n    const expenseData = {\n      name: formData.name.trim(),\n      amount: parseFloat(formData.amount),\n      category: finalCategory,\n      tags: processedTags, // Use the processed tags\n      walletId: formData.walletId,\n      isIncome: formData.isIncome,\n      notes: formData.notes ? formData.notes.trim() : '',\n      photoUrl: formData.photoUrl,\n      date: formData.date, // Keep original date format for saving\n      time: formData.time  // Keep original time format for saving\n    };\n    \n    try {\n      addExpense(expenseData);\n      \n      // Reset form (except category and wallet for convenience)\n      setFormData({\n        name: '',\n        amount: '',\n        category: finalCategory, // Keep the potentially new category for convenience\n        tags: [],\n        walletId: formData.walletId, // Keep the same wallet for convenience\n        isIncome: false,\n        notes: '',\n        photoUrl: '',\n        date: currentDate,\n        time: currentTime\n      });\n      setPreviewUrl('');\n      if (fileInputRef.current) {\n        fileInputRef.current.value = '';\n      }\n    } catch (submitError) {\n      console.error(\"Error adding expense:\", submitError);\n      alert(\"There was a problem saving your expense. Please try again.\");\n    }\n  };\n\n  // Helper function to get category color based on category ID\n  const getCategoryColor = (category) => {\n    if (!category) return 'gray';\n    return getColorName(category.color);\n  };\n\n  // Format a date string as a human-readable date\n  const formatDateForDisplay = (date) => {\n    if (!date) return '';\n    const dateObj = typeof date === 'string' ? new Date(date) : date;\n    return dateObj.toLocaleDateString('en-US', { \n      year: 'numeric', \n      month: 'short', \n      day: 'numeric' \n    });\n  };\n  \n  // Format a time string for display (convert 24h to 12h format)\n  const formatTimeForDisplay = (time) => {\n    if (!time) return '';\n    const [hours, minutes] = time.split(':');\n    const h = parseInt(hours, 10);\n    const ampm = h >= 12 ? 'PM' : 'AM';\n    const hour12 = h % 12 || 12;\n    return `${hour12}:${minutes} ${ampm}`;\n  };\n  \n  // Generate hours for time picker (00-23)\n  const hours = Array.from({ length: 24 }, (_, i) => i.toString().padStart(2, '0'));\n  \n  // Generate minutes for time picker (00-59)\n  const minutes = Array.from({ length: 60 }, (_, i) => i.toString().padStart(2, '0'));\n  \n  // Handle time selection\n  const handleTimeSelect = (hour, minute) => {\n    const newTime = `${hour}:${minute}`;\n    setFormData(prev => ({\n      ...prev,\n      time: newTime\n    }));\n    setActiveTimePicker(null);\n  };\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      {/* Sticky header */}\n      <div className=\"sticky top-0 left-0 right-0 px-6 py-4 bg-gray-800 border-b border-gray-700 z-10\">\n        <div className=\"flex justify-between items-center\">\n          <h2 className=\"text-xl font-semibold text-indigo-300\">\n            Add New {formData.isIncome ? 'Income' : 'Expense'}\n          </h2>\n          <button\n            type=\"button\"\n            className=\"text-gray-400 hover:text-white p-2 rounded-full bg-gray-700 bg-opacity-50\"\n            onClick={onClose}\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n              <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n            </svg>\n          </button>\n        </div>\n      </div>\n      \n      <div className=\"flex-1 overflow-auto px-6 py-4 pt-2\">\n        <div className=\"mb-4\">\n          <div className=\"flex bg-gray-700 rounded-md p-1\">\n            <button\n              type=\"button\"\n              className={`flex-1 py-2 px-4 rounded ${!formData.isIncome ? 'bg-indigo-600 text-white' : 'text-gray-300'}`}\n              onClick={() => !formData.isIncome || handleToggleType()}\n            >\n              Expense\n            </button>\n            <button\n              type=\"button\"\n              className={`flex-1 py-2 px-4 rounded ${formData.isIncome ? 'bg-green-600 text-white' : 'text-gray-300'}`}\n              onClick={() => formData.isIncome || handleToggleType()}\n            >\n              Income\n            </button>\n          </div>\n        </div>\n        \n        <form onSubmit={handleSubmit}>\n          <div className=\"mb-6\">\n            <label htmlFor=\"name\" className=\"block mb-2 font-medium text-gray-300\">\n              {formData.isIncome ? 'Income' : 'Expense'} Name\n            </label>\n            <input\n              type=\"text\"\n              id=\"name\"\n              name=\"name\"\n              value={formData.name}\n              onChange={handleChange}\n              placeholder={formData.isIncome ? \"e.g., Salary\" : \"e.g., Groceries\"}\n              className=\"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500\"\n              required\n              autoFocus\n            />\n          </div>\n          \n          <div className=\"mb-6\">\n            <label htmlFor=\"amount\" className=\"block mb-2 font-medium text-gray-300\">Amount (Rp)</label>\n            <input\n              type=\"number\"\n              id=\"amount\"\n              name=\"amount\"\n              value={formData.amount}\n              onChange={handleChange}\n              placeholder=\"0\"\n              step=\"1000\"\n              min=\"1000\"\n              className=\"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500\"\n              required\n            />\n          </div>\n\n          {/* Date and Time fields */}\n          <div className=\"grid grid-cols-2 gap-4 mb-6\">\n            <div className=\"relative\">\n              <label htmlFor=\"date\" className=\"block mb-2 font-medium text-gray-300\">Date</label>\n              <input\n                type=\"text\"\n                id=\"date\"\n                className=\"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer\"\n                placeholder=\"Select date\"\n                readOnly\n                value={formData.date ? formatDateForDisplay(formData.date) : ''}\n                onClick={() => setActiveDatePicker('date')}\n              />\n              {activeDatePicker === 'date' && (\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 date-picker-container\">\n                  <div className=\"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4\">\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <h4 className=\"text-lg font-medium text-white\">Select Date</h4>\n                      <button\n                        type=\"button\"\n                        className=\"text-gray-400 hover:text-white p-2 rounded-full\"\n                        onClick={() => setActiveDatePicker(null)}\n                      >\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                        </svg>\n                      </button>\n                    </div>\n                    <DateRangePicker\n                      value={{\n                        start: formData.date ? new Date(formData.date) : null,\n                        end: null\n                      }}\n                      onChange={(range) => {\n                        if (range.start) {\n                          const dateString = range.start.toISOString().slice(0, 10);\n                          setFormData(prev => ({\n                            ...prev,\n                            date: dateString\n                          }));\n                        }\n                        setActiveDatePicker(null);\n                      }}\n                      onClose={() => setActiveDatePicker(null)}\n                      isSingleDatePicker={true}\n                      pickerLabel=\"Select Date\"\n                    />\n                  </div>\n                </div>\n              )}\n            </div>\n            <div className=\"relative\">\n              <label htmlFor=\"time\" className=\"block mb-2 font-medium text-gray-300\">Time</label>\n              <input\n                type=\"text\"\n                id=\"time\"\n                className=\"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 cursor-pointer\"\n                placeholder=\"Select time\"\n                readOnly\n                value={formData.time ? formatTimeForDisplay(formData.time) : ''}\n                onClick={() => setActiveTimePicker('time')}\n              />\n              {activeTimePicker === 'time' && (\n                <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-70 time-picker-container\">\n                  <div className=\"bg-gray-800 rounded-lg p-6 w-full max-w-md mx-4\">\n                    <div className=\"flex justify-between items-center mb-4\">\n                      <h4 className=\"text-lg font-medium text-white\">Select Time</h4>\n                      <button\n                        type=\"button\"\n                        className=\"text-gray-400 hover:text-white p-2 rounded-full\"\n                        onClick={() => setActiveTimePicker(null)}\n                      >\n                        <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5\" fill=\"none\" viewBox=\"0 0 24 24\" stroke=\"currentColor\">\n                          <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M6 18L18 6M6 6l12 12\" />\n                        </svg>\n                      </button>\n                    </div>\n                    \n                    <div className=\"flex justify-between p-4 bg-gray-700 rounded-lg\">\n                      {/* Hours */}\n                      <div className=\"space-y-2 max-h-60 overflow-y-auto w-1/2 pr-2\">\n                        <p className=\"text-xs font-semibold text-gray-300 px-2\">Hour</p>\n                        <ul className=\"space-y-1\">\n                          {hours.map(hour => (\n                            <li key={`hour-${hour}`}>\n                              <button \n                                type=\"button\" \n                                className={`w-full text-left px-2 py-1 hover:bg-indigo-600 hover:text-white rounded ${\n                                  formData.time && formData.time.split(':')[0] === hour \n                                    ? 'bg-indigo-600 text-white' \n                                    : 'text-gray-300'\n                                }`}\n                                onClick={() => handleTimeSelect(hour, formData.time.split(':')[1] || '00')}\n                              >\n                                {hour}\n                              </button>\n                            </li>\n                          ))}\n                        </ul>\n                      </div>\n                      \n                      {/* Minutes */}\n                      <div className=\"space-y-2 max-h-60 overflow-y-auto w-1/2 pl-2\">\n                        <p className=\"text-xs font-semibold text-gray-300 px-2\">Minute</p>\n                        <ul className=\"space-y-1\">\n                          {minutes.map(minute => (\n                            <li key={`minute-${minute}`}>\n                              <button \n                                type=\"button\" \n                                className={`w-full text-left px-2 py-1 hover:bg-indigo-600 hover:text-white rounded ${\n                                  formData.time && formData.time.split(':')[1] === minute \n                                    ? 'bg-indigo-600 text-white' \n                                    : 'text-gray-300'\n                                }`}\n                                onClick={() => handleTimeSelect(formData.time.split(':')[0] || '00', minute)}\n                              >\n                                {minute}\n                              </button>\n                            </li>\n                          ))}\n                        </ul>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n          \n          {/* Wallet */}\n          <div className=\"mb-6\">\n            <label htmlFor=\"wallet\" className=\"block mb-2 font-medium text-gray-300\">Wallet</label>\n            {wallets.length > 0 ? (\n              <Combobox\n                name=\"wallet\"\n                options={wallets}\n                displayValue={(wallet) => wallet?.name}\n                defaultValue={wallets.find(w => w.id === formData.walletId)}\n                onChange={handleWalletChange}\n                aria-label=\"Wallet\"\n              >\n                {(wallet) => (\n                  <ComboboxOption value={wallet}>\n                    <ComboboxLabel>{wallet.name}</ComboboxLabel>\n                  </ComboboxOption>\n                )}\n              </Combobox>\n            ) : (\n              <div className=\"text-gray-400 py-2\">\n                No wallets available. Please add some in Wallets.\n              </div>\n            )}\n          </div>\n\n          {/* Category */}\n          <div className=\"mb-6\">\n            <div className=\"flex justify-between items-center mb-2\">\n              <label htmlFor=\"category\" className=\"font-medium text-gray-300\">Category</label>\n              {!showNewCategoryInput && (\n                <button\n                  type=\"button\"\n                  className=\"text-xs px-2 py-1 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md transition-colors\"\n                  onClick={handleAddNewCategoryClick}\n                >\n                  + New Category\n                </button>\n              )}\n            </div>\n            {showNewCategoryInput ? (\n              <input\n                type=\"text\"\n                value={newCategoryName}\n                onChange={handleChange}\n                placeholder=\"New category name\"\n                className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500\"\n                autoFocus\n              />\n            ) : (\n              <div className=\"space-y-4\">\n                <div className=\"relative mb-4\">\n                  <input\n                    type=\"text\"\n                    value={categorySearchQuery}\n                    onChange={handleCategorySearchChange}\n                    placeholder=\"Search categories...\"\n                    className=\"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500\"\n                  />\n                </div>\n                {categories.length > 0 ? (\n                  <div className=\"flex flex-wrap gap-2\">\n                    {filteredCategories.map((category) => (\n                      <Badge\n                        key={category.id}\n                        color={getCategoryColor(category)}\n                        className={selectedCategory?.id === category.id ? 'ring-2 ring-offset-2 ring-offset-gray-800 ring-indigo-500' : ''}\n                        onClick={() => handleCategoryChange(category)}\n                      >\n                        {category.name}\n                      </Badge>\n                    ))}\n                  </div>\n                ) : (\n                  <div className=\"text-gray-400 py-2\">\n                    No categories available. Please add some in Settings.\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n\n          <div className=\"mb-6\">\n            <TagSelectorWithLabel\n              selectedTags={formData.tags}\n              availableTags={tags}\n              onChange={handleTagsChange}\n              id=\"tags\"\n              dbInitialized={dbInitialized}\n            />\n          </div>\n          \n          <div className=\"mb-6\">\n            <label htmlFor=\"notes\" className=\"block mb-2 font-medium text-gray-300\">Notes (optional)</label>\n            <textarea\n              id=\"notes\"\n              name=\"notes\"\n              value={formData.notes}\n              onChange={handleChange}\n              placeholder=\"Add any additional details...\"\n              className=\"w-full px-4 py-2 bg-gray-700 border border-gray-600 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-indigo-500 min-h-[80px]\"\n            />\n          </div>\n          \n          <div className=\"mb-6\">\n            <label className=\"block mb-2 font-medium text-gray-300\">Photo (optional)</label>\n            <div className=\"flex gap-2 mb-2\">\n              <button \n                type=\"button\"\n                onClick={takePicture}\n                className=\"px-4 py-2 bg-gray-700 text-gray-300 rounded-md hover:bg-gray-600 flex items-center\"\n              >\n                <svg xmlns=\"http://www.w3.org/2000/svg\" className=\"h-5 w-5 mr-1\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\n                  <path fillRule=\"evenodd\" d=\"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z\" clipRule=\"evenodd\" />\n                </svg>\n                Take Photo\n              </button>\n              {previewUrl && (\n                <button \n                  type=\"button\"\n                  onClick={removePhoto}\n                  className=\"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700\"\n                >\n                  Remove Photo\n                </button>\n              )}\n            </div>\n            \n            <input\n              type=\"file\"\n              ref={fileInputRef}\n              accept=\"image/*\"\n              capture=\"camera\"\n              className=\"hidden\"\n              onChange={handlePhotoChange}\n            />\n            \n            {previewUrl && (\n              <div className=\"mt-2 relative\">\n                <img \n                  src={previewUrl} \n                  alt=\"Preview\" \n                  className=\"max-h-48 rounded-md border border-gray-600\" \n                />\n              </div>\n            )}\n          </div>\n          \n          <div className=\"pb-20\">\n            {/* Extra space at bottom for sticky footer */}\n          </div>\n        </form>\n      </div>\n      \n      {/* Sticky footer */}\n      <div className=\"sticky bottom-0 left-0 right-0 px-6 py-4 bg-gray-800 border-t border-gray-700 shadow-lg\">\n        <div className=\"flex justify-end\">\n          <button \n            type=\"button\"\n            onClick={handleSubmit}\n            className={`px-6 py-2 text-white rounded-md transition-colors duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-800 ${\n              formData.isIncome \n                ? 'bg-green-600 hover:bg-green-700 focus:ring-green-500'\n                : 'bg-blue-600 hover:bg-blue-700 focus:ring-blue-500'\n            }`}\n          >\n            {formData.isIncome ? 'Add Income' : 'Add Expense'}\n          </button>\n        </div>\n      </div>\n\n      <CategoryModal\n        open={showCategoryModal}\n        onClose={handleCloseCategoryModal}\n        onSave={handleSaveCategory}\n      />\n    </div>\n  );\n}\n\nexport default ExpenseForm; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}